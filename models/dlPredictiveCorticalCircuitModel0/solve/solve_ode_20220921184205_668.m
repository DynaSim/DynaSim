function [T,supExV4_V,supExV4_iNa_m,supExV4_iNa_h,supExV4_iK_n,supIxV4_V,supIxV4_iNa_m,supIxV4_iNa_h,supIxV4_iK_n,midExV4_V,midExV4_iNa_m,midExV4_iNa_h,midExV4_iK_n,midIxV4_V,midIxV4_iNa_m,midIxV4_iNa_h,midIxV4_iK_n,deepExV4_V,deepExV4_iNa_m,deepExV4_iNa_h,deepExV4_iK_n,deepIxV4_V,deepIxV4_iNa_m,deepIxV4_iNa_h,deepIxV4_iK_n,PreStimuliAxV4_V,PreStimuliAxV4_iNa_m,PreStimuliAxV4_iNa_h,PreStimuliAxV4_iK_n,PostStimuliAxV4_V,PostStimuliAxV4_iNa_m,PostStimuliAxV4_iNa_h,PostStimuliAxV4_iK_n,PreStimuliBxV4_V,PreStimuliBxV4_iNa_m,PreStimuliBxV4_iNa_h,PreStimuliBxV4_iK_n,PostStimuliBxV4_V,PostStimuliBxV4_iNa_m,PostStimuliBxV4_iNa_h,PostStimuliBxV4_iK_n,PreStimuliCxV4_V,PreStimuliCxV4_iNa_m,PreStimuliCxV4_iNa_h,PreStimuliCxV4_iK_n,PostStimuliCxV4_V,PostStimuliCxV4_iNa_m,PostStimuliCxV4_iNa_h,PostStimuliCxV4_iK_n,supExPFC_V,supExPFC_iNa_m,supExPFC_iNa_h,supExPFC_iK_n,supIxPFC_V,supIxPFC_iNa_m,supIxPFC_iNa_h,supIxPFC_iK_n,midExPFC_V,midExPFC_iNa_m,midExPFC_iNa_h,midExPFC_iK_n,midIxPFC_V,midIxPFC_iNa_m,midIxPFC_iNa_h,midIxPFC_iK_n,deepExPFC_V,deepExPFC_iNa_m,deepExPFC_iNa_h,deepExPFC_iK_n,deepIxPFC_V,deepIxPFC_iNa_m,deepIxPFC_iNa_h,deepIxPFC_iK_n,PreStimuliAxPFC_V,PreStimuliAxPFC_iNa_m,PreStimuliAxPFC_iNa_h,PreStimuliAxPFC_iK_n,PostStimuliAxPFC_V,PostStimuliAxPFC_iNa_m,PostStimuliAxPFC_iNa_h,PostStimuliAxPFC_iK_n,PreStimuliBxPFC_V,PreStimuliBxPFC_iNa_m,PreStimuliBxPFC_iNa_h,PreStimuliBxPFC_iK_n,PostStimuliBxPFC_V,PostStimuliBxPFC_iNa_m,PostStimuliBxPFC_iNa_h,PostStimuliBxPFC_iK_n,PreStimuliCxPFC_V,PreStimuliCxPFC_iNa_m,PreStimuliCxPFC_iNa_h,PreStimuliCxPFC_iK_n,PostStimuliCxPFC_V,PostStimuliCxPFC_iNa_m,PostStimuliCxPFC_iNa_h,PostStimuliCxPFC_iK_n,supIxV4_supExV4_iAMPActx_s,supExV4_supExV4_iAMPActx_s,supExV4_supIxV4_iGABActx_s,supIxV4_supIxV4_iGABActx_s,midIxV4_midExV4_iAMPActx_s,midExV4_midExV4_iAMPActx_s,midExV4_midIxV4_iGABActx_s,midIxV4_midIxV4_iGABActx_s,deepIxV4_deepExV4_iAMPActx_s,deepExV4_deepExV4_iAMPActx_s,deepExV4_deepIxV4_iGABActx_s,deepIxV4_deepIxV4_iGABActx_s,PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s,PreStimuliAxV4_PreStimuliAxV4_iAMPActx_s,PreStimuliAxV4_PostStimuliAxV4_iAMPActx_s,PostStimuliAxV4_PostStimuliAxV4_iAMPActx_s,PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s,PreStimuliBxV4_PreStimuliBxV4_iAMPActx_s,PreStimuliBxV4_PostStimuliBxV4_iAMPActx_s,PostStimuliBxV4_PostStimuliBxV4_iAMPActx_s,PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s,PreStimuliCxV4_PreStimuliCxV4_iAMPActx_s,PreStimuliCxV4_PostStimuliCxV4_iAMPActx_s,PostStimuliCxV4_PostStimuliCxV4_iAMPActx_s,midExV4_PreStimuliAxV4_iAMPActx_s,midExV4_PostStimuliAxV4_iAMPActx_s,midExV4_PreStimuliBxV4_iAMPActx_s,midExV4_PostStimuliBxV4_iAMPActx_s,midExV4_PreStimuliCxV4_iAMPActx_s,midExV4_PostStimuliCxV4_iAMPActx_s,supExV4_midExV4_iAMPActx_s,deepExV4_midExV4_iAMPActx_s,deepExV4_midIxV4_iGABActx_s,deepExV4_supExV4_iAMPActx_s,supIxPFC_supExPFC_iAMPActx_s,supExPFC_supExPFC_iAMPActx_s,supExPFC_supIxPFC_iGABActx_s,supIxPFC_supIxPFC_iGABActx_s,midIxPFC_midExPFC_iAMPActx_s,midExPFC_midExPFC_iAMPActx_s,midExPFC_midIxPFC_iGABActx_s,midIxPFC_midIxPFC_iGABActx_s,deepIxPFC_deepExPFC_iAMPActx_s,deepExPFC_deepExPFC_iAMPActx_s,deepExPFC_deepIxPFC_iGABActx_s,deepIxPFC_deepIxPFC_iGABActx_s,PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s,PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s,PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s,PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s,PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s,PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s,PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s,PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s,PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s,PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s,PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s,PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s,midExPFC_PreStimuliAxPFC_iAMPActx_s,midExPFC_PostStimuliAxPFC_iAMPActx_s,midExPFC_PreStimuliBxPFC_iAMPActx_s,midExPFC_PostStimuliBxPFC_iAMPActx_s,midExPFC_PreStimuliCxPFC_iAMPActx_s,midExPFC_PostStimuliCxPFC_iAMPActx_s,supExPFC_midExPFC_iAMPActx_s,deepExPFC_midExPFC_iAMPActx_s,deepExPFC_midIxPFC_iGABActx_s,deepExPFC_supExPFC_iAMPActx_s,midExPFC_supExV4_iAMPActx_s,midIxPFC_supIxV4_iAMPActx_s,midIxV4_deepIxPFC_iAMPActx_s,midExV4_deepExPFC_iAMPActx_s]=solve_ode

% ------------------------------------------------------------
% Parameters:
% ------------------------------------------------------------
params = load('params.mat','p');
p = params.p;
downsample_factor=p.downsample_factor;
dt=p.dt;
T=(p.tspan(1):dt:p.tspan(2))';
ntime=length(T);
nsamp=length(1:downsample_factor:ntime);

% seed the random number generator
rng(p.random_seed);

% ------------------------------------------------------------
% Initial conditions:
% ------------------------------------------------------------
t=0; k=1;

% STATE_VARIABLES:
supExV4_V_last =  -rand(1, p.supExV4_Npop)*74;
supExV4_V = zeros(nsamp,p.supExV4_Npop);
supExV4_V(1,:) = supExV4_V_last;
supExV4_iNa_m_last = p.supExV4_iNa_m_IC+p.supExV4_iNa_IC_noise*rand(1,p.supExV4_Npop);
supExV4_iNa_m = zeros(nsamp,p.supExV4_Npop);
supExV4_iNa_m(1,:) = supExV4_iNa_m_last;
supExV4_iNa_h_last = p.supExV4_iNa_h_IC+p.supExV4_iNa_IC_noise*rand(1,p.supExV4_Npop);
supExV4_iNa_h = zeros(nsamp,p.supExV4_Npop);
supExV4_iNa_h(1,:) = supExV4_iNa_h_last;
supExV4_iK_n_last = p.supExV4_iK_n_IC+p.supExV4_iK_IC_noise*rand(1,p.supExV4_Npop);
supExV4_iK_n = zeros(nsamp,p.supExV4_Npop);
supExV4_iK_n(1,:) = supExV4_iK_n_last;
supIxV4_V_last =  -rand(1, p.supIxV4_Npop)*74;
supIxV4_V = zeros(nsamp,p.supIxV4_Npop);
supIxV4_V(1,:) = supIxV4_V_last;
supIxV4_iNa_m_last = p.supIxV4_iNa_m_IC+p.supIxV4_iNa_IC_noise*rand(1,p.supIxV4_Npop);
supIxV4_iNa_m = zeros(nsamp,p.supIxV4_Npop);
supIxV4_iNa_m(1,:) = supIxV4_iNa_m_last;
supIxV4_iNa_h_last = p.supIxV4_iNa_h_IC+p.supIxV4_iNa_IC_noise*rand(1,p.supIxV4_Npop);
supIxV4_iNa_h = zeros(nsamp,p.supIxV4_Npop);
supIxV4_iNa_h(1,:) = supIxV4_iNa_h_last;
supIxV4_iK_n_last = p.supIxV4_iK_n_IC+p.supIxV4_iK_IC_noise*rand(1,p.supIxV4_Npop);
supIxV4_iK_n = zeros(nsamp,p.supIxV4_Npop);
supIxV4_iK_n(1,:) = supIxV4_iK_n_last;
midExV4_V_last =  -rand(1, p.midExV4_Npop)*74;
midExV4_V = zeros(nsamp,p.midExV4_Npop);
midExV4_V(1,:) = midExV4_V_last;
midExV4_iNa_m_last = p.midExV4_iNa_m_IC+p.midExV4_iNa_IC_noise*rand(1,p.midExV4_Npop);
midExV4_iNa_m = zeros(nsamp,p.midExV4_Npop);
midExV4_iNa_m(1,:) = midExV4_iNa_m_last;
midExV4_iNa_h_last = p.midExV4_iNa_h_IC+p.midExV4_iNa_IC_noise*rand(1,p.midExV4_Npop);
midExV4_iNa_h = zeros(nsamp,p.midExV4_Npop);
midExV4_iNa_h(1,:) = midExV4_iNa_h_last;
midExV4_iK_n_last = p.midExV4_iK_n_IC+p.midExV4_iK_IC_noise*rand(1,p.midExV4_Npop);
midExV4_iK_n = zeros(nsamp,p.midExV4_Npop);
midExV4_iK_n(1,:) = midExV4_iK_n_last;
midIxV4_V_last =  -rand(1, p.midIxV4_Npop)*74;
midIxV4_V = zeros(nsamp,p.midIxV4_Npop);
midIxV4_V(1,:) = midIxV4_V_last;
midIxV4_iNa_m_last = p.midIxV4_iNa_m_IC+p.midIxV4_iNa_IC_noise*rand(1,p.midIxV4_Npop);
midIxV4_iNa_m = zeros(nsamp,p.midIxV4_Npop);
midIxV4_iNa_m(1,:) = midIxV4_iNa_m_last;
midIxV4_iNa_h_last = p.midIxV4_iNa_h_IC+p.midIxV4_iNa_IC_noise*rand(1,p.midIxV4_Npop);
midIxV4_iNa_h = zeros(nsamp,p.midIxV4_Npop);
midIxV4_iNa_h(1,:) = midIxV4_iNa_h_last;
midIxV4_iK_n_last = p.midIxV4_iK_n_IC+p.midIxV4_iK_IC_noise*rand(1,p.midIxV4_Npop);
midIxV4_iK_n = zeros(nsamp,p.midIxV4_Npop);
midIxV4_iK_n(1,:) = midIxV4_iK_n_last;
deepExV4_V_last =  -rand(1, p.deepExV4_Npop)*74;
deepExV4_V = zeros(nsamp,p.deepExV4_Npop);
deepExV4_V(1,:) = deepExV4_V_last;
deepExV4_iNa_m_last = p.deepExV4_iNa_m_IC+p.deepExV4_iNa_IC_noise*rand(1,p.deepExV4_Npop);
deepExV4_iNa_m = zeros(nsamp,p.deepExV4_Npop);
deepExV4_iNa_m(1,:) = deepExV4_iNa_m_last;
deepExV4_iNa_h_last = p.deepExV4_iNa_h_IC+p.deepExV4_iNa_IC_noise*rand(1,p.deepExV4_Npop);
deepExV4_iNa_h = zeros(nsamp,p.deepExV4_Npop);
deepExV4_iNa_h(1,:) = deepExV4_iNa_h_last;
deepExV4_iK_n_last = p.deepExV4_iK_n_IC+p.deepExV4_iK_IC_noise*rand(1,p.deepExV4_Npop);
deepExV4_iK_n = zeros(nsamp,p.deepExV4_Npop);
deepExV4_iK_n(1,:) = deepExV4_iK_n_last;
deepIxV4_V_last =  -rand(1, p.deepIxV4_Npop)*74;
deepIxV4_V = zeros(nsamp,p.deepIxV4_Npop);
deepIxV4_V(1,:) = deepIxV4_V_last;
deepIxV4_iNa_m_last = p.deepIxV4_iNa_m_IC+p.deepIxV4_iNa_IC_noise*rand(1,p.deepIxV4_Npop);
deepIxV4_iNa_m = zeros(nsamp,p.deepIxV4_Npop);
deepIxV4_iNa_m(1,:) = deepIxV4_iNa_m_last;
deepIxV4_iNa_h_last = p.deepIxV4_iNa_h_IC+p.deepIxV4_iNa_IC_noise*rand(1,p.deepIxV4_Npop);
deepIxV4_iNa_h = zeros(nsamp,p.deepIxV4_Npop);
deepIxV4_iNa_h(1,:) = deepIxV4_iNa_h_last;
deepIxV4_iK_n_last = p.deepIxV4_iK_n_IC+p.deepIxV4_iK_IC_noise*rand(1,p.deepIxV4_Npop);
deepIxV4_iK_n = zeros(nsamp,p.deepIxV4_Npop);
deepIxV4_iK_n(1,:) = deepIxV4_iK_n_last;
PreStimuliAxV4_V_last =  -60 - rand(1, p.PreStimuliAxV4_Npop)*17;
PreStimuliAxV4_V = zeros(nsamp,p.PreStimuliAxV4_Npop);
PreStimuliAxV4_V(1,:) = PreStimuliAxV4_V_last;
PreStimuliAxV4_iNa_m_last = p.PreStimuliAxV4_iNa_m_IC+p.PreStimuliAxV4_iNa_IC_noise*rand(1,p.PreStimuliAxV4_Npop);
PreStimuliAxV4_iNa_m = zeros(nsamp,p.PreStimuliAxV4_Npop);
PreStimuliAxV4_iNa_m(1,:) = PreStimuliAxV4_iNa_m_last;
PreStimuliAxV4_iNa_h_last = p.PreStimuliAxV4_iNa_h_IC+p.PreStimuliAxV4_iNa_IC_noise*rand(1,p.PreStimuliAxV4_Npop);
PreStimuliAxV4_iNa_h = zeros(nsamp,p.PreStimuliAxV4_Npop);
PreStimuliAxV4_iNa_h(1,:) = PreStimuliAxV4_iNa_h_last;
PreStimuliAxV4_iK_n_last = p.PreStimuliAxV4_iK_n_IC+p.PreStimuliAxV4_iK_IC_noise*rand(1,p.PreStimuliAxV4_Npop);
PreStimuliAxV4_iK_n = zeros(nsamp,p.PreStimuliAxV4_Npop);
PreStimuliAxV4_iK_n(1,:) = PreStimuliAxV4_iK_n_last;
PostStimuliAxV4_V_last =  -60 - rand(1, p.PostStimuliAxV4_Npop)*17;
PostStimuliAxV4_V = zeros(nsamp,p.PostStimuliAxV4_Npop);
PostStimuliAxV4_V(1,:) = PostStimuliAxV4_V_last;
PostStimuliAxV4_iNa_m_last = p.PostStimuliAxV4_iNa_m_IC+p.PostStimuliAxV4_iNa_IC_noise*rand(1,p.PostStimuliAxV4_Npop);
PostStimuliAxV4_iNa_m = zeros(nsamp,p.PostStimuliAxV4_Npop);
PostStimuliAxV4_iNa_m(1,:) = PostStimuliAxV4_iNa_m_last;
PostStimuliAxV4_iNa_h_last = p.PostStimuliAxV4_iNa_h_IC+p.PostStimuliAxV4_iNa_IC_noise*rand(1,p.PostStimuliAxV4_Npop);
PostStimuliAxV4_iNa_h = zeros(nsamp,p.PostStimuliAxV4_Npop);
PostStimuliAxV4_iNa_h(1,:) = PostStimuliAxV4_iNa_h_last;
PostStimuliAxV4_iK_n_last = p.PostStimuliAxV4_iK_n_IC+p.PostStimuliAxV4_iK_IC_noise*rand(1,p.PostStimuliAxV4_Npop);
PostStimuliAxV4_iK_n = zeros(nsamp,p.PostStimuliAxV4_Npop);
PostStimuliAxV4_iK_n(1,:) = PostStimuliAxV4_iK_n_last;
PreStimuliBxV4_V_last =  -60 - rand(1, p.PreStimuliBxV4_Npop)*17;
PreStimuliBxV4_V = zeros(nsamp,p.PreStimuliBxV4_Npop);
PreStimuliBxV4_V(1,:) = PreStimuliBxV4_V_last;
PreStimuliBxV4_iNa_m_last = p.PreStimuliBxV4_iNa_m_IC+p.PreStimuliBxV4_iNa_IC_noise*rand(1,p.PreStimuliBxV4_Npop);
PreStimuliBxV4_iNa_m = zeros(nsamp,p.PreStimuliBxV4_Npop);
PreStimuliBxV4_iNa_m(1,:) = PreStimuliBxV4_iNa_m_last;
PreStimuliBxV4_iNa_h_last = p.PreStimuliBxV4_iNa_h_IC+p.PreStimuliBxV4_iNa_IC_noise*rand(1,p.PreStimuliBxV4_Npop);
PreStimuliBxV4_iNa_h = zeros(nsamp,p.PreStimuliBxV4_Npop);
PreStimuliBxV4_iNa_h(1,:) = PreStimuliBxV4_iNa_h_last;
PreStimuliBxV4_iK_n_last = p.PreStimuliBxV4_iK_n_IC+p.PreStimuliBxV4_iK_IC_noise*rand(1,p.PreStimuliBxV4_Npop);
PreStimuliBxV4_iK_n = zeros(nsamp,p.PreStimuliBxV4_Npop);
PreStimuliBxV4_iK_n(1,:) = PreStimuliBxV4_iK_n_last;
PostStimuliBxV4_V_last =  -60 - rand(1, p.PostStimuliBxV4_Npop)*17;
PostStimuliBxV4_V = zeros(nsamp,p.PostStimuliBxV4_Npop);
PostStimuliBxV4_V(1,:) = PostStimuliBxV4_V_last;
PostStimuliBxV4_iNa_m_last = p.PostStimuliBxV4_iNa_m_IC+p.PostStimuliBxV4_iNa_IC_noise*rand(1,p.PostStimuliBxV4_Npop);
PostStimuliBxV4_iNa_m = zeros(nsamp,p.PostStimuliBxV4_Npop);
PostStimuliBxV4_iNa_m(1,:) = PostStimuliBxV4_iNa_m_last;
PostStimuliBxV4_iNa_h_last = p.PostStimuliBxV4_iNa_h_IC+p.PostStimuliBxV4_iNa_IC_noise*rand(1,p.PostStimuliBxV4_Npop);
PostStimuliBxV4_iNa_h = zeros(nsamp,p.PostStimuliBxV4_Npop);
PostStimuliBxV4_iNa_h(1,:) = PostStimuliBxV4_iNa_h_last;
PostStimuliBxV4_iK_n_last = p.PostStimuliBxV4_iK_n_IC+p.PostStimuliBxV4_iK_IC_noise*rand(1,p.PostStimuliBxV4_Npop);
PostStimuliBxV4_iK_n = zeros(nsamp,p.PostStimuliBxV4_Npop);
PostStimuliBxV4_iK_n(1,:) = PostStimuliBxV4_iK_n_last;
PreStimuliCxV4_V_last =  -60 - rand(1, p.PreStimuliCxV4_Npop)*17;
PreStimuliCxV4_V = zeros(nsamp,p.PreStimuliCxV4_Npop);
PreStimuliCxV4_V(1,:) = PreStimuliCxV4_V_last;
PreStimuliCxV4_iNa_m_last = p.PreStimuliCxV4_iNa_m_IC+p.PreStimuliCxV4_iNa_IC_noise*rand(1,p.PreStimuliCxV4_Npop);
PreStimuliCxV4_iNa_m = zeros(nsamp,p.PreStimuliCxV4_Npop);
PreStimuliCxV4_iNa_m(1,:) = PreStimuliCxV4_iNa_m_last;
PreStimuliCxV4_iNa_h_last = p.PreStimuliCxV4_iNa_h_IC+p.PreStimuliCxV4_iNa_IC_noise*rand(1,p.PreStimuliCxV4_Npop);
PreStimuliCxV4_iNa_h = zeros(nsamp,p.PreStimuliCxV4_Npop);
PreStimuliCxV4_iNa_h(1,:) = PreStimuliCxV4_iNa_h_last;
PreStimuliCxV4_iK_n_last = p.PreStimuliCxV4_iK_n_IC+p.PreStimuliCxV4_iK_IC_noise*rand(1,p.PreStimuliCxV4_Npop);
PreStimuliCxV4_iK_n = zeros(nsamp,p.PreStimuliCxV4_Npop);
PreStimuliCxV4_iK_n(1,:) = PreStimuliCxV4_iK_n_last;
PostStimuliCxV4_V_last =  -60 - rand(1, p.PostStimuliCxV4_Npop)*17;
PostStimuliCxV4_V = zeros(nsamp,p.PostStimuliCxV4_Npop);
PostStimuliCxV4_V(1,:) = PostStimuliCxV4_V_last;
PostStimuliCxV4_iNa_m_last = p.PostStimuliCxV4_iNa_m_IC+p.PostStimuliCxV4_iNa_IC_noise*rand(1,p.PostStimuliCxV4_Npop);
PostStimuliCxV4_iNa_m = zeros(nsamp,p.PostStimuliCxV4_Npop);
PostStimuliCxV4_iNa_m(1,:) = PostStimuliCxV4_iNa_m_last;
PostStimuliCxV4_iNa_h_last = p.PostStimuliCxV4_iNa_h_IC+p.PostStimuliCxV4_iNa_IC_noise*rand(1,p.PostStimuliCxV4_Npop);
PostStimuliCxV4_iNa_h = zeros(nsamp,p.PostStimuliCxV4_Npop);
PostStimuliCxV4_iNa_h(1,:) = PostStimuliCxV4_iNa_h_last;
PostStimuliCxV4_iK_n_last = p.PostStimuliCxV4_iK_n_IC+p.PostStimuliCxV4_iK_IC_noise*rand(1,p.PostStimuliCxV4_Npop);
PostStimuliCxV4_iK_n = zeros(nsamp,p.PostStimuliCxV4_Npop);
PostStimuliCxV4_iK_n(1,:) = PostStimuliCxV4_iK_n_last;
supExPFC_V_last =  -rand(1, p.supExPFC_Npop)*74;
supExPFC_V = zeros(nsamp,p.supExPFC_Npop);
supExPFC_V(1,:) = supExPFC_V_last;
supExPFC_iNa_m_last = p.supExPFC_iNa_m_IC+p.supExPFC_iNa_IC_noise*rand(1,p.supExPFC_Npop);
supExPFC_iNa_m = zeros(nsamp,p.supExPFC_Npop);
supExPFC_iNa_m(1,:) = supExPFC_iNa_m_last;
supExPFC_iNa_h_last = p.supExPFC_iNa_h_IC+p.supExPFC_iNa_IC_noise*rand(1,p.supExPFC_Npop);
supExPFC_iNa_h = zeros(nsamp,p.supExPFC_Npop);
supExPFC_iNa_h(1,:) = supExPFC_iNa_h_last;
supExPFC_iK_n_last = p.supExPFC_iK_n_IC+p.supExPFC_iK_IC_noise*rand(1,p.supExPFC_Npop);
supExPFC_iK_n = zeros(nsamp,p.supExPFC_Npop);
supExPFC_iK_n(1,:) = supExPFC_iK_n_last;
supIxPFC_V_last =  -rand(1, p.supIxPFC_Npop)*74;
supIxPFC_V = zeros(nsamp,p.supIxPFC_Npop);
supIxPFC_V(1,:) = supIxPFC_V_last;
supIxPFC_iNa_m_last = p.supIxPFC_iNa_m_IC+p.supIxPFC_iNa_IC_noise*rand(1,p.supIxPFC_Npop);
supIxPFC_iNa_m = zeros(nsamp,p.supIxPFC_Npop);
supIxPFC_iNa_m(1,:) = supIxPFC_iNa_m_last;
supIxPFC_iNa_h_last = p.supIxPFC_iNa_h_IC+p.supIxPFC_iNa_IC_noise*rand(1,p.supIxPFC_Npop);
supIxPFC_iNa_h = zeros(nsamp,p.supIxPFC_Npop);
supIxPFC_iNa_h(1,:) = supIxPFC_iNa_h_last;
supIxPFC_iK_n_last = p.supIxPFC_iK_n_IC+p.supIxPFC_iK_IC_noise*rand(1,p.supIxPFC_Npop);
supIxPFC_iK_n = zeros(nsamp,p.supIxPFC_Npop);
supIxPFC_iK_n(1,:) = supIxPFC_iK_n_last;
midExPFC_V_last =  -rand(1, p.midExPFC_Npop)*74;
midExPFC_V = zeros(nsamp,p.midExPFC_Npop);
midExPFC_V(1,:) = midExPFC_V_last;
midExPFC_iNa_m_last = p.midExPFC_iNa_m_IC+p.midExPFC_iNa_IC_noise*rand(1,p.midExPFC_Npop);
midExPFC_iNa_m = zeros(nsamp,p.midExPFC_Npop);
midExPFC_iNa_m(1,:) = midExPFC_iNa_m_last;
midExPFC_iNa_h_last = p.midExPFC_iNa_h_IC+p.midExPFC_iNa_IC_noise*rand(1,p.midExPFC_Npop);
midExPFC_iNa_h = zeros(nsamp,p.midExPFC_Npop);
midExPFC_iNa_h(1,:) = midExPFC_iNa_h_last;
midExPFC_iK_n_last = p.midExPFC_iK_n_IC+p.midExPFC_iK_IC_noise*rand(1,p.midExPFC_Npop);
midExPFC_iK_n = zeros(nsamp,p.midExPFC_Npop);
midExPFC_iK_n(1,:) = midExPFC_iK_n_last;
midIxPFC_V_last =  -rand(1, p.midIxPFC_Npop)*74;
midIxPFC_V = zeros(nsamp,p.midIxPFC_Npop);
midIxPFC_V(1,:) = midIxPFC_V_last;
midIxPFC_iNa_m_last = p.midIxPFC_iNa_m_IC+p.midIxPFC_iNa_IC_noise*rand(1,p.midIxPFC_Npop);
midIxPFC_iNa_m = zeros(nsamp,p.midIxPFC_Npop);
midIxPFC_iNa_m(1,:) = midIxPFC_iNa_m_last;
midIxPFC_iNa_h_last = p.midIxPFC_iNa_h_IC+p.midIxPFC_iNa_IC_noise*rand(1,p.midIxPFC_Npop);
midIxPFC_iNa_h = zeros(nsamp,p.midIxPFC_Npop);
midIxPFC_iNa_h(1,:) = midIxPFC_iNa_h_last;
midIxPFC_iK_n_last = p.midIxPFC_iK_n_IC+p.midIxPFC_iK_IC_noise*rand(1,p.midIxPFC_Npop);
midIxPFC_iK_n = zeros(nsamp,p.midIxPFC_Npop);
midIxPFC_iK_n(1,:) = midIxPFC_iK_n_last;
deepExPFC_V_last =  -rand(1, p.deepExPFC_Npop)*74;
deepExPFC_V = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_V(1,:) = deepExPFC_V_last;
deepExPFC_iNa_m_last = p.deepExPFC_iNa_m_IC+p.deepExPFC_iNa_IC_noise*rand(1,p.deepExPFC_Npop);
deepExPFC_iNa_m = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_iNa_m(1,:) = deepExPFC_iNa_m_last;
deepExPFC_iNa_h_last = p.deepExPFC_iNa_h_IC+p.deepExPFC_iNa_IC_noise*rand(1,p.deepExPFC_Npop);
deepExPFC_iNa_h = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_iNa_h(1,:) = deepExPFC_iNa_h_last;
deepExPFC_iK_n_last = p.deepExPFC_iK_n_IC+p.deepExPFC_iK_IC_noise*rand(1,p.deepExPFC_Npop);
deepExPFC_iK_n = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_iK_n(1,:) = deepExPFC_iK_n_last;
deepIxPFC_V_last =  -rand(1, p.deepIxPFC_Npop)*74;
deepIxPFC_V = zeros(nsamp,p.deepIxPFC_Npop);
deepIxPFC_V(1,:) = deepIxPFC_V_last;
deepIxPFC_iNa_m_last = p.deepIxPFC_iNa_m_IC+p.deepIxPFC_iNa_IC_noise*rand(1,p.deepIxPFC_Npop);
deepIxPFC_iNa_m = zeros(nsamp,p.deepIxPFC_Npop);
deepIxPFC_iNa_m(1,:) = deepIxPFC_iNa_m_last;
deepIxPFC_iNa_h_last = p.deepIxPFC_iNa_h_IC+p.deepIxPFC_iNa_IC_noise*rand(1,p.deepIxPFC_Npop);
deepIxPFC_iNa_h = zeros(nsamp,p.deepIxPFC_Npop);
deepIxPFC_iNa_h(1,:) = deepIxPFC_iNa_h_last;
deepIxPFC_iK_n_last = p.deepIxPFC_iK_n_IC+p.deepIxPFC_iK_IC_noise*rand(1,p.deepIxPFC_Npop);
deepIxPFC_iK_n = zeros(nsamp,p.deepIxPFC_Npop);
deepIxPFC_iK_n(1,:) = deepIxPFC_iK_n_last;
PreStimuliAxPFC_V_last =  -60 - rand(1, p.PreStimuliAxPFC_Npop)*17;
PreStimuliAxPFC_V = zeros(nsamp,p.PreStimuliAxPFC_Npop);
PreStimuliAxPFC_V(1,:) = PreStimuliAxPFC_V_last;
PreStimuliAxPFC_iNa_m_last = p.PreStimuliAxPFC_iNa_m_IC+p.PreStimuliAxPFC_iNa_IC_noise*rand(1,p.PreStimuliAxPFC_Npop);
PreStimuliAxPFC_iNa_m = zeros(nsamp,p.PreStimuliAxPFC_Npop);
PreStimuliAxPFC_iNa_m(1,:) = PreStimuliAxPFC_iNa_m_last;
PreStimuliAxPFC_iNa_h_last = p.PreStimuliAxPFC_iNa_h_IC+p.PreStimuliAxPFC_iNa_IC_noise*rand(1,p.PreStimuliAxPFC_Npop);
PreStimuliAxPFC_iNa_h = zeros(nsamp,p.PreStimuliAxPFC_Npop);
PreStimuliAxPFC_iNa_h(1,:) = PreStimuliAxPFC_iNa_h_last;
PreStimuliAxPFC_iK_n_last = p.PreStimuliAxPFC_iK_n_IC+p.PreStimuliAxPFC_iK_IC_noise*rand(1,p.PreStimuliAxPFC_Npop);
PreStimuliAxPFC_iK_n = zeros(nsamp,p.PreStimuliAxPFC_Npop);
PreStimuliAxPFC_iK_n(1,:) = PreStimuliAxPFC_iK_n_last;
PostStimuliAxPFC_V_last =  -60 - rand(1, p.PostStimuliAxPFC_Npop)*17;
PostStimuliAxPFC_V = zeros(nsamp,p.PostStimuliAxPFC_Npop);
PostStimuliAxPFC_V(1,:) = PostStimuliAxPFC_V_last;
PostStimuliAxPFC_iNa_m_last = p.PostStimuliAxPFC_iNa_m_IC+p.PostStimuliAxPFC_iNa_IC_noise*rand(1,p.PostStimuliAxPFC_Npop);
PostStimuliAxPFC_iNa_m = zeros(nsamp,p.PostStimuliAxPFC_Npop);
PostStimuliAxPFC_iNa_m(1,:) = PostStimuliAxPFC_iNa_m_last;
PostStimuliAxPFC_iNa_h_last = p.PostStimuliAxPFC_iNa_h_IC+p.PostStimuliAxPFC_iNa_IC_noise*rand(1,p.PostStimuliAxPFC_Npop);
PostStimuliAxPFC_iNa_h = zeros(nsamp,p.PostStimuliAxPFC_Npop);
PostStimuliAxPFC_iNa_h(1,:) = PostStimuliAxPFC_iNa_h_last;
PostStimuliAxPFC_iK_n_last = p.PostStimuliAxPFC_iK_n_IC+p.PostStimuliAxPFC_iK_IC_noise*rand(1,p.PostStimuliAxPFC_Npop);
PostStimuliAxPFC_iK_n = zeros(nsamp,p.PostStimuliAxPFC_Npop);
PostStimuliAxPFC_iK_n(1,:) = PostStimuliAxPFC_iK_n_last;
PreStimuliBxPFC_V_last =  -60 - rand(1, p.PreStimuliBxPFC_Npop)*17;
PreStimuliBxPFC_V = zeros(nsamp,p.PreStimuliBxPFC_Npop);
PreStimuliBxPFC_V(1,:) = PreStimuliBxPFC_V_last;
PreStimuliBxPFC_iNa_m_last = p.PreStimuliBxPFC_iNa_m_IC+p.PreStimuliBxPFC_iNa_IC_noise*rand(1,p.PreStimuliBxPFC_Npop);
PreStimuliBxPFC_iNa_m = zeros(nsamp,p.PreStimuliBxPFC_Npop);
PreStimuliBxPFC_iNa_m(1,:) = PreStimuliBxPFC_iNa_m_last;
PreStimuliBxPFC_iNa_h_last = p.PreStimuliBxPFC_iNa_h_IC+p.PreStimuliBxPFC_iNa_IC_noise*rand(1,p.PreStimuliBxPFC_Npop);
PreStimuliBxPFC_iNa_h = zeros(nsamp,p.PreStimuliBxPFC_Npop);
PreStimuliBxPFC_iNa_h(1,:) = PreStimuliBxPFC_iNa_h_last;
PreStimuliBxPFC_iK_n_last = p.PreStimuliBxPFC_iK_n_IC+p.PreStimuliBxPFC_iK_IC_noise*rand(1,p.PreStimuliBxPFC_Npop);
PreStimuliBxPFC_iK_n = zeros(nsamp,p.PreStimuliBxPFC_Npop);
PreStimuliBxPFC_iK_n(1,:) = PreStimuliBxPFC_iK_n_last;
PostStimuliBxPFC_V_last =  -60 - rand(1, p.PostStimuliBxPFC_Npop)*17;
PostStimuliBxPFC_V = zeros(nsamp,p.PostStimuliBxPFC_Npop);
PostStimuliBxPFC_V(1,:) = PostStimuliBxPFC_V_last;
PostStimuliBxPFC_iNa_m_last = p.PostStimuliBxPFC_iNa_m_IC+p.PostStimuliBxPFC_iNa_IC_noise*rand(1,p.PostStimuliBxPFC_Npop);
PostStimuliBxPFC_iNa_m = zeros(nsamp,p.PostStimuliBxPFC_Npop);
PostStimuliBxPFC_iNa_m(1,:) = PostStimuliBxPFC_iNa_m_last;
PostStimuliBxPFC_iNa_h_last = p.PostStimuliBxPFC_iNa_h_IC+p.PostStimuliBxPFC_iNa_IC_noise*rand(1,p.PostStimuliBxPFC_Npop);
PostStimuliBxPFC_iNa_h = zeros(nsamp,p.PostStimuliBxPFC_Npop);
PostStimuliBxPFC_iNa_h(1,:) = PostStimuliBxPFC_iNa_h_last;
PostStimuliBxPFC_iK_n_last = p.PostStimuliBxPFC_iK_n_IC+p.PostStimuliBxPFC_iK_IC_noise*rand(1,p.PostStimuliBxPFC_Npop);
PostStimuliBxPFC_iK_n = zeros(nsamp,p.PostStimuliBxPFC_Npop);
PostStimuliBxPFC_iK_n(1,:) = PostStimuliBxPFC_iK_n_last;
PreStimuliCxPFC_V_last =  -60 - rand(1, p.PreStimuliCxPFC_Npop)*17;
PreStimuliCxPFC_V = zeros(nsamp,p.PreStimuliCxPFC_Npop);
PreStimuliCxPFC_V(1,:) = PreStimuliCxPFC_V_last;
PreStimuliCxPFC_iNa_m_last = p.PreStimuliCxPFC_iNa_m_IC+p.PreStimuliCxPFC_iNa_IC_noise*rand(1,p.PreStimuliCxPFC_Npop);
PreStimuliCxPFC_iNa_m = zeros(nsamp,p.PreStimuliCxPFC_Npop);
PreStimuliCxPFC_iNa_m(1,:) = PreStimuliCxPFC_iNa_m_last;
PreStimuliCxPFC_iNa_h_last = p.PreStimuliCxPFC_iNa_h_IC+p.PreStimuliCxPFC_iNa_IC_noise*rand(1,p.PreStimuliCxPFC_Npop);
PreStimuliCxPFC_iNa_h = zeros(nsamp,p.PreStimuliCxPFC_Npop);
PreStimuliCxPFC_iNa_h(1,:) = PreStimuliCxPFC_iNa_h_last;
PreStimuliCxPFC_iK_n_last = p.PreStimuliCxPFC_iK_n_IC+p.PreStimuliCxPFC_iK_IC_noise*rand(1,p.PreStimuliCxPFC_Npop);
PreStimuliCxPFC_iK_n = zeros(nsamp,p.PreStimuliCxPFC_Npop);
PreStimuliCxPFC_iK_n(1,:) = PreStimuliCxPFC_iK_n_last;
PostStimuliCxPFC_V_last =  -60 - rand(1, p.PostStimuliCxPFC_Npop)*17;
PostStimuliCxPFC_V = zeros(nsamp,p.PostStimuliCxPFC_Npop);
PostStimuliCxPFC_V(1,:) = PostStimuliCxPFC_V_last;
PostStimuliCxPFC_iNa_m_last = p.PostStimuliCxPFC_iNa_m_IC+p.PostStimuliCxPFC_iNa_IC_noise*rand(1,p.PostStimuliCxPFC_Npop);
PostStimuliCxPFC_iNa_m = zeros(nsamp,p.PostStimuliCxPFC_Npop);
PostStimuliCxPFC_iNa_m(1,:) = PostStimuliCxPFC_iNa_m_last;
PostStimuliCxPFC_iNa_h_last = p.PostStimuliCxPFC_iNa_h_IC+p.PostStimuliCxPFC_iNa_IC_noise*rand(1,p.PostStimuliCxPFC_Npop);
PostStimuliCxPFC_iNa_h = zeros(nsamp,p.PostStimuliCxPFC_Npop);
PostStimuliCxPFC_iNa_h(1,:) = PostStimuliCxPFC_iNa_h_last;
PostStimuliCxPFC_iK_n_last = p.PostStimuliCxPFC_iK_n_IC+p.PostStimuliCxPFC_iK_IC_noise*rand(1,p.PostStimuliCxPFC_Npop);
PostStimuliCxPFC_iK_n = zeros(nsamp,p.PostStimuliCxPFC_Npop);
PostStimuliCxPFC_iK_n(1,:) = PostStimuliCxPFC_iK_n_last;
supIxV4_supExV4_iAMPActx_s_last =  p.supIxV4_supExV4_iAMPActx_IC+p.supIxV4_supExV4_iAMPActx_IC_noise.*rand(1,p.supExV4_Npop);
supIxV4_supExV4_iAMPActx_s = zeros(nsamp,p.supExV4_Npop);
supIxV4_supExV4_iAMPActx_s(1,:) = supIxV4_supExV4_iAMPActx_s_last;
supExV4_supExV4_iAMPActx_s_last =  p.supExV4_supExV4_iAMPActx_IC+p.supExV4_supExV4_iAMPActx_IC_noise.*rand(1,p.supExV4_Npop);
supExV4_supExV4_iAMPActx_s = zeros(nsamp,p.supExV4_Npop);
supExV4_supExV4_iAMPActx_s(1,:) = supExV4_supExV4_iAMPActx_s_last;
supExV4_supIxV4_iGABActx_s_last =  p.supExV4_supIxV4_iGABActx_IC+p.supExV4_supIxV4_iGABActx_IC_noise.*rand(1,p.supIxV4_Npop);
supExV4_supIxV4_iGABActx_s = zeros(nsamp,p.supIxV4_Npop);
supExV4_supIxV4_iGABActx_s(1,:) = supExV4_supIxV4_iGABActx_s_last;
supIxV4_supIxV4_iGABActx_s_last =  p.supIxV4_supIxV4_iGABActx_IC+p.supIxV4_supIxV4_iGABActx_IC_noise.*rand(1,p.supIxV4_Npop);
supIxV4_supIxV4_iGABActx_s = zeros(nsamp,p.supIxV4_Npop);
supIxV4_supIxV4_iGABActx_s(1,:) = supIxV4_supIxV4_iGABActx_s_last;
midIxV4_midExV4_iAMPActx_s_last =  p.midIxV4_midExV4_iAMPActx_IC+p.midIxV4_midExV4_iAMPActx_IC_noise.*rand(1,p.midExV4_Npop);
midIxV4_midExV4_iAMPActx_s = zeros(nsamp,p.midExV4_Npop);
midIxV4_midExV4_iAMPActx_s(1,:) = midIxV4_midExV4_iAMPActx_s_last;
midExV4_midExV4_iAMPActx_s_last =  p.midExV4_midExV4_iAMPActx_IC+p.midExV4_midExV4_iAMPActx_IC_noise.*rand(1,p.midExV4_Npop);
midExV4_midExV4_iAMPActx_s = zeros(nsamp,p.midExV4_Npop);
midExV4_midExV4_iAMPActx_s(1,:) = midExV4_midExV4_iAMPActx_s_last;
midExV4_midIxV4_iGABActx_s_last =  p.midExV4_midIxV4_iGABActx_IC+p.midExV4_midIxV4_iGABActx_IC_noise.*rand(1,p.midIxV4_Npop);
midExV4_midIxV4_iGABActx_s = zeros(nsamp,p.midIxV4_Npop);
midExV4_midIxV4_iGABActx_s(1,:) = midExV4_midIxV4_iGABActx_s_last;
midIxV4_midIxV4_iGABActx_s_last =  p.midIxV4_midIxV4_iGABActx_IC+p.midIxV4_midIxV4_iGABActx_IC_noise.*rand(1,p.midIxV4_Npop);
midIxV4_midIxV4_iGABActx_s = zeros(nsamp,p.midIxV4_Npop);
midIxV4_midIxV4_iGABActx_s(1,:) = midIxV4_midIxV4_iGABActx_s_last;
deepIxV4_deepExV4_iAMPActx_s_last =  p.deepIxV4_deepExV4_iAMPActx_IC+p.deepIxV4_deepExV4_iAMPActx_IC_noise.*rand(1,p.deepExV4_Npop);
deepIxV4_deepExV4_iAMPActx_s = zeros(nsamp,p.deepExV4_Npop);
deepIxV4_deepExV4_iAMPActx_s(1,:) = deepIxV4_deepExV4_iAMPActx_s_last;
deepExV4_deepExV4_iAMPActx_s_last =  p.deepExV4_deepExV4_iAMPActx_IC+p.deepExV4_deepExV4_iAMPActx_IC_noise.*rand(1,p.deepExV4_Npop);
deepExV4_deepExV4_iAMPActx_s = zeros(nsamp,p.deepExV4_Npop);
deepExV4_deepExV4_iAMPActx_s(1,:) = deepExV4_deepExV4_iAMPActx_s_last;
deepExV4_deepIxV4_iGABActx_s_last =  p.deepExV4_deepIxV4_iGABActx_IC+p.deepExV4_deepIxV4_iGABActx_IC_noise.*rand(1,p.deepIxV4_Npop);
deepExV4_deepIxV4_iGABActx_s = zeros(nsamp,p.deepIxV4_Npop);
deepExV4_deepIxV4_iGABActx_s(1,:) = deepExV4_deepIxV4_iGABActx_s_last;
deepIxV4_deepIxV4_iGABActx_s_last =  p.deepIxV4_deepIxV4_iGABActx_IC+p.deepIxV4_deepIxV4_iGABActx_IC_noise.*rand(1,p.deepIxV4_Npop);
deepIxV4_deepIxV4_iGABActx_s = zeros(nsamp,p.deepIxV4_Npop);
deepIxV4_deepIxV4_iGABActx_s(1,:) = deepIxV4_deepIxV4_iGABActx_s_last;
PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last =  p.PostStimuliAxV4_PreStimuliAxV4_iAMPActx_IC+p.PostStimuliAxV4_PreStimuliAxV4_iAMPActx_IC_noise.*rand(1,p.PreStimuliAxV4_Npop);
PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s = zeros(nsamp,p.PreStimuliAxV4_Npop);
PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s(1,:) = PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last;
PreStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last =  p.PreStimuliAxV4_PreStimuliAxV4_iAMPActx_IC+p.PreStimuliAxV4_PreStimuliAxV4_iAMPActx_IC_noise.*rand(1,p.PreStimuliAxV4_Npop);
PreStimuliAxV4_PreStimuliAxV4_iAMPActx_s = zeros(nsamp,p.PreStimuliAxV4_Npop);
PreStimuliAxV4_PreStimuliAxV4_iAMPActx_s(1,:) = PreStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last;
PreStimuliAxV4_PostStimuliAxV4_iAMPActx_s_last =  p.PreStimuliAxV4_PostStimuliAxV4_iAMPActx_IC+p.PreStimuliAxV4_PostStimuliAxV4_iAMPActx_IC_noise.*rand(1,p.PostStimuliAxV4_Npop);
PreStimuliAxV4_PostStimuliAxV4_iAMPActx_s = zeros(nsamp,p.PostStimuliAxV4_Npop);
PreStimuliAxV4_PostStimuliAxV4_iAMPActx_s(1,:) = PreStimuliAxV4_PostStimuliAxV4_iAMPActx_s_last;
PostStimuliAxV4_PostStimuliAxV4_iAMPActx_s_last =  p.PostStimuliAxV4_PostStimuliAxV4_iAMPActx_IC+p.PostStimuliAxV4_PostStimuliAxV4_iAMPActx_IC_noise.*rand(1,p.PostStimuliAxV4_Npop);
PostStimuliAxV4_PostStimuliAxV4_iAMPActx_s = zeros(nsamp,p.PostStimuliAxV4_Npop);
PostStimuliAxV4_PostStimuliAxV4_iAMPActx_s(1,:) = PostStimuliAxV4_PostStimuliAxV4_iAMPActx_s_last;
PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last =  p.PostStimuliBxV4_PreStimuliBxV4_iAMPActx_IC+p.PostStimuliBxV4_PreStimuliBxV4_iAMPActx_IC_noise.*rand(1,p.PreStimuliBxV4_Npop);
PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s = zeros(nsamp,p.PreStimuliBxV4_Npop);
PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s(1,:) = PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last;
PreStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last =  p.PreStimuliBxV4_PreStimuliBxV4_iAMPActx_IC+p.PreStimuliBxV4_PreStimuliBxV4_iAMPActx_IC_noise.*rand(1,p.PreStimuliBxV4_Npop);
PreStimuliBxV4_PreStimuliBxV4_iAMPActx_s = zeros(nsamp,p.PreStimuliBxV4_Npop);
PreStimuliBxV4_PreStimuliBxV4_iAMPActx_s(1,:) = PreStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last;
PreStimuliBxV4_PostStimuliBxV4_iAMPActx_s_last =  p.PreStimuliBxV4_PostStimuliBxV4_iAMPActx_IC+p.PreStimuliBxV4_PostStimuliBxV4_iAMPActx_IC_noise.*rand(1,p.PostStimuliBxV4_Npop);
PreStimuliBxV4_PostStimuliBxV4_iAMPActx_s = zeros(nsamp,p.PostStimuliBxV4_Npop);
PreStimuliBxV4_PostStimuliBxV4_iAMPActx_s(1,:) = PreStimuliBxV4_PostStimuliBxV4_iAMPActx_s_last;
PostStimuliBxV4_PostStimuliBxV4_iAMPActx_s_last =  p.PostStimuliBxV4_PostStimuliBxV4_iAMPActx_IC+p.PostStimuliBxV4_PostStimuliBxV4_iAMPActx_IC_noise.*rand(1,p.PostStimuliBxV4_Npop);
PostStimuliBxV4_PostStimuliBxV4_iAMPActx_s = zeros(nsamp,p.PostStimuliBxV4_Npop);
PostStimuliBxV4_PostStimuliBxV4_iAMPActx_s(1,:) = PostStimuliBxV4_PostStimuliBxV4_iAMPActx_s_last;
PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last =  p.PostStimuliCxV4_PreStimuliCxV4_iAMPActx_IC+p.PostStimuliCxV4_PreStimuliCxV4_iAMPActx_IC_noise.*rand(1,p.PreStimuliCxV4_Npop);
PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s = zeros(nsamp,p.PreStimuliCxV4_Npop);
PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s(1,:) = PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last;
PreStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last =  p.PreStimuliCxV4_PreStimuliCxV4_iAMPActx_IC+p.PreStimuliCxV4_PreStimuliCxV4_iAMPActx_IC_noise.*rand(1,p.PreStimuliCxV4_Npop);
PreStimuliCxV4_PreStimuliCxV4_iAMPActx_s = zeros(nsamp,p.PreStimuliCxV4_Npop);
PreStimuliCxV4_PreStimuliCxV4_iAMPActx_s(1,:) = PreStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last;
PreStimuliCxV4_PostStimuliCxV4_iAMPActx_s_last =  p.PreStimuliCxV4_PostStimuliCxV4_iAMPActx_IC+p.PreStimuliCxV4_PostStimuliCxV4_iAMPActx_IC_noise.*rand(1,p.PostStimuliCxV4_Npop);
PreStimuliCxV4_PostStimuliCxV4_iAMPActx_s = zeros(nsamp,p.PostStimuliCxV4_Npop);
PreStimuliCxV4_PostStimuliCxV4_iAMPActx_s(1,:) = PreStimuliCxV4_PostStimuliCxV4_iAMPActx_s_last;
PostStimuliCxV4_PostStimuliCxV4_iAMPActx_s_last =  p.PostStimuliCxV4_PostStimuliCxV4_iAMPActx_IC+p.PostStimuliCxV4_PostStimuliCxV4_iAMPActx_IC_noise.*rand(1,p.PostStimuliCxV4_Npop);
PostStimuliCxV4_PostStimuliCxV4_iAMPActx_s = zeros(nsamp,p.PostStimuliCxV4_Npop);
PostStimuliCxV4_PostStimuliCxV4_iAMPActx_s(1,:) = PostStimuliCxV4_PostStimuliCxV4_iAMPActx_s_last;
midExV4_PreStimuliAxV4_iAMPActx_s_last =  p.midExV4_PreStimuliAxV4_iAMPActx_IC+p.midExV4_PreStimuliAxV4_iAMPActx_IC_noise.*rand(1,p.PreStimuliAxV4_Npop);
midExV4_PreStimuliAxV4_iAMPActx_s = zeros(nsamp,p.PreStimuliAxV4_Npop);
midExV4_PreStimuliAxV4_iAMPActx_s(1,:) = midExV4_PreStimuliAxV4_iAMPActx_s_last;
midExV4_PostStimuliAxV4_iAMPActx_s_last =  p.midExV4_PostStimuliAxV4_iAMPActx_IC+p.midExV4_PostStimuliAxV4_iAMPActx_IC_noise.*rand(1,p.PostStimuliAxV4_Npop);
midExV4_PostStimuliAxV4_iAMPActx_s = zeros(nsamp,p.PostStimuliAxV4_Npop);
midExV4_PostStimuliAxV4_iAMPActx_s(1,:) = midExV4_PostStimuliAxV4_iAMPActx_s_last;
midExV4_PreStimuliBxV4_iAMPActx_s_last =  p.midExV4_PreStimuliBxV4_iAMPActx_IC+p.midExV4_PreStimuliBxV4_iAMPActx_IC_noise.*rand(1,p.PreStimuliBxV4_Npop);
midExV4_PreStimuliBxV4_iAMPActx_s = zeros(nsamp,p.PreStimuliBxV4_Npop);
midExV4_PreStimuliBxV4_iAMPActx_s(1,:) = midExV4_PreStimuliBxV4_iAMPActx_s_last;
midExV4_PostStimuliBxV4_iAMPActx_s_last =  p.midExV4_PostStimuliBxV4_iAMPActx_IC+p.midExV4_PostStimuliBxV4_iAMPActx_IC_noise.*rand(1,p.PostStimuliBxV4_Npop);
midExV4_PostStimuliBxV4_iAMPActx_s = zeros(nsamp,p.PostStimuliBxV4_Npop);
midExV4_PostStimuliBxV4_iAMPActx_s(1,:) = midExV4_PostStimuliBxV4_iAMPActx_s_last;
midExV4_PreStimuliCxV4_iAMPActx_s_last =  p.midExV4_PreStimuliCxV4_iAMPActx_IC+p.midExV4_PreStimuliCxV4_iAMPActx_IC_noise.*rand(1,p.PreStimuliCxV4_Npop);
midExV4_PreStimuliCxV4_iAMPActx_s = zeros(nsamp,p.PreStimuliCxV4_Npop);
midExV4_PreStimuliCxV4_iAMPActx_s(1,:) = midExV4_PreStimuliCxV4_iAMPActx_s_last;
midExV4_PostStimuliCxV4_iAMPActx_s_last =  p.midExV4_PostStimuliCxV4_iAMPActx_IC+p.midExV4_PostStimuliCxV4_iAMPActx_IC_noise.*rand(1,p.PostStimuliCxV4_Npop);
midExV4_PostStimuliCxV4_iAMPActx_s = zeros(nsamp,p.PostStimuliCxV4_Npop);
midExV4_PostStimuliCxV4_iAMPActx_s(1,:) = midExV4_PostStimuliCxV4_iAMPActx_s_last;
supExV4_midExV4_iAMPActx_s_last =  p.supExV4_midExV4_iAMPActx_IC+p.supExV4_midExV4_iAMPActx_IC_noise.*rand(1,p.midExV4_Npop);
supExV4_midExV4_iAMPActx_s = zeros(nsamp,p.midExV4_Npop);
supExV4_midExV4_iAMPActx_s(1,:) = supExV4_midExV4_iAMPActx_s_last;
deepExV4_midExV4_iAMPActx_s_last =  p.deepExV4_midExV4_iAMPActx_IC+p.deepExV4_midExV4_iAMPActx_IC_noise.*rand(1,p.midExV4_Npop);
deepExV4_midExV4_iAMPActx_s = zeros(nsamp,p.midExV4_Npop);
deepExV4_midExV4_iAMPActx_s(1,:) = deepExV4_midExV4_iAMPActx_s_last;
deepExV4_midIxV4_iGABActx_s_last =  p.deepExV4_midIxV4_iGABActx_IC+p.deepExV4_midIxV4_iGABActx_IC_noise.*rand(1,p.midIxV4_Npop);
deepExV4_midIxV4_iGABActx_s = zeros(nsamp,p.midIxV4_Npop);
deepExV4_midIxV4_iGABActx_s(1,:) = deepExV4_midIxV4_iGABActx_s_last;
deepExV4_supExV4_iAMPActx_s_last =  p.deepExV4_supExV4_iAMPActx_IC+p.deepExV4_supExV4_iAMPActx_IC_noise.*rand(1,p.supExV4_Npop);
deepExV4_supExV4_iAMPActx_s = zeros(nsamp,p.supExV4_Npop);
deepExV4_supExV4_iAMPActx_s(1,:) = deepExV4_supExV4_iAMPActx_s_last;
supIxPFC_supExPFC_iAMPActx_s_last =  p.supIxPFC_supExPFC_iAMPActx_IC+p.supIxPFC_supExPFC_iAMPActx_IC_noise.*rand(1,p.supExPFC_Npop);
supIxPFC_supExPFC_iAMPActx_s = zeros(nsamp,p.supExPFC_Npop);
supIxPFC_supExPFC_iAMPActx_s(1,:) = supIxPFC_supExPFC_iAMPActx_s_last;
supExPFC_supExPFC_iAMPActx_s_last =  p.supExPFC_supExPFC_iAMPActx_IC+p.supExPFC_supExPFC_iAMPActx_IC_noise.*rand(1,p.supExPFC_Npop);
supExPFC_supExPFC_iAMPActx_s = zeros(nsamp,p.supExPFC_Npop);
supExPFC_supExPFC_iAMPActx_s(1,:) = supExPFC_supExPFC_iAMPActx_s_last;
supExPFC_supIxPFC_iGABActx_s_last =  p.supExPFC_supIxPFC_iGABActx_IC+p.supExPFC_supIxPFC_iGABActx_IC_noise.*rand(1,p.supIxPFC_Npop);
supExPFC_supIxPFC_iGABActx_s = zeros(nsamp,p.supIxPFC_Npop);
supExPFC_supIxPFC_iGABActx_s(1,:) = supExPFC_supIxPFC_iGABActx_s_last;
supIxPFC_supIxPFC_iGABActx_s_last =  p.supIxPFC_supIxPFC_iGABActx_IC+p.supIxPFC_supIxPFC_iGABActx_IC_noise.*rand(1,p.supIxPFC_Npop);
supIxPFC_supIxPFC_iGABActx_s = zeros(nsamp,p.supIxPFC_Npop);
supIxPFC_supIxPFC_iGABActx_s(1,:) = supIxPFC_supIxPFC_iGABActx_s_last;
midIxPFC_midExPFC_iAMPActx_s_last =  p.midIxPFC_midExPFC_iAMPActx_IC+p.midIxPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
midIxPFC_midExPFC_iAMPActx_s = zeros(nsamp,p.midExPFC_Npop);
midIxPFC_midExPFC_iAMPActx_s(1,:) = midIxPFC_midExPFC_iAMPActx_s_last;
midExPFC_midExPFC_iAMPActx_s_last =  p.midExPFC_midExPFC_iAMPActx_IC+p.midExPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
midExPFC_midExPFC_iAMPActx_s = zeros(nsamp,p.midExPFC_Npop);
midExPFC_midExPFC_iAMPActx_s(1,:) = midExPFC_midExPFC_iAMPActx_s_last;
midExPFC_midIxPFC_iGABActx_s_last =  p.midExPFC_midIxPFC_iGABActx_IC+p.midExPFC_midIxPFC_iGABActx_IC_noise.*rand(1,p.midIxPFC_Npop);
midExPFC_midIxPFC_iGABActx_s = zeros(nsamp,p.midIxPFC_Npop);
midExPFC_midIxPFC_iGABActx_s(1,:) = midExPFC_midIxPFC_iGABActx_s_last;
midIxPFC_midIxPFC_iGABActx_s_last =  p.midIxPFC_midIxPFC_iGABActx_IC+p.midIxPFC_midIxPFC_iGABActx_IC_noise.*rand(1,p.midIxPFC_Npop);
midIxPFC_midIxPFC_iGABActx_s = zeros(nsamp,p.midIxPFC_Npop);
midIxPFC_midIxPFC_iGABActx_s(1,:) = midIxPFC_midIxPFC_iGABActx_s_last;
deepIxPFC_deepExPFC_iAMPActx_s_last =  p.deepIxPFC_deepExPFC_iAMPActx_IC+p.deepIxPFC_deepExPFC_iAMPActx_IC_noise.*rand(1,p.deepExPFC_Npop);
deepIxPFC_deepExPFC_iAMPActx_s = zeros(nsamp,p.deepExPFC_Npop);
deepIxPFC_deepExPFC_iAMPActx_s(1,:) = deepIxPFC_deepExPFC_iAMPActx_s_last;
deepExPFC_deepExPFC_iAMPActx_s_last =  p.deepExPFC_deepExPFC_iAMPActx_IC+p.deepExPFC_deepExPFC_iAMPActx_IC_noise.*rand(1,p.deepExPFC_Npop);
deepExPFC_deepExPFC_iAMPActx_s = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_deepExPFC_iAMPActx_s(1,:) = deepExPFC_deepExPFC_iAMPActx_s_last;
deepExPFC_deepIxPFC_iGABActx_s_last =  p.deepExPFC_deepIxPFC_iGABActx_IC+p.deepExPFC_deepIxPFC_iGABActx_IC_noise.*rand(1,p.deepIxPFC_Npop);
deepExPFC_deepIxPFC_iGABActx_s = zeros(nsamp,p.deepIxPFC_Npop);
deepExPFC_deepIxPFC_iGABActx_s(1,:) = deepExPFC_deepIxPFC_iGABActx_s_last;
deepIxPFC_deepIxPFC_iGABActx_s_last =  p.deepIxPFC_deepIxPFC_iGABActx_IC+p.deepIxPFC_deepIxPFC_iGABActx_IC_noise.*rand(1,p.deepIxPFC_Npop);
deepIxPFC_deepIxPFC_iGABActx_s = zeros(nsamp,p.deepIxPFC_Npop);
deepIxPFC_deepIxPFC_iGABActx_s(1,:) = deepIxPFC_deepIxPFC_iGABActx_s_last;
PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last =  p.PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_IC+p.PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_IC_noise.*rand(1,p.PreStimuliAxPFC_Npop);
PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s = zeros(nsamp,p.PreStimuliAxPFC_Npop);
PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s(1,:) = PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last;
PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last =  p.PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_IC+p.PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_IC_noise.*rand(1,p.PreStimuliAxPFC_Npop);
PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s = zeros(nsamp,p.PreStimuliAxPFC_Npop);
PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s(1,:) = PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last;
PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_last =  p.PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_IC+p.PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_IC_noise.*rand(1,p.PostStimuliAxPFC_Npop);
PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s = zeros(nsamp,p.PostStimuliAxPFC_Npop);
PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s(1,:) = PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_last;
PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_last =  p.PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_IC+p.PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_IC_noise.*rand(1,p.PostStimuliAxPFC_Npop);
PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s = zeros(nsamp,p.PostStimuliAxPFC_Npop);
PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s(1,:) = PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_last;
PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last =  p.PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_IC+p.PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_IC_noise.*rand(1,p.PreStimuliBxPFC_Npop);
PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s = zeros(nsamp,p.PreStimuliBxPFC_Npop);
PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s(1,:) = PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last;
PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last =  p.PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_IC+p.PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_IC_noise.*rand(1,p.PreStimuliBxPFC_Npop);
PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s = zeros(nsamp,p.PreStimuliBxPFC_Npop);
PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s(1,:) = PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last;
PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_last =  p.PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_IC+p.PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_IC_noise.*rand(1,p.PostStimuliBxPFC_Npop);
PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s = zeros(nsamp,p.PostStimuliBxPFC_Npop);
PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s(1,:) = PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_last;
PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_last =  p.PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_IC+p.PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_IC_noise.*rand(1,p.PostStimuliBxPFC_Npop);
PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s = zeros(nsamp,p.PostStimuliBxPFC_Npop);
PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s(1,:) = PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_last;
PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last =  p.PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_IC+p.PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_IC_noise.*rand(1,p.PreStimuliCxPFC_Npop);
PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s = zeros(nsamp,p.PreStimuliCxPFC_Npop);
PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s(1,:) = PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last;
PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last =  p.PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_IC+p.PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_IC_noise.*rand(1,p.PreStimuliCxPFC_Npop);
PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s = zeros(nsamp,p.PreStimuliCxPFC_Npop);
PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s(1,:) = PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last;
PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_last =  p.PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_IC+p.PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_IC_noise.*rand(1,p.PostStimuliCxPFC_Npop);
PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s = zeros(nsamp,p.PostStimuliCxPFC_Npop);
PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s(1,:) = PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_last;
PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_last =  p.PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_IC+p.PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_IC_noise.*rand(1,p.PostStimuliCxPFC_Npop);
PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s = zeros(nsamp,p.PostStimuliCxPFC_Npop);
PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s(1,:) = PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_last;
midExPFC_PreStimuliAxPFC_iAMPActx_s_last =  p.midExPFC_PreStimuliAxPFC_iAMPActx_IC+p.midExPFC_PreStimuliAxPFC_iAMPActx_IC_noise.*rand(1,p.PreStimuliAxPFC_Npop);
midExPFC_PreStimuliAxPFC_iAMPActx_s = zeros(nsamp,p.PreStimuliAxPFC_Npop);
midExPFC_PreStimuliAxPFC_iAMPActx_s(1,:) = midExPFC_PreStimuliAxPFC_iAMPActx_s_last;
midExPFC_PostStimuliAxPFC_iAMPActx_s_last =  p.midExPFC_PostStimuliAxPFC_iAMPActx_IC+p.midExPFC_PostStimuliAxPFC_iAMPActx_IC_noise.*rand(1,p.PostStimuliAxPFC_Npop);
midExPFC_PostStimuliAxPFC_iAMPActx_s = zeros(nsamp,p.PostStimuliAxPFC_Npop);
midExPFC_PostStimuliAxPFC_iAMPActx_s(1,:) = midExPFC_PostStimuliAxPFC_iAMPActx_s_last;
midExPFC_PreStimuliBxPFC_iAMPActx_s_last =  p.midExPFC_PreStimuliBxPFC_iAMPActx_IC+p.midExPFC_PreStimuliBxPFC_iAMPActx_IC_noise.*rand(1,p.PreStimuliBxPFC_Npop);
midExPFC_PreStimuliBxPFC_iAMPActx_s = zeros(nsamp,p.PreStimuliBxPFC_Npop);
midExPFC_PreStimuliBxPFC_iAMPActx_s(1,:) = midExPFC_PreStimuliBxPFC_iAMPActx_s_last;
midExPFC_PostStimuliBxPFC_iAMPActx_s_last =  p.midExPFC_PostStimuliBxPFC_iAMPActx_IC+p.midExPFC_PostStimuliBxPFC_iAMPActx_IC_noise.*rand(1,p.PostStimuliBxPFC_Npop);
midExPFC_PostStimuliBxPFC_iAMPActx_s = zeros(nsamp,p.PostStimuliBxPFC_Npop);
midExPFC_PostStimuliBxPFC_iAMPActx_s(1,:) = midExPFC_PostStimuliBxPFC_iAMPActx_s_last;
midExPFC_PreStimuliCxPFC_iAMPActx_s_last =  p.midExPFC_PreStimuliCxPFC_iAMPActx_IC+p.midExPFC_PreStimuliCxPFC_iAMPActx_IC_noise.*rand(1,p.PreStimuliCxPFC_Npop);
midExPFC_PreStimuliCxPFC_iAMPActx_s = zeros(nsamp,p.PreStimuliCxPFC_Npop);
midExPFC_PreStimuliCxPFC_iAMPActx_s(1,:) = midExPFC_PreStimuliCxPFC_iAMPActx_s_last;
midExPFC_PostStimuliCxPFC_iAMPActx_s_last =  p.midExPFC_PostStimuliCxPFC_iAMPActx_IC+p.midExPFC_PostStimuliCxPFC_iAMPActx_IC_noise.*rand(1,p.PostStimuliCxPFC_Npop);
midExPFC_PostStimuliCxPFC_iAMPActx_s = zeros(nsamp,p.PostStimuliCxPFC_Npop);
midExPFC_PostStimuliCxPFC_iAMPActx_s(1,:) = midExPFC_PostStimuliCxPFC_iAMPActx_s_last;
supExPFC_midExPFC_iAMPActx_s_last =  p.supExPFC_midExPFC_iAMPActx_IC+p.supExPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
supExPFC_midExPFC_iAMPActx_s = zeros(nsamp,p.midExPFC_Npop);
supExPFC_midExPFC_iAMPActx_s(1,:) = supExPFC_midExPFC_iAMPActx_s_last;
deepExPFC_midExPFC_iAMPActx_s_last =  p.deepExPFC_midExPFC_iAMPActx_IC+p.deepExPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
deepExPFC_midExPFC_iAMPActx_s = zeros(nsamp,p.midExPFC_Npop);
deepExPFC_midExPFC_iAMPActx_s(1,:) = deepExPFC_midExPFC_iAMPActx_s_last;
deepExPFC_midIxPFC_iGABActx_s_last =  p.deepExPFC_midIxPFC_iGABActx_IC+p.deepExPFC_midIxPFC_iGABActx_IC_noise.*rand(1,p.midIxPFC_Npop);
deepExPFC_midIxPFC_iGABActx_s = zeros(nsamp,p.midIxPFC_Npop);
deepExPFC_midIxPFC_iGABActx_s(1,:) = deepExPFC_midIxPFC_iGABActx_s_last;
deepExPFC_supExPFC_iAMPActx_s_last =  p.deepExPFC_supExPFC_iAMPActx_IC+p.deepExPFC_supExPFC_iAMPActx_IC_noise.*rand(1,p.supExPFC_Npop);
deepExPFC_supExPFC_iAMPActx_s = zeros(nsamp,p.supExPFC_Npop);
deepExPFC_supExPFC_iAMPActx_s(1,:) = deepExPFC_supExPFC_iAMPActx_s_last;
midExPFC_supExV4_iAMPActx_s_last =  p.midExPFC_supExV4_iAMPActx_IC+p.midExPFC_supExV4_iAMPActx_IC_noise.*rand(1,p.supExV4_Npop);
midExPFC_supExV4_iAMPActx_s = zeros(nsamp,p.supExV4_Npop);
midExPFC_supExV4_iAMPActx_s(1,:) = midExPFC_supExV4_iAMPActx_s_last;
midIxPFC_supIxV4_iAMPActx_s_last =  p.midIxPFC_supIxV4_iAMPActx_IC+p.midIxPFC_supIxV4_iAMPActx_IC_noise.*rand(1,p.supIxV4_Npop);
midIxPFC_supIxV4_iAMPActx_s = zeros(nsamp,p.supIxV4_Npop);
midIxPFC_supIxV4_iAMPActx_s(1,:) = midIxPFC_supIxV4_iAMPActx_s_last;
midIxV4_deepIxPFC_iAMPActx_s_last =  p.midIxV4_deepIxPFC_iAMPActx_IC+p.midIxV4_deepIxPFC_iAMPActx_IC_noise.*rand(1,p.deepIxPFC_Npop);
midIxV4_deepIxPFC_iAMPActx_s = zeros(nsamp,p.deepIxPFC_Npop);
midIxV4_deepIxPFC_iAMPActx_s(1,:) = midIxV4_deepIxPFC_iAMPActx_s_last;
midExV4_deepExPFC_iAMPActx_s_last =  p.midExV4_deepExPFC_iAMPActx_IC+p.midExV4_deepExPFC_iAMPActx_IC_noise.*rand(1,p.deepExPFC_Npop);
midExV4_deepExPFC_iAMPActx_s = zeros(nsamp,p.deepExPFC_Npop);
midExV4_deepExPFC_iAMPActx_s(1,:) = midExV4_deepExPFC_iAMPActx_s_last;

% ###########################################################
% Numerical integration:
% ###########################################################
n=2;
for k=2:ntime
  t=T(k-1);
  supExV4_V_k1 = (p.supExV4_Iapp + ((((-p.supExV4_iNa_gNa.*supExV4_iNa_m_last.^3.*supExV4_iNa_h_last.*(supExV4_V_last-p.supExV4_iNa_ENa))))+((((-p.supExV4_iK_gK.*supExV4_iK_n_last.^4.*(supExV4_V_last-p.supExV4_iK_EK))))+((-(((p.supExV4_supExV4_iAMPActx_gAMPA.*(supExV4_supExV4_iAMPActx_s_last*p.supExV4_supExV4_iAMPActx_netcon).*(supExV4_V_last-p.supExV4_supExV4_iAMPActx_EAMPA)))))+((((-p.supExV4_supIxV4_iGABActx_gGABAa.*(supExV4_supIxV4_iGABActx_s_last*p.supExV4_supIxV4_iGABActx_netcon).*(supExV4_V_last-p.supExV4_supIxV4_iGABActx_EGABAa))))+((-(((p.supExV4_midExV4_iAMPActx_gAMPA.*(supExV4_midExV4_iAMPActx_s_last*p.supExV4_midExV4_iAMPActx_netcon).*(supExV4_V_last-p.supExV4_midExV4_iAMPActx_EAMPA)))))))))) + p.supExV4_noise*randn(1, p.supExV4_Npop))/p.supExV4_C;
  supExV4_iNa_m_k1 = (((2.5-.1*(supExV4_V_last+65))./(exp(2.5-.1*(supExV4_V_last+65))-1))).*(1-supExV4_iNa_m_last)-((4*exp(-(supExV4_V_last+65)/18))).*supExV4_iNa_m_last;
  supExV4_iNa_h_k1 = ((.07*exp(-(supExV4_V_last+65)/20))).*(1-supExV4_iNa_h_last)-((1./(exp(3-.1*(supExV4_V_last+65))+1))).*supExV4_iNa_h_last;
  supExV4_iK_n_k1 = (((.1-.01*(supExV4_V_last+65))./(exp(1-.1*(supExV4_V_last+65))-1))).*(1-supExV4_iK_n_last)-((.125*exp(-(supExV4_V_last+65)/80))).*supExV4_iK_n_last;
  supIxV4_V_k1 = (p.supIxV4_Iapp + ((((-p.supIxV4_iNa_gNa.*supIxV4_iNa_m_last.^3.*supIxV4_iNa_h_last.*(supIxV4_V_last-p.supIxV4_iNa_ENa))))+((((-p.supIxV4_iK_gK.*supIxV4_iK_n_last.^4.*(supIxV4_V_last-p.supIxV4_iK_EK))))+((-(((p.supIxV4_supExV4_iAMPActx_gAMPA.*(supIxV4_supExV4_iAMPActx_s_last*p.supIxV4_supExV4_iAMPActx_netcon).*(supIxV4_V_last-p.supIxV4_supExV4_iAMPActx_EAMPA)))))+((((-p.supIxV4_supIxV4_iGABActx_gGABAa.*(supIxV4_supIxV4_iGABActx_s_last*p.supIxV4_supIxV4_iGABActx_netcon).*(supIxV4_V_last-p.supIxV4_supIxV4_iGABActx_EGABAa)))))))) + p.supIxV4_noise*randn(1, p.supIxV4_Npop))/p.supIxV4_C;
  supIxV4_iNa_m_k1 = (((2.5-.1*(supIxV4_V_last+65))./(exp(2.5-.1*(supIxV4_V_last+65))-1))).*(1-supIxV4_iNa_m_last)-((4*exp(-(supIxV4_V_last+65)/18))).*supIxV4_iNa_m_last;
  supIxV4_iNa_h_k1 = ((.07*exp(-(supIxV4_V_last+65)/20))).*(1-supIxV4_iNa_h_last)-((1./(exp(3-.1*(supIxV4_V_last+65))+1))).*supIxV4_iNa_h_last;
  supIxV4_iK_n_k1 = (((.1-.01*(supIxV4_V_last+65))./(exp(1-.1*(supIxV4_V_last+65))-1))).*(1-supIxV4_iK_n_last)-((.125*exp(-(supIxV4_V_last+65)/80))).*supIxV4_iK_n_last;
  midExV4_V_k1 = (p.midExV4_Iapp + ((((-p.midExV4_iNa_gNa.*midExV4_iNa_m_last.^3.*midExV4_iNa_h_last.*(midExV4_V_last-p.midExV4_iNa_ENa))))+((((-p.midExV4_iK_gK.*midExV4_iK_n_last.^4.*(midExV4_V_last-p.midExV4_iK_EK))))+((-(((p.midExV4_midExV4_iAMPActx_gAMPA.*(midExV4_midExV4_iAMPActx_s_last*p.midExV4_midExV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_midExV4_iAMPActx_EAMPA)))))+((((-p.midExV4_midIxV4_iGABActx_gGABAa.*(midExV4_midIxV4_iGABActx_s_last*p.midExV4_midIxV4_iGABActx_netcon).*(midExV4_V_last-p.midExV4_midIxV4_iGABActx_EGABAa))))+((-(((p.midExV4_PreStimuliAxV4_iAMPActx_gAMPA.*(midExV4_PreStimuliAxV4_iAMPActx_s_last*p.midExV4_PreStimuliAxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_PreStimuliAxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_PostStimuliAxV4_iAMPActx_gAMPA.*(midExV4_PostStimuliAxV4_iAMPActx_s_last*p.midExV4_PostStimuliAxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_PostStimuliAxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_PreStimuliBxV4_iAMPActx_gAMPA.*(midExV4_PreStimuliBxV4_iAMPActx_s_last*p.midExV4_PreStimuliBxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_PreStimuliBxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_PostStimuliBxV4_iAMPActx_gAMPA.*(midExV4_PostStimuliBxV4_iAMPActx_s_last*p.midExV4_PostStimuliBxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_PostStimuliBxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_PreStimuliCxV4_iAMPActx_gAMPA.*(midExV4_PreStimuliCxV4_iAMPActx_s_last*p.midExV4_PreStimuliCxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_PreStimuliCxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_PostStimuliCxV4_iAMPActx_gAMPA.*(midExV4_PostStimuliCxV4_iAMPActx_s_last*p.midExV4_PostStimuliCxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_PostStimuliCxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_deepExPFC_iAMPActx_gAMPA.*(midExV4_deepExPFC_iAMPActx_s_last*p.midExV4_deepExPFC_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_deepExPFC_iAMPActx_EAMPA)))))))))))))))) + p.midExV4_noise*randn(1, p.midExV4_Npop))/p.midExV4_C;
  midExV4_iNa_m_k1 = (((2.5-.1*(midExV4_V_last+65))./(exp(2.5-.1*(midExV4_V_last+65))-1))).*(1-midExV4_iNa_m_last)-((4*exp(-(midExV4_V_last+65)/18))).*midExV4_iNa_m_last;
  midExV4_iNa_h_k1 = ((.07*exp(-(midExV4_V_last+65)/20))).*(1-midExV4_iNa_h_last)-((1./(exp(3-.1*(midExV4_V_last+65))+1))).*midExV4_iNa_h_last;
  midExV4_iK_n_k1 = (((.1-.01*(midExV4_V_last+65))./(exp(1-.1*(midExV4_V_last+65))-1))).*(1-midExV4_iK_n_last)-((.125*exp(-(midExV4_V_last+65)/80))).*midExV4_iK_n_last;
  midIxV4_V_k1 = (p.midIxV4_Iapp + ((((-p.midIxV4_iNa_gNa.*midIxV4_iNa_m_last.^3.*midIxV4_iNa_h_last.*(midIxV4_V_last-p.midIxV4_iNa_ENa))))+((((-p.midIxV4_iK_gK.*midIxV4_iK_n_last.^4.*(midIxV4_V_last-p.midIxV4_iK_EK))))+((-(((p.midIxV4_midExV4_iAMPActx_gAMPA.*(midIxV4_midExV4_iAMPActx_s_last*p.midIxV4_midExV4_iAMPActx_netcon).*(midIxV4_V_last-p.midIxV4_midExV4_iAMPActx_EAMPA)))))+((((-p.midIxV4_midIxV4_iGABActx_gGABAa.*(midIxV4_midIxV4_iGABActx_s_last*p.midIxV4_midIxV4_iGABActx_netcon).*(midIxV4_V_last-p.midIxV4_midIxV4_iGABActx_EGABAa))))+((-(((p.midIxV4_deepIxPFC_iAMPActx_gAMPA.*(midIxV4_deepIxPFC_iAMPActx_s_last*p.midIxV4_deepIxPFC_iAMPActx_netcon).*(midIxV4_V_last-p.midIxV4_deepIxPFC_iAMPActx_EAMPA)))))))))) + p.midIxV4_noise*randn(1, p.midIxV4_Npop))/p.midIxV4_C;
  midIxV4_iNa_m_k1 = (((2.5-.1*(midIxV4_V_last+65))./(exp(2.5-.1*(midIxV4_V_last+65))-1))).*(1-midIxV4_iNa_m_last)-((4*exp(-(midIxV4_V_last+65)/18))).*midIxV4_iNa_m_last;
  midIxV4_iNa_h_k1 = ((.07*exp(-(midIxV4_V_last+65)/20))).*(1-midIxV4_iNa_h_last)-((1./(exp(3-.1*(midIxV4_V_last+65))+1))).*midIxV4_iNa_h_last;
  midIxV4_iK_n_k1 = (((.1-.01*(midIxV4_V_last+65))./(exp(1-.1*(midIxV4_V_last+65))-1))).*(1-midIxV4_iK_n_last)-((.125*exp(-(midIxV4_V_last+65)/80))).*midIxV4_iK_n_last;
  deepExV4_V_k1 = (p.deepExV4_Iapp + ((((-p.deepExV4_iNa_gNa.*deepExV4_iNa_m_last.^3.*deepExV4_iNa_h_last.*(deepExV4_V_last-p.deepExV4_iNa_ENa))))+((((-p.deepExV4_iK_gK.*deepExV4_iK_n_last.^4.*(deepExV4_V_last-p.deepExV4_iK_EK))))+((-(((p.deepExV4_deepExV4_iAMPActx_gAMPA.*(deepExV4_deepExV4_iAMPActx_s_last*p.deepExV4_deepExV4_iAMPActx_netcon).*(deepExV4_V_last-p.deepExV4_deepExV4_iAMPActx_EAMPA)))))+((((-p.deepExV4_deepIxV4_iGABActx_gGABAa.*(deepExV4_deepIxV4_iGABActx_s_last*p.deepExV4_deepIxV4_iGABActx_netcon).*(deepExV4_V_last-p.deepExV4_deepIxV4_iGABActx_EGABAa))))+((-(((p.deepExV4_midExV4_iAMPActx_gAMPA.*(deepExV4_midExV4_iAMPActx_s_last*p.deepExV4_midExV4_iAMPActx_netcon).*(deepExV4_V_last-p.deepExV4_midExV4_iAMPActx_EAMPA)))))+((((-p.deepExV4_midIxV4_iGABActx_gGABAa.*(deepExV4_midIxV4_iGABActx_s_last*p.deepExV4_midIxV4_iGABActx_netcon).*(deepExV4_V_last-p.deepExV4_midIxV4_iGABActx_EGABAa))))+((-(((p.deepExV4_supExV4_iAMPActx_gAMPA.*(deepExV4_supExV4_iAMPActx_s_last*p.deepExV4_supExV4_iAMPActx_netcon).*(deepExV4_V_last-p.deepExV4_supExV4_iAMPActx_EAMPA)))))))))))) + p.deepExV4_noise*randn(1, p.deepExV4_Npop))/p.deepExV4_C;
  deepExV4_iNa_m_k1 = (((2.5-.1*(deepExV4_V_last+65))./(exp(2.5-.1*(deepExV4_V_last+65))-1))).*(1-deepExV4_iNa_m_last)-((4*exp(-(deepExV4_V_last+65)/18))).*deepExV4_iNa_m_last;
  deepExV4_iNa_h_k1 = ((.07*exp(-(deepExV4_V_last+65)/20))).*(1-deepExV4_iNa_h_last)-((1./(exp(3-.1*(deepExV4_V_last+65))+1))).*deepExV4_iNa_h_last;
  deepExV4_iK_n_k1 = (((.1-.01*(deepExV4_V_last+65))./(exp(1-.1*(deepExV4_V_last+65))-1))).*(1-deepExV4_iK_n_last)-((.125*exp(-(deepExV4_V_last+65)/80))).*deepExV4_iK_n_last;
  deepIxV4_V_k1 = (p.deepIxV4_Iapp + ((((-p.deepIxV4_iNa_gNa.*deepIxV4_iNa_m_last.^3.*deepIxV4_iNa_h_last.*(deepIxV4_V_last-p.deepIxV4_iNa_ENa))))+((((-p.deepIxV4_iK_gK.*deepIxV4_iK_n_last.^4.*(deepIxV4_V_last-p.deepIxV4_iK_EK))))+((-(((p.deepIxV4_deepExV4_iAMPActx_gAMPA.*(deepIxV4_deepExV4_iAMPActx_s_last*p.deepIxV4_deepExV4_iAMPActx_netcon).*(deepIxV4_V_last-p.deepIxV4_deepExV4_iAMPActx_EAMPA)))))+((((-p.deepIxV4_deepIxV4_iGABActx_gGABAa.*(deepIxV4_deepIxV4_iGABActx_s_last*p.deepIxV4_deepIxV4_iGABActx_netcon).*(deepIxV4_V_last-p.deepIxV4_deepIxV4_iGABActx_EGABAa)))))))) + p.deepIxV4_noise*randn(1, p.deepIxV4_Npop))/p.deepIxV4_C;
  deepIxV4_iNa_m_k1 = (((2.5-.1*(deepIxV4_V_last+65))./(exp(2.5-.1*(deepIxV4_V_last+65))-1))).*(1-deepIxV4_iNa_m_last)-((4*exp(-(deepIxV4_V_last+65)/18))).*deepIxV4_iNa_m_last;
  deepIxV4_iNa_h_k1 = ((.07*exp(-(deepIxV4_V_last+65)/20))).*(1-deepIxV4_iNa_h_last)-((1./(exp(3-.1*(deepIxV4_V_last+65))+1))).*deepIxV4_iNa_h_last;
  deepIxV4_iK_n_k1 = (((.1-.01*(deepIxV4_V_last+65))./(exp(1-.1*(deepIxV4_V_last+65))-1))).*(1-deepIxV4_iK_n_last)-((.125*exp(-(deepIxV4_V_last+65)/80))).*deepIxV4_iK_n_last;
  PreStimuliAxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PreStimuliAxV4_t1).^2) - exp(- (t - p.PreStimuliAxV4_t2).^2)) + p.PreStimuliAxV4_noise*randn(1, p.PreStimuliAxV4_Npop))/p.PreStimuliAxV4_C;
  PreStimuliAxV4_iNa_m_k1 = (((2.5-.1*(PreStimuliAxV4_V_last+65))./(exp(2.5-.1*(PreStimuliAxV4_V_last+65))-1))).*(1-PreStimuliAxV4_iNa_m_last)-((4*exp(-(PreStimuliAxV4_V_last+65)/18))).*PreStimuliAxV4_iNa_m_last;
  PreStimuliAxV4_iNa_h_k1 = ((.07*exp(-(PreStimuliAxV4_V_last+65)/20))).*(1-PreStimuliAxV4_iNa_h_last)-((1./(exp(3-.1*(PreStimuliAxV4_V_last+65))+1))).*PreStimuliAxV4_iNa_h_last;
  PreStimuliAxV4_iK_n_k1 = (((.1-.01*(PreStimuliAxV4_V_last+65))./(exp(1-.1*(PreStimuliAxV4_V_last+65))-1))).*(1-PreStimuliAxV4_iK_n_last)-((.125*exp(-(PreStimuliAxV4_V_last+65)/80))).*PreStimuliAxV4_iK_n_last;
  PostStimuliAxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PostStimuliAxV4_t1).^2) - exp(- (t - p.PostStimuliAxV4_t2).^2)) + p.PostStimuliAxV4_noise*randn(1, p.PostStimuliAxV4_Npop))/p.PostStimuliAxV4_C;
  PostStimuliAxV4_iNa_m_k1 = (((2.5-.1*(PostStimuliAxV4_V_last+65))./(exp(2.5-.1*(PostStimuliAxV4_V_last+65))-1))).*(1-PostStimuliAxV4_iNa_m_last)-((4*exp(-(PostStimuliAxV4_V_last+65)/18))).*PostStimuliAxV4_iNa_m_last;
  PostStimuliAxV4_iNa_h_k1 = ((.07*exp(-(PostStimuliAxV4_V_last+65)/20))).*(1-PostStimuliAxV4_iNa_h_last)-((1./(exp(3-.1*(PostStimuliAxV4_V_last+65))+1))).*PostStimuliAxV4_iNa_h_last;
  PostStimuliAxV4_iK_n_k1 = (((.1-.01*(PostStimuliAxV4_V_last+65))./(exp(1-.1*(PostStimuliAxV4_V_last+65))-1))).*(1-PostStimuliAxV4_iK_n_last)-((.125*exp(-(PostStimuliAxV4_V_last+65)/80))).*PostStimuliAxV4_iK_n_last;
  PreStimuliBxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PreStimuliBxV4_t1).^2) - exp(- (t - p.PreStimuliBxV4_t2).^2)) + p.PreStimuliBxV4_noise*randn(1, p.PreStimuliBxV4_Npop))/p.PreStimuliBxV4_C;
  PreStimuliBxV4_iNa_m_k1 = (((2.5-.1*(PreStimuliBxV4_V_last+65))./(exp(2.5-.1*(PreStimuliBxV4_V_last+65))-1))).*(1-PreStimuliBxV4_iNa_m_last)-((4*exp(-(PreStimuliBxV4_V_last+65)/18))).*PreStimuliBxV4_iNa_m_last;
  PreStimuliBxV4_iNa_h_k1 = ((.07*exp(-(PreStimuliBxV4_V_last+65)/20))).*(1-PreStimuliBxV4_iNa_h_last)-((1./(exp(3-.1*(PreStimuliBxV4_V_last+65))+1))).*PreStimuliBxV4_iNa_h_last;
  PreStimuliBxV4_iK_n_k1 = (((.1-.01*(PreStimuliBxV4_V_last+65))./(exp(1-.1*(PreStimuliBxV4_V_last+65))-1))).*(1-PreStimuliBxV4_iK_n_last)-((.125*exp(-(PreStimuliBxV4_V_last+65)/80))).*PreStimuliBxV4_iK_n_last;
  PostStimuliBxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PostStimuliBxV4_t1).^2) - exp(- (t - p.PostStimuliBxV4_t2).^2)) + p.PostStimuliBxV4_noise*randn(1, p.PostStimuliBxV4_Npop))/p.PostStimuliBxV4_C;
  PostStimuliBxV4_iNa_m_k1 = (((2.5-.1*(PostStimuliBxV4_V_last+65))./(exp(2.5-.1*(PostStimuliBxV4_V_last+65))-1))).*(1-PostStimuliBxV4_iNa_m_last)-((4*exp(-(PostStimuliBxV4_V_last+65)/18))).*PostStimuliBxV4_iNa_m_last;
  PostStimuliBxV4_iNa_h_k1 = ((.07*exp(-(PostStimuliBxV4_V_last+65)/20))).*(1-PostStimuliBxV4_iNa_h_last)-((1./(exp(3-.1*(PostStimuliBxV4_V_last+65))+1))).*PostStimuliBxV4_iNa_h_last;
  PostStimuliBxV4_iK_n_k1 = (((.1-.01*(PostStimuliBxV4_V_last+65))./(exp(1-.1*(PostStimuliBxV4_V_last+65))-1))).*(1-PostStimuliBxV4_iK_n_last)-((.125*exp(-(PostStimuliBxV4_V_last+65)/80))).*PostStimuliBxV4_iK_n_last;
  PreStimuliCxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PreStimuliCxV4_t1).^2) - exp(- (t - p.PreStimuliCxV4_t2).^2)) + p.PreStimuliCxV4_noise*randn(1, p.PreStimuliCxV4_Npop))/p.PreStimuliCxV4_C;
  PreStimuliCxV4_iNa_m_k1 = (((2.5-.1*(PreStimuliCxV4_V_last+65))./(exp(2.5-.1*(PreStimuliCxV4_V_last+65))-1))).*(1-PreStimuliCxV4_iNa_m_last)-((4*exp(-(PreStimuliCxV4_V_last+65)/18))).*PreStimuliCxV4_iNa_m_last;
  PreStimuliCxV4_iNa_h_k1 = ((.07*exp(-(PreStimuliCxV4_V_last+65)/20))).*(1-PreStimuliCxV4_iNa_h_last)-((1./(exp(3-.1*(PreStimuliCxV4_V_last+65))+1))).*PreStimuliCxV4_iNa_h_last;
  PreStimuliCxV4_iK_n_k1 = (((.1-.01*(PreStimuliCxV4_V_last+65))./(exp(1-.1*(PreStimuliCxV4_V_last+65))-1))).*(1-PreStimuliCxV4_iK_n_last)-((.125*exp(-(PreStimuliCxV4_V_last+65)/80))).*PreStimuliCxV4_iK_n_last;
  PostStimuliCxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PostStimuliCxV4_t1).^2) - exp(- (t - p.PostStimuliCxV4_t2).^2)) + p.PostStimuliCxV4_noise*randn(1, p.PostStimuliCxV4_Npop))/p.PostStimuliCxV4_C;
  PostStimuliCxV4_iNa_m_k1 = (((2.5-.1*(PostStimuliCxV4_V_last+65))./(exp(2.5-.1*(PostStimuliCxV4_V_last+65))-1))).*(1-PostStimuliCxV4_iNa_m_last)-((4*exp(-(PostStimuliCxV4_V_last+65)/18))).*PostStimuliCxV4_iNa_m_last;
  PostStimuliCxV4_iNa_h_k1 = ((.07*exp(-(PostStimuliCxV4_V_last+65)/20))).*(1-PostStimuliCxV4_iNa_h_last)-((1./(exp(3-.1*(PostStimuliCxV4_V_last+65))+1))).*PostStimuliCxV4_iNa_h_last;
  PostStimuliCxV4_iK_n_k1 = (((.1-.01*(PostStimuliCxV4_V_last+65))./(exp(1-.1*(PostStimuliCxV4_V_last+65))-1))).*(1-PostStimuliCxV4_iK_n_last)-((.125*exp(-(PostStimuliCxV4_V_last+65)/80))).*PostStimuliCxV4_iK_n_last;
  supExPFC_V_k1 = (p.supExPFC_Iapp + ((((-p.supExPFC_iNa_gNa.*supExPFC_iNa_m_last.^3.*supExPFC_iNa_h_last.*(supExPFC_V_last-p.supExPFC_iNa_ENa))))+((((-p.supExPFC_iK_gK.*supExPFC_iK_n_last.^4.*(supExPFC_V_last-p.supExPFC_iK_EK))))+((-(((p.supExPFC_supExPFC_iAMPActx_gAMPA.*(supExPFC_supExPFC_iAMPActx_s_last*p.supExPFC_supExPFC_iAMPActx_netcon).*(supExPFC_V_last-p.supExPFC_supExPFC_iAMPActx_EAMPA)))))+((((-p.supExPFC_supIxPFC_iGABActx_gGABAa.*(supExPFC_supIxPFC_iGABActx_s_last*p.supExPFC_supIxPFC_iGABActx_netcon).*(supExPFC_V_last-p.supExPFC_supIxPFC_iGABActx_EGABAa))))+((-(((p.supExPFC_midExPFC_iAMPActx_gAMPA.*(supExPFC_midExPFC_iAMPActx_s_last*p.supExPFC_midExPFC_iAMPActx_netcon).*(supExPFC_V_last-p.supExPFC_midExPFC_iAMPActx_EAMPA)))))))))) + p.supExPFC_noise*randn(1, p.supExPFC_Npop))/p.supExPFC_C;
  supExPFC_iNa_m_k1 = (((2.5-.1*(supExPFC_V_last+65))./(exp(2.5-.1*(supExPFC_V_last+65))-1))).*(1-supExPFC_iNa_m_last)-((4*exp(-(supExPFC_V_last+65)/18))).*supExPFC_iNa_m_last;
  supExPFC_iNa_h_k1 = ((.07*exp(-(supExPFC_V_last+65)/20))).*(1-supExPFC_iNa_h_last)-((1./(exp(3-.1*(supExPFC_V_last+65))+1))).*supExPFC_iNa_h_last;
  supExPFC_iK_n_k1 = (((.1-.01*(supExPFC_V_last+65))./(exp(1-.1*(supExPFC_V_last+65))-1))).*(1-supExPFC_iK_n_last)-((.125*exp(-(supExPFC_V_last+65)/80))).*supExPFC_iK_n_last;
  supIxPFC_V_k1 = (p.supIxPFC_Iapp + ((((-p.supIxPFC_iNa_gNa.*supIxPFC_iNa_m_last.^3.*supIxPFC_iNa_h_last.*(supIxPFC_V_last-p.supIxPFC_iNa_ENa))))+((((-p.supIxPFC_iK_gK.*supIxPFC_iK_n_last.^4.*(supIxPFC_V_last-p.supIxPFC_iK_EK))))+((-(((p.supIxPFC_supExPFC_iAMPActx_gAMPA.*(supIxPFC_supExPFC_iAMPActx_s_last*p.supIxPFC_supExPFC_iAMPActx_netcon).*(supIxPFC_V_last-p.supIxPFC_supExPFC_iAMPActx_EAMPA)))))+((((-p.supIxPFC_supIxPFC_iGABActx_gGABAa.*(supIxPFC_supIxPFC_iGABActx_s_last*p.supIxPFC_supIxPFC_iGABActx_netcon).*(supIxPFC_V_last-p.supIxPFC_supIxPFC_iGABActx_EGABAa)))))))) + p.supIxPFC_noise*randn(1, p.supIxPFC_Npop))/p.supIxPFC_C;
  supIxPFC_iNa_m_k1 = (((2.5-.1*(supIxPFC_V_last+65))./(exp(2.5-.1*(supIxPFC_V_last+65))-1))).*(1-supIxPFC_iNa_m_last)-((4*exp(-(supIxPFC_V_last+65)/18))).*supIxPFC_iNa_m_last;
  supIxPFC_iNa_h_k1 = ((.07*exp(-(supIxPFC_V_last+65)/20))).*(1-supIxPFC_iNa_h_last)-((1./(exp(3-.1*(supIxPFC_V_last+65))+1))).*supIxPFC_iNa_h_last;
  supIxPFC_iK_n_k1 = (((.1-.01*(supIxPFC_V_last+65))./(exp(1-.1*(supIxPFC_V_last+65))-1))).*(1-supIxPFC_iK_n_last)-((.125*exp(-(supIxPFC_V_last+65)/80))).*supIxPFC_iK_n_last;
  midExPFC_V_k1 = (p.midExPFC_Iapp + ((((-p.midExPFC_iNa_gNa.*midExPFC_iNa_m_last.^3.*midExPFC_iNa_h_last.*(midExPFC_V_last-p.midExPFC_iNa_ENa))))+((((-p.midExPFC_iK_gK.*midExPFC_iK_n_last.^4.*(midExPFC_V_last-p.midExPFC_iK_EK))))+((-(((p.midExPFC_midExPFC_iAMPActx_gAMPA.*(midExPFC_midExPFC_iAMPActx_s_last*p.midExPFC_midExPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_midExPFC_iAMPActx_EAMPA)))))+((((-p.midExPFC_midIxPFC_iGABActx_gGABAa.*(midExPFC_midIxPFC_iGABActx_s_last*p.midExPFC_midIxPFC_iGABActx_netcon).*(midExPFC_V_last-p.midExPFC_midIxPFC_iGABActx_EGABAa))))+((-(((p.midExPFC_PreStimuliAxPFC_iAMPActx_gAMPA.*(midExPFC_PreStimuliAxPFC_iAMPActx_s_last*p.midExPFC_PreStimuliAxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_PreStimuliAxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_PostStimuliAxPFC_iAMPActx_gAMPA.*(midExPFC_PostStimuliAxPFC_iAMPActx_s_last*p.midExPFC_PostStimuliAxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_PostStimuliAxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_PreStimuliBxPFC_iAMPActx_gAMPA.*(midExPFC_PreStimuliBxPFC_iAMPActx_s_last*p.midExPFC_PreStimuliBxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_PreStimuliBxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_PostStimuliBxPFC_iAMPActx_gAMPA.*(midExPFC_PostStimuliBxPFC_iAMPActx_s_last*p.midExPFC_PostStimuliBxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_PostStimuliBxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_PreStimuliCxPFC_iAMPActx_gAMPA.*(midExPFC_PreStimuliCxPFC_iAMPActx_s_last*p.midExPFC_PreStimuliCxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_PreStimuliCxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_PostStimuliCxPFC_iAMPActx_gAMPA.*(midExPFC_PostStimuliCxPFC_iAMPActx_s_last*p.midExPFC_PostStimuliCxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_PostStimuliCxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_supExV4_iAMPActx_gAMPA.*(midExPFC_supExV4_iAMPActx_s_last*p.midExPFC_supExV4_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_supExV4_iAMPActx_EAMPA)))))))))))))))) + p.midExPFC_noise*randn(1, p.midExPFC_Npop))/p.midExPFC_C;
  midExPFC_iNa_m_k1 = (((2.5-.1*(midExPFC_V_last+65))./(exp(2.5-.1*(midExPFC_V_last+65))-1))).*(1-midExPFC_iNa_m_last)-((4*exp(-(midExPFC_V_last+65)/18))).*midExPFC_iNa_m_last;
  midExPFC_iNa_h_k1 = ((.07*exp(-(midExPFC_V_last+65)/20))).*(1-midExPFC_iNa_h_last)-((1./(exp(3-.1*(midExPFC_V_last+65))+1))).*midExPFC_iNa_h_last;
  midExPFC_iK_n_k1 = (((.1-.01*(midExPFC_V_last+65))./(exp(1-.1*(midExPFC_V_last+65))-1))).*(1-midExPFC_iK_n_last)-((.125*exp(-(midExPFC_V_last+65)/80))).*midExPFC_iK_n_last;
  midIxPFC_V_k1 = (p.midIxPFC_Iapp + ((((-p.midIxPFC_iNa_gNa.*midIxPFC_iNa_m_last.^3.*midIxPFC_iNa_h_last.*(midIxPFC_V_last-p.midIxPFC_iNa_ENa))))+((((-p.midIxPFC_iK_gK.*midIxPFC_iK_n_last.^4.*(midIxPFC_V_last-p.midIxPFC_iK_EK))))+((-(((p.midIxPFC_midExPFC_iAMPActx_gAMPA.*(midIxPFC_midExPFC_iAMPActx_s_last*p.midIxPFC_midExPFC_iAMPActx_netcon).*(midIxPFC_V_last-p.midIxPFC_midExPFC_iAMPActx_EAMPA)))))+((((-p.midIxPFC_midIxPFC_iGABActx_gGABAa.*(midIxPFC_midIxPFC_iGABActx_s_last*p.midIxPFC_midIxPFC_iGABActx_netcon).*(midIxPFC_V_last-p.midIxPFC_midIxPFC_iGABActx_EGABAa))))+((-(((p.midIxPFC_supIxV4_iAMPActx_gAMPA.*(midIxPFC_supIxV4_iAMPActx_s_last*p.midIxPFC_supIxV4_iAMPActx_netcon).*(midIxPFC_V_last-p.midIxPFC_supIxV4_iAMPActx_EAMPA)))))))))) + p.midIxPFC_noise*randn(1, p.midIxPFC_Npop))/p.midIxPFC_C;
  midIxPFC_iNa_m_k1 = (((2.5-.1*(midIxPFC_V_last+65))./(exp(2.5-.1*(midIxPFC_V_last+65))-1))).*(1-midIxPFC_iNa_m_last)-((4*exp(-(midIxPFC_V_last+65)/18))).*midIxPFC_iNa_m_last;
  midIxPFC_iNa_h_k1 = ((.07*exp(-(midIxPFC_V_last+65)/20))).*(1-midIxPFC_iNa_h_last)-((1./(exp(3-.1*(midIxPFC_V_last+65))+1))).*midIxPFC_iNa_h_last;
  midIxPFC_iK_n_k1 = (((.1-.01*(midIxPFC_V_last+65))./(exp(1-.1*(midIxPFC_V_last+65))-1))).*(1-midIxPFC_iK_n_last)-((.125*exp(-(midIxPFC_V_last+65)/80))).*midIxPFC_iK_n_last;
  deepExPFC_V_k1 = (p.deepExPFC_Iapp + ((((-p.deepExPFC_iNa_gNa.*deepExPFC_iNa_m_last.^3.*deepExPFC_iNa_h_last.*(deepExPFC_V_last-p.deepExPFC_iNa_ENa))))+((((-p.deepExPFC_iK_gK.*deepExPFC_iK_n_last.^4.*(deepExPFC_V_last-p.deepExPFC_iK_EK))))+((-(((p.deepExPFC_deepExPFC_iAMPActx_gAMPA.*(deepExPFC_deepExPFC_iAMPActx_s_last*p.deepExPFC_deepExPFC_iAMPActx_netcon).*(deepExPFC_V_last-p.deepExPFC_deepExPFC_iAMPActx_EAMPA)))))+((((-p.deepExPFC_deepIxPFC_iGABActx_gGABAa.*(deepExPFC_deepIxPFC_iGABActx_s_last*p.deepExPFC_deepIxPFC_iGABActx_netcon).*(deepExPFC_V_last-p.deepExPFC_deepIxPFC_iGABActx_EGABAa))))+((-(((p.deepExPFC_midExPFC_iAMPActx_gAMPA.*(deepExPFC_midExPFC_iAMPActx_s_last*p.deepExPFC_midExPFC_iAMPActx_netcon).*(deepExPFC_V_last-p.deepExPFC_midExPFC_iAMPActx_EAMPA)))))+((((-p.deepExPFC_midIxPFC_iGABActx_gGABAa.*(deepExPFC_midIxPFC_iGABActx_s_last*p.deepExPFC_midIxPFC_iGABActx_netcon).*(deepExPFC_V_last-p.deepExPFC_midIxPFC_iGABActx_EGABAa))))+((-(((p.deepExPFC_supExPFC_iAMPActx_gAMPA.*(deepExPFC_supExPFC_iAMPActx_s_last*p.deepExPFC_supExPFC_iAMPActx_netcon).*(deepExPFC_V_last-p.deepExPFC_supExPFC_iAMPActx_EAMPA)))))))))))) + p.deepExPFC_noise*randn(1, p.deepExPFC_Npop))/p.deepExPFC_C;
  deepExPFC_iNa_m_k1 = (((2.5-.1*(deepExPFC_V_last+65))./(exp(2.5-.1*(deepExPFC_V_last+65))-1))).*(1-deepExPFC_iNa_m_last)-((4*exp(-(deepExPFC_V_last+65)/18))).*deepExPFC_iNa_m_last;
  deepExPFC_iNa_h_k1 = ((.07*exp(-(deepExPFC_V_last+65)/20))).*(1-deepExPFC_iNa_h_last)-((1./(exp(3-.1*(deepExPFC_V_last+65))+1))).*deepExPFC_iNa_h_last;
  deepExPFC_iK_n_k1 = (((.1-.01*(deepExPFC_V_last+65))./(exp(1-.1*(deepExPFC_V_last+65))-1))).*(1-deepExPFC_iK_n_last)-((.125*exp(-(deepExPFC_V_last+65)/80))).*deepExPFC_iK_n_last;
  deepIxPFC_V_k1 = (p.deepIxPFC_Iapp + ((((-p.deepIxPFC_iNa_gNa.*deepIxPFC_iNa_m_last.^3.*deepIxPFC_iNa_h_last.*(deepIxPFC_V_last-p.deepIxPFC_iNa_ENa))))+((((-p.deepIxPFC_iK_gK.*deepIxPFC_iK_n_last.^4.*(deepIxPFC_V_last-p.deepIxPFC_iK_EK))))+((-(((p.deepIxPFC_deepExPFC_iAMPActx_gAMPA.*(deepIxPFC_deepExPFC_iAMPActx_s_last*p.deepIxPFC_deepExPFC_iAMPActx_netcon).*(deepIxPFC_V_last-p.deepIxPFC_deepExPFC_iAMPActx_EAMPA)))))+((((-p.deepIxPFC_deepIxPFC_iGABActx_gGABAa.*(deepIxPFC_deepIxPFC_iGABActx_s_last*p.deepIxPFC_deepIxPFC_iGABActx_netcon).*(deepIxPFC_V_last-p.deepIxPFC_deepIxPFC_iGABActx_EGABAa)))))))) + p.deepIxPFC_noise*randn(1, p.deepIxPFC_Npop))/p.deepIxPFC_C;
  deepIxPFC_iNa_m_k1 = (((2.5-.1*(deepIxPFC_V_last+65))./(exp(2.5-.1*(deepIxPFC_V_last+65))-1))).*(1-deepIxPFC_iNa_m_last)-((4*exp(-(deepIxPFC_V_last+65)/18))).*deepIxPFC_iNa_m_last;
  deepIxPFC_iNa_h_k1 = ((.07*exp(-(deepIxPFC_V_last+65)/20))).*(1-deepIxPFC_iNa_h_last)-((1./(exp(3-.1*(deepIxPFC_V_last+65))+1))).*deepIxPFC_iNa_h_last;
  deepIxPFC_iK_n_k1 = (((.1-.01*(deepIxPFC_V_last+65))./(exp(1-.1*(deepIxPFC_V_last+65))-1))).*(1-deepIxPFC_iK_n_last)-((.125*exp(-(deepIxPFC_V_last+65)/80))).*deepIxPFC_iK_n_last;
  PreStimuliAxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PreStimuliAxPFC_t1).^2) - exp(- (t - p.PreStimuliAxPFC_t2).^2)) + p.PreStimuliAxPFC_noise*randn(1, p.PreStimuliAxPFC_Npop))/p.PreStimuliAxPFC_C;
  PreStimuliAxPFC_iNa_m_k1 = (((2.5-.1*(PreStimuliAxPFC_V_last+65))./(exp(2.5-.1*(PreStimuliAxPFC_V_last+65))-1))).*(1-PreStimuliAxPFC_iNa_m_last)-((4*exp(-(PreStimuliAxPFC_V_last+65)/18))).*PreStimuliAxPFC_iNa_m_last;
  PreStimuliAxPFC_iNa_h_k1 = ((.07*exp(-(PreStimuliAxPFC_V_last+65)/20))).*(1-PreStimuliAxPFC_iNa_h_last)-((1./(exp(3-.1*(PreStimuliAxPFC_V_last+65))+1))).*PreStimuliAxPFC_iNa_h_last;
  PreStimuliAxPFC_iK_n_k1 = (((.1-.01*(PreStimuliAxPFC_V_last+65))./(exp(1-.1*(PreStimuliAxPFC_V_last+65))-1))).*(1-PreStimuliAxPFC_iK_n_last)-((.125*exp(-(PreStimuliAxPFC_V_last+65)/80))).*PreStimuliAxPFC_iK_n_last;
  PostStimuliAxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PostStimuliAxPFC_t1).^2) - exp(- (t - p.PostStimuliAxPFC_t2).^2)) + p.PostStimuliAxPFC_noise*randn(1, p.PostStimuliAxPFC_Npop))/p.PostStimuliAxPFC_C;
  PostStimuliAxPFC_iNa_m_k1 = (((2.5-.1*(PostStimuliAxPFC_V_last+65))./(exp(2.5-.1*(PostStimuliAxPFC_V_last+65))-1))).*(1-PostStimuliAxPFC_iNa_m_last)-((4*exp(-(PostStimuliAxPFC_V_last+65)/18))).*PostStimuliAxPFC_iNa_m_last;
  PostStimuliAxPFC_iNa_h_k1 = ((.07*exp(-(PostStimuliAxPFC_V_last+65)/20))).*(1-PostStimuliAxPFC_iNa_h_last)-((1./(exp(3-.1*(PostStimuliAxPFC_V_last+65))+1))).*PostStimuliAxPFC_iNa_h_last;
  PostStimuliAxPFC_iK_n_k1 = (((.1-.01*(PostStimuliAxPFC_V_last+65))./(exp(1-.1*(PostStimuliAxPFC_V_last+65))-1))).*(1-PostStimuliAxPFC_iK_n_last)-((.125*exp(-(PostStimuliAxPFC_V_last+65)/80))).*PostStimuliAxPFC_iK_n_last;
  PreStimuliBxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PreStimuliBxPFC_t1).^2) - exp(- (t - p.PreStimuliBxPFC_t2).^2)) + p.PreStimuliBxPFC_noise*randn(1, p.PreStimuliBxPFC_Npop))/p.PreStimuliBxPFC_C;
  PreStimuliBxPFC_iNa_m_k1 = (((2.5-.1*(PreStimuliBxPFC_V_last+65))./(exp(2.5-.1*(PreStimuliBxPFC_V_last+65))-1))).*(1-PreStimuliBxPFC_iNa_m_last)-((4*exp(-(PreStimuliBxPFC_V_last+65)/18))).*PreStimuliBxPFC_iNa_m_last;
  PreStimuliBxPFC_iNa_h_k1 = ((.07*exp(-(PreStimuliBxPFC_V_last+65)/20))).*(1-PreStimuliBxPFC_iNa_h_last)-((1./(exp(3-.1*(PreStimuliBxPFC_V_last+65))+1))).*PreStimuliBxPFC_iNa_h_last;
  PreStimuliBxPFC_iK_n_k1 = (((.1-.01*(PreStimuliBxPFC_V_last+65))./(exp(1-.1*(PreStimuliBxPFC_V_last+65))-1))).*(1-PreStimuliBxPFC_iK_n_last)-((.125*exp(-(PreStimuliBxPFC_V_last+65)/80))).*PreStimuliBxPFC_iK_n_last;
  PostStimuliBxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PostStimuliBxPFC_t1).^2) - exp(- (t - p.PostStimuliBxPFC_t2).^2)) + p.PostStimuliBxPFC_noise*randn(1, p.PostStimuliBxPFC_Npop))/p.PostStimuliBxPFC_C;
  PostStimuliBxPFC_iNa_m_k1 = (((2.5-.1*(PostStimuliBxPFC_V_last+65))./(exp(2.5-.1*(PostStimuliBxPFC_V_last+65))-1))).*(1-PostStimuliBxPFC_iNa_m_last)-((4*exp(-(PostStimuliBxPFC_V_last+65)/18))).*PostStimuliBxPFC_iNa_m_last;
  PostStimuliBxPFC_iNa_h_k1 = ((.07*exp(-(PostStimuliBxPFC_V_last+65)/20))).*(1-PostStimuliBxPFC_iNa_h_last)-((1./(exp(3-.1*(PostStimuliBxPFC_V_last+65))+1))).*PostStimuliBxPFC_iNa_h_last;
  PostStimuliBxPFC_iK_n_k1 = (((.1-.01*(PostStimuliBxPFC_V_last+65))./(exp(1-.1*(PostStimuliBxPFC_V_last+65))-1))).*(1-PostStimuliBxPFC_iK_n_last)-((.125*exp(-(PostStimuliBxPFC_V_last+65)/80))).*PostStimuliBxPFC_iK_n_last;
  PreStimuliCxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PreStimuliCxPFC_t1).^2) - exp(- (t - p.PreStimuliCxPFC_t2).^2)) + p.PreStimuliCxPFC_noise*randn(1, p.PreStimuliCxPFC_Npop))/p.PreStimuliCxPFC_C;
  PreStimuliCxPFC_iNa_m_k1 = (((2.5-.1*(PreStimuliCxPFC_V_last+65))./(exp(2.5-.1*(PreStimuliCxPFC_V_last+65))-1))).*(1-PreStimuliCxPFC_iNa_m_last)-((4*exp(-(PreStimuliCxPFC_V_last+65)/18))).*PreStimuliCxPFC_iNa_m_last;
  PreStimuliCxPFC_iNa_h_k1 = ((.07*exp(-(PreStimuliCxPFC_V_last+65)/20))).*(1-PreStimuliCxPFC_iNa_h_last)-((1./(exp(3-.1*(PreStimuliCxPFC_V_last+65))+1))).*PreStimuliCxPFC_iNa_h_last;
  PreStimuliCxPFC_iK_n_k1 = (((.1-.01*(PreStimuliCxPFC_V_last+65))./(exp(1-.1*(PreStimuliCxPFC_V_last+65))-1))).*(1-PreStimuliCxPFC_iK_n_last)-((.125*exp(-(PreStimuliCxPFC_V_last+65)/80))).*PreStimuliCxPFC_iK_n_last;
  PostStimuliCxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PostStimuliCxPFC_t1).^2) - exp(- (t - p.PostStimuliCxPFC_t2).^2)) + p.PostStimuliCxPFC_noise*randn(1, p.PostStimuliCxPFC_Npop))/p.PostStimuliCxPFC_C;
  PostStimuliCxPFC_iNa_m_k1 = (((2.5-.1*(PostStimuliCxPFC_V_last+65))./(exp(2.5-.1*(PostStimuliCxPFC_V_last+65))-1))).*(1-PostStimuliCxPFC_iNa_m_last)-((4*exp(-(PostStimuliCxPFC_V_last+65)/18))).*PostStimuliCxPFC_iNa_m_last;
  PostStimuliCxPFC_iNa_h_k1 = ((.07*exp(-(PostStimuliCxPFC_V_last+65)/20))).*(1-PostStimuliCxPFC_iNa_h_last)-((1./(exp(3-.1*(PostStimuliCxPFC_V_last+65))+1))).*PostStimuliCxPFC_iNa_h_last;
  PostStimuliCxPFC_iK_n_k1 = (((.1-.01*(PostStimuliCxPFC_V_last+65))./(exp(1-.1*(PostStimuliCxPFC_V_last+65))-1))).*(1-PostStimuliCxPFC_iK_n_last)-((.125*exp(-(PostStimuliCxPFC_V_last+65)/80))).*PostStimuliCxPFC_iK_n_last;
  supIxV4_supExV4_iAMPActx_s_k1 = -supIxV4_supExV4_iAMPActx_s_last./p.supIxV4_supExV4_iAMPActx_tauAMPA + ((1-supIxV4_supExV4_iAMPActx_s_last)/p.supIxV4_supExV4_iAMPActx_tauAMPAr).*(1+tanh(supExV4_V_last/10));
  supExV4_supExV4_iAMPActx_s_k1 = -supExV4_supExV4_iAMPActx_s_last./p.supExV4_supExV4_iAMPActx_tauAMPA + ((1-supExV4_supExV4_iAMPActx_s_last)/p.supExV4_supExV4_iAMPActx_tauAMPAr).*(1+tanh(supExV4_V_last/10));
  supExV4_supIxV4_iGABActx_s_k1 = -supExV4_supIxV4_iGABActx_s_last./p.supExV4_supIxV4_iGABActx_tauGABA + 1/2*(1+tanh(supIxV4_V_last/10)).*((1-supExV4_supIxV4_iGABActx_s_last)/p.supExV4_supIxV4_iGABActx_tauGABAr);
  supIxV4_supIxV4_iGABActx_s_k1 = -supIxV4_supIxV4_iGABActx_s_last./p.supIxV4_supIxV4_iGABActx_tauGABA + 1/2*(1+tanh(supIxV4_V_last/10)).*((1-supIxV4_supIxV4_iGABActx_s_last)/p.supIxV4_supIxV4_iGABActx_tauGABAr);
  midIxV4_midExV4_iAMPActx_s_k1 = -midIxV4_midExV4_iAMPActx_s_last./p.midIxV4_midExV4_iAMPActx_tauAMPA + ((1-midIxV4_midExV4_iAMPActx_s_last)/p.midIxV4_midExV4_iAMPActx_tauAMPAr).*(1+tanh(midExV4_V_last/10));
  midExV4_midExV4_iAMPActx_s_k1 = -midExV4_midExV4_iAMPActx_s_last./p.midExV4_midExV4_iAMPActx_tauAMPA + ((1-midExV4_midExV4_iAMPActx_s_last)/p.midExV4_midExV4_iAMPActx_tauAMPAr).*(1+tanh(midExV4_V_last/10));
  midExV4_midIxV4_iGABActx_s_k1 = -midExV4_midIxV4_iGABActx_s_last./p.midExV4_midIxV4_iGABActx_tauGABA + 1/2*(1+tanh(midIxV4_V_last/10)).*((1-midExV4_midIxV4_iGABActx_s_last)/p.midExV4_midIxV4_iGABActx_tauGABAr);
  midIxV4_midIxV4_iGABActx_s_k1 = -midIxV4_midIxV4_iGABActx_s_last./p.midIxV4_midIxV4_iGABActx_tauGABA + 1/2*(1+tanh(midIxV4_V_last/10)).*((1-midIxV4_midIxV4_iGABActx_s_last)/p.midIxV4_midIxV4_iGABActx_tauGABAr);
  deepIxV4_deepExV4_iAMPActx_s_k1 = -deepIxV4_deepExV4_iAMPActx_s_last./p.deepIxV4_deepExV4_iAMPActx_tauAMPA + ((1-deepIxV4_deepExV4_iAMPActx_s_last)/p.deepIxV4_deepExV4_iAMPActx_tauAMPAr).*(1+tanh(deepExV4_V_last/10));
  deepExV4_deepExV4_iAMPActx_s_k1 = -deepExV4_deepExV4_iAMPActx_s_last./p.deepExV4_deepExV4_iAMPActx_tauAMPA + ((1-deepExV4_deepExV4_iAMPActx_s_last)/p.deepExV4_deepExV4_iAMPActx_tauAMPAr).*(1+tanh(deepExV4_V_last/10));
  deepExV4_deepIxV4_iGABActx_s_k1 = -deepExV4_deepIxV4_iGABActx_s_last./p.deepExV4_deepIxV4_iGABActx_tauGABA + 1/2*(1+tanh(deepIxV4_V_last/10)).*((1-deepExV4_deepIxV4_iGABActx_s_last)/p.deepExV4_deepIxV4_iGABActx_tauGABAr);
  deepIxV4_deepIxV4_iGABActx_s_k1 = -deepIxV4_deepIxV4_iGABActx_s_last./p.deepIxV4_deepIxV4_iGABActx_tauGABA + 1/2*(1+tanh(deepIxV4_V_last/10)).*((1-deepIxV4_deepIxV4_iGABActx_s_last)/p.deepIxV4_deepIxV4_iGABActx_tauGABAr);
  PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_k1 = -PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last./p.PostStimuliAxV4_PreStimuliAxV4_iAMPActx_tauAMPA + ((1-PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last)/p.PostStimuliAxV4_PreStimuliAxV4_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliAxV4_V_last/10));
  PreStimuliAxV4_PreStimuliAxV4_iAMPActx_s_k1 = -PreStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last./p.PreStimuliAxV4_PreStimuliAxV4_iAMPActx_tauAMPA + ((1-PreStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last)/p.PreStimuliAxV4_PreStimuliAxV4_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliAxV4_V_last/10));
  PreStimuliAxV4_PostStimuliAxV4_iAMPActx_s_k1 = -PreStimuliAxV4_PostStimuliAxV4_iAMPActx_s_last./p.PreStimuliAxV4_PostStimuliAxV4_iAMPActx_tauAMPA + ((1-PreStimuliAxV4_PostStimuliAxV4_iAMPActx_s_last)/p.PreStimuliAxV4_PostStimuliAxV4_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliAxV4_V_last/10));
  PostStimuliAxV4_PostStimuliAxV4_iAMPActx_s_k1 = -PostStimuliAxV4_PostStimuliAxV4_iAMPActx_s_last./p.PostStimuliAxV4_PostStimuliAxV4_iAMPActx_tauAMPA + ((1-PostStimuliAxV4_PostStimuliAxV4_iAMPActx_s_last)/p.PostStimuliAxV4_PostStimuliAxV4_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliAxV4_V_last/10));
  PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_k1 = -PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last./p.PostStimuliBxV4_PreStimuliBxV4_iAMPActx_tauAMPA + ((1-PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last)/p.PostStimuliBxV4_PreStimuliBxV4_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliBxV4_V_last/10));
  PreStimuliBxV4_PreStimuliBxV4_iAMPActx_s_k1 = -PreStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last./p.PreStimuliBxV4_PreStimuliBxV4_iAMPActx_tauAMPA + ((1-PreStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last)/p.PreStimuliBxV4_PreStimuliBxV4_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliBxV4_V_last/10));
  PreStimuliBxV4_PostStimuliBxV4_iAMPActx_s_k1 = -PreStimuliBxV4_PostStimuliBxV4_iAMPActx_s_last./p.PreStimuliBxV4_PostStimuliBxV4_iAMPActx_tauAMPA + ((1-PreStimuliBxV4_PostStimuliBxV4_iAMPActx_s_last)/p.PreStimuliBxV4_PostStimuliBxV4_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliBxV4_V_last/10));
  PostStimuliBxV4_PostStimuliBxV4_iAMPActx_s_k1 = -PostStimuliBxV4_PostStimuliBxV4_iAMPActx_s_last./p.PostStimuliBxV4_PostStimuliBxV4_iAMPActx_tauAMPA + ((1-PostStimuliBxV4_PostStimuliBxV4_iAMPActx_s_last)/p.PostStimuliBxV4_PostStimuliBxV4_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliBxV4_V_last/10));
  PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_k1 = -PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last./p.PostStimuliCxV4_PreStimuliCxV4_iAMPActx_tauAMPA + ((1-PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last)/p.PostStimuliCxV4_PreStimuliCxV4_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliCxV4_V_last/10));
  PreStimuliCxV4_PreStimuliCxV4_iAMPActx_s_k1 = -PreStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last./p.PreStimuliCxV4_PreStimuliCxV4_iAMPActx_tauAMPA + ((1-PreStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last)/p.PreStimuliCxV4_PreStimuliCxV4_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliCxV4_V_last/10));
  PreStimuliCxV4_PostStimuliCxV4_iAMPActx_s_k1 = -PreStimuliCxV4_PostStimuliCxV4_iAMPActx_s_last./p.PreStimuliCxV4_PostStimuliCxV4_iAMPActx_tauAMPA + ((1-PreStimuliCxV4_PostStimuliCxV4_iAMPActx_s_last)/p.PreStimuliCxV4_PostStimuliCxV4_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliCxV4_V_last/10));
  PostStimuliCxV4_PostStimuliCxV4_iAMPActx_s_k1 = -PostStimuliCxV4_PostStimuliCxV4_iAMPActx_s_last./p.PostStimuliCxV4_PostStimuliCxV4_iAMPActx_tauAMPA + ((1-PostStimuliCxV4_PostStimuliCxV4_iAMPActx_s_last)/p.PostStimuliCxV4_PostStimuliCxV4_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliCxV4_V_last/10));
  midExV4_PreStimuliAxV4_iAMPActx_s_k1 = -midExV4_PreStimuliAxV4_iAMPActx_s_last./p.midExV4_PreStimuliAxV4_iAMPActx_tauAMPA + ((1-midExV4_PreStimuliAxV4_iAMPActx_s_last)/p.midExV4_PreStimuliAxV4_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliAxV4_V_last/10));
  midExV4_PostStimuliAxV4_iAMPActx_s_k1 = -midExV4_PostStimuliAxV4_iAMPActx_s_last./p.midExV4_PostStimuliAxV4_iAMPActx_tauAMPA + ((1-midExV4_PostStimuliAxV4_iAMPActx_s_last)/p.midExV4_PostStimuliAxV4_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliAxV4_V_last/10));
  midExV4_PreStimuliBxV4_iAMPActx_s_k1 = -midExV4_PreStimuliBxV4_iAMPActx_s_last./p.midExV4_PreStimuliBxV4_iAMPActx_tauAMPA + ((1-midExV4_PreStimuliBxV4_iAMPActx_s_last)/p.midExV4_PreStimuliBxV4_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliBxV4_V_last/10));
  midExV4_PostStimuliBxV4_iAMPActx_s_k1 = -midExV4_PostStimuliBxV4_iAMPActx_s_last./p.midExV4_PostStimuliBxV4_iAMPActx_tauAMPA + ((1-midExV4_PostStimuliBxV4_iAMPActx_s_last)/p.midExV4_PostStimuliBxV4_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliBxV4_V_last/10));
  midExV4_PreStimuliCxV4_iAMPActx_s_k1 = -midExV4_PreStimuliCxV4_iAMPActx_s_last./p.midExV4_PreStimuliCxV4_iAMPActx_tauAMPA + ((1-midExV4_PreStimuliCxV4_iAMPActx_s_last)/p.midExV4_PreStimuliCxV4_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliCxV4_V_last/10));
  midExV4_PostStimuliCxV4_iAMPActx_s_k1 = -midExV4_PostStimuliCxV4_iAMPActx_s_last./p.midExV4_PostStimuliCxV4_iAMPActx_tauAMPA + ((1-midExV4_PostStimuliCxV4_iAMPActx_s_last)/p.midExV4_PostStimuliCxV4_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliCxV4_V_last/10));
  supExV4_midExV4_iAMPActx_s_k1 = -supExV4_midExV4_iAMPActx_s_last./p.supExV4_midExV4_iAMPActx_tauAMPA + ((1-supExV4_midExV4_iAMPActx_s_last)/p.supExV4_midExV4_iAMPActx_tauAMPAr).*(1+tanh(midExV4_V_last/10));
  deepExV4_midExV4_iAMPActx_s_k1 = -deepExV4_midExV4_iAMPActx_s_last./p.deepExV4_midExV4_iAMPActx_tauAMPA + ((1-deepExV4_midExV4_iAMPActx_s_last)/p.deepExV4_midExV4_iAMPActx_tauAMPAr).*(1+tanh(midExV4_V_last/10));
  deepExV4_midIxV4_iGABActx_s_k1 = -deepExV4_midIxV4_iGABActx_s_last./p.deepExV4_midIxV4_iGABActx_tauGABA + 1/2*(1+tanh(midIxV4_V_last/10)).*((1-deepExV4_midIxV4_iGABActx_s_last)/p.deepExV4_midIxV4_iGABActx_tauGABAr);
  deepExV4_supExV4_iAMPActx_s_k1 = -deepExV4_supExV4_iAMPActx_s_last./p.deepExV4_supExV4_iAMPActx_tauAMPA + ((1-deepExV4_supExV4_iAMPActx_s_last)/p.deepExV4_supExV4_iAMPActx_tauAMPAr).*(1+tanh(supExV4_V_last/10));
  supIxPFC_supExPFC_iAMPActx_s_k1 = -supIxPFC_supExPFC_iAMPActx_s_last./p.supIxPFC_supExPFC_iAMPActx_tauAMPA + ((1-supIxPFC_supExPFC_iAMPActx_s_last)/p.supIxPFC_supExPFC_iAMPActx_tauAMPAr).*(1+tanh(supExPFC_V_last/10));
  supExPFC_supExPFC_iAMPActx_s_k1 = -supExPFC_supExPFC_iAMPActx_s_last./p.supExPFC_supExPFC_iAMPActx_tauAMPA + ((1-supExPFC_supExPFC_iAMPActx_s_last)/p.supExPFC_supExPFC_iAMPActx_tauAMPAr).*(1+tanh(supExPFC_V_last/10));
  supExPFC_supIxPFC_iGABActx_s_k1 = -supExPFC_supIxPFC_iGABActx_s_last./p.supExPFC_supIxPFC_iGABActx_tauGABA + 1/2*(1+tanh(supIxPFC_V_last/10)).*((1-supExPFC_supIxPFC_iGABActx_s_last)/p.supExPFC_supIxPFC_iGABActx_tauGABAr);
  supIxPFC_supIxPFC_iGABActx_s_k1 = -supIxPFC_supIxPFC_iGABActx_s_last./p.supIxPFC_supIxPFC_iGABActx_tauGABA + 1/2*(1+tanh(supIxPFC_V_last/10)).*((1-supIxPFC_supIxPFC_iGABActx_s_last)/p.supIxPFC_supIxPFC_iGABActx_tauGABAr);
  midIxPFC_midExPFC_iAMPActx_s_k1 = -midIxPFC_midExPFC_iAMPActx_s_last./p.midIxPFC_midExPFC_iAMPActx_tauAMPA + ((1-midIxPFC_midExPFC_iAMPActx_s_last)/p.midIxPFC_midExPFC_iAMPActx_tauAMPAr).*(1+tanh(midExPFC_V_last/10));
  midExPFC_midExPFC_iAMPActx_s_k1 = -midExPFC_midExPFC_iAMPActx_s_last./p.midExPFC_midExPFC_iAMPActx_tauAMPA + ((1-midExPFC_midExPFC_iAMPActx_s_last)/p.midExPFC_midExPFC_iAMPActx_tauAMPAr).*(1+tanh(midExPFC_V_last/10));
  midExPFC_midIxPFC_iGABActx_s_k1 = -midExPFC_midIxPFC_iGABActx_s_last./p.midExPFC_midIxPFC_iGABActx_tauGABA + 1/2*(1+tanh(midIxPFC_V_last/10)).*((1-midExPFC_midIxPFC_iGABActx_s_last)/p.midExPFC_midIxPFC_iGABActx_tauGABAr);
  midIxPFC_midIxPFC_iGABActx_s_k1 = -midIxPFC_midIxPFC_iGABActx_s_last./p.midIxPFC_midIxPFC_iGABActx_tauGABA + 1/2*(1+tanh(midIxPFC_V_last/10)).*((1-midIxPFC_midIxPFC_iGABActx_s_last)/p.midIxPFC_midIxPFC_iGABActx_tauGABAr);
  deepIxPFC_deepExPFC_iAMPActx_s_k1 = -deepIxPFC_deepExPFC_iAMPActx_s_last./p.deepIxPFC_deepExPFC_iAMPActx_tauAMPA + ((1-deepIxPFC_deepExPFC_iAMPActx_s_last)/p.deepIxPFC_deepExPFC_iAMPActx_tauAMPAr).*(1+tanh(deepExPFC_V_last/10));
  deepExPFC_deepExPFC_iAMPActx_s_k1 = -deepExPFC_deepExPFC_iAMPActx_s_last./p.deepExPFC_deepExPFC_iAMPActx_tauAMPA + ((1-deepExPFC_deepExPFC_iAMPActx_s_last)/p.deepExPFC_deepExPFC_iAMPActx_tauAMPAr).*(1+tanh(deepExPFC_V_last/10));
  deepExPFC_deepIxPFC_iGABActx_s_k1 = -deepExPFC_deepIxPFC_iGABActx_s_last./p.deepExPFC_deepIxPFC_iGABActx_tauGABA + 1/2*(1+tanh(deepIxPFC_V_last/10)).*((1-deepExPFC_deepIxPFC_iGABActx_s_last)/p.deepExPFC_deepIxPFC_iGABActx_tauGABAr);
  deepIxPFC_deepIxPFC_iGABActx_s_k1 = -deepIxPFC_deepIxPFC_iGABActx_s_last./p.deepIxPFC_deepIxPFC_iGABActx_tauGABA + 1/2*(1+tanh(deepIxPFC_V_last/10)).*((1-deepIxPFC_deepIxPFC_iGABActx_s_last)/p.deepIxPFC_deepIxPFC_iGABActx_tauGABAr);
  PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_k1 = -PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last./p.PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_tauAMPA + ((1-PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last)/p.PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliAxPFC_V_last/10));
  PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_k1 = -PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last./p.PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_tauAMPA + ((1-PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last)/p.PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliAxPFC_V_last/10));
  PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_k1 = -PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_last./p.PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_tauAMPA + ((1-PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_last)/p.PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliAxPFC_V_last/10));
  PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_k1 = -PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_last./p.PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_tauAMPA + ((1-PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_last)/p.PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliAxPFC_V_last/10));
  PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_k1 = -PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last./p.PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_tauAMPA + ((1-PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last)/p.PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliBxPFC_V_last/10));
  PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_k1 = -PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last./p.PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_tauAMPA + ((1-PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last)/p.PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliBxPFC_V_last/10));
  PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_k1 = -PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_last./p.PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_tauAMPA + ((1-PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_last)/p.PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliBxPFC_V_last/10));
  PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_k1 = -PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_last./p.PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_tauAMPA + ((1-PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_last)/p.PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliBxPFC_V_last/10));
  PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_k1 = -PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last./p.PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_tauAMPA + ((1-PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last)/p.PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliCxPFC_V_last/10));
  PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_k1 = -PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last./p.PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_tauAMPA + ((1-PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last)/p.PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliCxPFC_V_last/10));
  PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_k1 = -PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_last./p.PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_tauAMPA + ((1-PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_last)/p.PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliCxPFC_V_last/10));
  PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_k1 = -PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_last./p.PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_tauAMPA + ((1-PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_last)/p.PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliCxPFC_V_last/10));
  midExPFC_PreStimuliAxPFC_iAMPActx_s_k1 = -midExPFC_PreStimuliAxPFC_iAMPActx_s_last./p.midExPFC_PreStimuliAxPFC_iAMPActx_tauAMPA + ((1-midExPFC_PreStimuliAxPFC_iAMPActx_s_last)/p.midExPFC_PreStimuliAxPFC_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliAxPFC_V_last/10));
  midExPFC_PostStimuliAxPFC_iAMPActx_s_k1 = -midExPFC_PostStimuliAxPFC_iAMPActx_s_last./p.midExPFC_PostStimuliAxPFC_iAMPActx_tauAMPA + ((1-midExPFC_PostStimuliAxPFC_iAMPActx_s_last)/p.midExPFC_PostStimuliAxPFC_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliAxPFC_V_last/10));
  midExPFC_PreStimuliBxPFC_iAMPActx_s_k1 = -midExPFC_PreStimuliBxPFC_iAMPActx_s_last./p.midExPFC_PreStimuliBxPFC_iAMPActx_tauAMPA + ((1-midExPFC_PreStimuliBxPFC_iAMPActx_s_last)/p.midExPFC_PreStimuliBxPFC_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliBxPFC_V_last/10));
  midExPFC_PostStimuliBxPFC_iAMPActx_s_k1 = -midExPFC_PostStimuliBxPFC_iAMPActx_s_last./p.midExPFC_PostStimuliBxPFC_iAMPActx_tauAMPA + ((1-midExPFC_PostStimuliBxPFC_iAMPActx_s_last)/p.midExPFC_PostStimuliBxPFC_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliBxPFC_V_last/10));
  midExPFC_PreStimuliCxPFC_iAMPActx_s_k1 = -midExPFC_PreStimuliCxPFC_iAMPActx_s_last./p.midExPFC_PreStimuliCxPFC_iAMPActx_tauAMPA + ((1-midExPFC_PreStimuliCxPFC_iAMPActx_s_last)/p.midExPFC_PreStimuliCxPFC_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliCxPFC_V_last/10));
  midExPFC_PostStimuliCxPFC_iAMPActx_s_k1 = -midExPFC_PostStimuliCxPFC_iAMPActx_s_last./p.midExPFC_PostStimuliCxPFC_iAMPActx_tauAMPA + ((1-midExPFC_PostStimuliCxPFC_iAMPActx_s_last)/p.midExPFC_PostStimuliCxPFC_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliCxPFC_V_last/10));
  supExPFC_midExPFC_iAMPActx_s_k1 = -supExPFC_midExPFC_iAMPActx_s_last./p.supExPFC_midExPFC_iAMPActx_tauAMPA + ((1-supExPFC_midExPFC_iAMPActx_s_last)/p.supExPFC_midExPFC_iAMPActx_tauAMPAr).*(1+tanh(midExPFC_V_last/10));
  deepExPFC_midExPFC_iAMPActx_s_k1 = -deepExPFC_midExPFC_iAMPActx_s_last./p.deepExPFC_midExPFC_iAMPActx_tauAMPA + ((1-deepExPFC_midExPFC_iAMPActx_s_last)/p.deepExPFC_midExPFC_iAMPActx_tauAMPAr).*(1+tanh(midExPFC_V_last/10));
  deepExPFC_midIxPFC_iGABActx_s_k1 = -deepExPFC_midIxPFC_iGABActx_s_last./p.deepExPFC_midIxPFC_iGABActx_tauGABA + 1/2*(1+tanh(midIxPFC_V_last/10)).*((1-deepExPFC_midIxPFC_iGABActx_s_last)/p.deepExPFC_midIxPFC_iGABActx_tauGABAr);
  deepExPFC_supExPFC_iAMPActx_s_k1 = -deepExPFC_supExPFC_iAMPActx_s_last./p.deepExPFC_supExPFC_iAMPActx_tauAMPA + ((1-deepExPFC_supExPFC_iAMPActx_s_last)/p.deepExPFC_supExPFC_iAMPActx_tauAMPAr).*(1+tanh(supExPFC_V_last/10));
  midExPFC_supExV4_iAMPActx_s_k1 = -midExPFC_supExV4_iAMPActx_s_last./p.midExPFC_supExV4_iAMPActx_tauAMPA + ((1-midExPFC_supExV4_iAMPActx_s_last)/p.midExPFC_supExV4_iAMPActx_tauAMPAr).*(1+tanh(supExV4_V_last/10));
  midIxPFC_supIxV4_iAMPActx_s_k1 = -midIxPFC_supIxV4_iAMPActx_s_last./p.midIxPFC_supIxV4_iAMPActx_tauAMPA + ((1-midIxPFC_supIxV4_iAMPActx_s_last)/p.midIxPFC_supIxV4_iAMPActx_tauAMPAr).*(1+tanh(supIxV4_V_last/10));
  midIxV4_deepIxPFC_iAMPActx_s_k1 = -midIxV4_deepIxPFC_iAMPActx_s_last./p.midIxV4_deepIxPFC_iAMPActx_tauAMPA + ((1-midIxV4_deepIxPFC_iAMPActx_s_last)/p.midIxV4_deepIxPFC_iAMPActx_tauAMPAr).*(1+tanh(deepIxPFC_V_last/10));
  midExV4_deepExPFC_iAMPActx_s_k1 = -midExV4_deepExPFC_iAMPActx_s_last./p.midExV4_deepExPFC_iAMPActx_tauAMPA + ((1-midExV4_deepExPFC_iAMPActx_s_last)/p.midExV4_deepExPFC_iAMPActx_tauAMPAr).*(1+tanh(deepExPFC_V_last/10));

  % ------------------------------------------------------------
  % Update state variables:
  % ------------------------------------------------------------
  supExV4_V_last = supExV4_V_last+dt*supExV4_V_k1;
  supExV4_iNa_m_last = supExV4_iNa_m_last+dt*supExV4_iNa_m_k1;
  supExV4_iNa_h_last = supExV4_iNa_h_last+dt*supExV4_iNa_h_k1;
  supExV4_iK_n_last = supExV4_iK_n_last+dt*supExV4_iK_n_k1;
  supIxV4_V_last = supIxV4_V_last+dt*supIxV4_V_k1;
  supIxV4_iNa_m_last = supIxV4_iNa_m_last+dt*supIxV4_iNa_m_k1;
  supIxV4_iNa_h_last = supIxV4_iNa_h_last+dt*supIxV4_iNa_h_k1;
  supIxV4_iK_n_last = supIxV4_iK_n_last+dt*supIxV4_iK_n_k1;
  midExV4_V_last = midExV4_V_last+dt*midExV4_V_k1;
  midExV4_iNa_m_last = midExV4_iNa_m_last+dt*midExV4_iNa_m_k1;
  midExV4_iNa_h_last = midExV4_iNa_h_last+dt*midExV4_iNa_h_k1;
  midExV4_iK_n_last = midExV4_iK_n_last+dt*midExV4_iK_n_k1;
  midIxV4_V_last = midIxV4_V_last+dt*midIxV4_V_k1;
  midIxV4_iNa_m_last = midIxV4_iNa_m_last+dt*midIxV4_iNa_m_k1;
  midIxV4_iNa_h_last = midIxV4_iNa_h_last+dt*midIxV4_iNa_h_k1;
  midIxV4_iK_n_last = midIxV4_iK_n_last+dt*midIxV4_iK_n_k1;
  deepExV4_V_last = deepExV4_V_last+dt*deepExV4_V_k1;
  deepExV4_iNa_m_last = deepExV4_iNa_m_last+dt*deepExV4_iNa_m_k1;
  deepExV4_iNa_h_last = deepExV4_iNa_h_last+dt*deepExV4_iNa_h_k1;
  deepExV4_iK_n_last = deepExV4_iK_n_last+dt*deepExV4_iK_n_k1;
  deepIxV4_V_last = deepIxV4_V_last+dt*deepIxV4_V_k1;
  deepIxV4_iNa_m_last = deepIxV4_iNa_m_last+dt*deepIxV4_iNa_m_k1;
  deepIxV4_iNa_h_last = deepIxV4_iNa_h_last+dt*deepIxV4_iNa_h_k1;
  deepIxV4_iK_n_last = deepIxV4_iK_n_last+dt*deepIxV4_iK_n_k1;
  PreStimuliAxV4_V_last = PreStimuliAxV4_V_last+dt*PreStimuliAxV4_V_k1;
  PreStimuliAxV4_iNa_m_last = PreStimuliAxV4_iNa_m_last+dt*PreStimuliAxV4_iNa_m_k1;
  PreStimuliAxV4_iNa_h_last = PreStimuliAxV4_iNa_h_last+dt*PreStimuliAxV4_iNa_h_k1;
  PreStimuliAxV4_iK_n_last = PreStimuliAxV4_iK_n_last+dt*PreStimuliAxV4_iK_n_k1;
  PostStimuliAxV4_V_last = PostStimuliAxV4_V_last+dt*PostStimuliAxV4_V_k1;
  PostStimuliAxV4_iNa_m_last = PostStimuliAxV4_iNa_m_last+dt*PostStimuliAxV4_iNa_m_k1;
  PostStimuliAxV4_iNa_h_last = PostStimuliAxV4_iNa_h_last+dt*PostStimuliAxV4_iNa_h_k1;
  PostStimuliAxV4_iK_n_last = PostStimuliAxV4_iK_n_last+dt*PostStimuliAxV4_iK_n_k1;
  PreStimuliBxV4_V_last = PreStimuliBxV4_V_last+dt*PreStimuliBxV4_V_k1;
  PreStimuliBxV4_iNa_m_last = PreStimuliBxV4_iNa_m_last+dt*PreStimuliBxV4_iNa_m_k1;
  PreStimuliBxV4_iNa_h_last = PreStimuliBxV4_iNa_h_last+dt*PreStimuliBxV4_iNa_h_k1;
  PreStimuliBxV4_iK_n_last = PreStimuliBxV4_iK_n_last+dt*PreStimuliBxV4_iK_n_k1;
  PostStimuliBxV4_V_last = PostStimuliBxV4_V_last+dt*PostStimuliBxV4_V_k1;
  PostStimuliBxV4_iNa_m_last = PostStimuliBxV4_iNa_m_last+dt*PostStimuliBxV4_iNa_m_k1;
  PostStimuliBxV4_iNa_h_last = PostStimuliBxV4_iNa_h_last+dt*PostStimuliBxV4_iNa_h_k1;
  PostStimuliBxV4_iK_n_last = PostStimuliBxV4_iK_n_last+dt*PostStimuliBxV4_iK_n_k1;
  PreStimuliCxV4_V_last = PreStimuliCxV4_V_last+dt*PreStimuliCxV4_V_k1;
  PreStimuliCxV4_iNa_m_last = PreStimuliCxV4_iNa_m_last+dt*PreStimuliCxV4_iNa_m_k1;
  PreStimuliCxV4_iNa_h_last = PreStimuliCxV4_iNa_h_last+dt*PreStimuliCxV4_iNa_h_k1;
  PreStimuliCxV4_iK_n_last = PreStimuliCxV4_iK_n_last+dt*PreStimuliCxV4_iK_n_k1;
  PostStimuliCxV4_V_last = PostStimuliCxV4_V_last+dt*PostStimuliCxV4_V_k1;
  PostStimuliCxV4_iNa_m_last = PostStimuliCxV4_iNa_m_last+dt*PostStimuliCxV4_iNa_m_k1;
  PostStimuliCxV4_iNa_h_last = PostStimuliCxV4_iNa_h_last+dt*PostStimuliCxV4_iNa_h_k1;
  PostStimuliCxV4_iK_n_last = PostStimuliCxV4_iK_n_last+dt*PostStimuliCxV4_iK_n_k1;
  supExPFC_V_last = supExPFC_V_last+dt*supExPFC_V_k1;
  supExPFC_iNa_m_last = supExPFC_iNa_m_last+dt*supExPFC_iNa_m_k1;
  supExPFC_iNa_h_last = supExPFC_iNa_h_last+dt*supExPFC_iNa_h_k1;
  supExPFC_iK_n_last = supExPFC_iK_n_last+dt*supExPFC_iK_n_k1;
  supIxPFC_V_last = supIxPFC_V_last+dt*supIxPFC_V_k1;
  supIxPFC_iNa_m_last = supIxPFC_iNa_m_last+dt*supIxPFC_iNa_m_k1;
  supIxPFC_iNa_h_last = supIxPFC_iNa_h_last+dt*supIxPFC_iNa_h_k1;
  supIxPFC_iK_n_last = supIxPFC_iK_n_last+dt*supIxPFC_iK_n_k1;
  midExPFC_V_last = midExPFC_V_last+dt*midExPFC_V_k1;
  midExPFC_iNa_m_last = midExPFC_iNa_m_last+dt*midExPFC_iNa_m_k1;
  midExPFC_iNa_h_last = midExPFC_iNa_h_last+dt*midExPFC_iNa_h_k1;
  midExPFC_iK_n_last = midExPFC_iK_n_last+dt*midExPFC_iK_n_k1;
  midIxPFC_V_last = midIxPFC_V_last+dt*midIxPFC_V_k1;
  midIxPFC_iNa_m_last = midIxPFC_iNa_m_last+dt*midIxPFC_iNa_m_k1;
  midIxPFC_iNa_h_last = midIxPFC_iNa_h_last+dt*midIxPFC_iNa_h_k1;
  midIxPFC_iK_n_last = midIxPFC_iK_n_last+dt*midIxPFC_iK_n_k1;
  deepExPFC_V_last = deepExPFC_V_last+dt*deepExPFC_V_k1;
  deepExPFC_iNa_m_last = deepExPFC_iNa_m_last+dt*deepExPFC_iNa_m_k1;
  deepExPFC_iNa_h_last = deepExPFC_iNa_h_last+dt*deepExPFC_iNa_h_k1;
  deepExPFC_iK_n_last = deepExPFC_iK_n_last+dt*deepExPFC_iK_n_k1;
  deepIxPFC_V_last = deepIxPFC_V_last+dt*deepIxPFC_V_k1;
  deepIxPFC_iNa_m_last = deepIxPFC_iNa_m_last+dt*deepIxPFC_iNa_m_k1;
  deepIxPFC_iNa_h_last = deepIxPFC_iNa_h_last+dt*deepIxPFC_iNa_h_k1;
  deepIxPFC_iK_n_last = deepIxPFC_iK_n_last+dt*deepIxPFC_iK_n_k1;
  PreStimuliAxPFC_V_last = PreStimuliAxPFC_V_last+dt*PreStimuliAxPFC_V_k1;
  PreStimuliAxPFC_iNa_m_last = PreStimuliAxPFC_iNa_m_last+dt*PreStimuliAxPFC_iNa_m_k1;
  PreStimuliAxPFC_iNa_h_last = PreStimuliAxPFC_iNa_h_last+dt*PreStimuliAxPFC_iNa_h_k1;
  PreStimuliAxPFC_iK_n_last = PreStimuliAxPFC_iK_n_last+dt*PreStimuliAxPFC_iK_n_k1;
  PostStimuliAxPFC_V_last = PostStimuliAxPFC_V_last+dt*PostStimuliAxPFC_V_k1;
  PostStimuliAxPFC_iNa_m_last = PostStimuliAxPFC_iNa_m_last+dt*PostStimuliAxPFC_iNa_m_k1;
  PostStimuliAxPFC_iNa_h_last = PostStimuliAxPFC_iNa_h_last+dt*PostStimuliAxPFC_iNa_h_k1;
  PostStimuliAxPFC_iK_n_last = PostStimuliAxPFC_iK_n_last+dt*PostStimuliAxPFC_iK_n_k1;
  PreStimuliBxPFC_V_last = PreStimuliBxPFC_V_last+dt*PreStimuliBxPFC_V_k1;
  PreStimuliBxPFC_iNa_m_last = PreStimuliBxPFC_iNa_m_last+dt*PreStimuliBxPFC_iNa_m_k1;
  PreStimuliBxPFC_iNa_h_last = PreStimuliBxPFC_iNa_h_last+dt*PreStimuliBxPFC_iNa_h_k1;
  PreStimuliBxPFC_iK_n_last = PreStimuliBxPFC_iK_n_last+dt*PreStimuliBxPFC_iK_n_k1;
  PostStimuliBxPFC_V_last = PostStimuliBxPFC_V_last+dt*PostStimuliBxPFC_V_k1;
  PostStimuliBxPFC_iNa_m_last = PostStimuliBxPFC_iNa_m_last+dt*PostStimuliBxPFC_iNa_m_k1;
  PostStimuliBxPFC_iNa_h_last = PostStimuliBxPFC_iNa_h_last+dt*PostStimuliBxPFC_iNa_h_k1;
  PostStimuliBxPFC_iK_n_last = PostStimuliBxPFC_iK_n_last+dt*PostStimuliBxPFC_iK_n_k1;
  PreStimuliCxPFC_V_last = PreStimuliCxPFC_V_last+dt*PreStimuliCxPFC_V_k1;
  PreStimuliCxPFC_iNa_m_last = PreStimuliCxPFC_iNa_m_last+dt*PreStimuliCxPFC_iNa_m_k1;
  PreStimuliCxPFC_iNa_h_last = PreStimuliCxPFC_iNa_h_last+dt*PreStimuliCxPFC_iNa_h_k1;
  PreStimuliCxPFC_iK_n_last = PreStimuliCxPFC_iK_n_last+dt*PreStimuliCxPFC_iK_n_k1;
  PostStimuliCxPFC_V_last = PostStimuliCxPFC_V_last+dt*PostStimuliCxPFC_V_k1;
  PostStimuliCxPFC_iNa_m_last = PostStimuliCxPFC_iNa_m_last+dt*PostStimuliCxPFC_iNa_m_k1;
  PostStimuliCxPFC_iNa_h_last = PostStimuliCxPFC_iNa_h_last+dt*PostStimuliCxPFC_iNa_h_k1;
  PostStimuliCxPFC_iK_n_last = PostStimuliCxPFC_iK_n_last+dt*PostStimuliCxPFC_iK_n_k1;
  supIxV4_supExV4_iAMPActx_s_last = supIxV4_supExV4_iAMPActx_s_last+dt*supIxV4_supExV4_iAMPActx_s_k1;
  supExV4_supExV4_iAMPActx_s_last = supExV4_supExV4_iAMPActx_s_last+dt*supExV4_supExV4_iAMPActx_s_k1;
  supExV4_supIxV4_iGABActx_s_last = supExV4_supIxV4_iGABActx_s_last+dt*supExV4_supIxV4_iGABActx_s_k1;
  supIxV4_supIxV4_iGABActx_s_last = supIxV4_supIxV4_iGABActx_s_last+dt*supIxV4_supIxV4_iGABActx_s_k1;
  midIxV4_midExV4_iAMPActx_s_last = midIxV4_midExV4_iAMPActx_s_last+dt*midIxV4_midExV4_iAMPActx_s_k1;
  midExV4_midExV4_iAMPActx_s_last = midExV4_midExV4_iAMPActx_s_last+dt*midExV4_midExV4_iAMPActx_s_k1;
  midExV4_midIxV4_iGABActx_s_last = midExV4_midIxV4_iGABActx_s_last+dt*midExV4_midIxV4_iGABActx_s_k1;
  midIxV4_midIxV4_iGABActx_s_last = midIxV4_midIxV4_iGABActx_s_last+dt*midIxV4_midIxV4_iGABActx_s_k1;
  deepIxV4_deepExV4_iAMPActx_s_last = deepIxV4_deepExV4_iAMPActx_s_last+dt*deepIxV4_deepExV4_iAMPActx_s_k1;
  deepExV4_deepExV4_iAMPActx_s_last = deepExV4_deepExV4_iAMPActx_s_last+dt*deepExV4_deepExV4_iAMPActx_s_k1;
  deepExV4_deepIxV4_iGABActx_s_last = deepExV4_deepIxV4_iGABActx_s_last+dt*deepExV4_deepIxV4_iGABActx_s_k1;
  deepIxV4_deepIxV4_iGABActx_s_last = deepIxV4_deepIxV4_iGABActx_s_last+dt*deepIxV4_deepIxV4_iGABActx_s_k1;
  PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last = PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last+dt*PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_k1;
  PreStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last = PreStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last+dt*PreStimuliAxV4_PreStimuliAxV4_iAMPActx_s_k1;
  PreStimuliAxV4_PostStimuliAxV4_iAMPActx_s_last = PreStimuliAxV4_PostStimuliAxV4_iAMPActx_s_last+dt*PreStimuliAxV4_PostStimuliAxV4_iAMPActx_s_k1;
  PostStimuliAxV4_PostStimuliAxV4_iAMPActx_s_last = PostStimuliAxV4_PostStimuliAxV4_iAMPActx_s_last+dt*PostStimuliAxV4_PostStimuliAxV4_iAMPActx_s_k1;
  PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last = PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last+dt*PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_k1;
  PreStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last = PreStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last+dt*PreStimuliBxV4_PreStimuliBxV4_iAMPActx_s_k1;
  PreStimuliBxV4_PostStimuliBxV4_iAMPActx_s_last = PreStimuliBxV4_PostStimuliBxV4_iAMPActx_s_last+dt*PreStimuliBxV4_PostStimuliBxV4_iAMPActx_s_k1;
  PostStimuliBxV4_PostStimuliBxV4_iAMPActx_s_last = PostStimuliBxV4_PostStimuliBxV4_iAMPActx_s_last+dt*PostStimuliBxV4_PostStimuliBxV4_iAMPActx_s_k1;
  PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last = PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last+dt*PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_k1;
  PreStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last = PreStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last+dt*PreStimuliCxV4_PreStimuliCxV4_iAMPActx_s_k1;
  PreStimuliCxV4_PostStimuliCxV4_iAMPActx_s_last = PreStimuliCxV4_PostStimuliCxV4_iAMPActx_s_last+dt*PreStimuliCxV4_PostStimuliCxV4_iAMPActx_s_k1;
  PostStimuliCxV4_PostStimuliCxV4_iAMPActx_s_last = PostStimuliCxV4_PostStimuliCxV4_iAMPActx_s_last+dt*PostStimuliCxV4_PostStimuliCxV4_iAMPActx_s_k1;
  midExV4_PreStimuliAxV4_iAMPActx_s_last = midExV4_PreStimuliAxV4_iAMPActx_s_last+dt*midExV4_PreStimuliAxV4_iAMPActx_s_k1;
  midExV4_PostStimuliAxV4_iAMPActx_s_last = midExV4_PostStimuliAxV4_iAMPActx_s_last+dt*midExV4_PostStimuliAxV4_iAMPActx_s_k1;
  midExV4_PreStimuliBxV4_iAMPActx_s_last = midExV4_PreStimuliBxV4_iAMPActx_s_last+dt*midExV4_PreStimuliBxV4_iAMPActx_s_k1;
  midExV4_PostStimuliBxV4_iAMPActx_s_last = midExV4_PostStimuliBxV4_iAMPActx_s_last+dt*midExV4_PostStimuliBxV4_iAMPActx_s_k1;
  midExV4_PreStimuliCxV4_iAMPActx_s_last = midExV4_PreStimuliCxV4_iAMPActx_s_last+dt*midExV4_PreStimuliCxV4_iAMPActx_s_k1;
  midExV4_PostStimuliCxV4_iAMPActx_s_last = midExV4_PostStimuliCxV4_iAMPActx_s_last+dt*midExV4_PostStimuliCxV4_iAMPActx_s_k1;
  supExV4_midExV4_iAMPActx_s_last = supExV4_midExV4_iAMPActx_s_last+dt*supExV4_midExV4_iAMPActx_s_k1;
  deepExV4_midExV4_iAMPActx_s_last = deepExV4_midExV4_iAMPActx_s_last+dt*deepExV4_midExV4_iAMPActx_s_k1;
  deepExV4_midIxV4_iGABActx_s_last = deepExV4_midIxV4_iGABActx_s_last+dt*deepExV4_midIxV4_iGABActx_s_k1;
  deepExV4_supExV4_iAMPActx_s_last = deepExV4_supExV4_iAMPActx_s_last+dt*deepExV4_supExV4_iAMPActx_s_k1;
  supIxPFC_supExPFC_iAMPActx_s_last = supIxPFC_supExPFC_iAMPActx_s_last+dt*supIxPFC_supExPFC_iAMPActx_s_k1;
  supExPFC_supExPFC_iAMPActx_s_last = supExPFC_supExPFC_iAMPActx_s_last+dt*supExPFC_supExPFC_iAMPActx_s_k1;
  supExPFC_supIxPFC_iGABActx_s_last = supExPFC_supIxPFC_iGABActx_s_last+dt*supExPFC_supIxPFC_iGABActx_s_k1;
  supIxPFC_supIxPFC_iGABActx_s_last = supIxPFC_supIxPFC_iGABActx_s_last+dt*supIxPFC_supIxPFC_iGABActx_s_k1;
  midIxPFC_midExPFC_iAMPActx_s_last = midIxPFC_midExPFC_iAMPActx_s_last+dt*midIxPFC_midExPFC_iAMPActx_s_k1;
  midExPFC_midExPFC_iAMPActx_s_last = midExPFC_midExPFC_iAMPActx_s_last+dt*midExPFC_midExPFC_iAMPActx_s_k1;
  midExPFC_midIxPFC_iGABActx_s_last = midExPFC_midIxPFC_iGABActx_s_last+dt*midExPFC_midIxPFC_iGABActx_s_k1;
  midIxPFC_midIxPFC_iGABActx_s_last = midIxPFC_midIxPFC_iGABActx_s_last+dt*midIxPFC_midIxPFC_iGABActx_s_k1;
  deepIxPFC_deepExPFC_iAMPActx_s_last = deepIxPFC_deepExPFC_iAMPActx_s_last+dt*deepIxPFC_deepExPFC_iAMPActx_s_k1;
  deepExPFC_deepExPFC_iAMPActx_s_last = deepExPFC_deepExPFC_iAMPActx_s_last+dt*deepExPFC_deepExPFC_iAMPActx_s_k1;
  deepExPFC_deepIxPFC_iGABActx_s_last = deepExPFC_deepIxPFC_iGABActx_s_last+dt*deepExPFC_deepIxPFC_iGABActx_s_k1;
  deepIxPFC_deepIxPFC_iGABActx_s_last = deepIxPFC_deepIxPFC_iGABActx_s_last+dt*deepIxPFC_deepIxPFC_iGABActx_s_k1;
  PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last = PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last+dt*PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_k1;
  PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last = PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last+dt*PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_k1;
  PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_last = PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_last+dt*PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_k1;
  PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_last = PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_last+dt*PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_k1;
  PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last = PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last+dt*PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_k1;
  PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last = PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last+dt*PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_k1;
  PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_last = PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_last+dt*PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_k1;
  PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_last = PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_last+dt*PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_k1;
  PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last = PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last+dt*PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_k1;
  PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last = PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last+dt*PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_k1;
  PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_last = PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_last+dt*PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_k1;
  PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_last = PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_last+dt*PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_k1;
  midExPFC_PreStimuliAxPFC_iAMPActx_s_last = midExPFC_PreStimuliAxPFC_iAMPActx_s_last+dt*midExPFC_PreStimuliAxPFC_iAMPActx_s_k1;
  midExPFC_PostStimuliAxPFC_iAMPActx_s_last = midExPFC_PostStimuliAxPFC_iAMPActx_s_last+dt*midExPFC_PostStimuliAxPFC_iAMPActx_s_k1;
  midExPFC_PreStimuliBxPFC_iAMPActx_s_last = midExPFC_PreStimuliBxPFC_iAMPActx_s_last+dt*midExPFC_PreStimuliBxPFC_iAMPActx_s_k1;
  midExPFC_PostStimuliBxPFC_iAMPActx_s_last = midExPFC_PostStimuliBxPFC_iAMPActx_s_last+dt*midExPFC_PostStimuliBxPFC_iAMPActx_s_k1;
  midExPFC_PreStimuliCxPFC_iAMPActx_s_last = midExPFC_PreStimuliCxPFC_iAMPActx_s_last+dt*midExPFC_PreStimuliCxPFC_iAMPActx_s_k1;
  midExPFC_PostStimuliCxPFC_iAMPActx_s_last = midExPFC_PostStimuliCxPFC_iAMPActx_s_last+dt*midExPFC_PostStimuliCxPFC_iAMPActx_s_k1;
  supExPFC_midExPFC_iAMPActx_s_last = supExPFC_midExPFC_iAMPActx_s_last+dt*supExPFC_midExPFC_iAMPActx_s_k1;
  deepExPFC_midExPFC_iAMPActx_s_last = deepExPFC_midExPFC_iAMPActx_s_last+dt*deepExPFC_midExPFC_iAMPActx_s_k1;
  deepExPFC_midIxPFC_iGABActx_s_last = deepExPFC_midIxPFC_iGABActx_s_last+dt*deepExPFC_midIxPFC_iGABActx_s_k1;
  deepExPFC_supExPFC_iAMPActx_s_last = deepExPFC_supExPFC_iAMPActx_s_last+dt*deepExPFC_supExPFC_iAMPActx_s_k1;
  midExPFC_supExV4_iAMPActx_s_last = midExPFC_supExV4_iAMPActx_s_last+dt*midExPFC_supExV4_iAMPActx_s_k1;
  midIxPFC_supIxV4_iAMPActx_s_last = midIxPFC_supIxV4_iAMPActx_s_last+dt*midIxPFC_supIxV4_iAMPActx_s_k1;
  midIxV4_deepIxPFC_iAMPActx_s_last = midIxV4_deepIxPFC_iAMPActx_s_last+dt*midIxV4_deepIxPFC_iAMPActx_s_k1;
  midExV4_deepExPFC_iAMPActx_s_last = midExV4_deepExPFC_iAMPActx_s_last+dt*midExV4_deepExPFC_iAMPActx_s_k1;

  if mod(k,downsample_factor)==0 % store this time point

  % ------------------------------------------------------------
  % Store state variables:
  % ------------------------------------------------------------
    supExV4_V(n,:) = supExV4_V_last;
    supExV4_iNa_m(n,:) = supExV4_iNa_m_last;
    supExV4_iNa_h(n,:) = supExV4_iNa_h_last;
    supExV4_iK_n(n,:) = supExV4_iK_n_last;
    supIxV4_V(n,:) = supIxV4_V_last;
    supIxV4_iNa_m(n,:) = supIxV4_iNa_m_last;
    supIxV4_iNa_h(n,:) = supIxV4_iNa_h_last;
    supIxV4_iK_n(n,:) = supIxV4_iK_n_last;
    midExV4_V(n,:) = midExV4_V_last;
    midExV4_iNa_m(n,:) = midExV4_iNa_m_last;
    midExV4_iNa_h(n,:) = midExV4_iNa_h_last;
    midExV4_iK_n(n,:) = midExV4_iK_n_last;
    midIxV4_V(n,:) = midIxV4_V_last;
    midIxV4_iNa_m(n,:) = midIxV4_iNa_m_last;
    midIxV4_iNa_h(n,:) = midIxV4_iNa_h_last;
    midIxV4_iK_n(n,:) = midIxV4_iK_n_last;
    deepExV4_V(n,:) = deepExV4_V_last;
    deepExV4_iNa_m(n,:) = deepExV4_iNa_m_last;
    deepExV4_iNa_h(n,:) = deepExV4_iNa_h_last;
    deepExV4_iK_n(n,:) = deepExV4_iK_n_last;
    deepIxV4_V(n,:) = deepIxV4_V_last;
    deepIxV4_iNa_m(n,:) = deepIxV4_iNa_m_last;
    deepIxV4_iNa_h(n,:) = deepIxV4_iNa_h_last;
    deepIxV4_iK_n(n,:) = deepIxV4_iK_n_last;
    PreStimuliAxV4_V(n,:) = PreStimuliAxV4_V_last;
    PreStimuliAxV4_iNa_m(n,:) = PreStimuliAxV4_iNa_m_last;
    PreStimuliAxV4_iNa_h(n,:) = PreStimuliAxV4_iNa_h_last;
    PreStimuliAxV4_iK_n(n,:) = PreStimuliAxV4_iK_n_last;
    PostStimuliAxV4_V(n,:) = PostStimuliAxV4_V_last;
    PostStimuliAxV4_iNa_m(n,:) = PostStimuliAxV4_iNa_m_last;
    PostStimuliAxV4_iNa_h(n,:) = PostStimuliAxV4_iNa_h_last;
    PostStimuliAxV4_iK_n(n,:) = PostStimuliAxV4_iK_n_last;
    PreStimuliBxV4_V(n,:) = PreStimuliBxV4_V_last;
    PreStimuliBxV4_iNa_m(n,:) = PreStimuliBxV4_iNa_m_last;
    PreStimuliBxV4_iNa_h(n,:) = PreStimuliBxV4_iNa_h_last;
    PreStimuliBxV4_iK_n(n,:) = PreStimuliBxV4_iK_n_last;
    PostStimuliBxV4_V(n,:) = PostStimuliBxV4_V_last;
    PostStimuliBxV4_iNa_m(n,:) = PostStimuliBxV4_iNa_m_last;
    PostStimuliBxV4_iNa_h(n,:) = PostStimuliBxV4_iNa_h_last;
    PostStimuliBxV4_iK_n(n,:) = PostStimuliBxV4_iK_n_last;
    PreStimuliCxV4_V(n,:) = PreStimuliCxV4_V_last;
    PreStimuliCxV4_iNa_m(n,:) = PreStimuliCxV4_iNa_m_last;
    PreStimuliCxV4_iNa_h(n,:) = PreStimuliCxV4_iNa_h_last;
    PreStimuliCxV4_iK_n(n,:) = PreStimuliCxV4_iK_n_last;
    PostStimuliCxV4_V(n,:) = PostStimuliCxV4_V_last;
    PostStimuliCxV4_iNa_m(n,:) = PostStimuliCxV4_iNa_m_last;
    PostStimuliCxV4_iNa_h(n,:) = PostStimuliCxV4_iNa_h_last;
    PostStimuliCxV4_iK_n(n,:) = PostStimuliCxV4_iK_n_last;
    supExPFC_V(n,:) = supExPFC_V_last;
    supExPFC_iNa_m(n,:) = supExPFC_iNa_m_last;
    supExPFC_iNa_h(n,:) = supExPFC_iNa_h_last;
    supExPFC_iK_n(n,:) = supExPFC_iK_n_last;
    supIxPFC_V(n,:) = supIxPFC_V_last;
    supIxPFC_iNa_m(n,:) = supIxPFC_iNa_m_last;
    supIxPFC_iNa_h(n,:) = supIxPFC_iNa_h_last;
    supIxPFC_iK_n(n,:) = supIxPFC_iK_n_last;
    midExPFC_V(n,:) = midExPFC_V_last;
    midExPFC_iNa_m(n,:) = midExPFC_iNa_m_last;
    midExPFC_iNa_h(n,:) = midExPFC_iNa_h_last;
    midExPFC_iK_n(n,:) = midExPFC_iK_n_last;
    midIxPFC_V(n,:) = midIxPFC_V_last;
    midIxPFC_iNa_m(n,:) = midIxPFC_iNa_m_last;
    midIxPFC_iNa_h(n,:) = midIxPFC_iNa_h_last;
    midIxPFC_iK_n(n,:) = midIxPFC_iK_n_last;
    deepExPFC_V(n,:) = deepExPFC_V_last;
    deepExPFC_iNa_m(n,:) = deepExPFC_iNa_m_last;
    deepExPFC_iNa_h(n,:) = deepExPFC_iNa_h_last;
    deepExPFC_iK_n(n,:) = deepExPFC_iK_n_last;
    deepIxPFC_V(n,:) = deepIxPFC_V_last;
    deepIxPFC_iNa_m(n,:) = deepIxPFC_iNa_m_last;
    deepIxPFC_iNa_h(n,:) = deepIxPFC_iNa_h_last;
    deepIxPFC_iK_n(n,:) = deepIxPFC_iK_n_last;
    PreStimuliAxPFC_V(n,:) = PreStimuliAxPFC_V_last;
    PreStimuliAxPFC_iNa_m(n,:) = PreStimuliAxPFC_iNa_m_last;
    PreStimuliAxPFC_iNa_h(n,:) = PreStimuliAxPFC_iNa_h_last;
    PreStimuliAxPFC_iK_n(n,:) = PreStimuliAxPFC_iK_n_last;
    PostStimuliAxPFC_V(n,:) = PostStimuliAxPFC_V_last;
    PostStimuliAxPFC_iNa_m(n,:) = PostStimuliAxPFC_iNa_m_last;
    PostStimuliAxPFC_iNa_h(n,:) = PostStimuliAxPFC_iNa_h_last;
    PostStimuliAxPFC_iK_n(n,:) = PostStimuliAxPFC_iK_n_last;
    PreStimuliBxPFC_V(n,:) = PreStimuliBxPFC_V_last;
    PreStimuliBxPFC_iNa_m(n,:) = PreStimuliBxPFC_iNa_m_last;
    PreStimuliBxPFC_iNa_h(n,:) = PreStimuliBxPFC_iNa_h_last;
    PreStimuliBxPFC_iK_n(n,:) = PreStimuliBxPFC_iK_n_last;
    PostStimuliBxPFC_V(n,:) = PostStimuliBxPFC_V_last;
    PostStimuliBxPFC_iNa_m(n,:) = PostStimuliBxPFC_iNa_m_last;
    PostStimuliBxPFC_iNa_h(n,:) = PostStimuliBxPFC_iNa_h_last;
    PostStimuliBxPFC_iK_n(n,:) = PostStimuliBxPFC_iK_n_last;
    PreStimuliCxPFC_V(n,:) = PreStimuliCxPFC_V_last;
    PreStimuliCxPFC_iNa_m(n,:) = PreStimuliCxPFC_iNa_m_last;
    PreStimuliCxPFC_iNa_h(n,:) = PreStimuliCxPFC_iNa_h_last;
    PreStimuliCxPFC_iK_n(n,:) = PreStimuliCxPFC_iK_n_last;
    PostStimuliCxPFC_V(n,:) = PostStimuliCxPFC_V_last;
    PostStimuliCxPFC_iNa_m(n,:) = PostStimuliCxPFC_iNa_m_last;
    PostStimuliCxPFC_iNa_h(n,:) = PostStimuliCxPFC_iNa_h_last;
    PostStimuliCxPFC_iK_n(n,:) = PostStimuliCxPFC_iK_n_last;
    supIxV4_supExV4_iAMPActx_s(n,:) = supIxV4_supExV4_iAMPActx_s_last;
    supExV4_supExV4_iAMPActx_s(n,:) = supExV4_supExV4_iAMPActx_s_last;
    supExV4_supIxV4_iGABActx_s(n,:) = supExV4_supIxV4_iGABActx_s_last;
    supIxV4_supIxV4_iGABActx_s(n,:) = supIxV4_supIxV4_iGABActx_s_last;
    midIxV4_midExV4_iAMPActx_s(n,:) = midIxV4_midExV4_iAMPActx_s_last;
    midExV4_midExV4_iAMPActx_s(n,:) = midExV4_midExV4_iAMPActx_s_last;
    midExV4_midIxV4_iGABActx_s(n,:) = midExV4_midIxV4_iGABActx_s_last;
    midIxV4_midIxV4_iGABActx_s(n,:) = midIxV4_midIxV4_iGABActx_s_last;
    deepIxV4_deepExV4_iAMPActx_s(n,:) = deepIxV4_deepExV4_iAMPActx_s_last;
    deepExV4_deepExV4_iAMPActx_s(n,:) = deepExV4_deepExV4_iAMPActx_s_last;
    deepExV4_deepIxV4_iGABActx_s(n,:) = deepExV4_deepIxV4_iGABActx_s_last;
    deepIxV4_deepIxV4_iGABActx_s(n,:) = deepIxV4_deepIxV4_iGABActx_s_last;
    PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s(n,:) = PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last;
    PreStimuliAxV4_PreStimuliAxV4_iAMPActx_s(n,:) = PreStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last;
    PreStimuliAxV4_PostStimuliAxV4_iAMPActx_s(n,:) = PreStimuliAxV4_PostStimuliAxV4_iAMPActx_s_last;
    PostStimuliAxV4_PostStimuliAxV4_iAMPActx_s(n,:) = PostStimuliAxV4_PostStimuliAxV4_iAMPActx_s_last;
    PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s(n,:) = PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last;
    PreStimuliBxV4_PreStimuliBxV4_iAMPActx_s(n,:) = PreStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last;
    PreStimuliBxV4_PostStimuliBxV4_iAMPActx_s(n,:) = PreStimuliBxV4_PostStimuliBxV4_iAMPActx_s_last;
    PostStimuliBxV4_PostStimuliBxV4_iAMPActx_s(n,:) = PostStimuliBxV4_PostStimuliBxV4_iAMPActx_s_last;
    PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s(n,:) = PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last;
    PreStimuliCxV4_PreStimuliCxV4_iAMPActx_s(n,:) = PreStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last;
    PreStimuliCxV4_PostStimuliCxV4_iAMPActx_s(n,:) = PreStimuliCxV4_PostStimuliCxV4_iAMPActx_s_last;
    PostStimuliCxV4_PostStimuliCxV4_iAMPActx_s(n,:) = PostStimuliCxV4_PostStimuliCxV4_iAMPActx_s_last;
    midExV4_PreStimuliAxV4_iAMPActx_s(n,:) = midExV4_PreStimuliAxV4_iAMPActx_s_last;
    midExV4_PostStimuliAxV4_iAMPActx_s(n,:) = midExV4_PostStimuliAxV4_iAMPActx_s_last;
    midExV4_PreStimuliBxV4_iAMPActx_s(n,:) = midExV4_PreStimuliBxV4_iAMPActx_s_last;
    midExV4_PostStimuliBxV4_iAMPActx_s(n,:) = midExV4_PostStimuliBxV4_iAMPActx_s_last;
    midExV4_PreStimuliCxV4_iAMPActx_s(n,:) = midExV4_PreStimuliCxV4_iAMPActx_s_last;
    midExV4_PostStimuliCxV4_iAMPActx_s(n,:) = midExV4_PostStimuliCxV4_iAMPActx_s_last;
    supExV4_midExV4_iAMPActx_s(n,:) = supExV4_midExV4_iAMPActx_s_last;
    deepExV4_midExV4_iAMPActx_s(n,:) = deepExV4_midExV4_iAMPActx_s_last;
    deepExV4_midIxV4_iGABActx_s(n,:) = deepExV4_midIxV4_iGABActx_s_last;
    deepExV4_supExV4_iAMPActx_s(n,:) = deepExV4_supExV4_iAMPActx_s_last;
    supIxPFC_supExPFC_iAMPActx_s(n,:) = supIxPFC_supExPFC_iAMPActx_s_last;
    supExPFC_supExPFC_iAMPActx_s(n,:) = supExPFC_supExPFC_iAMPActx_s_last;
    supExPFC_supIxPFC_iGABActx_s(n,:) = supExPFC_supIxPFC_iGABActx_s_last;
    supIxPFC_supIxPFC_iGABActx_s(n,:) = supIxPFC_supIxPFC_iGABActx_s_last;
    midIxPFC_midExPFC_iAMPActx_s(n,:) = midIxPFC_midExPFC_iAMPActx_s_last;
    midExPFC_midExPFC_iAMPActx_s(n,:) = midExPFC_midExPFC_iAMPActx_s_last;
    midExPFC_midIxPFC_iGABActx_s(n,:) = midExPFC_midIxPFC_iGABActx_s_last;
    midIxPFC_midIxPFC_iGABActx_s(n,:) = midIxPFC_midIxPFC_iGABActx_s_last;
    deepIxPFC_deepExPFC_iAMPActx_s(n,:) = deepIxPFC_deepExPFC_iAMPActx_s_last;
    deepExPFC_deepExPFC_iAMPActx_s(n,:) = deepExPFC_deepExPFC_iAMPActx_s_last;
    deepExPFC_deepIxPFC_iGABActx_s(n,:) = deepExPFC_deepIxPFC_iGABActx_s_last;
    deepIxPFC_deepIxPFC_iGABActx_s(n,:) = deepIxPFC_deepIxPFC_iGABActx_s_last;
    PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s(n,:) = PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last;
    PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s(n,:) = PreStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last;
    PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s(n,:) = PreStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_last;
    PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s(n,:) = PostStimuliAxPFC_PostStimuliAxPFC_iAMPActx_s_last;
    PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s(n,:) = PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last;
    PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s(n,:) = PreStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last;
    PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s(n,:) = PreStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_last;
    PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s(n,:) = PostStimuliBxPFC_PostStimuliBxPFC_iAMPActx_s_last;
    PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s(n,:) = PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last;
    PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s(n,:) = PreStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last;
    PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s(n,:) = PreStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_last;
    PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s(n,:) = PostStimuliCxPFC_PostStimuliCxPFC_iAMPActx_s_last;
    midExPFC_PreStimuliAxPFC_iAMPActx_s(n,:) = midExPFC_PreStimuliAxPFC_iAMPActx_s_last;
    midExPFC_PostStimuliAxPFC_iAMPActx_s(n,:) = midExPFC_PostStimuliAxPFC_iAMPActx_s_last;
    midExPFC_PreStimuliBxPFC_iAMPActx_s(n,:) = midExPFC_PreStimuliBxPFC_iAMPActx_s_last;
    midExPFC_PostStimuliBxPFC_iAMPActx_s(n,:) = midExPFC_PostStimuliBxPFC_iAMPActx_s_last;
    midExPFC_PreStimuliCxPFC_iAMPActx_s(n,:) = midExPFC_PreStimuliCxPFC_iAMPActx_s_last;
    midExPFC_PostStimuliCxPFC_iAMPActx_s(n,:) = midExPFC_PostStimuliCxPFC_iAMPActx_s_last;
    supExPFC_midExPFC_iAMPActx_s(n,:) = supExPFC_midExPFC_iAMPActx_s_last;
    deepExPFC_midExPFC_iAMPActx_s(n,:) = deepExPFC_midExPFC_iAMPActx_s_last;
    deepExPFC_midIxPFC_iGABActx_s(n,:) = deepExPFC_midIxPFC_iGABActx_s_last;
    deepExPFC_supExPFC_iAMPActx_s(n,:) = deepExPFC_supExPFC_iAMPActx_s_last;
    midExPFC_supExV4_iAMPActx_s(n,:) = midExPFC_supExV4_iAMPActx_s_last;
    midIxPFC_supIxV4_iAMPActx_s(n,:) = midIxPFC_supIxV4_iAMPActx_s_last;
    midIxV4_deepIxPFC_iAMPActx_s(n,:) = midIxV4_deepIxPFC_iAMPActx_s_last;
    midExV4_deepExPFC_iAMPActx_s(n,:) = midExV4_deepExPFC_iAMPActx_s_last;

    n=n+1;
  end
end

T=T(1:downsample_factor:ntime);

end
