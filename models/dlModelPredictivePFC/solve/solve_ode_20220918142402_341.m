function [T,supExV4_V,supExV4_iNa_m,supExV4_iNa_h,supExV4_iK_n,supIxV4_V,supIxV4_iNa_m,supIxV4_iNa_h,supIxV4_iK_n,midExV4_V,midExV4_iNa_m,midExV4_iNa_h,midExV4_iK_n,midIxV4_V,midIxV4_iNa_m,midIxV4_iNa_h,midIxV4_iK_n,deepExV4_V,deepExV4_iNa_m,deepExV4_iNa_h,deepExV4_iK_n,deepIxV4_V,deepIxV4_iNa_m,deepIxV4_iNa_h,deepIxV4_iK_n,EAxV4_V,EAxV4_iNa_m,EAxV4_iNa_h,EAxV4_iK_n,IAxV4_V,IAxV4_iNa_m,IAxV4_iNa_h,IAxV4_iK_n,EBxV4_V,EBxV4_iNa_m,EBxV4_iNa_h,EBxV4_iK_n,IBxV4_V,IBxV4_iNa_m,IBxV4_iNa_h,IBxV4_iK_n,ECxV4_V,ECxV4_iNa_m,ECxV4_iNa_h,ECxV4_iK_n,ICxV4_V,ICxV4_iNa_m,ICxV4_iNa_h,ICxV4_iK_n,supExPFC_V,supExPFC_iNa_m,supExPFC_iNa_h,supExPFC_iK_n,supIxPFC_V,supIxPFC_iNa_m,supIxPFC_iNa_h,supIxPFC_iK_n,midExPFC_V,midExPFC_iNa_m,midExPFC_iNa_h,midExPFC_iK_n,midIxPFC_V,midIxPFC_iNa_m,midIxPFC_iNa_h,midIxPFC_iK_n,deepExPFC_V,deepExPFC_iNa_m,deepExPFC_iNa_h,deepExPFC_iK_n,deepIxPFC_V,deepIxPFC_iNa_m,deepIxPFC_iNa_h,deepIxPFC_iK_n,EAxPFC_V,EAxPFC_iNa_m,EAxPFC_iNa_h,EAxPFC_iK_n,IAxPFC_V,IAxPFC_iNa_m,IAxPFC_iNa_h,IAxPFC_iK_n,EBxPFC_V,EBxPFC_iNa_m,EBxPFC_iNa_h,EBxPFC_iK_n,IBxPFC_V,IBxPFC_iNa_m,IBxPFC_iNa_h,IBxPFC_iK_n,ECxPFC_V,ECxPFC_iNa_m,ECxPFC_iNa_h,ECxPFC_iK_n,ICxPFC_V,ICxPFC_iNa_m,ICxPFC_iNa_h,ICxPFC_iK_n,supIxV4_supExV4_iAMPActx_s,supExV4_supExV4_iAMPActx_s,supExV4_supIxV4_iGABActx_s,supIxV4_supIxV4_iGABActx_s,midIxV4_midExV4_iAMPActx_s,midExV4_midExV4_iAMPActx_s,midExV4_midIxV4_iGABActx_s,midIxV4_midIxV4_iGABActx_s,deepIxV4_deepExV4_iAMPActx_s,deepExV4_deepExV4_iAMPActx_s,deepExV4_deepIxV4_iGABActx_s,deepIxV4_deepIxV4_iGABActx_s,supExV4_midExV4_iAMPActx_s,deepExV4_midExV4_iAMPActx_s,deepExV4_midIxV4_iGABActx_s,deepExV4_supExV4_iAMPActx_s,supIxPFC_supExPFC_iAMPActx_s,supExPFC_supExPFC_iAMPActx_s,supExPFC_supIxPFC_iGABActx_s,supIxPFC_supIxPFC_iGABActx_s,midIxPFC_midExPFC_iAMPActx_s,midExPFC_midExPFC_iAMPActx_s,midExPFC_midIxPFC_iGABActx_s,midIxPFC_midIxPFC_iGABActx_s,deepIxPFC_deepExPFC_iAMPActx_s,deepExPFC_deepExPFC_iAMPActx_s,deepExPFC_deepIxPFC_iGABActx_s,deepIxPFC_deepIxPFC_iGABActx_s,supExPFC_midExPFC_iAMPActx_s,deepExPFC_midExPFC_iAMPActx_s,deepExPFC_midIxPFC_iGABActx_s,deepExPFC_supExPFC_iAMPActx_s,supExV4_ctx_iPoisson_g_poisson,supExV4_ctx_iPoisson_I_poisson,supIxV4_ctx_iPoisson_g_poisson,supIxV4_ctx_iPoisson_I_poisson,midExV4_ctx_iPoisson_g_poisson,midExV4_ctx_iPoisson_I_poisson,midIxV4_ctx_iPoisson_g_poisson,midIxV4_ctx_iPoisson_I_poisson,deepExV4_ctx_iPoisson_g_poisson,deepExV4_ctx_iPoisson_I_poisson,deepIxV4_ctx_iPoisson_g_poisson,deepIxV4_ctx_iPoisson_I_poisson,EAxV4_ctx_iPoisson_g_poisson,EAxV4_ctx_iPoisson_I_poisson,IAxV4_ctx_iPoisson_g_poisson,IAxV4_ctx_iPoisson_I_poisson,EBxV4_ctx_iPoisson_g_poisson,EBxV4_ctx_iPoisson_I_poisson,IBxV4_ctx_iPoisson_g_poisson,IBxV4_ctx_iPoisson_I_poisson,ECxV4_ctx_iPoisson_g_poisson,ECxV4_ctx_iPoisson_I_poisson,ICxV4_ctx_iPoisson_g_poisson,ICxV4_ctx_iPoisson_I_poisson,supExPFC_ctx_iPoisson_g_poisson,supExPFC_ctx_iPoisson_I_poisson,supIxPFC_ctx_iPoisson_g_poisson,supIxPFC_ctx_iPoisson_I_poisson,midExPFC_ctx_iPoisson_g_poisson,midExPFC_ctx_iPoisson_I_poisson,midIxPFC_ctx_iPoisson_g_poisson,midIxPFC_ctx_iPoisson_I_poisson,deepExPFC_ctx_iPoisson_g_poisson,deepExPFC_ctx_iPoisson_I_poisson,deepIxPFC_ctx_iPoisson_g_poisson,deepIxPFC_ctx_iPoisson_I_poisson,EAxPFC_ctx_iPoisson_g_poisson,EAxPFC_ctx_iPoisson_I_poisson,IAxPFC_ctx_iPoisson_g_poisson,IAxPFC_ctx_iPoisson_I_poisson,EBxPFC_ctx_iPoisson_g_poisson,EBxPFC_ctx_iPoisson_I_poisson,IBxPFC_ctx_iPoisson_g_poisson,IBxPFC_ctx_iPoisson_I_poisson,ECxPFC_ctx_iPoisson_g_poisson,ECxPFC_ctx_iPoisson_I_poisson,ICxPFC_ctx_iPoisson_g_poisson,ICxPFC_ctx_iPoisson_I_poisson,IAxV4_EAxV4_iPoisson_gPoisson,EAxV4_EAxV4_iPoisson_gPoisson,EAxV4_IAxV4_iPoisson_gPoisson,IAxV4_IAxV4_iPoisson_gPoisson,IBxV4_EBxV4_iPoisson_gPoisson,EBxV4_EBxV4_iPoisson_gPoisson,EBxV4_IBxV4_iPoisson_gPoisson,IBxV4_IBxV4_iPoisson_gPoisson,ICxV4_ECxV4_iPoisson_gPoisson,ECxV4_ECxV4_iPoisson_gPoisson,ECxV4_ICxV4_iPoisson_gPoisson,ICxV4_ICxV4_iPoisson_gPoisson,midExV4_EAxV4_iPoisson_gPoisson,midExV4_IAxV4_iPoisson_gPoisson,midExV4_EBxV4_iPoisson_gPoisson,midExV4_IBxV4_iPoisson_gPoisson,midExV4_ECxV4_iPoisson_gPoisson,midExV4_ICxV4_iPoisson_gPoisson,IAxPFC_EAxPFC_iPoisson_gPoisson,EAxPFC_EAxPFC_iPoisson_gPoisson,EAxPFC_IAxPFC_iPoisson_gPoisson,IAxPFC_IAxPFC_iPoisson_gPoisson,IBxPFC_EBxPFC_iPoisson_gPoisson,EBxPFC_EBxPFC_iPoisson_gPoisson,EBxPFC_IBxPFC_iPoisson_gPoisson,IBxPFC_IBxPFC_iPoisson_gPoisson,ICxPFC_ECxPFC_iPoisson_gPoisson,ECxPFC_ECxPFC_iPoisson_gPoisson,ECxPFC_ICxPFC_iPoisson_gPoisson,ICxPFC_ICxPFC_iPoisson_gPoisson,midExPFC_EAxPFC_iPoisson_gPoisson,midExPFC_IAxPFC_iPoisson_gPoisson,midExPFC_EBxPFC_iPoisson_gPoisson,midExPFC_IBxPFC_iPoisson_gPoisson,midExPFC_ECxPFC_iPoisson_gPoisson,midExPFC_ICxPFC_iPoisson_gPoisson,midExPFC_deepExV4_iPoisson_gPoisson,midIxPFC_deepIxV4_iPoisson_gPoisson,supExV4_ctx_iPoisson_s_poisson,supIxV4_ctx_iPoisson_s_poisson,midExV4_ctx_iPoisson_s_poisson,midIxV4_ctx_iPoisson_s_poisson,deepExV4_ctx_iPoisson_s_poisson,deepIxV4_ctx_iPoisson_s_poisson,EAxV4_ctx_iPoisson_s_poisson,IAxV4_ctx_iPoisson_s_poisson,EBxV4_ctx_iPoisson_s_poisson,IBxV4_ctx_iPoisson_s_poisson,ECxV4_ctx_iPoisson_s_poisson,ICxV4_ctx_iPoisson_s_poisson,supExPFC_ctx_iPoisson_s_poisson,supIxPFC_ctx_iPoisson_s_poisson,midExPFC_ctx_iPoisson_s_poisson,midIxPFC_ctx_iPoisson_s_poisson,deepExPFC_ctx_iPoisson_s_poisson,deepIxPFC_ctx_iPoisson_s_poisson,EAxPFC_ctx_iPoisson_s_poisson,IAxPFC_ctx_iPoisson_s_poisson,EBxPFC_ctx_iPoisson_s_poisson,IBxPFC_ctx_iPoisson_s_poisson,ECxPFC_ctx_iPoisson_s_poisson,ICxPFC_ctx_iPoisson_s_poisson,IAxV4_EAxV4_iPoisson_s,EAxV4_EAxV4_iPoisson_s,EAxV4_IAxV4_iPoisson_s,IAxV4_IAxV4_iPoisson_s,IBxV4_EBxV4_iPoisson_s,EBxV4_EBxV4_iPoisson_s,EBxV4_IBxV4_iPoisson_s,IBxV4_IBxV4_iPoisson_s,ICxV4_ECxV4_iPoisson_s,ECxV4_ECxV4_iPoisson_s,ECxV4_ICxV4_iPoisson_s,ICxV4_ICxV4_iPoisson_s,midExV4_EAxV4_iPoisson_s,midExV4_IAxV4_iPoisson_s,midExV4_EBxV4_iPoisson_s,midExV4_IBxV4_iPoisson_s,midExV4_ECxV4_iPoisson_s,midExV4_ICxV4_iPoisson_s,IAxPFC_EAxPFC_iPoisson_s,EAxPFC_EAxPFC_iPoisson_s,EAxPFC_IAxPFC_iPoisson_s,IAxPFC_IAxPFC_iPoisson_s,IBxPFC_EBxPFC_iPoisson_s,EBxPFC_EBxPFC_iPoisson_s,EBxPFC_IBxPFC_iPoisson_s,IBxPFC_IBxPFC_iPoisson_s,ICxPFC_ECxPFC_iPoisson_s,ECxPFC_ECxPFC_iPoisson_s,ECxPFC_ICxPFC_iPoisson_s,ICxPFC_ICxPFC_iPoisson_s,midExPFC_EAxPFC_iPoisson_s,midExPFC_IAxPFC_iPoisson_s,midExPFC_EBxPFC_iPoisson_s,midExPFC_IBxPFC_iPoisson_s,midExPFC_ECxPFC_iPoisson_s,midExPFC_ICxPFC_iPoisson_s,midExPFC_deepExV4_iPoisson_s,midIxPFC_deepIxV4_iPoisson_s]=solve_ode

% ------------------------------------------------------------
% Parameters:
% ------------------------------------------------------------
params = load('params.mat','p');
p = params.p;
downsample_factor=p.downsample_factor;
dt=p.dt;
T=(p.tspan(1):dt:p.tspan(2))';
ntime=length(T);
nsamp=length(1:downsample_factor:ntime);

% seed the random number generator
rng(p.random_seed);

% ------------------------------------------------------------
% Fixed variables:
% ------------------------------------------------------------
supExV4_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.supExV4_ctx_iPoisson_onset_poisson,p.supExV4_ctx_iPoisson_offset_poisson,p.supExV4_ctx_iPoisson_latency_poisson,p.supExV4_ctx_iPoisson_f_poisson,p.supExV4_ctx_iPoisson_fsigma_poisson,p.supExV4_ctx_iPoisson_phi_poisson,p.supExV4_ctx_iPoisson_connsigma_poisson,p.supExV4_ctx_iPoisson_baseline_poisson,p.supExV4_ctx_iPoisson_DC_poisson,p.supExV4_ctx_iPoisson_AC_poisson,p.supExV4_ctx_iPoisson_slopedutycycle_poisson,p.supExV4_ctx_iPoisson_thresholddutycycle_poisson,p.supExV4_ctx_iPoisson_tau_poisson,p.supExV4_ctx_iPoisson_kick_poisson,T,p.supExV4_Npop);
supIxV4_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.supIxV4_ctx_iPoisson_onset_poisson,p.supIxV4_ctx_iPoisson_offset_poisson,p.supIxV4_ctx_iPoisson_latency_poisson,p.supIxV4_ctx_iPoisson_f_poisson,p.supIxV4_ctx_iPoisson_fsigma_poisson,p.supIxV4_ctx_iPoisson_phi_poisson,p.supIxV4_ctx_iPoisson_connsigma_poisson,p.supIxV4_ctx_iPoisson_baseline_poisson,p.supIxV4_ctx_iPoisson_DC_poisson,p.supIxV4_ctx_iPoisson_AC_poisson,p.supIxV4_ctx_iPoisson_slopedutycycle_poisson,p.supIxV4_ctx_iPoisson_thresholddutycycle_poisson,p.supIxV4_ctx_iPoisson_tau_poisson,p.supIxV4_ctx_iPoisson_kick_poisson,T,p.supIxV4_Npop);
midExV4_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.midExV4_ctx_iPoisson_onset_poisson,p.midExV4_ctx_iPoisson_offset_poisson,p.midExV4_ctx_iPoisson_latency_poisson,p.midExV4_ctx_iPoisson_f_poisson,p.midExV4_ctx_iPoisson_fsigma_poisson,p.midExV4_ctx_iPoisson_phi_poisson,p.midExV4_ctx_iPoisson_connsigma_poisson,p.midExV4_ctx_iPoisson_baseline_poisson,p.midExV4_ctx_iPoisson_DC_poisson,p.midExV4_ctx_iPoisson_AC_poisson,p.midExV4_ctx_iPoisson_slopedutycycle_poisson,p.midExV4_ctx_iPoisson_thresholddutycycle_poisson,p.midExV4_ctx_iPoisson_tau_poisson,p.midExV4_ctx_iPoisson_kick_poisson,T,p.midExV4_Npop);
midIxV4_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.midIxV4_ctx_iPoisson_onset_poisson,p.midIxV4_ctx_iPoisson_offset_poisson,p.midIxV4_ctx_iPoisson_latency_poisson,p.midIxV4_ctx_iPoisson_f_poisson,p.midIxV4_ctx_iPoisson_fsigma_poisson,p.midIxV4_ctx_iPoisson_phi_poisson,p.midIxV4_ctx_iPoisson_connsigma_poisson,p.midIxV4_ctx_iPoisson_baseline_poisson,p.midIxV4_ctx_iPoisson_DC_poisson,p.midIxV4_ctx_iPoisson_AC_poisson,p.midIxV4_ctx_iPoisson_slopedutycycle_poisson,p.midIxV4_ctx_iPoisson_thresholddutycycle_poisson,p.midIxV4_ctx_iPoisson_tau_poisson,p.midIxV4_ctx_iPoisson_kick_poisson,T,p.midIxV4_Npop);
deepExV4_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.deepExV4_ctx_iPoisson_onset_poisson,p.deepExV4_ctx_iPoisson_offset_poisson,p.deepExV4_ctx_iPoisson_latency_poisson,p.deepExV4_ctx_iPoisson_f_poisson,p.deepExV4_ctx_iPoisson_fsigma_poisson,p.deepExV4_ctx_iPoisson_phi_poisson,p.deepExV4_ctx_iPoisson_connsigma_poisson,p.deepExV4_ctx_iPoisson_baseline_poisson,p.deepExV4_ctx_iPoisson_DC_poisson,p.deepExV4_ctx_iPoisson_AC_poisson,p.deepExV4_ctx_iPoisson_slopedutycycle_poisson,p.deepExV4_ctx_iPoisson_thresholddutycycle_poisson,p.deepExV4_ctx_iPoisson_tau_poisson,p.deepExV4_ctx_iPoisson_kick_poisson,T,p.deepExV4_Npop);
deepIxV4_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.deepIxV4_ctx_iPoisson_onset_poisson,p.deepIxV4_ctx_iPoisson_offset_poisson,p.deepIxV4_ctx_iPoisson_latency_poisson,p.deepIxV4_ctx_iPoisson_f_poisson,p.deepIxV4_ctx_iPoisson_fsigma_poisson,p.deepIxV4_ctx_iPoisson_phi_poisson,p.deepIxV4_ctx_iPoisson_connsigma_poisson,p.deepIxV4_ctx_iPoisson_baseline_poisson,p.deepIxV4_ctx_iPoisson_DC_poisson,p.deepIxV4_ctx_iPoisson_AC_poisson,p.deepIxV4_ctx_iPoisson_slopedutycycle_poisson,p.deepIxV4_ctx_iPoisson_thresholddutycycle_poisson,p.deepIxV4_ctx_iPoisson_tau_poisson,p.deepIxV4_ctx_iPoisson_kick_poisson,T,p.deepIxV4_Npop);
EAxV4_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.EAxV4_ctx_iPoisson_onset_poisson,p.EAxV4_ctx_iPoisson_offset_poisson,p.EAxV4_ctx_iPoisson_latency_poisson,p.EAxV4_ctx_iPoisson_f_poisson,p.EAxV4_ctx_iPoisson_fsigma_poisson,p.EAxV4_ctx_iPoisson_phi_poisson,p.EAxV4_ctx_iPoisson_connsigma_poisson,p.EAxV4_ctx_iPoisson_baseline_poisson,p.EAxV4_ctx_iPoisson_DC_poisson,p.EAxV4_ctx_iPoisson_AC_poisson,p.EAxV4_ctx_iPoisson_slopedutycycle_poisson,p.EAxV4_ctx_iPoisson_thresholddutycycle_poisson,p.EAxV4_ctx_iPoisson_tau_poisson,p.EAxV4_ctx_iPoisson_kick_poisson,T,p.EAxV4_Npop);
IAxV4_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.IAxV4_ctx_iPoisson_onset_poisson,p.IAxV4_ctx_iPoisson_offset_poisson,p.IAxV4_ctx_iPoisson_latency_poisson,p.IAxV4_ctx_iPoisson_f_poisson,p.IAxV4_ctx_iPoisson_fsigma_poisson,p.IAxV4_ctx_iPoisson_phi_poisson,p.IAxV4_ctx_iPoisson_connsigma_poisson,p.IAxV4_ctx_iPoisson_baseline_poisson,p.IAxV4_ctx_iPoisson_DC_poisson,p.IAxV4_ctx_iPoisson_AC_poisson,p.IAxV4_ctx_iPoisson_slopedutycycle_poisson,p.IAxV4_ctx_iPoisson_thresholddutycycle_poisson,p.IAxV4_ctx_iPoisson_tau_poisson,p.IAxV4_ctx_iPoisson_kick_poisson,T,p.IAxV4_Npop);
EBxV4_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.EBxV4_ctx_iPoisson_onset_poisson,p.EBxV4_ctx_iPoisson_offset_poisson,p.EBxV4_ctx_iPoisson_latency_poisson,p.EBxV4_ctx_iPoisson_f_poisson,p.EBxV4_ctx_iPoisson_fsigma_poisson,p.EBxV4_ctx_iPoisson_phi_poisson,p.EBxV4_ctx_iPoisson_connsigma_poisson,p.EBxV4_ctx_iPoisson_baseline_poisson,p.EBxV4_ctx_iPoisson_DC_poisson,p.EBxV4_ctx_iPoisson_AC_poisson,p.EBxV4_ctx_iPoisson_slopedutycycle_poisson,p.EBxV4_ctx_iPoisson_thresholddutycycle_poisson,p.EBxV4_ctx_iPoisson_tau_poisson,p.EBxV4_ctx_iPoisson_kick_poisson,T,p.EBxV4_Npop);
IBxV4_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.IBxV4_ctx_iPoisson_onset_poisson,p.IBxV4_ctx_iPoisson_offset_poisson,p.IBxV4_ctx_iPoisson_latency_poisson,p.IBxV4_ctx_iPoisson_f_poisson,p.IBxV4_ctx_iPoisson_fsigma_poisson,p.IBxV4_ctx_iPoisson_phi_poisson,p.IBxV4_ctx_iPoisson_connsigma_poisson,p.IBxV4_ctx_iPoisson_baseline_poisson,p.IBxV4_ctx_iPoisson_DC_poisson,p.IBxV4_ctx_iPoisson_AC_poisson,p.IBxV4_ctx_iPoisson_slopedutycycle_poisson,p.IBxV4_ctx_iPoisson_thresholddutycycle_poisson,p.IBxV4_ctx_iPoisson_tau_poisson,p.IBxV4_ctx_iPoisson_kick_poisson,T,p.IBxV4_Npop);
ECxV4_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.ECxV4_ctx_iPoisson_onset_poisson,p.ECxV4_ctx_iPoisson_offset_poisson,p.ECxV4_ctx_iPoisson_latency_poisson,p.ECxV4_ctx_iPoisson_f_poisson,p.ECxV4_ctx_iPoisson_fsigma_poisson,p.ECxV4_ctx_iPoisson_phi_poisson,p.ECxV4_ctx_iPoisson_connsigma_poisson,p.ECxV4_ctx_iPoisson_baseline_poisson,p.ECxV4_ctx_iPoisson_DC_poisson,p.ECxV4_ctx_iPoisson_AC_poisson,p.ECxV4_ctx_iPoisson_slopedutycycle_poisson,p.ECxV4_ctx_iPoisson_thresholddutycycle_poisson,p.ECxV4_ctx_iPoisson_tau_poisson,p.ECxV4_ctx_iPoisson_kick_poisson,T,p.ECxV4_Npop);
ICxV4_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.ICxV4_ctx_iPoisson_onset_poisson,p.ICxV4_ctx_iPoisson_offset_poisson,p.ICxV4_ctx_iPoisson_latency_poisson,p.ICxV4_ctx_iPoisson_f_poisson,p.ICxV4_ctx_iPoisson_fsigma_poisson,p.ICxV4_ctx_iPoisson_phi_poisson,p.ICxV4_ctx_iPoisson_connsigma_poisson,p.ICxV4_ctx_iPoisson_baseline_poisson,p.ICxV4_ctx_iPoisson_DC_poisson,p.ICxV4_ctx_iPoisson_AC_poisson,p.ICxV4_ctx_iPoisson_slopedutycycle_poisson,p.ICxV4_ctx_iPoisson_thresholddutycycle_poisson,p.ICxV4_ctx_iPoisson_tau_poisson,p.ICxV4_ctx_iPoisson_kick_poisson,T,p.ICxV4_Npop);
supExPFC_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.supExPFC_ctx_iPoisson_onset_poisson,p.supExPFC_ctx_iPoisson_offset_poisson,p.supExPFC_ctx_iPoisson_latency_poisson,p.supExPFC_ctx_iPoisson_f_poisson,p.supExPFC_ctx_iPoisson_fsigma_poisson,p.supExPFC_ctx_iPoisson_phi_poisson,p.supExPFC_ctx_iPoisson_connsigma_poisson,p.supExPFC_ctx_iPoisson_baseline_poisson,p.supExPFC_ctx_iPoisson_DC_poisson,p.supExPFC_ctx_iPoisson_AC_poisson,p.supExPFC_ctx_iPoisson_slopedutycycle_poisson,p.supExPFC_ctx_iPoisson_thresholddutycycle_poisson,p.supExPFC_ctx_iPoisson_tau_poisson,p.supExPFC_ctx_iPoisson_kick_poisson,T,p.supExPFC_Npop);
supIxPFC_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.supIxPFC_ctx_iPoisson_onset_poisson,p.supIxPFC_ctx_iPoisson_offset_poisson,p.supIxPFC_ctx_iPoisson_latency_poisson,p.supIxPFC_ctx_iPoisson_f_poisson,p.supIxPFC_ctx_iPoisson_fsigma_poisson,p.supIxPFC_ctx_iPoisson_phi_poisson,p.supIxPFC_ctx_iPoisson_connsigma_poisson,p.supIxPFC_ctx_iPoisson_baseline_poisson,p.supIxPFC_ctx_iPoisson_DC_poisson,p.supIxPFC_ctx_iPoisson_AC_poisson,p.supIxPFC_ctx_iPoisson_slopedutycycle_poisson,p.supIxPFC_ctx_iPoisson_thresholddutycycle_poisson,p.supIxPFC_ctx_iPoisson_tau_poisson,p.supIxPFC_ctx_iPoisson_kick_poisson,T,p.supIxPFC_Npop);
midExPFC_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.midExPFC_ctx_iPoisson_onset_poisson,p.midExPFC_ctx_iPoisson_offset_poisson,p.midExPFC_ctx_iPoisson_latency_poisson,p.midExPFC_ctx_iPoisson_f_poisson,p.midExPFC_ctx_iPoisson_fsigma_poisson,p.midExPFC_ctx_iPoisson_phi_poisson,p.midExPFC_ctx_iPoisson_connsigma_poisson,p.midExPFC_ctx_iPoisson_baseline_poisson,p.midExPFC_ctx_iPoisson_DC_poisson,p.midExPFC_ctx_iPoisson_AC_poisson,p.midExPFC_ctx_iPoisson_slopedutycycle_poisson,p.midExPFC_ctx_iPoisson_thresholddutycycle_poisson,p.midExPFC_ctx_iPoisson_tau_poisson,p.midExPFC_ctx_iPoisson_kick_poisson,T,p.midExPFC_Npop);
midIxPFC_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.midIxPFC_ctx_iPoisson_onset_poisson,p.midIxPFC_ctx_iPoisson_offset_poisson,p.midIxPFC_ctx_iPoisson_latency_poisson,p.midIxPFC_ctx_iPoisson_f_poisson,p.midIxPFC_ctx_iPoisson_fsigma_poisson,p.midIxPFC_ctx_iPoisson_phi_poisson,p.midIxPFC_ctx_iPoisson_connsigma_poisson,p.midIxPFC_ctx_iPoisson_baseline_poisson,p.midIxPFC_ctx_iPoisson_DC_poisson,p.midIxPFC_ctx_iPoisson_AC_poisson,p.midIxPFC_ctx_iPoisson_slopedutycycle_poisson,p.midIxPFC_ctx_iPoisson_thresholddutycycle_poisson,p.midIxPFC_ctx_iPoisson_tau_poisson,p.midIxPFC_ctx_iPoisson_kick_poisson,T,p.midIxPFC_Npop);
deepExPFC_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.deepExPFC_ctx_iPoisson_onset_poisson,p.deepExPFC_ctx_iPoisson_offset_poisson,p.deepExPFC_ctx_iPoisson_latency_poisson,p.deepExPFC_ctx_iPoisson_f_poisson,p.deepExPFC_ctx_iPoisson_fsigma_poisson,p.deepExPFC_ctx_iPoisson_phi_poisson,p.deepExPFC_ctx_iPoisson_connsigma_poisson,p.deepExPFC_ctx_iPoisson_baseline_poisson,p.deepExPFC_ctx_iPoisson_DC_poisson,p.deepExPFC_ctx_iPoisson_AC_poisson,p.deepExPFC_ctx_iPoisson_slopedutycycle_poisson,p.deepExPFC_ctx_iPoisson_thresholddutycycle_poisson,p.deepExPFC_ctx_iPoisson_tau_poisson,p.deepExPFC_ctx_iPoisson_kick_poisson,T,p.deepExPFC_Npop);
deepIxPFC_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.deepIxPFC_ctx_iPoisson_onset_poisson,p.deepIxPFC_ctx_iPoisson_offset_poisson,p.deepIxPFC_ctx_iPoisson_latency_poisson,p.deepIxPFC_ctx_iPoisson_f_poisson,p.deepIxPFC_ctx_iPoisson_fsigma_poisson,p.deepIxPFC_ctx_iPoisson_phi_poisson,p.deepIxPFC_ctx_iPoisson_connsigma_poisson,p.deepIxPFC_ctx_iPoisson_baseline_poisson,p.deepIxPFC_ctx_iPoisson_DC_poisson,p.deepIxPFC_ctx_iPoisson_AC_poisson,p.deepIxPFC_ctx_iPoisson_slopedutycycle_poisson,p.deepIxPFC_ctx_iPoisson_thresholddutycycle_poisson,p.deepIxPFC_ctx_iPoisson_tau_poisson,p.deepIxPFC_ctx_iPoisson_kick_poisson,T,p.deepIxPFC_Npop);
EAxPFC_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.EAxPFC_ctx_iPoisson_onset_poisson,p.EAxPFC_ctx_iPoisson_offset_poisson,p.EAxPFC_ctx_iPoisson_latency_poisson,p.EAxPFC_ctx_iPoisson_f_poisson,p.EAxPFC_ctx_iPoisson_fsigma_poisson,p.EAxPFC_ctx_iPoisson_phi_poisson,p.EAxPFC_ctx_iPoisson_connsigma_poisson,p.EAxPFC_ctx_iPoisson_baseline_poisson,p.EAxPFC_ctx_iPoisson_DC_poisson,p.EAxPFC_ctx_iPoisson_AC_poisson,p.EAxPFC_ctx_iPoisson_slopedutycycle_poisson,p.EAxPFC_ctx_iPoisson_thresholddutycycle_poisson,p.EAxPFC_ctx_iPoisson_tau_poisson,p.EAxPFC_ctx_iPoisson_kick_poisson,T,p.EAxPFC_Npop);
IAxPFC_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.IAxPFC_ctx_iPoisson_onset_poisson,p.IAxPFC_ctx_iPoisson_offset_poisson,p.IAxPFC_ctx_iPoisson_latency_poisson,p.IAxPFC_ctx_iPoisson_f_poisson,p.IAxPFC_ctx_iPoisson_fsigma_poisson,p.IAxPFC_ctx_iPoisson_phi_poisson,p.IAxPFC_ctx_iPoisson_connsigma_poisson,p.IAxPFC_ctx_iPoisson_baseline_poisson,p.IAxPFC_ctx_iPoisson_DC_poisson,p.IAxPFC_ctx_iPoisson_AC_poisson,p.IAxPFC_ctx_iPoisson_slopedutycycle_poisson,p.IAxPFC_ctx_iPoisson_thresholddutycycle_poisson,p.IAxPFC_ctx_iPoisson_tau_poisson,p.IAxPFC_ctx_iPoisson_kick_poisson,T,p.IAxPFC_Npop);
EBxPFC_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.EBxPFC_ctx_iPoisson_onset_poisson,p.EBxPFC_ctx_iPoisson_offset_poisson,p.EBxPFC_ctx_iPoisson_latency_poisson,p.EBxPFC_ctx_iPoisson_f_poisson,p.EBxPFC_ctx_iPoisson_fsigma_poisson,p.EBxPFC_ctx_iPoisson_phi_poisson,p.EBxPFC_ctx_iPoisson_connsigma_poisson,p.EBxPFC_ctx_iPoisson_baseline_poisson,p.EBxPFC_ctx_iPoisson_DC_poisson,p.EBxPFC_ctx_iPoisson_AC_poisson,p.EBxPFC_ctx_iPoisson_slopedutycycle_poisson,p.EBxPFC_ctx_iPoisson_thresholddutycycle_poisson,p.EBxPFC_ctx_iPoisson_tau_poisson,p.EBxPFC_ctx_iPoisson_kick_poisson,T,p.EBxPFC_Npop);
IBxPFC_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.IBxPFC_ctx_iPoisson_onset_poisson,p.IBxPFC_ctx_iPoisson_offset_poisson,p.IBxPFC_ctx_iPoisson_latency_poisson,p.IBxPFC_ctx_iPoisson_f_poisson,p.IBxPFC_ctx_iPoisson_fsigma_poisson,p.IBxPFC_ctx_iPoisson_phi_poisson,p.IBxPFC_ctx_iPoisson_connsigma_poisson,p.IBxPFC_ctx_iPoisson_baseline_poisson,p.IBxPFC_ctx_iPoisson_DC_poisson,p.IBxPFC_ctx_iPoisson_AC_poisson,p.IBxPFC_ctx_iPoisson_slopedutycycle_poisson,p.IBxPFC_ctx_iPoisson_thresholddutycycle_poisson,p.IBxPFC_ctx_iPoisson_tau_poisson,p.IBxPFC_ctx_iPoisson_kick_poisson,T,p.IBxPFC_Npop);
ECxPFC_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.ECxPFC_ctx_iPoisson_onset_poisson,p.ECxPFC_ctx_iPoisson_offset_poisson,p.ECxPFC_ctx_iPoisson_latency_poisson,p.ECxPFC_ctx_iPoisson_f_poisson,p.ECxPFC_ctx_iPoisson_fsigma_poisson,p.ECxPFC_ctx_iPoisson_phi_poisson,p.ECxPFC_ctx_iPoisson_connsigma_poisson,p.ECxPFC_ctx_iPoisson_baseline_poisson,p.ECxPFC_ctx_iPoisson_DC_poisson,p.ECxPFC_ctx_iPoisson_AC_poisson,p.ECxPFC_ctx_iPoisson_slopedutycycle_poisson,p.ECxPFC_ctx_iPoisson_thresholddutycycle_poisson,p.ECxPFC_ctx_iPoisson_tau_poisson,p.ECxPFC_ctx_iPoisson_kick_poisson,T,p.ECxPFC_Npop);
ICxPFC_ctx_iPoisson_s_poisson = getPoissonDutyCycleGating(p.ICxPFC_ctx_iPoisson_onset_poisson,p.ICxPFC_ctx_iPoisson_offset_poisson,p.ICxPFC_ctx_iPoisson_latency_poisson,p.ICxPFC_ctx_iPoisson_f_poisson,p.ICxPFC_ctx_iPoisson_fsigma_poisson,p.ICxPFC_ctx_iPoisson_phi_poisson,p.ICxPFC_ctx_iPoisson_connsigma_poisson,p.ICxPFC_ctx_iPoisson_baseline_poisson,p.ICxPFC_ctx_iPoisson_DC_poisson,p.ICxPFC_ctx_iPoisson_AC_poisson,p.ICxPFC_ctx_iPoisson_slopedutycycle_poisson,p.ICxPFC_ctx_iPoisson_thresholddutycycle_poisson,p.ICxPFC_ctx_iPoisson_tau_poisson,p.ICxPFC_ctx_iPoisson_kick_poisson,T,p.ICxPFC_Npop);
IAxV4_EAxV4_iPoisson_s = getPoissonGating(p.IAxV4_EAxV4_iPoisson_baseline,p.IAxV4_EAxV4_iPoisson_DC,p.IAxV4_EAxV4_iPoisson_AC,p.IAxV4_EAxV4_iPoisson_f,p.IAxV4_EAxV4_iPoisson_phi,p.IAxV4_EAxV4_iPoisson_onset,p.IAxV4_EAxV4_iPoisson_offset,p.IAxV4_EAxV4_iPoisson_tau,T,p.IAxV4_Npop);
EAxV4_EAxV4_iPoisson_s = getPoissonGating(p.EAxV4_EAxV4_iPoisson_baseline,p.EAxV4_EAxV4_iPoisson_DC,p.EAxV4_EAxV4_iPoisson_AC,p.EAxV4_EAxV4_iPoisson_f,p.EAxV4_EAxV4_iPoisson_phi,p.EAxV4_EAxV4_iPoisson_onset,p.EAxV4_EAxV4_iPoisson_offset,p.EAxV4_EAxV4_iPoisson_tau,T,p.EAxV4_Npop);
EAxV4_IAxV4_iPoisson_s = getPoissonGating(p.EAxV4_IAxV4_iPoisson_baseline,p.EAxV4_IAxV4_iPoisson_DC,p.EAxV4_IAxV4_iPoisson_AC,p.EAxV4_IAxV4_iPoisson_f,p.EAxV4_IAxV4_iPoisson_phi,p.EAxV4_IAxV4_iPoisson_onset,p.EAxV4_IAxV4_iPoisson_offset,p.EAxV4_IAxV4_iPoisson_tau,T,p.EAxV4_Npop);
IAxV4_IAxV4_iPoisson_s = getPoissonGating(p.IAxV4_IAxV4_iPoisson_baseline,p.IAxV4_IAxV4_iPoisson_DC,p.IAxV4_IAxV4_iPoisson_AC,p.IAxV4_IAxV4_iPoisson_f,p.IAxV4_IAxV4_iPoisson_phi,p.IAxV4_IAxV4_iPoisson_onset,p.IAxV4_IAxV4_iPoisson_offset,p.IAxV4_IAxV4_iPoisson_tau,T,p.IAxV4_Npop);
IBxV4_EBxV4_iPoisson_s = getPoissonGating(p.IBxV4_EBxV4_iPoisson_baseline,p.IBxV4_EBxV4_iPoisson_DC,p.IBxV4_EBxV4_iPoisson_AC,p.IBxV4_EBxV4_iPoisson_f,p.IBxV4_EBxV4_iPoisson_phi,p.IBxV4_EBxV4_iPoisson_onset,p.IBxV4_EBxV4_iPoisson_offset,p.IBxV4_EBxV4_iPoisson_tau,T,p.IBxV4_Npop);
EBxV4_EBxV4_iPoisson_s = getPoissonGating(p.EBxV4_EBxV4_iPoisson_baseline,p.EBxV4_EBxV4_iPoisson_DC,p.EBxV4_EBxV4_iPoisson_AC,p.EBxV4_EBxV4_iPoisson_f,p.EBxV4_EBxV4_iPoisson_phi,p.EBxV4_EBxV4_iPoisson_onset,p.EBxV4_EBxV4_iPoisson_offset,p.EBxV4_EBxV4_iPoisson_tau,T,p.EBxV4_Npop);
EBxV4_IBxV4_iPoisson_s = getPoissonGating(p.EBxV4_IBxV4_iPoisson_baseline,p.EBxV4_IBxV4_iPoisson_DC,p.EBxV4_IBxV4_iPoisson_AC,p.EBxV4_IBxV4_iPoisson_f,p.EBxV4_IBxV4_iPoisson_phi,p.EBxV4_IBxV4_iPoisson_onset,p.EBxV4_IBxV4_iPoisson_offset,p.EBxV4_IBxV4_iPoisson_tau,T,p.EBxV4_Npop);
IBxV4_IBxV4_iPoisson_s = getPoissonGating(p.IBxV4_IBxV4_iPoisson_baseline,p.IBxV4_IBxV4_iPoisson_DC,p.IBxV4_IBxV4_iPoisson_AC,p.IBxV4_IBxV4_iPoisson_f,p.IBxV4_IBxV4_iPoisson_phi,p.IBxV4_IBxV4_iPoisson_onset,p.IBxV4_IBxV4_iPoisson_offset,p.IBxV4_IBxV4_iPoisson_tau,T,p.IBxV4_Npop);
ICxV4_ECxV4_iPoisson_s = getPoissonGating(p.ICxV4_ECxV4_iPoisson_baseline,p.ICxV4_ECxV4_iPoisson_DC,p.ICxV4_ECxV4_iPoisson_AC,p.ICxV4_ECxV4_iPoisson_f,p.ICxV4_ECxV4_iPoisson_phi,p.ICxV4_ECxV4_iPoisson_onset,p.ICxV4_ECxV4_iPoisson_offset,p.ICxV4_ECxV4_iPoisson_tau,T,p.ICxV4_Npop);
ECxV4_ECxV4_iPoisson_s = getPoissonGating(p.ECxV4_ECxV4_iPoisson_baseline,p.ECxV4_ECxV4_iPoisson_DC,p.ECxV4_ECxV4_iPoisson_AC,p.ECxV4_ECxV4_iPoisson_f,p.ECxV4_ECxV4_iPoisson_phi,p.ECxV4_ECxV4_iPoisson_onset,p.ECxV4_ECxV4_iPoisson_offset,p.ECxV4_ECxV4_iPoisson_tau,T,p.ECxV4_Npop);
ECxV4_ICxV4_iPoisson_s = getPoissonGating(p.ECxV4_ICxV4_iPoisson_baseline,p.ECxV4_ICxV4_iPoisson_DC,p.ECxV4_ICxV4_iPoisson_AC,p.ECxV4_ICxV4_iPoisson_f,p.ECxV4_ICxV4_iPoisson_phi,p.ECxV4_ICxV4_iPoisson_onset,p.ECxV4_ICxV4_iPoisson_offset,p.ECxV4_ICxV4_iPoisson_tau,T,p.ECxV4_Npop);
ICxV4_ICxV4_iPoisson_s = getPoissonGating(p.ICxV4_ICxV4_iPoisson_baseline,p.ICxV4_ICxV4_iPoisson_DC,p.ICxV4_ICxV4_iPoisson_AC,p.ICxV4_ICxV4_iPoisson_f,p.ICxV4_ICxV4_iPoisson_phi,p.ICxV4_ICxV4_iPoisson_onset,p.ICxV4_ICxV4_iPoisson_offset,p.ICxV4_ICxV4_iPoisson_tau,T,p.ICxV4_Npop);
midExV4_EAxV4_iPoisson_s = getPoissonGating(p.midExV4_EAxV4_iPoisson_baseline,p.midExV4_EAxV4_iPoisson_DC,p.midExV4_EAxV4_iPoisson_AC,p.midExV4_EAxV4_iPoisson_f,p.midExV4_EAxV4_iPoisson_phi,p.midExV4_EAxV4_iPoisson_onset,p.midExV4_EAxV4_iPoisson_offset,p.midExV4_EAxV4_iPoisson_tau,T,p.midExV4_Npop);
midExV4_IAxV4_iPoisson_s = getPoissonGating(p.midExV4_IAxV4_iPoisson_baseline,p.midExV4_IAxV4_iPoisson_DC,p.midExV4_IAxV4_iPoisson_AC,p.midExV4_IAxV4_iPoisson_f,p.midExV4_IAxV4_iPoisson_phi,p.midExV4_IAxV4_iPoisson_onset,p.midExV4_IAxV4_iPoisson_offset,p.midExV4_IAxV4_iPoisson_tau,T,p.midExV4_Npop);
midExV4_EBxV4_iPoisson_s = getPoissonGating(p.midExV4_EBxV4_iPoisson_baseline,p.midExV4_EBxV4_iPoisson_DC,p.midExV4_EBxV4_iPoisson_AC,p.midExV4_EBxV4_iPoisson_f,p.midExV4_EBxV4_iPoisson_phi,p.midExV4_EBxV4_iPoisson_onset,p.midExV4_EBxV4_iPoisson_offset,p.midExV4_EBxV4_iPoisson_tau,T,p.midExV4_Npop);
midExV4_IBxV4_iPoisson_s = getPoissonGating(p.midExV4_IBxV4_iPoisson_baseline,p.midExV4_IBxV4_iPoisson_DC,p.midExV4_IBxV4_iPoisson_AC,p.midExV4_IBxV4_iPoisson_f,p.midExV4_IBxV4_iPoisson_phi,p.midExV4_IBxV4_iPoisson_onset,p.midExV4_IBxV4_iPoisson_offset,p.midExV4_IBxV4_iPoisson_tau,T,p.midExV4_Npop);
midExV4_ECxV4_iPoisson_s = getPoissonGating(p.midExV4_ECxV4_iPoisson_baseline,p.midExV4_ECxV4_iPoisson_DC,p.midExV4_ECxV4_iPoisson_AC,p.midExV4_ECxV4_iPoisson_f,p.midExV4_ECxV4_iPoisson_phi,p.midExV4_ECxV4_iPoisson_onset,p.midExV4_ECxV4_iPoisson_offset,p.midExV4_ECxV4_iPoisson_tau,T,p.midExV4_Npop);
midExV4_ICxV4_iPoisson_s = getPoissonGating(p.midExV4_ICxV4_iPoisson_baseline,p.midExV4_ICxV4_iPoisson_DC,p.midExV4_ICxV4_iPoisson_AC,p.midExV4_ICxV4_iPoisson_f,p.midExV4_ICxV4_iPoisson_phi,p.midExV4_ICxV4_iPoisson_onset,p.midExV4_ICxV4_iPoisson_offset,p.midExV4_ICxV4_iPoisson_tau,T,p.midExV4_Npop);
IAxPFC_EAxPFC_iPoisson_s = getPoissonGating(p.IAxPFC_EAxPFC_iPoisson_baseline,p.IAxPFC_EAxPFC_iPoisson_DC,p.IAxPFC_EAxPFC_iPoisson_AC,p.IAxPFC_EAxPFC_iPoisson_f,p.IAxPFC_EAxPFC_iPoisson_phi,p.IAxPFC_EAxPFC_iPoisson_onset,p.IAxPFC_EAxPFC_iPoisson_offset,p.IAxPFC_EAxPFC_iPoisson_tau,T,p.IAxPFC_Npop);
EAxPFC_EAxPFC_iPoisson_s = getPoissonGating(p.EAxPFC_EAxPFC_iPoisson_baseline,p.EAxPFC_EAxPFC_iPoisson_DC,p.EAxPFC_EAxPFC_iPoisson_AC,p.EAxPFC_EAxPFC_iPoisson_f,p.EAxPFC_EAxPFC_iPoisson_phi,p.EAxPFC_EAxPFC_iPoisson_onset,p.EAxPFC_EAxPFC_iPoisson_offset,p.EAxPFC_EAxPFC_iPoisson_tau,T,p.EAxPFC_Npop);
EAxPFC_IAxPFC_iPoisson_s = getPoissonGating(p.EAxPFC_IAxPFC_iPoisson_baseline,p.EAxPFC_IAxPFC_iPoisson_DC,p.EAxPFC_IAxPFC_iPoisson_AC,p.EAxPFC_IAxPFC_iPoisson_f,p.EAxPFC_IAxPFC_iPoisson_phi,p.EAxPFC_IAxPFC_iPoisson_onset,p.EAxPFC_IAxPFC_iPoisson_offset,p.EAxPFC_IAxPFC_iPoisson_tau,T,p.EAxPFC_Npop);
IAxPFC_IAxPFC_iPoisson_s = getPoissonGating(p.IAxPFC_IAxPFC_iPoisson_baseline,p.IAxPFC_IAxPFC_iPoisson_DC,p.IAxPFC_IAxPFC_iPoisson_AC,p.IAxPFC_IAxPFC_iPoisson_f,p.IAxPFC_IAxPFC_iPoisson_phi,p.IAxPFC_IAxPFC_iPoisson_onset,p.IAxPFC_IAxPFC_iPoisson_offset,p.IAxPFC_IAxPFC_iPoisson_tau,T,p.IAxPFC_Npop);
IBxPFC_EBxPFC_iPoisson_s = getPoissonGating(p.IBxPFC_EBxPFC_iPoisson_baseline,p.IBxPFC_EBxPFC_iPoisson_DC,p.IBxPFC_EBxPFC_iPoisson_AC,p.IBxPFC_EBxPFC_iPoisson_f,p.IBxPFC_EBxPFC_iPoisson_phi,p.IBxPFC_EBxPFC_iPoisson_onset,p.IBxPFC_EBxPFC_iPoisson_offset,p.IBxPFC_EBxPFC_iPoisson_tau,T,p.IBxPFC_Npop);
EBxPFC_EBxPFC_iPoisson_s = getPoissonGating(p.EBxPFC_EBxPFC_iPoisson_baseline,p.EBxPFC_EBxPFC_iPoisson_DC,p.EBxPFC_EBxPFC_iPoisson_AC,p.EBxPFC_EBxPFC_iPoisson_f,p.EBxPFC_EBxPFC_iPoisson_phi,p.EBxPFC_EBxPFC_iPoisson_onset,p.EBxPFC_EBxPFC_iPoisson_offset,p.EBxPFC_EBxPFC_iPoisson_tau,T,p.EBxPFC_Npop);
EBxPFC_IBxPFC_iPoisson_s = getPoissonGating(p.EBxPFC_IBxPFC_iPoisson_baseline,p.EBxPFC_IBxPFC_iPoisson_DC,p.EBxPFC_IBxPFC_iPoisson_AC,p.EBxPFC_IBxPFC_iPoisson_f,p.EBxPFC_IBxPFC_iPoisson_phi,p.EBxPFC_IBxPFC_iPoisson_onset,p.EBxPFC_IBxPFC_iPoisson_offset,p.EBxPFC_IBxPFC_iPoisson_tau,T,p.EBxPFC_Npop);
IBxPFC_IBxPFC_iPoisson_s = getPoissonGating(p.IBxPFC_IBxPFC_iPoisson_baseline,p.IBxPFC_IBxPFC_iPoisson_DC,p.IBxPFC_IBxPFC_iPoisson_AC,p.IBxPFC_IBxPFC_iPoisson_f,p.IBxPFC_IBxPFC_iPoisson_phi,p.IBxPFC_IBxPFC_iPoisson_onset,p.IBxPFC_IBxPFC_iPoisson_offset,p.IBxPFC_IBxPFC_iPoisson_tau,T,p.IBxPFC_Npop);
ICxPFC_ECxPFC_iPoisson_s = getPoissonGating(p.ICxPFC_ECxPFC_iPoisson_baseline,p.ICxPFC_ECxPFC_iPoisson_DC,p.ICxPFC_ECxPFC_iPoisson_AC,p.ICxPFC_ECxPFC_iPoisson_f,p.ICxPFC_ECxPFC_iPoisson_phi,p.ICxPFC_ECxPFC_iPoisson_onset,p.ICxPFC_ECxPFC_iPoisson_offset,p.ICxPFC_ECxPFC_iPoisson_tau,T,p.ICxPFC_Npop);
ECxPFC_ECxPFC_iPoisson_s = getPoissonGating(p.ECxPFC_ECxPFC_iPoisson_baseline,p.ECxPFC_ECxPFC_iPoisson_DC,p.ECxPFC_ECxPFC_iPoisson_AC,p.ECxPFC_ECxPFC_iPoisson_f,p.ECxPFC_ECxPFC_iPoisson_phi,p.ECxPFC_ECxPFC_iPoisson_onset,p.ECxPFC_ECxPFC_iPoisson_offset,p.ECxPFC_ECxPFC_iPoisson_tau,T,p.ECxPFC_Npop);
ECxPFC_ICxPFC_iPoisson_s = getPoissonGating(p.ECxPFC_ICxPFC_iPoisson_baseline,p.ECxPFC_ICxPFC_iPoisson_DC,p.ECxPFC_ICxPFC_iPoisson_AC,p.ECxPFC_ICxPFC_iPoisson_f,p.ECxPFC_ICxPFC_iPoisson_phi,p.ECxPFC_ICxPFC_iPoisson_onset,p.ECxPFC_ICxPFC_iPoisson_offset,p.ECxPFC_ICxPFC_iPoisson_tau,T,p.ECxPFC_Npop);
ICxPFC_ICxPFC_iPoisson_s = getPoissonGating(p.ICxPFC_ICxPFC_iPoisson_baseline,p.ICxPFC_ICxPFC_iPoisson_DC,p.ICxPFC_ICxPFC_iPoisson_AC,p.ICxPFC_ICxPFC_iPoisson_f,p.ICxPFC_ICxPFC_iPoisson_phi,p.ICxPFC_ICxPFC_iPoisson_onset,p.ICxPFC_ICxPFC_iPoisson_offset,p.ICxPFC_ICxPFC_iPoisson_tau,T,p.ICxPFC_Npop);
midExPFC_EAxPFC_iPoisson_s = getPoissonGating(p.midExPFC_EAxPFC_iPoisson_baseline,p.midExPFC_EAxPFC_iPoisson_DC,p.midExPFC_EAxPFC_iPoisson_AC,p.midExPFC_EAxPFC_iPoisson_f,p.midExPFC_EAxPFC_iPoisson_phi,p.midExPFC_EAxPFC_iPoisson_onset,p.midExPFC_EAxPFC_iPoisson_offset,p.midExPFC_EAxPFC_iPoisson_tau,T,p.midExPFC_Npop);
midExPFC_IAxPFC_iPoisson_s = getPoissonGating(p.midExPFC_IAxPFC_iPoisson_baseline,p.midExPFC_IAxPFC_iPoisson_DC,p.midExPFC_IAxPFC_iPoisson_AC,p.midExPFC_IAxPFC_iPoisson_f,p.midExPFC_IAxPFC_iPoisson_phi,p.midExPFC_IAxPFC_iPoisson_onset,p.midExPFC_IAxPFC_iPoisson_offset,p.midExPFC_IAxPFC_iPoisson_tau,T,p.midExPFC_Npop);
midExPFC_EBxPFC_iPoisson_s = getPoissonGating(p.midExPFC_EBxPFC_iPoisson_baseline,p.midExPFC_EBxPFC_iPoisson_DC,p.midExPFC_EBxPFC_iPoisson_AC,p.midExPFC_EBxPFC_iPoisson_f,p.midExPFC_EBxPFC_iPoisson_phi,p.midExPFC_EBxPFC_iPoisson_onset,p.midExPFC_EBxPFC_iPoisson_offset,p.midExPFC_EBxPFC_iPoisson_tau,T,p.midExPFC_Npop);
midExPFC_IBxPFC_iPoisson_s = getPoissonGating(p.midExPFC_IBxPFC_iPoisson_baseline,p.midExPFC_IBxPFC_iPoisson_DC,p.midExPFC_IBxPFC_iPoisson_AC,p.midExPFC_IBxPFC_iPoisson_f,p.midExPFC_IBxPFC_iPoisson_phi,p.midExPFC_IBxPFC_iPoisson_onset,p.midExPFC_IBxPFC_iPoisson_offset,p.midExPFC_IBxPFC_iPoisson_tau,T,p.midExPFC_Npop);
midExPFC_ECxPFC_iPoisson_s = getPoissonGating(p.midExPFC_ECxPFC_iPoisson_baseline,p.midExPFC_ECxPFC_iPoisson_DC,p.midExPFC_ECxPFC_iPoisson_AC,p.midExPFC_ECxPFC_iPoisson_f,p.midExPFC_ECxPFC_iPoisson_phi,p.midExPFC_ECxPFC_iPoisson_onset,p.midExPFC_ECxPFC_iPoisson_offset,p.midExPFC_ECxPFC_iPoisson_tau,T,p.midExPFC_Npop);
midExPFC_ICxPFC_iPoisson_s = getPoissonGating(p.midExPFC_ICxPFC_iPoisson_baseline,p.midExPFC_ICxPFC_iPoisson_DC,p.midExPFC_ICxPFC_iPoisson_AC,p.midExPFC_ICxPFC_iPoisson_f,p.midExPFC_ICxPFC_iPoisson_phi,p.midExPFC_ICxPFC_iPoisson_onset,p.midExPFC_ICxPFC_iPoisson_offset,p.midExPFC_ICxPFC_iPoisson_tau,T,p.midExPFC_Npop);
midExPFC_deepExV4_iPoisson_s = getPoissonGating(p.midExPFC_deepExV4_iPoisson_baseline,p.midExPFC_deepExV4_iPoisson_DC,p.midExPFC_deepExV4_iPoisson_AC,p.midExPFC_deepExV4_iPoisson_f,p.midExPFC_deepExV4_iPoisson_phi,p.midExPFC_deepExV4_iPoisson_onset,p.midExPFC_deepExV4_iPoisson_offset,p.midExPFC_deepExV4_iPoisson_tau,T,p.midExPFC_Npop);
midIxPFC_deepIxV4_iPoisson_s = getPoissonGating(p.midIxPFC_deepIxV4_iPoisson_baseline,p.midIxPFC_deepIxV4_iPoisson_DC,p.midIxPFC_deepIxV4_iPoisson_AC,p.midIxPFC_deepIxV4_iPoisson_f,p.midIxPFC_deepIxV4_iPoisson_phi,p.midIxPFC_deepIxV4_iPoisson_onset,p.midIxPFC_deepIxV4_iPoisson_offset,p.midIxPFC_deepIxV4_iPoisson_tau,T,p.midIxPFC_Npop);

% ------------------------------------------------------------
% Initial conditions:
% ------------------------------------------------------------
t=0; k=1;

% STATE_VARIABLES:
supExV4_V_last =  -rand(1, p.supExV4_Npop)*74;
supExV4_V = zeros(nsamp,p.supExV4_Npop);
supExV4_V(1,:) = supExV4_V_last;
supExV4_iNa_m_last = p.supExV4_iNa_m_IC+p.supExV4_iNa_IC_noise*rand(1,p.supExV4_Npop);
supExV4_iNa_m = zeros(nsamp,p.supExV4_Npop);
supExV4_iNa_m(1,:) = supExV4_iNa_m_last;
supExV4_iNa_h_last = p.supExV4_iNa_h_IC+p.supExV4_iNa_IC_noise*rand(1,p.supExV4_Npop);
supExV4_iNa_h = zeros(nsamp,p.supExV4_Npop);
supExV4_iNa_h(1,:) = supExV4_iNa_h_last;
supExV4_iK_n_last = p.supExV4_iK_n_IC+p.supExV4_iK_IC_noise*rand(1,p.supExV4_Npop);
supExV4_iK_n = zeros(nsamp,p.supExV4_Npop);
supExV4_iK_n(1,:) = supExV4_iK_n_last;
supIxV4_V_last =  -rand(1, p.supIxV4_Npop)*74;
supIxV4_V = zeros(nsamp,p.supIxV4_Npop);
supIxV4_V(1,:) = supIxV4_V_last;
supIxV4_iNa_m_last = p.supIxV4_iNa_m_IC+p.supIxV4_iNa_IC_noise*rand(1,p.supIxV4_Npop);
supIxV4_iNa_m = zeros(nsamp,p.supIxV4_Npop);
supIxV4_iNa_m(1,:) = supIxV4_iNa_m_last;
supIxV4_iNa_h_last = p.supIxV4_iNa_h_IC+p.supIxV4_iNa_IC_noise*rand(1,p.supIxV4_Npop);
supIxV4_iNa_h = zeros(nsamp,p.supIxV4_Npop);
supIxV4_iNa_h(1,:) = supIxV4_iNa_h_last;
supIxV4_iK_n_last = p.supIxV4_iK_n_IC+p.supIxV4_iK_IC_noise*rand(1,p.supIxV4_Npop);
supIxV4_iK_n = zeros(nsamp,p.supIxV4_Npop);
supIxV4_iK_n(1,:) = supIxV4_iK_n_last;
midExV4_V_last =  -rand(1, p.midExV4_Npop)*74;
midExV4_V = zeros(nsamp,p.midExV4_Npop);
midExV4_V(1,:) = midExV4_V_last;
midExV4_iNa_m_last = p.midExV4_iNa_m_IC+p.midExV4_iNa_IC_noise*rand(1,p.midExV4_Npop);
midExV4_iNa_m = zeros(nsamp,p.midExV4_Npop);
midExV4_iNa_m(1,:) = midExV4_iNa_m_last;
midExV4_iNa_h_last = p.midExV4_iNa_h_IC+p.midExV4_iNa_IC_noise*rand(1,p.midExV4_Npop);
midExV4_iNa_h = zeros(nsamp,p.midExV4_Npop);
midExV4_iNa_h(1,:) = midExV4_iNa_h_last;
midExV4_iK_n_last = p.midExV4_iK_n_IC+p.midExV4_iK_IC_noise*rand(1,p.midExV4_Npop);
midExV4_iK_n = zeros(nsamp,p.midExV4_Npop);
midExV4_iK_n(1,:) = midExV4_iK_n_last;
midIxV4_V_last =  -rand(1, p.midIxV4_Npop)*74;
midIxV4_V = zeros(nsamp,p.midIxV4_Npop);
midIxV4_V(1,:) = midIxV4_V_last;
midIxV4_iNa_m_last = p.midIxV4_iNa_m_IC+p.midIxV4_iNa_IC_noise*rand(1,p.midIxV4_Npop);
midIxV4_iNa_m = zeros(nsamp,p.midIxV4_Npop);
midIxV4_iNa_m(1,:) = midIxV4_iNa_m_last;
midIxV4_iNa_h_last = p.midIxV4_iNa_h_IC+p.midIxV4_iNa_IC_noise*rand(1,p.midIxV4_Npop);
midIxV4_iNa_h = zeros(nsamp,p.midIxV4_Npop);
midIxV4_iNa_h(1,:) = midIxV4_iNa_h_last;
midIxV4_iK_n_last = p.midIxV4_iK_n_IC+p.midIxV4_iK_IC_noise*rand(1,p.midIxV4_Npop);
midIxV4_iK_n = zeros(nsamp,p.midIxV4_Npop);
midIxV4_iK_n(1,:) = midIxV4_iK_n_last;
deepExV4_V_last =  -rand(1, p.deepExV4_Npop)*74;
deepExV4_V = zeros(nsamp,p.deepExV4_Npop);
deepExV4_V(1,:) = deepExV4_V_last;
deepExV4_iNa_m_last = p.deepExV4_iNa_m_IC+p.deepExV4_iNa_IC_noise*rand(1,p.deepExV4_Npop);
deepExV4_iNa_m = zeros(nsamp,p.deepExV4_Npop);
deepExV4_iNa_m(1,:) = deepExV4_iNa_m_last;
deepExV4_iNa_h_last = p.deepExV4_iNa_h_IC+p.deepExV4_iNa_IC_noise*rand(1,p.deepExV4_Npop);
deepExV4_iNa_h = zeros(nsamp,p.deepExV4_Npop);
deepExV4_iNa_h(1,:) = deepExV4_iNa_h_last;
deepExV4_iK_n_last = p.deepExV4_iK_n_IC+p.deepExV4_iK_IC_noise*rand(1,p.deepExV4_Npop);
deepExV4_iK_n = zeros(nsamp,p.deepExV4_Npop);
deepExV4_iK_n(1,:) = deepExV4_iK_n_last;
deepIxV4_V_last =  -rand(1, p.deepIxV4_Npop)*74;
deepIxV4_V = zeros(nsamp,p.deepIxV4_Npop);
deepIxV4_V(1,:) = deepIxV4_V_last;
deepIxV4_iNa_m_last = p.deepIxV4_iNa_m_IC+p.deepIxV4_iNa_IC_noise*rand(1,p.deepIxV4_Npop);
deepIxV4_iNa_m = zeros(nsamp,p.deepIxV4_Npop);
deepIxV4_iNa_m(1,:) = deepIxV4_iNa_m_last;
deepIxV4_iNa_h_last = p.deepIxV4_iNa_h_IC+p.deepIxV4_iNa_IC_noise*rand(1,p.deepIxV4_Npop);
deepIxV4_iNa_h = zeros(nsamp,p.deepIxV4_Npop);
deepIxV4_iNa_h(1,:) = deepIxV4_iNa_h_last;
deepIxV4_iK_n_last = p.deepIxV4_iK_n_IC+p.deepIxV4_iK_IC_noise*rand(1,p.deepIxV4_Npop);
deepIxV4_iK_n = zeros(nsamp,p.deepIxV4_Npop);
deepIxV4_iK_n(1,:) = deepIxV4_iK_n_last;
EAxV4_V_last =  -60 - rand(1, p.EAxV4_Npop)*17;
EAxV4_V = zeros(nsamp,p.EAxV4_Npop);
EAxV4_V(1,:) = EAxV4_V_last;
EAxV4_iNa_m_last = p.EAxV4_iNa_m_IC+p.EAxV4_iNa_IC_noise*rand(1,p.EAxV4_Npop);
EAxV4_iNa_m = zeros(nsamp,p.EAxV4_Npop);
EAxV4_iNa_m(1,:) = EAxV4_iNa_m_last;
EAxV4_iNa_h_last = p.EAxV4_iNa_h_IC+p.EAxV4_iNa_IC_noise*rand(1,p.EAxV4_Npop);
EAxV4_iNa_h = zeros(nsamp,p.EAxV4_Npop);
EAxV4_iNa_h(1,:) = EAxV4_iNa_h_last;
EAxV4_iK_n_last = p.EAxV4_iK_n_IC+p.EAxV4_iK_IC_noise*rand(1,p.EAxV4_Npop);
EAxV4_iK_n = zeros(nsamp,p.EAxV4_Npop);
EAxV4_iK_n(1,:) = EAxV4_iK_n_last;
IAxV4_V_last =  -60 - rand(1, p.IAxV4_Npop)*17;
IAxV4_V = zeros(nsamp,p.IAxV4_Npop);
IAxV4_V(1,:) = IAxV4_V_last;
IAxV4_iNa_m_last = p.IAxV4_iNa_m_IC+p.IAxV4_iNa_IC_noise*rand(1,p.IAxV4_Npop);
IAxV4_iNa_m = zeros(nsamp,p.IAxV4_Npop);
IAxV4_iNa_m(1,:) = IAxV4_iNa_m_last;
IAxV4_iNa_h_last = p.IAxV4_iNa_h_IC+p.IAxV4_iNa_IC_noise*rand(1,p.IAxV4_Npop);
IAxV4_iNa_h = zeros(nsamp,p.IAxV4_Npop);
IAxV4_iNa_h(1,:) = IAxV4_iNa_h_last;
IAxV4_iK_n_last = p.IAxV4_iK_n_IC+p.IAxV4_iK_IC_noise*rand(1,p.IAxV4_Npop);
IAxV4_iK_n = zeros(nsamp,p.IAxV4_Npop);
IAxV4_iK_n(1,:) = IAxV4_iK_n_last;
EBxV4_V_last =  -60 - rand(1, p.EBxV4_Npop)*17;
EBxV4_V = zeros(nsamp,p.EBxV4_Npop);
EBxV4_V(1,:) = EBxV4_V_last;
EBxV4_iNa_m_last = p.EBxV4_iNa_m_IC+p.EBxV4_iNa_IC_noise*rand(1,p.EBxV4_Npop);
EBxV4_iNa_m = zeros(nsamp,p.EBxV4_Npop);
EBxV4_iNa_m(1,:) = EBxV4_iNa_m_last;
EBxV4_iNa_h_last = p.EBxV4_iNa_h_IC+p.EBxV4_iNa_IC_noise*rand(1,p.EBxV4_Npop);
EBxV4_iNa_h = zeros(nsamp,p.EBxV4_Npop);
EBxV4_iNa_h(1,:) = EBxV4_iNa_h_last;
EBxV4_iK_n_last = p.EBxV4_iK_n_IC+p.EBxV4_iK_IC_noise*rand(1,p.EBxV4_Npop);
EBxV4_iK_n = zeros(nsamp,p.EBxV4_Npop);
EBxV4_iK_n(1,:) = EBxV4_iK_n_last;
IBxV4_V_last =  -60 - rand(1, p.IBxV4_Npop)*17;
IBxV4_V = zeros(nsamp,p.IBxV4_Npop);
IBxV4_V(1,:) = IBxV4_V_last;
IBxV4_iNa_m_last = p.IBxV4_iNa_m_IC+p.IBxV4_iNa_IC_noise*rand(1,p.IBxV4_Npop);
IBxV4_iNa_m = zeros(nsamp,p.IBxV4_Npop);
IBxV4_iNa_m(1,:) = IBxV4_iNa_m_last;
IBxV4_iNa_h_last = p.IBxV4_iNa_h_IC+p.IBxV4_iNa_IC_noise*rand(1,p.IBxV4_Npop);
IBxV4_iNa_h = zeros(nsamp,p.IBxV4_Npop);
IBxV4_iNa_h(1,:) = IBxV4_iNa_h_last;
IBxV4_iK_n_last = p.IBxV4_iK_n_IC+p.IBxV4_iK_IC_noise*rand(1,p.IBxV4_Npop);
IBxV4_iK_n = zeros(nsamp,p.IBxV4_Npop);
IBxV4_iK_n(1,:) = IBxV4_iK_n_last;
ECxV4_V_last =  -60 - rand(1, p.ECxV4_Npop)*17;
ECxV4_V = zeros(nsamp,p.ECxV4_Npop);
ECxV4_V(1,:) = ECxV4_V_last;
ECxV4_iNa_m_last = p.ECxV4_iNa_m_IC+p.ECxV4_iNa_IC_noise*rand(1,p.ECxV4_Npop);
ECxV4_iNa_m = zeros(nsamp,p.ECxV4_Npop);
ECxV4_iNa_m(1,:) = ECxV4_iNa_m_last;
ECxV4_iNa_h_last = p.ECxV4_iNa_h_IC+p.ECxV4_iNa_IC_noise*rand(1,p.ECxV4_Npop);
ECxV4_iNa_h = zeros(nsamp,p.ECxV4_Npop);
ECxV4_iNa_h(1,:) = ECxV4_iNa_h_last;
ECxV4_iK_n_last = p.ECxV4_iK_n_IC+p.ECxV4_iK_IC_noise*rand(1,p.ECxV4_Npop);
ECxV4_iK_n = zeros(nsamp,p.ECxV4_Npop);
ECxV4_iK_n(1,:) = ECxV4_iK_n_last;
ICxV4_V_last =  -60 - rand(1, p.ICxV4_Npop)*17;
ICxV4_V = zeros(nsamp,p.ICxV4_Npop);
ICxV4_V(1,:) = ICxV4_V_last;
ICxV4_iNa_m_last = p.ICxV4_iNa_m_IC+p.ICxV4_iNa_IC_noise*rand(1,p.ICxV4_Npop);
ICxV4_iNa_m = zeros(nsamp,p.ICxV4_Npop);
ICxV4_iNa_m(1,:) = ICxV4_iNa_m_last;
ICxV4_iNa_h_last = p.ICxV4_iNa_h_IC+p.ICxV4_iNa_IC_noise*rand(1,p.ICxV4_Npop);
ICxV4_iNa_h = zeros(nsamp,p.ICxV4_Npop);
ICxV4_iNa_h(1,:) = ICxV4_iNa_h_last;
ICxV4_iK_n_last = p.ICxV4_iK_n_IC+p.ICxV4_iK_IC_noise*rand(1,p.ICxV4_Npop);
ICxV4_iK_n = zeros(nsamp,p.ICxV4_Npop);
ICxV4_iK_n(1,:) = ICxV4_iK_n_last;
supExPFC_V_last =  -rand(1, p.supExPFC_Npop)*74;
supExPFC_V = zeros(nsamp,p.supExPFC_Npop);
supExPFC_V(1,:) = supExPFC_V_last;
supExPFC_iNa_m_last = p.supExPFC_iNa_m_IC+p.supExPFC_iNa_IC_noise*rand(1,p.supExPFC_Npop);
supExPFC_iNa_m = zeros(nsamp,p.supExPFC_Npop);
supExPFC_iNa_m(1,:) = supExPFC_iNa_m_last;
supExPFC_iNa_h_last = p.supExPFC_iNa_h_IC+p.supExPFC_iNa_IC_noise*rand(1,p.supExPFC_Npop);
supExPFC_iNa_h = zeros(nsamp,p.supExPFC_Npop);
supExPFC_iNa_h(1,:) = supExPFC_iNa_h_last;
supExPFC_iK_n_last = p.supExPFC_iK_n_IC+p.supExPFC_iK_IC_noise*rand(1,p.supExPFC_Npop);
supExPFC_iK_n = zeros(nsamp,p.supExPFC_Npop);
supExPFC_iK_n(1,:) = supExPFC_iK_n_last;
supIxPFC_V_last =  -rand(1, p.supIxPFC_Npop)*74;
supIxPFC_V = zeros(nsamp,p.supIxPFC_Npop);
supIxPFC_V(1,:) = supIxPFC_V_last;
supIxPFC_iNa_m_last = p.supIxPFC_iNa_m_IC+p.supIxPFC_iNa_IC_noise*rand(1,p.supIxPFC_Npop);
supIxPFC_iNa_m = zeros(nsamp,p.supIxPFC_Npop);
supIxPFC_iNa_m(1,:) = supIxPFC_iNa_m_last;
supIxPFC_iNa_h_last = p.supIxPFC_iNa_h_IC+p.supIxPFC_iNa_IC_noise*rand(1,p.supIxPFC_Npop);
supIxPFC_iNa_h = zeros(nsamp,p.supIxPFC_Npop);
supIxPFC_iNa_h(1,:) = supIxPFC_iNa_h_last;
supIxPFC_iK_n_last = p.supIxPFC_iK_n_IC+p.supIxPFC_iK_IC_noise*rand(1,p.supIxPFC_Npop);
supIxPFC_iK_n = zeros(nsamp,p.supIxPFC_Npop);
supIxPFC_iK_n(1,:) = supIxPFC_iK_n_last;
midExPFC_V_last =  -rand(1, p.midExPFC_Npop)*74;
midExPFC_V = zeros(nsamp,p.midExPFC_Npop);
midExPFC_V(1,:) = midExPFC_V_last;
midExPFC_iNa_m_last = p.midExPFC_iNa_m_IC+p.midExPFC_iNa_IC_noise*rand(1,p.midExPFC_Npop);
midExPFC_iNa_m = zeros(nsamp,p.midExPFC_Npop);
midExPFC_iNa_m(1,:) = midExPFC_iNa_m_last;
midExPFC_iNa_h_last = p.midExPFC_iNa_h_IC+p.midExPFC_iNa_IC_noise*rand(1,p.midExPFC_Npop);
midExPFC_iNa_h = zeros(nsamp,p.midExPFC_Npop);
midExPFC_iNa_h(1,:) = midExPFC_iNa_h_last;
midExPFC_iK_n_last = p.midExPFC_iK_n_IC+p.midExPFC_iK_IC_noise*rand(1,p.midExPFC_Npop);
midExPFC_iK_n = zeros(nsamp,p.midExPFC_Npop);
midExPFC_iK_n(1,:) = midExPFC_iK_n_last;
midIxPFC_V_last =  -rand(1, p.midIxPFC_Npop)*74;
midIxPFC_V = zeros(nsamp,p.midIxPFC_Npop);
midIxPFC_V(1,:) = midIxPFC_V_last;
midIxPFC_iNa_m_last = p.midIxPFC_iNa_m_IC+p.midIxPFC_iNa_IC_noise*rand(1,p.midIxPFC_Npop);
midIxPFC_iNa_m = zeros(nsamp,p.midIxPFC_Npop);
midIxPFC_iNa_m(1,:) = midIxPFC_iNa_m_last;
midIxPFC_iNa_h_last = p.midIxPFC_iNa_h_IC+p.midIxPFC_iNa_IC_noise*rand(1,p.midIxPFC_Npop);
midIxPFC_iNa_h = zeros(nsamp,p.midIxPFC_Npop);
midIxPFC_iNa_h(1,:) = midIxPFC_iNa_h_last;
midIxPFC_iK_n_last = p.midIxPFC_iK_n_IC+p.midIxPFC_iK_IC_noise*rand(1,p.midIxPFC_Npop);
midIxPFC_iK_n = zeros(nsamp,p.midIxPFC_Npop);
midIxPFC_iK_n(1,:) = midIxPFC_iK_n_last;
deepExPFC_V_last =  -rand(1, p.deepExPFC_Npop)*74;
deepExPFC_V = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_V(1,:) = deepExPFC_V_last;
deepExPFC_iNa_m_last = p.deepExPFC_iNa_m_IC+p.deepExPFC_iNa_IC_noise*rand(1,p.deepExPFC_Npop);
deepExPFC_iNa_m = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_iNa_m(1,:) = deepExPFC_iNa_m_last;
deepExPFC_iNa_h_last = p.deepExPFC_iNa_h_IC+p.deepExPFC_iNa_IC_noise*rand(1,p.deepExPFC_Npop);
deepExPFC_iNa_h = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_iNa_h(1,:) = deepExPFC_iNa_h_last;
deepExPFC_iK_n_last = p.deepExPFC_iK_n_IC+p.deepExPFC_iK_IC_noise*rand(1,p.deepExPFC_Npop);
deepExPFC_iK_n = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_iK_n(1,:) = deepExPFC_iK_n_last;
deepIxPFC_V_last =  -rand(1, p.deepIxPFC_Npop)*74;
deepIxPFC_V = zeros(nsamp,p.deepIxPFC_Npop);
deepIxPFC_V(1,:) = deepIxPFC_V_last;
deepIxPFC_iNa_m_last = p.deepIxPFC_iNa_m_IC+p.deepIxPFC_iNa_IC_noise*rand(1,p.deepIxPFC_Npop);
deepIxPFC_iNa_m = zeros(nsamp,p.deepIxPFC_Npop);
deepIxPFC_iNa_m(1,:) = deepIxPFC_iNa_m_last;
deepIxPFC_iNa_h_last = p.deepIxPFC_iNa_h_IC+p.deepIxPFC_iNa_IC_noise*rand(1,p.deepIxPFC_Npop);
deepIxPFC_iNa_h = zeros(nsamp,p.deepIxPFC_Npop);
deepIxPFC_iNa_h(1,:) = deepIxPFC_iNa_h_last;
deepIxPFC_iK_n_last = p.deepIxPFC_iK_n_IC+p.deepIxPFC_iK_IC_noise*rand(1,p.deepIxPFC_Npop);
deepIxPFC_iK_n = zeros(nsamp,p.deepIxPFC_Npop);
deepIxPFC_iK_n(1,:) = deepIxPFC_iK_n_last;
EAxPFC_V_last =  -60 - rand(1, p.EAxPFC_Npop)*17;
EAxPFC_V = zeros(nsamp,p.EAxPFC_Npop);
EAxPFC_V(1,:) = EAxPFC_V_last;
EAxPFC_iNa_m_last = p.EAxPFC_iNa_m_IC+p.EAxPFC_iNa_IC_noise*rand(1,p.EAxPFC_Npop);
EAxPFC_iNa_m = zeros(nsamp,p.EAxPFC_Npop);
EAxPFC_iNa_m(1,:) = EAxPFC_iNa_m_last;
EAxPFC_iNa_h_last = p.EAxPFC_iNa_h_IC+p.EAxPFC_iNa_IC_noise*rand(1,p.EAxPFC_Npop);
EAxPFC_iNa_h = zeros(nsamp,p.EAxPFC_Npop);
EAxPFC_iNa_h(1,:) = EAxPFC_iNa_h_last;
EAxPFC_iK_n_last = p.EAxPFC_iK_n_IC+p.EAxPFC_iK_IC_noise*rand(1,p.EAxPFC_Npop);
EAxPFC_iK_n = zeros(nsamp,p.EAxPFC_Npop);
EAxPFC_iK_n(1,:) = EAxPFC_iK_n_last;
IAxPFC_V_last =  -60 - rand(1, p.IAxPFC_Npop)*17;
IAxPFC_V = zeros(nsamp,p.IAxPFC_Npop);
IAxPFC_V(1,:) = IAxPFC_V_last;
IAxPFC_iNa_m_last = p.IAxPFC_iNa_m_IC+p.IAxPFC_iNa_IC_noise*rand(1,p.IAxPFC_Npop);
IAxPFC_iNa_m = zeros(nsamp,p.IAxPFC_Npop);
IAxPFC_iNa_m(1,:) = IAxPFC_iNa_m_last;
IAxPFC_iNa_h_last = p.IAxPFC_iNa_h_IC+p.IAxPFC_iNa_IC_noise*rand(1,p.IAxPFC_Npop);
IAxPFC_iNa_h = zeros(nsamp,p.IAxPFC_Npop);
IAxPFC_iNa_h(1,:) = IAxPFC_iNa_h_last;
IAxPFC_iK_n_last = p.IAxPFC_iK_n_IC+p.IAxPFC_iK_IC_noise*rand(1,p.IAxPFC_Npop);
IAxPFC_iK_n = zeros(nsamp,p.IAxPFC_Npop);
IAxPFC_iK_n(1,:) = IAxPFC_iK_n_last;
EBxPFC_V_last =  -60 - rand(1, p.EBxPFC_Npop)*17;
EBxPFC_V = zeros(nsamp,p.EBxPFC_Npop);
EBxPFC_V(1,:) = EBxPFC_V_last;
EBxPFC_iNa_m_last = p.EBxPFC_iNa_m_IC+p.EBxPFC_iNa_IC_noise*rand(1,p.EBxPFC_Npop);
EBxPFC_iNa_m = zeros(nsamp,p.EBxPFC_Npop);
EBxPFC_iNa_m(1,:) = EBxPFC_iNa_m_last;
EBxPFC_iNa_h_last = p.EBxPFC_iNa_h_IC+p.EBxPFC_iNa_IC_noise*rand(1,p.EBxPFC_Npop);
EBxPFC_iNa_h = zeros(nsamp,p.EBxPFC_Npop);
EBxPFC_iNa_h(1,:) = EBxPFC_iNa_h_last;
EBxPFC_iK_n_last = p.EBxPFC_iK_n_IC+p.EBxPFC_iK_IC_noise*rand(1,p.EBxPFC_Npop);
EBxPFC_iK_n = zeros(nsamp,p.EBxPFC_Npop);
EBxPFC_iK_n(1,:) = EBxPFC_iK_n_last;
IBxPFC_V_last =  -60 - rand(1, p.IBxPFC_Npop)*17;
IBxPFC_V = zeros(nsamp,p.IBxPFC_Npop);
IBxPFC_V(1,:) = IBxPFC_V_last;
IBxPFC_iNa_m_last = p.IBxPFC_iNa_m_IC+p.IBxPFC_iNa_IC_noise*rand(1,p.IBxPFC_Npop);
IBxPFC_iNa_m = zeros(nsamp,p.IBxPFC_Npop);
IBxPFC_iNa_m(1,:) = IBxPFC_iNa_m_last;
IBxPFC_iNa_h_last = p.IBxPFC_iNa_h_IC+p.IBxPFC_iNa_IC_noise*rand(1,p.IBxPFC_Npop);
IBxPFC_iNa_h = zeros(nsamp,p.IBxPFC_Npop);
IBxPFC_iNa_h(1,:) = IBxPFC_iNa_h_last;
IBxPFC_iK_n_last = p.IBxPFC_iK_n_IC+p.IBxPFC_iK_IC_noise*rand(1,p.IBxPFC_Npop);
IBxPFC_iK_n = zeros(nsamp,p.IBxPFC_Npop);
IBxPFC_iK_n(1,:) = IBxPFC_iK_n_last;
ECxPFC_V_last =  -60 - rand(1, p.ECxPFC_Npop)*17;
ECxPFC_V = zeros(nsamp,p.ECxPFC_Npop);
ECxPFC_V(1,:) = ECxPFC_V_last;
ECxPFC_iNa_m_last = p.ECxPFC_iNa_m_IC+p.ECxPFC_iNa_IC_noise*rand(1,p.ECxPFC_Npop);
ECxPFC_iNa_m = zeros(nsamp,p.ECxPFC_Npop);
ECxPFC_iNa_m(1,:) = ECxPFC_iNa_m_last;
ECxPFC_iNa_h_last = p.ECxPFC_iNa_h_IC+p.ECxPFC_iNa_IC_noise*rand(1,p.ECxPFC_Npop);
ECxPFC_iNa_h = zeros(nsamp,p.ECxPFC_Npop);
ECxPFC_iNa_h(1,:) = ECxPFC_iNa_h_last;
ECxPFC_iK_n_last = p.ECxPFC_iK_n_IC+p.ECxPFC_iK_IC_noise*rand(1,p.ECxPFC_Npop);
ECxPFC_iK_n = zeros(nsamp,p.ECxPFC_Npop);
ECxPFC_iK_n(1,:) = ECxPFC_iK_n_last;
ICxPFC_V_last =  -60 - rand(1, p.ICxPFC_Npop)*17;
ICxPFC_V = zeros(nsamp,p.ICxPFC_Npop);
ICxPFC_V(1,:) = ICxPFC_V_last;
ICxPFC_iNa_m_last = p.ICxPFC_iNa_m_IC+p.ICxPFC_iNa_IC_noise*rand(1,p.ICxPFC_Npop);
ICxPFC_iNa_m = zeros(nsamp,p.ICxPFC_Npop);
ICxPFC_iNa_m(1,:) = ICxPFC_iNa_m_last;
ICxPFC_iNa_h_last = p.ICxPFC_iNa_h_IC+p.ICxPFC_iNa_IC_noise*rand(1,p.ICxPFC_Npop);
ICxPFC_iNa_h = zeros(nsamp,p.ICxPFC_Npop);
ICxPFC_iNa_h(1,:) = ICxPFC_iNa_h_last;
ICxPFC_iK_n_last = p.ICxPFC_iK_n_IC+p.ICxPFC_iK_IC_noise*rand(1,p.ICxPFC_Npop);
ICxPFC_iK_n = zeros(nsamp,p.ICxPFC_Npop);
ICxPFC_iK_n(1,:) = ICxPFC_iK_n_last;
supIxV4_supExV4_iAMPActx_s_last =  p.supIxV4_supExV4_iAMPActx_IC+p.supIxV4_supExV4_iAMPActx_IC_noise.*rand(1,p.supExV4_Npop);
supIxV4_supExV4_iAMPActx_s = zeros(nsamp,p.supExV4_Npop);
supIxV4_supExV4_iAMPActx_s(1,:) = supIxV4_supExV4_iAMPActx_s_last;
supExV4_supExV4_iAMPActx_s_last =  p.supExV4_supExV4_iAMPActx_IC+p.supExV4_supExV4_iAMPActx_IC_noise.*rand(1,p.supExV4_Npop);
supExV4_supExV4_iAMPActx_s = zeros(nsamp,p.supExV4_Npop);
supExV4_supExV4_iAMPActx_s(1,:) = supExV4_supExV4_iAMPActx_s_last;
supExV4_supIxV4_iGABActx_s_last =  p.supExV4_supIxV4_iGABActx_IC+p.supExV4_supIxV4_iGABActx_IC_noise.*rand(1,p.supIxV4_Npop);
supExV4_supIxV4_iGABActx_s = zeros(nsamp,p.supIxV4_Npop);
supExV4_supIxV4_iGABActx_s(1,:) = supExV4_supIxV4_iGABActx_s_last;
supIxV4_supIxV4_iGABActx_s_last =  p.supIxV4_supIxV4_iGABActx_IC+p.supIxV4_supIxV4_iGABActx_IC_noise.*rand(1,p.supIxV4_Npop);
supIxV4_supIxV4_iGABActx_s = zeros(nsamp,p.supIxV4_Npop);
supIxV4_supIxV4_iGABActx_s(1,:) = supIxV4_supIxV4_iGABActx_s_last;
midIxV4_midExV4_iAMPActx_s_last =  p.midIxV4_midExV4_iAMPActx_IC+p.midIxV4_midExV4_iAMPActx_IC_noise.*rand(1,p.midExV4_Npop);
midIxV4_midExV4_iAMPActx_s = zeros(nsamp,p.midExV4_Npop);
midIxV4_midExV4_iAMPActx_s(1,:) = midIxV4_midExV4_iAMPActx_s_last;
midExV4_midExV4_iAMPActx_s_last =  p.midExV4_midExV4_iAMPActx_IC+p.midExV4_midExV4_iAMPActx_IC_noise.*rand(1,p.midExV4_Npop);
midExV4_midExV4_iAMPActx_s = zeros(nsamp,p.midExV4_Npop);
midExV4_midExV4_iAMPActx_s(1,:) = midExV4_midExV4_iAMPActx_s_last;
midExV4_midIxV4_iGABActx_s_last =  p.midExV4_midIxV4_iGABActx_IC+p.midExV4_midIxV4_iGABActx_IC_noise.*rand(1,p.midIxV4_Npop);
midExV4_midIxV4_iGABActx_s = zeros(nsamp,p.midIxV4_Npop);
midExV4_midIxV4_iGABActx_s(1,:) = midExV4_midIxV4_iGABActx_s_last;
midIxV4_midIxV4_iGABActx_s_last =  p.midIxV4_midIxV4_iGABActx_IC+p.midIxV4_midIxV4_iGABActx_IC_noise.*rand(1,p.midIxV4_Npop);
midIxV4_midIxV4_iGABActx_s = zeros(nsamp,p.midIxV4_Npop);
midIxV4_midIxV4_iGABActx_s(1,:) = midIxV4_midIxV4_iGABActx_s_last;
deepIxV4_deepExV4_iAMPActx_s_last =  p.deepIxV4_deepExV4_iAMPActx_IC+p.deepIxV4_deepExV4_iAMPActx_IC_noise.*rand(1,p.deepExV4_Npop);
deepIxV4_deepExV4_iAMPActx_s = zeros(nsamp,p.deepExV4_Npop);
deepIxV4_deepExV4_iAMPActx_s(1,:) = deepIxV4_deepExV4_iAMPActx_s_last;
deepExV4_deepExV4_iAMPActx_s_last =  p.deepExV4_deepExV4_iAMPActx_IC+p.deepExV4_deepExV4_iAMPActx_IC_noise.*rand(1,p.deepExV4_Npop);
deepExV4_deepExV4_iAMPActx_s = zeros(nsamp,p.deepExV4_Npop);
deepExV4_deepExV4_iAMPActx_s(1,:) = deepExV4_deepExV4_iAMPActx_s_last;
deepExV4_deepIxV4_iGABActx_s_last =  p.deepExV4_deepIxV4_iGABActx_IC+p.deepExV4_deepIxV4_iGABActx_IC_noise.*rand(1,p.deepIxV4_Npop);
deepExV4_deepIxV4_iGABActx_s = zeros(nsamp,p.deepIxV4_Npop);
deepExV4_deepIxV4_iGABActx_s(1,:) = deepExV4_deepIxV4_iGABActx_s_last;
deepIxV4_deepIxV4_iGABActx_s_last =  p.deepIxV4_deepIxV4_iGABActx_IC+p.deepIxV4_deepIxV4_iGABActx_IC_noise.*rand(1,p.deepIxV4_Npop);
deepIxV4_deepIxV4_iGABActx_s = zeros(nsamp,p.deepIxV4_Npop);
deepIxV4_deepIxV4_iGABActx_s(1,:) = deepIxV4_deepIxV4_iGABActx_s_last;
supExV4_midExV4_iAMPActx_s_last =  p.supExV4_midExV4_iAMPActx_IC+p.supExV4_midExV4_iAMPActx_IC_noise.*rand(1,p.midExV4_Npop);
supExV4_midExV4_iAMPActx_s = zeros(nsamp,p.midExV4_Npop);
supExV4_midExV4_iAMPActx_s(1,:) = supExV4_midExV4_iAMPActx_s_last;
deepExV4_midExV4_iAMPActx_s_last =  p.deepExV4_midExV4_iAMPActx_IC+p.deepExV4_midExV4_iAMPActx_IC_noise.*rand(1,p.midExV4_Npop);
deepExV4_midExV4_iAMPActx_s = zeros(nsamp,p.midExV4_Npop);
deepExV4_midExV4_iAMPActx_s(1,:) = deepExV4_midExV4_iAMPActx_s_last;
deepExV4_midIxV4_iGABActx_s_last =  p.deepExV4_midIxV4_iGABActx_IC+p.deepExV4_midIxV4_iGABActx_IC_noise.*rand(1,p.midIxV4_Npop);
deepExV4_midIxV4_iGABActx_s = zeros(nsamp,p.midIxV4_Npop);
deepExV4_midIxV4_iGABActx_s(1,:) = deepExV4_midIxV4_iGABActx_s_last;
deepExV4_supExV4_iAMPActx_s_last =  p.deepExV4_supExV4_iAMPActx_IC+p.deepExV4_supExV4_iAMPActx_IC_noise.*rand(1,p.supExV4_Npop);
deepExV4_supExV4_iAMPActx_s = zeros(nsamp,p.supExV4_Npop);
deepExV4_supExV4_iAMPActx_s(1,:) = deepExV4_supExV4_iAMPActx_s_last;
supIxPFC_supExPFC_iAMPActx_s_last =  p.supIxPFC_supExPFC_iAMPActx_IC+p.supIxPFC_supExPFC_iAMPActx_IC_noise.*rand(1,p.supExPFC_Npop);
supIxPFC_supExPFC_iAMPActx_s = zeros(nsamp,p.supExPFC_Npop);
supIxPFC_supExPFC_iAMPActx_s(1,:) = supIxPFC_supExPFC_iAMPActx_s_last;
supExPFC_supExPFC_iAMPActx_s_last =  p.supExPFC_supExPFC_iAMPActx_IC+p.supExPFC_supExPFC_iAMPActx_IC_noise.*rand(1,p.supExPFC_Npop);
supExPFC_supExPFC_iAMPActx_s = zeros(nsamp,p.supExPFC_Npop);
supExPFC_supExPFC_iAMPActx_s(1,:) = supExPFC_supExPFC_iAMPActx_s_last;
supExPFC_supIxPFC_iGABActx_s_last =  p.supExPFC_supIxPFC_iGABActx_IC+p.supExPFC_supIxPFC_iGABActx_IC_noise.*rand(1,p.supIxPFC_Npop);
supExPFC_supIxPFC_iGABActx_s = zeros(nsamp,p.supIxPFC_Npop);
supExPFC_supIxPFC_iGABActx_s(1,:) = supExPFC_supIxPFC_iGABActx_s_last;
supIxPFC_supIxPFC_iGABActx_s_last =  p.supIxPFC_supIxPFC_iGABActx_IC+p.supIxPFC_supIxPFC_iGABActx_IC_noise.*rand(1,p.supIxPFC_Npop);
supIxPFC_supIxPFC_iGABActx_s = zeros(nsamp,p.supIxPFC_Npop);
supIxPFC_supIxPFC_iGABActx_s(1,:) = supIxPFC_supIxPFC_iGABActx_s_last;
midIxPFC_midExPFC_iAMPActx_s_last =  p.midIxPFC_midExPFC_iAMPActx_IC+p.midIxPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
midIxPFC_midExPFC_iAMPActx_s = zeros(nsamp,p.midExPFC_Npop);
midIxPFC_midExPFC_iAMPActx_s(1,:) = midIxPFC_midExPFC_iAMPActx_s_last;
midExPFC_midExPFC_iAMPActx_s_last =  p.midExPFC_midExPFC_iAMPActx_IC+p.midExPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
midExPFC_midExPFC_iAMPActx_s = zeros(nsamp,p.midExPFC_Npop);
midExPFC_midExPFC_iAMPActx_s(1,:) = midExPFC_midExPFC_iAMPActx_s_last;
midExPFC_midIxPFC_iGABActx_s_last =  p.midExPFC_midIxPFC_iGABActx_IC+p.midExPFC_midIxPFC_iGABActx_IC_noise.*rand(1,p.midIxPFC_Npop);
midExPFC_midIxPFC_iGABActx_s = zeros(nsamp,p.midIxPFC_Npop);
midExPFC_midIxPFC_iGABActx_s(1,:) = midExPFC_midIxPFC_iGABActx_s_last;
midIxPFC_midIxPFC_iGABActx_s_last =  p.midIxPFC_midIxPFC_iGABActx_IC+p.midIxPFC_midIxPFC_iGABActx_IC_noise.*rand(1,p.midIxPFC_Npop);
midIxPFC_midIxPFC_iGABActx_s = zeros(nsamp,p.midIxPFC_Npop);
midIxPFC_midIxPFC_iGABActx_s(1,:) = midIxPFC_midIxPFC_iGABActx_s_last;
deepIxPFC_deepExPFC_iAMPActx_s_last =  p.deepIxPFC_deepExPFC_iAMPActx_IC+p.deepIxPFC_deepExPFC_iAMPActx_IC_noise.*rand(1,p.deepExPFC_Npop);
deepIxPFC_deepExPFC_iAMPActx_s = zeros(nsamp,p.deepExPFC_Npop);
deepIxPFC_deepExPFC_iAMPActx_s(1,:) = deepIxPFC_deepExPFC_iAMPActx_s_last;
deepExPFC_deepExPFC_iAMPActx_s_last =  p.deepExPFC_deepExPFC_iAMPActx_IC+p.deepExPFC_deepExPFC_iAMPActx_IC_noise.*rand(1,p.deepExPFC_Npop);
deepExPFC_deepExPFC_iAMPActx_s = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_deepExPFC_iAMPActx_s(1,:) = deepExPFC_deepExPFC_iAMPActx_s_last;
deepExPFC_deepIxPFC_iGABActx_s_last =  p.deepExPFC_deepIxPFC_iGABActx_IC+p.deepExPFC_deepIxPFC_iGABActx_IC_noise.*rand(1,p.deepIxPFC_Npop);
deepExPFC_deepIxPFC_iGABActx_s = zeros(nsamp,p.deepIxPFC_Npop);
deepExPFC_deepIxPFC_iGABActx_s(1,:) = deepExPFC_deepIxPFC_iGABActx_s_last;
deepIxPFC_deepIxPFC_iGABActx_s_last =  p.deepIxPFC_deepIxPFC_iGABActx_IC+p.deepIxPFC_deepIxPFC_iGABActx_IC_noise.*rand(1,p.deepIxPFC_Npop);
deepIxPFC_deepIxPFC_iGABActx_s = zeros(nsamp,p.deepIxPFC_Npop);
deepIxPFC_deepIxPFC_iGABActx_s(1,:) = deepIxPFC_deepIxPFC_iGABActx_s_last;
supExPFC_midExPFC_iAMPActx_s_last =  p.supExPFC_midExPFC_iAMPActx_IC+p.supExPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
supExPFC_midExPFC_iAMPActx_s = zeros(nsamp,p.midExPFC_Npop);
supExPFC_midExPFC_iAMPActx_s(1,:) = supExPFC_midExPFC_iAMPActx_s_last;
deepExPFC_midExPFC_iAMPActx_s_last =  p.deepExPFC_midExPFC_iAMPActx_IC+p.deepExPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
deepExPFC_midExPFC_iAMPActx_s = zeros(nsamp,p.midExPFC_Npop);
deepExPFC_midExPFC_iAMPActx_s(1,:) = deepExPFC_midExPFC_iAMPActx_s_last;
deepExPFC_midIxPFC_iGABActx_s_last =  p.deepExPFC_midIxPFC_iGABActx_IC+p.deepExPFC_midIxPFC_iGABActx_IC_noise.*rand(1,p.midIxPFC_Npop);
deepExPFC_midIxPFC_iGABActx_s = zeros(nsamp,p.midIxPFC_Npop);
deepExPFC_midIxPFC_iGABActx_s(1,:) = deepExPFC_midIxPFC_iGABActx_s_last;
deepExPFC_supExPFC_iAMPActx_s_last =  p.deepExPFC_supExPFC_iAMPActx_IC+p.deepExPFC_supExPFC_iAMPActx_IC_noise.*rand(1,p.supExPFC_Npop);
deepExPFC_supExPFC_iAMPActx_s = zeros(nsamp,p.supExPFC_Npop);
deepExPFC_supExPFC_iAMPActx_s(1,:) = deepExPFC_supExPFC_iAMPActx_s_last;

% MONITORS:
supExV4_ctx_iPoisson_g_poisson = zeros(nsamp,p.supExV4_Npop);
supExV4_ctx_iPoisson_g_poisson(1,:)=p.supExV4_ctx_iPoisson_g_poisson.*supExV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
supExV4_ctx_iPoisson_I_poisson = zeros(nsamp,p.supExV4_Npop);
supExV4_ctx_iPoisson_I_poisson(1,:)=-((p.supExV4_ctx_iPoisson_g_poisson.*supExV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(supExV4_V_last-p.supExV4_ctx_iPoisson_E_poisson);
supIxV4_ctx_iPoisson_g_poisson = zeros(nsamp,p.supIxV4_Npop);
supIxV4_ctx_iPoisson_g_poisson(1,:)=p.supIxV4_ctx_iPoisson_g_poisson.*supIxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
supIxV4_ctx_iPoisson_I_poisson = zeros(nsamp,p.supIxV4_Npop);
supIxV4_ctx_iPoisson_I_poisson(1,:)=-((p.supIxV4_ctx_iPoisson_g_poisson.*supIxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(supIxV4_V_last-p.supIxV4_ctx_iPoisson_E_poisson);
midExV4_ctx_iPoisson_g_poisson = zeros(nsamp,p.midExV4_Npop);
midExV4_ctx_iPoisson_g_poisson(1,:)=p.midExV4_ctx_iPoisson_g_poisson.*midExV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
midExV4_ctx_iPoisson_I_poisson = zeros(nsamp,p.midExV4_Npop);
midExV4_ctx_iPoisson_I_poisson(1,:)=-((p.midExV4_ctx_iPoisson_g_poisson.*midExV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(midExV4_V_last-p.midExV4_ctx_iPoisson_E_poisson);
midIxV4_ctx_iPoisson_g_poisson = zeros(nsamp,p.midIxV4_Npop);
midIxV4_ctx_iPoisson_g_poisson(1,:)=p.midIxV4_ctx_iPoisson_g_poisson.*midIxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
midIxV4_ctx_iPoisson_I_poisson = zeros(nsamp,p.midIxV4_Npop);
midIxV4_ctx_iPoisson_I_poisson(1,:)=-((p.midIxV4_ctx_iPoisson_g_poisson.*midIxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(midIxV4_V_last-p.midIxV4_ctx_iPoisson_E_poisson);
deepExV4_ctx_iPoisson_g_poisson = zeros(nsamp,p.deepExV4_Npop);
deepExV4_ctx_iPoisson_g_poisson(1,:)=p.deepExV4_ctx_iPoisson_g_poisson.*deepExV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
deepExV4_ctx_iPoisson_I_poisson = zeros(nsamp,p.deepExV4_Npop);
deepExV4_ctx_iPoisson_I_poisson(1,:)=-((p.deepExV4_ctx_iPoisson_g_poisson.*deepExV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(deepExV4_V_last-p.deepExV4_ctx_iPoisson_E_poisson);
deepIxV4_ctx_iPoisson_g_poisson = zeros(nsamp,p.deepIxV4_Npop);
deepIxV4_ctx_iPoisson_g_poisson(1,:)=p.deepIxV4_ctx_iPoisson_g_poisson.*deepIxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
deepIxV4_ctx_iPoisson_I_poisson = zeros(nsamp,p.deepIxV4_Npop);
deepIxV4_ctx_iPoisson_I_poisson(1,:)=-((p.deepIxV4_ctx_iPoisson_g_poisson.*deepIxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(deepIxV4_V_last-p.deepIxV4_ctx_iPoisson_E_poisson);
EAxV4_ctx_iPoisson_g_poisson = zeros(nsamp,p.EAxV4_Npop);
EAxV4_ctx_iPoisson_g_poisson(1,:)=p.EAxV4_ctx_iPoisson_g_poisson.*EAxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
EAxV4_ctx_iPoisson_I_poisson = zeros(nsamp,p.EAxV4_Npop);
EAxV4_ctx_iPoisson_I_poisson(1,:)=-((p.EAxV4_ctx_iPoisson_g_poisson.*EAxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(EAxV4_V_last-p.EAxV4_ctx_iPoisson_E_poisson);
IAxV4_ctx_iPoisson_g_poisson = zeros(nsamp,p.IAxV4_Npop);
IAxV4_ctx_iPoisson_g_poisson(1,:)=p.IAxV4_ctx_iPoisson_g_poisson.*IAxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
IAxV4_ctx_iPoisson_I_poisson = zeros(nsamp,p.IAxV4_Npop);
IAxV4_ctx_iPoisson_I_poisson(1,:)=-((p.IAxV4_ctx_iPoisson_g_poisson.*IAxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(IAxV4_V_last-p.IAxV4_ctx_iPoisson_E_poisson);
EBxV4_ctx_iPoisson_g_poisson = zeros(nsamp,p.EBxV4_Npop);
EBxV4_ctx_iPoisson_g_poisson(1,:)=p.EBxV4_ctx_iPoisson_g_poisson.*EBxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
EBxV4_ctx_iPoisson_I_poisson = zeros(nsamp,p.EBxV4_Npop);
EBxV4_ctx_iPoisson_I_poisson(1,:)=-((p.EBxV4_ctx_iPoisson_g_poisson.*EBxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(EBxV4_V_last-p.EBxV4_ctx_iPoisson_E_poisson);
IBxV4_ctx_iPoisson_g_poisson = zeros(nsamp,p.IBxV4_Npop);
IBxV4_ctx_iPoisson_g_poisson(1,:)=p.IBxV4_ctx_iPoisson_g_poisson.*IBxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
IBxV4_ctx_iPoisson_I_poisson = zeros(nsamp,p.IBxV4_Npop);
IBxV4_ctx_iPoisson_I_poisson(1,:)=-((p.IBxV4_ctx_iPoisson_g_poisson.*IBxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(IBxV4_V_last-p.IBxV4_ctx_iPoisson_E_poisson);
ECxV4_ctx_iPoisson_g_poisson = zeros(nsamp,p.ECxV4_Npop);
ECxV4_ctx_iPoisson_g_poisson(1,:)=p.ECxV4_ctx_iPoisson_g_poisson.*ECxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
ECxV4_ctx_iPoisson_I_poisson = zeros(nsamp,p.ECxV4_Npop);
ECxV4_ctx_iPoisson_I_poisson(1,:)=-((p.ECxV4_ctx_iPoisson_g_poisson.*ECxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(ECxV4_V_last-p.ECxV4_ctx_iPoisson_E_poisson);
ICxV4_ctx_iPoisson_g_poisson = zeros(nsamp,p.ICxV4_Npop);
ICxV4_ctx_iPoisson_g_poisson(1,:)=p.ICxV4_ctx_iPoisson_g_poisson.*ICxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
ICxV4_ctx_iPoisson_I_poisson = zeros(nsamp,p.ICxV4_Npop);
ICxV4_ctx_iPoisson_I_poisson(1,:)=-((p.ICxV4_ctx_iPoisson_g_poisson.*ICxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(ICxV4_V_last-p.ICxV4_ctx_iPoisson_E_poisson);
supExPFC_ctx_iPoisson_g_poisson = zeros(nsamp,p.supExPFC_Npop);
supExPFC_ctx_iPoisson_g_poisson(1,:)=p.supExPFC_ctx_iPoisson_g_poisson.*supExPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
supExPFC_ctx_iPoisson_I_poisson = zeros(nsamp,p.supExPFC_Npop);
supExPFC_ctx_iPoisson_I_poisson(1,:)=-((p.supExPFC_ctx_iPoisson_g_poisson.*supExPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(supExPFC_V_last-p.supExPFC_ctx_iPoisson_E_poisson);
supIxPFC_ctx_iPoisson_g_poisson = zeros(nsamp,p.supIxPFC_Npop);
supIxPFC_ctx_iPoisson_g_poisson(1,:)=p.supIxPFC_ctx_iPoisson_g_poisson.*supIxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
supIxPFC_ctx_iPoisson_I_poisson = zeros(nsamp,p.supIxPFC_Npop);
supIxPFC_ctx_iPoisson_I_poisson(1,:)=-((p.supIxPFC_ctx_iPoisson_g_poisson.*supIxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(supIxPFC_V_last-p.supIxPFC_ctx_iPoisson_E_poisson);
midExPFC_ctx_iPoisson_g_poisson = zeros(nsamp,p.midExPFC_Npop);
midExPFC_ctx_iPoisson_g_poisson(1,:)=p.midExPFC_ctx_iPoisson_g_poisson.*midExPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
midExPFC_ctx_iPoisson_I_poisson = zeros(nsamp,p.midExPFC_Npop);
midExPFC_ctx_iPoisson_I_poisson(1,:)=-((p.midExPFC_ctx_iPoisson_g_poisson.*midExPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(midExPFC_V_last-p.midExPFC_ctx_iPoisson_E_poisson);
midIxPFC_ctx_iPoisson_g_poisson = zeros(nsamp,p.midIxPFC_Npop);
midIxPFC_ctx_iPoisson_g_poisson(1,:)=p.midIxPFC_ctx_iPoisson_g_poisson.*midIxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
midIxPFC_ctx_iPoisson_I_poisson = zeros(nsamp,p.midIxPFC_Npop);
midIxPFC_ctx_iPoisson_I_poisson(1,:)=-((p.midIxPFC_ctx_iPoisson_g_poisson.*midIxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(midIxPFC_V_last-p.midIxPFC_ctx_iPoisson_E_poisson);
deepExPFC_ctx_iPoisson_g_poisson = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_ctx_iPoisson_g_poisson(1,:)=p.deepExPFC_ctx_iPoisson_g_poisson.*deepExPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
deepExPFC_ctx_iPoisson_I_poisson = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_ctx_iPoisson_I_poisson(1,:)=-((p.deepExPFC_ctx_iPoisson_g_poisson.*deepExPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(deepExPFC_V_last-p.deepExPFC_ctx_iPoisson_E_poisson);
deepIxPFC_ctx_iPoisson_g_poisson = zeros(nsamp,p.deepIxPFC_Npop);
deepIxPFC_ctx_iPoisson_g_poisson(1,:)=p.deepIxPFC_ctx_iPoisson_g_poisson.*deepIxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
deepIxPFC_ctx_iPoisson_I_poisson = zeros(nsamp,p.deepIxPFC_Npop);
deepIxPFC_ctx_iPoisson_I_poisson(1,:)=-((p.deepIxPFC_ctx_iPoisson_g_poisson.*deepIxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(deepIxPFC_V_last-p.deepIxPFC_ctx_iPoisson_E_poisson);
EAxPFC_ctx_iPoisson_g_poisson = zeros(nsamp,p.EAxPFC_Npop);
EAxPFC_ctx_iPoisson_g_poisson(1,:)=p.EAxPFC_ctx_iPoisson_g_poisson.*EAxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
EAxPFC_ctx_iPoisson_I_poisson = zeros(nsamp,p.EAxPFC_Npop);
EAxPFC_ctx_iPoisson_I_poisson(1,:)=-((p.EAxPFC_ctx_iPoisson_g_poisson.*EAxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(EAxPFC_V_last-p.EAxPFC_ctx_iPoisson_E_poisson);
IAxPFC_ctx_iPoisson_g_poisson = zeros(nsamp,p.IAxPFC_Npop);
IAxPFC_ctx_iPoisson_g_poisson(1,:)=p.IAxPFC_ctx_iPoisson_g_poisson.*IAxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
IAxPFC_ctx_iPoisson_I_poisson = zeros(nsamp,p.IAxPFC_Npop);
IAxPFC_ctx_iPoisson_I_poisson(1,:)=-((p.IAxPFC_ctx_iPoisson_g_poisson.*IAxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(IAxPFC_V_last-p.IAxPFC_ctx_iPoisson_E_poisson);
EBxPFC_ctx_iPoisson_g_poisson = zeros(nsamp,p.EBxPFC_Npop);
EBxPFC_ctx_iPoisson_g_poisson(1,:)=p.EBxPFC_ctx_iPoisson_g_poisson.*EBxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
EBxPFC_ctx_iPoisson_I_poisson = zeros(nsamp,p.EBxPFC_Npop);
EBxPFC_ctx_iPoisson_I_poisson(1,:)=-((p.EBxPFC_ctx_iPoisson_g_poisson.*EBxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(EBxPFC_V_last-p.EBxPFC_ctx_iPoisson_E_poisson);
IBxPFC_ctx_iPoisson_g_poisson = zeros(nsamp,p.IBxPFC_Npop);
IBxPFC_ctx_iPoisson_g_poisson(1,:)=p.IBxPFC_ctx_iPoisson_g_poisson.*IBxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
IBxPFC_ctx_iPoisson_I_poisson = zeros(nsamp,p.IBxPFC_Npop);
IBxPFC_ctx_iPoisson_I_poisson(1,:)=-((p.IBxPFC_ctx_iPoisson_g_poisson.*IBxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(IBxPFC_V_last-p.IBxPFC_ctx_iPoisson_E_poisson);
ECxPFC_ctx_iPoisson_g_poisson = zeros(nsamp,p.ECxPFC_Npop);
ECxPFC_ctx_iPoisson_g_poisson(1,:)=p.ECxPFC_ctx_iPoisson_g_poisson.*ECxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
ECxPFC_ctx_iPoisson_I_poisson = zeros(nsamp,p.ECxPFC_Npop);
ECxPFC_ctx_iPoisson_I_poisson(1,:)=-((p.ECxPFC_ctx_iPoisson_g_poisson.*ECxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(ECxPFC_V_last-p.ECxPFC_ctx_iPoisson_E_poisson);
ICxPFC_ctx_iPoisson_g_poisson = zeros(nsamp,p.ICxPFC_Npop);
ICxPFC_ctx_iPoisson_g_poisson(1,:)=p.ICxPFC_ctx_iPoisson_g_poisson.*ICxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
ICxPFC_ctx_iPoisson_I_poisson = zeros(nsamp,p.ICxPFC_Npop);
ICxPFC_ctx_iPoisson_I_poisson(1,:)=-((p.ICxPFC_ctx_iPoisson_g_poisson.*ICxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(ICxPFC_V_last-p.ICxPFC_ctx_iPoisson_E_poisson);
IAxV4_EAxV4_iPoisson_gPoisson = zeros(nsamp,p.IAxV4_Npop);
IAxV4_EAxV4_iPoisson_gPoisson(1,:)=p.IAxV4_EAxV4_iPoisson_gext.*IAxV4_EAxV4_iPoisson_s(k,:);
EAxV4_EAxV4_iPoisson_gPoisson = zeros(nsamp,p.EAxV4_Npop);
EAxV4_EAxV4_iPoisson_gPoisson(1,:)=p.EAxV4_EAxV4_iPoisson_gext.*EAxV4_EAxV4_iPoisson_s(k,:);
EAxV4_IAxV4_iPoisson_gPoisson = zeros(nsamp,p.EAxV4_Npop);
EAxV4_IAxV4_iPoisson_gPoisson(1,:)=p.EAxV4_IAxV4_iPoisson_gext.*EAxV4_IAxV4_iPoisson_s(k,:);
IAxV4_IAxV4_iPoisson_gPoisson = zeros(nsamp,p.IAxV4_Npop);
IAxV4_IAxV4_iPoisson_gPoisson(1,:)=p.IAxV4_IAxV4_iPoisson_gext.*IAxV4_IAxV4_iPoisson_s(k,:);
IBxV4_EBxV4_iPoisson_gPoisson = zeros(nsamp,p.IBxV4_Npop);
IBxV4_EBxV4_iPoisson_gPoisson(1,:)=p.IBxV4_EBxV4_iPoisson_gext.*IBxV4_EBxV4_iPoisson_s(k,:);
EBxV4_EBxV4_iPoisson_gPoisson = zeros(nsamp,p.EBxV4_Npop);
EBxV4_EBxV4_iPoisson_gPoisson(1,:)=p.EBxV4_EBxV4_iPoisson_gext.*EBxV4_EBxV4_iPoisson_s(k,:);
EBxV4_IBxV4_iPoisson_gPoisson = zeros(nsamp,p.EBxV4_Npop);
EBxV4_IBxV4_iPoisson_gPoisson(1,:)=p.EBxV4_IBxV4_iPoisson_gext.*EBxV4_IBxV4_iPoisson_s(k,:);
IBxV4_IBxV4_iPoisson_gPoisson = zeros(nsamp,p.IBxV4_Npop);
IBxV4_IBxV4_iPoisson_gPoisson(1,:)=p.IBxV4_IBxV4_iPoisson_gext.*IBxV4_IBxV4_iPoisson_s(k,:);
ICxV4_ECxV4_iPoisson_gPoisson = zeros(nsamp,p.ICxV4_Npop);
ICxV4_ECxV4_iPoisson_gPoisson(1,:)=p.ICxV4_ECxV4_iPoisson_gext.*ICxV4_ECxV4_iPoisson_s(k,:);
ECxV4_ECxV4_iPoisson_gPoisson = zeros(nsamp,p.ECxV4_Npop);
ECxV4_ECxV4_iPoisson_gPoisson(1,:)=p.ECxV4_ECxV4_iPoisson_gext.*ECxV4_ECxV4_iPoisson_s(k,:);
ECxV4_ICxV4_iPoisson_gPoisson = zeros(nsamp,p.ECxV4_Npop);
ECxV4_ICxV4_iPoisson_gPoisson(1,:)=p.ECxV4_ICxV4_iPoisson_gext.*ECxV4_ICxV4_iPoisson_s(k,:);
ICxV4_ICxV4_iPoisson_gPoisson = zeros(nsamp,p.ICxV4_Npop);
ICxV4_ICxV4_iPoisson_gPoisson(1,:)=p.ICxV4_ICxV4_iPoisson_gext.*ICxV4_ICxV4_iPoisson_s(k,:);
midExV4_EAxV4_iPoisson_gPoisson = zeros(nsamp,p.midExV4_Npop);
midExV4_EAxV4_iPoisson_gPoisson(1,:)=p.midExV4_EAxV4_iPoisson_gext.*midExV4_EAxV4_iPoisson_s(k,:);
midExV4_IAxV4_iPoisson_gPoisson = zeros(nsamp,p.midExV4_Npop);
midExV4_IAxV4_iPoisson_gPoisson(1,:)=p.midExV4_IAxV4_iPoisson_gext.*midExV4_IAxV4_iPoisson_s(k,:);
midExV4_EBxV4_iPoisson_gPoisson = zeros(nsamp,p.midExV4_Npop);
midExV4_EBxV4_iPoisson_gPoisson(1,:)=p.midExV4_EBxV4_iPoisson_gext.*midExV4_EBxV4_iPoisson_s(k,:);
midExV4_IBxV4_iPoisson_gPoisson = zeros(nsamp,p.midExV4_Npop);
midExV4_IBxV4_iPoisson_gPoisson(1,:)=p.midExV4_IBxV4_iPoisson_gext.*midExV4_IBxV4_iPoisson_s(k,:);
midExV4_ECxV4_iPoisson_gPoisson = zeros(nsamp,p.midExV4_Npop);
midExV4_ECxV4_iPoisson_gPoisson(1,:)=p.midExV4_ECxV4_iPoisson_gext.*midExV4_ECxV4_iPoisson_s(k,:);
midExV4_ICxV4_iPoisson_gPoisson = zeros(nsamp,p.midExV4_Npop);
midExV4_ICxV4_iPoisson_gPoisson(1,:)=p.midExV4_ICxV4_iPoisson_gext.*midExV4_ICxV4_iPoisson_s(k,:);
IAxPFC_EAxPFC_iPoisson_gPoisson = zeros(nsamp,p.IAxPFC_Npop);
IAxPFC_EAxPFC_iPoisson_gPoisson(1,:)=p.IAxPFC_EAxPFC_iPoisson_gext.*IAxPFC_EAxPFC_iPoisson_s(k,:);
EAxPFC_EAxPFC_iPoisson_gPoisson = zeros(nsamp,p.EAxPFC_Npop);
EAxPFC_EAxPFC_iPoisson_gPoisson(1,:)=p.EAxPFC_EAxPFC_iPoisson_gext.*EAxPFC_EAxPFC_iPoisson_s(k,:);
EAxPFC_IAxPFC_iPoisson_gPoisson = zeros(nsamp,p.EAxPFC_Npop);
EAxPFC_IAxPFC_iPoisson_gPoisson(1,:)=p.EAxPFC_IAxPFC_iPoisson_gext.*EAxPFC_IAxPFC_iPoisson_s(k,:);
IAxPFC_IAxPFC_iPoisson_gPoisson = zeros(nsamp,p.IAxPFC_Npop);
IAxPFC_IAxPFC_iPoisson_gPoisson(1,:)=p.IAxPFC_IAxPFC_iPoisson_gext.*IAxPFC_IAxPFC_iPoisson_s(k,:);
IBxPFC_EBxPFC_iPoisson_gPoisson = zeros(nsamp,p.IBxPFC_Npop);
IBxPFC_EBxPFC_iPoisson_gPoisson(1,:)=p.IBxPFC_EBxPFC_iPoisson_gext.*IBxPFC_EBxPFC_iPoisson_s(k,:);
EBxPFC_EBxPFC_iPoisson_gPoisson = zeros(nsamp,p.EBxPFC_Npop);
EBxPFC_EBxPFC_iPoisson_gPoisson(1,:)=p.EBxPFC_EBxPFC_iPoisson_gext.*EBxPFC_EBxPFC_iPoisson_s(k,:);
EBxPFC_IBxPFC_iPoisson_gPoisson = zeros(nsamp,p.EBxPFC_Npop);
EBxPFC_IBxPFC_iPoisson_gPoisson(1,:)=p.EBxPFC_IBxPFC_iPoisson_gext.*EBxPFC_IBxPFC_iPoisson_s(k,:);
IBxPFC_IBxPFC_iPoisson_gPoisson = zeros(nsamp,p.IBxPFC_Npop);
IBxPFC_IBxPFC_iPoisson_gPoisson(1,:)=p.IBxPFC_IBxPFC_iPoisson_gext.*IBxPFC_IBxPFC_iPoisson_s(k,:);
ICxPFC_ECxPFC_iPoisson_gPoisson = zeros(nsamp,p.ICxPFC_Npop);
ICxPFC_ECxPFC_iPoisson_gPoisson(1,:)=p.ICxPFC_ECxPFC_iPoisson_gext.*ICxPFC_ECxPFC_iPoisson_s(k,:);
ECxPFC_ECxPFC_iPoisson_gPoisson = zeros(nsamp,p.ECxPFC_Npop);
ECxPFC_ECxPFC_iPoisson_gPoisson(1,:)=p.ECxPFC_ECxPFC_iPoisson_gext.*ECxPFC_ECxPFC_iPoisson_s(k,:);
ECxPFC_ICxPFC_iPoisson_gPoisson = zeros(nsamp,p.ECxPFC_Npop);
ECxPFC_ICxPFC_iPoisson_gPoisson(1,:)=p.ECxPFC_ICxPFC_iPoisson_gext.*ECxPFC_ICxPFC_iPoisson_s(k,:);
ICxPFC_ICxPFC_iPoisson_gPoisson = zeros(nsamp,p.ICxPFC_Npop);
ICxPFC_ICxPFC_iPoisson_gPoisson(1,:)=p.ICxPFC_ICxPFC_iPoisson_gext.*ICxPFC_ICxPFC_iPoisson_s(k,:);
midExPFC_EAxPFC_iPoisson_gPoisson = zeros(nsamp,p.midExPFC_Npop);
midExPFC_EAxPFC_iPoisson_gPoisson(1,:)=p.midExPFC_EAxPFC_iPoisson_gext.*midExPFC_EAxPFC_iPoisson_s(k,:);
midExPFC_IAxPFC_iPoisson_gPoisson = zeros(nsamp,p.midExPFC_Npop);
midExPFC_IAxPFC_iPoisson_gPoisson(1,:)=p.midExPFC_IAxPFC_iPoisson_gext.*midExPFC_IAxPFC_iPoisson_s(k,:);
midExPFC_EBxPFC_iPoisson_gPoisson = zeros(nsamp,p.midExPFC_Npop);
midExPFC_EBxPFC_iPoisson_gPoisson(1,:)=p.midExPFC_EBxPFC_iPoisson_gext.*midExPFC_EBxPFC_iPoisson_s(k,:);
midExPFC_IBxPFC_iPoisson_gPoisson = zeros(nsamp,p.midExPFC_Npop);
midExPFC_IBxPFC_iPoisson_gPoisson(1,:)=p.midExPFC_IBxPFC_iPoisson_gext.*midExPFC_IBxPFC_iPoisson_s(k,:);
midExPFC_ECxPFC_iPoisson_gPoisson = zeros(nsamp,p.midExPFC_Npop);
midExPFC_ECxPFC_iPoisson_gPoisson(1,:)=p.midExPFC_ECxPFC_iPoisson_gext.*midExPFC_ECxPFC_iPoisson_s(k,:);
midExPFC_ICxPFC_iPoisson_gPoisson = zeros(nsamp,p.midExPFC_Npop);
midExPFC_ICxPFC_iPoisson_gPoisson(1,:)=p.midExPFC_ICxPFC_iPoisson_gext.*midExPFC_ICxPFC_iPoisson_s(k,:);
midExPFC_deepExV4_iPoisson_gPoisson = zeros(nsamp,p.midExPFC_Npop);
midExPFC_deepExV4_iPoisson_gPoisson(1,:)=p.midExPFC_deepExV4_iPoisson_gext.*midExPFC_deepExV4_iPoisson_s(k,:);
midIxPFC_deepIxV4_iPoisson_gPoisson = zeros(nsamp,p.midIxPFC_Npop);
midIxPFC_deepIxV4_iPoisson_gPoisson(1,:)=p.midIxPFC_deepIxV4_iPoisson_gext.*midIxPFC_deepIxV4_iPoisson_s(k,:);

% ###########################################################
% Numerical integration:
% ###########################################################
n=2;
for k=2:ntime
  t=T(k-1);
  supExV4_V_k1 = (p.supExV4_Iapp + ((((-p.supExV4_iNa_gNa.*supExV4_iNa_m_last.^3.*supExV4_iNa_h_last.*(supExV4_V_last-p.supExV4_iNa_ENa))))+((((-p.supExV4_iK_gK.*supExV4_iK_n_last.^4.*(supExV4_V_last-p.supExV4_iK_EK))))+((((-((p.supExV4_ctx_iPoisson_g_poisson.*supExV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(supExV4_V_last-p.supExV4_ctx_iPoisson_E_poisson))))+((-(((p.supExV4_supExV4_iAMPActx_gAMPA.*(supExV4_supExV4_iAMPActx_s_last*p.supExV4_supExV4_iAMPActx_netcon).*(supExV4_V_last-p.supExV4_supExV4_iAMPActx_EAMPA)))))+((((-p.supExV4_supIxV4_iGABActx_gGABAa.*(supExV4_supIxV4_iGABActx_s_last*p.supExV4_supIxV4_iGABActx_netcon).*(supExV4_V_last-p.supExV4_supIxV4_iGABActx_EGABAa))))+((-(((p.supExV4_midExV4_iAMPActx_gAMPA.*(supExV4_midExV4_iAMPActx_s_last*p.supExV4_midExV4_iAMPActx_netcon).*(supExV4_V_last-p.supExV4_midExV4_iAMPActx_EAMPA))))))))))) + p.supExV4_noise*randn(1, p.supExV4_Npop))/p.supExV4_C;
  supExV4_iNa_m_k1 = (((2.5-.1*(supExV4_V_last+65))./(exp(2.5-.1*(supExV4_V_last+65))-1))).*(1-supExV4_iNa_m_last)-((4*exp(-(supExV4_V_last+65)/18))).*supExV4_iNa_m_last;
  supExV4_iNa_h_k1 = ((.07*exp(-(supExV4_V_last+65)/20))).*(1-supExV4_iNa_h_last)-((1./(exp(3-.1*(supExV4_V_last+65))+1))).*supExV4_iNa_h_last;
  supExV4_iK_n_k1 = (((.1-.01*(supExV4_V_last+65))./(exp(1-.1*(supExV4_V_last+65))-1))).*(1-supExV4_iK_n_last)-((.125*exp(-(supExV4_V_last+65)/80))).*supExV4_iK_n_last;
  supIxV4_V_k1 = (p.supIxV4_Iapp + ((((-p.supIxV4_iNa_gNa.*supIxV4_iNa_m_last.^3.*supIxV4_iNa_h_last.*(supIxV4_V_last-p.supIxV4_iNa_ENa))))+((((-p.supIxV4_iK_gK.*supIxV4_iK_n_last.^4.*(supIxV4_V_last-p.supIxV4_iK_EK))))+((((-((p.supIxV4_ctx_iPoisson_g_poisson.*supIxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(supIxV4_V_last-p.supIxV4_ctx_iPoisson_E_poisson))))+((-(((p.supIxV4_supExV4_iAMPActx_gAMPA.*(supIxV4_supExV4_iAMPActx_s_last*p.supIxV4_supExV4_iAMPActx_netcon).*(supIxV4_V_last-p.supIxV4_supExV4_iAMPActx_EAMPA)))))+((((-p.supIxV4_supIxV4_iGABActx_gGABAa.*(supIxV4_supIxV4_iGABActx_s_last*p.supIxV4_supIxV4_iGABActx_netcon).*(supIxV4_V_last-p.supIxV4_supIxV4_iGABActx_EGABAa))))))))) + p.supIxV4_noise*randn(1, p.supIxV4_Npop))/p.supIxV4_C;
  supIxV4_iNa_m_k1 = (((2.5-.1*(supIxV4_V_last+65))./(exp(2.5-.1*(supIxV4_V_last+65))-1))).*(1-supIxV4_iNa_m_last)-((4*exp(-(supIxV4_V_last+65)/18))).*supIxV4_iNa_m_last;
  supIxV4_iNa_h_k1 = ((.07*exp(-(supIxV4_V_last+65)/20))).*(1-supIxV4_iNa_h_last)-((1./(exp(3-.1*(supIxV4_V_last+65))+1))).*supIxV4_iNa_h_last;
  supIxV4_iK_n_k1 = (((.1-.01*(supIxV4_V_last+65))./(exp(1-.1*(supIxV4_V_last+65))-1))).*(1-supIxV4_iK_n_last)-((.125*exp(-(supIxV4_V_last+65)/80))).*supIxV4_iK_n_last;
  midExV4_V_k1 = (p.midExV4_Iapp + ((((-p.midExV4_iNa_gNa.*midExV4_iNa_m_last.^3.*midExV4_iNa_h_last.*(midExV4_V_last-p.midExV4_iNa_ENa))))+((((-p.midExV4_iK_gK.*midExV4_iK_n_last.^4.*(midExV4_V_last-p.midExV4_iK_EK))))+((((-((p.midExV4_ctx_iPoisson_g_poisson.*midExV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(midExV4_V_last-p.midExV4_ctx_iPoisson_E_poisson))))+((-(((p.midExV4_midExV4_iAMPActx_gAMPA.*(midExV4_midExV4_iAMPActx_s_last*p.midExV4_midExV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_midExV4_iAMPActx_EAMPA)))))+((((-p.midExV4_midIxV4_iGABActx_gGABAa.*(midExV4_midIxV4_iGABActx_s_last*p.midExV4_midIxV4_iGABActx_netcon).*(midExV4_V_last-p.midExV4_midIxV4_iGABActx_EGABAa))))+((((-((p.midExV4_EAxV4_iPoisson_gext.*midExV4_EAxV4_iPoisson_s(k,:))).*(midExV4_V_last-p.midExV4_EAxV4_iPoisson_Eext))))+((((-((p.midExV4_IAxV4_iPoisson_gext.*midExV4_IAxV4_iPoisson_s(k,:))).*(midExV4_V_last-p.midExV4_IAxV4_iPoisson_Eext))))+((((-((p.midExV4_EBxV4_iPoisson_gext.*midExV4_EBxV4_iPoisson_s(k,:))).*(midExV4_V_last-p.midExV4_EBxV4_iPoisson_Eext))))+((((-((p.midExV4_IBxV4_iPoisson_gext.*midExV4_IBxV4_iPoisson_s(k,:))).*(midExV4_V_last-p.midExV4_IBxV4_iPoisson_Eext))))+((((-((p.midExV4_ECxV4_iPoisson_gext.*midExV4_ECxV4_iPoisson_s(k,:))).*(midExV4_V_last-p.midExV4_ECxV4_iPoisson_Eext))))+((((-((p.midExV4_ICxV4_iPoisson_gext.*midExV4_ICxV4_iPoisson_s(k,:))).*(midExV4_V_last-p.midExV4_ICxV4_iPoisson_Eext))))))))))))))) + p.midExV4_noise*randn(1, p.midExV4_Npop))/p.midExV4_C;
  midExV4_iNa_m_k1 = (((2.5-.1*(midExV4_V_last+65))./(exp(2.5-.1*(midExV4_V_last+65))-1))).*(1-midExV4_iNa_m_last)-((4*exp(-(midExV4_V_last+65)/18))).*midExV4_iNa_m_last;
  midExV4_iNa_h_k1 = ((.07*exp(-(midExV4_V_last+65)/20))).*(1-midExV4_iNa_h_last)-((1./(exp(3-.1*(midExV4_V_last+65))+1))).*midExV4_iNa_h_last;
  midExV4_iK_n_k1 = (((.1-.01*(midExV4_V_last+65))./(exp(1-.1*(midExV4_V_last+65))-1))).*(1-midExV4_iK_n_last)-((.125*exp(-(midExV4_V_last+65)/80))).*midExV4_iK_n_last;
  midIxV4_V_k1 = (p.midIxV4_Iapp + ((((-p.midIxV4_iNa_gNa.*midIxV4_iNa_m_last.^3.*midIxV4_iNa_h_last.*(midIxV4_V_last-p.midIxV4_iNa_ENa))))+((((-p.midIxV4_iK_gK.*midIxV4_iK_n_last.^4.*(midIxV4_V_last-p.midIxV4_iK_EK))))+((((-((p.midIxV4_ctx_iPoisson_g_poisson.*midIxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(midIxV4_V_last-p.midIxV4_ctx_iPoisson_E_poisson))))+((-(((p.midIxV4_midExV4_iAMPActx_gAMPA.*(midIxV4_midExV4_iAMPActx_s_last*p.midIxV4_midExV4_iAMPActx_netcon).*(midIxV4_V_last-p.midIxV4_midExV4_iAMPActx_EAMPA)))))+((((-p.midIxV4_midIxV4_iGABActx_gGABAa.*(midIxV4_midIxV4_iGABActx_s_last*p.midIxV4_midIxV4_iGABActx_netcon).*(midIxV4_V_last-p.midIxV4_midIxV4_iGABActx_EGABAa))))))))) + p.midIxV4_noise*randn(1, p.midIxV4_Npop))/p.midIxV4_C;
  midIxV4_iNa_m_k1 = (((2.5-.1*(midIxV4_V_last+65))./(exp(2.5-.1*(midIxV4_V_last+65))-1))).*(1-midIxV4_iNa_m_last)-((4*exp(-(midIxV4_V_last+65)/18))).*midIxV4_iNa_m_last;
  midIxV4_iNa_h_k1 = ((.07*exp(-(midIxV4_V_last+65)/20))).*(1-midIxV4_iNa_h_last)-((1./(exp(3-.1*(midIxV4_V_last+65))+1))).*midIxV4_iNa_h_last;
  midIxV4_iK_n_k1 = (((.1-.01*(midIxV4_V_last+65))./(exp(1-.1*(midIxV4_V_last+65))-1))).*(1-midIxV4_iK_n_last)-((.125*exp(-(midIxV4_V_last+65)/80))).*midIxV4_iK_n_last;
  deepExV4_V_k1 = (p.deepExV4_Iapp + ((((-p.deepExV4_iNa_gNa.*deepExV4_iNa_m_last.^3.*deepExV4_iNa_h_last.*(deepExV4_V_last-p.deepExV4_iNa_ENa))))+((((-p.deepExV4_iK_gK.*deepExV4_iK_n_last.^4.*(deepExV4_V_last-p.deepExV4_iK_EK))))+((((-((p.deepExV4_ctx_iPoisson_g_poisson.*deepExV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(deepExV4_V_last-p.deepExV4_ctx_iPoisson_E_poisson))))+((-(((p.deepExV4_deepExV4_iAMPActx_gAMPA.*(deepExV4_deepExV4_iAMPActx_s_last*p.deepExV4_deepExV4_iAMPActx_netcon).*(deepExV4_V_last-p.deepExV4_deepExV4_iAMPActx_EAMPA)))))+((((-p.deepExV4_deepIxV4_iGABActx_gGABAa.*(deepExV4_deepIxV4_iGABActx_s_last*p.deepExV4_deepIxV4_iGABActx_netcon).*(deepExV4_V_last-p.deepExV4_deepIxV4_iGABActx_EGABAa))))+((-(((p.deepExV4_midExV4_iAMPActx_gAMPA.*(deepExV4_midExV4_iAMPActx_s_last*p.deepExV4_midExV4_iAMPActx_netcon).*(deepExV4_V_last-p.deepExV4_midExV4_iAMPActx_EAMPA)))))+((((-p.deepExV4_midIxV4_iGABActx_gGABAa.*(deepExV4_midIxV4_iGABActx_s_last*p.deepExV4_midIxV4_iGABActx_netcon).*(deepExV4_V_last-p.deepExV4_midIxV4_iGABActx_EGABAa))))+((-(((p.deepExV4_supExV4_iAMPActx_gAMPA.*(deepExV4_supExV4_iAMPActx_s_last*p.deepExV4_supExV4_iAMPActx_netcon).*(deepExV4_V_last-p.deepExV4_supExV4_iAMPActx_EAMPA))))))))))))) + p.deepExV4_noise*randn(1, p.deepExV4_Npop))/p.deepExV4_C;
  deepExV4_iNa_m_k1 = (((2.5-.1*(deepExV4_V_last+65))./(exp(2.5-.1*(deepExV4_V_last+65))-1))).*(1-deepExV4_iNa_m_last)-((4*exp(-(deepExV4_V_last+65)/18))).*deepExV4_iNa_m_last;
  deepExV4_iNa_h_k1 = ((.07*exp(-(deepExV4_V_last+65)/20))).*(1-deepExV4_iNa_h_last)-((1./(exp(3-.1*(deepExV4_V_last+65))+1))).*deepExV4_iNa_h_last;
  deepExV4_iK_n_k1 = (((.1-.01*(deepExV4_V_last+65))./(exp(1-.1*(deepExV4_V_last+65))-1))).*(1-deepExV4_iK_n_last)-((.125*exp(-(deepExV4_V_last+65)/80))).*deepExV4_iK_n_last;
  deepIxV4_V_k1 = (p.deepIxV4_Iapp + ((((-p.deepIxV4_iNa_gNa.*deepIxV4_iNa_m_last.^3.*deepIxV4_iNa_h_last.*(deepIxV4_V_last-p.deepIxV4_iNa_ENa))))+((((-p.deepIxV4_iK_gK.*deepIxV4_iK_n_last.^4.*(deepIxV4_V_last-p.deepIxV4_iK_EK))))+((((-((p.deepIxV4_ctx_iPoisson_g_poisson.*deepIxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(deepIxV4_V_last-p.deepIxV4_ctx_iPoisson_E_poisson))))+((-(((p.deepIxV4_deepExV4_iAMPActx_gAMPA.*(deepIxV4_deepExV4_iAMPActx_s_last*p.deepIxV4_deepExV4_iAMPActx_netcon).*(deepIxV4_V_last-p.deepIxV4_deepExV4_iAMPActx_EAMPA)))))+((((-p.deepIxV4_deepIxV4_iGABActx_gGABAa.*(deepIxV4_deepIxV4_iGABActx_s_last*p.deepIxV4_deepIxV4_iGABActx_netcon).*(deepIxV4_V_last-p.deepIxV4_deepIxV4_iGABActx_EGABAa))))))))) + p.deepIxV4_noise*randn(1, p.deepIxV4_Npop))/p.deepIxV4_C;
  deepIxV4_iNa_m_k1 = (((2.5-.1*(deepIxV4_V_last+65))./(exp(2.5-.1*(deepIxV4_V_last+65))-1))).*(1-deepIxV4_iNa_m_last)-((4*exp(-(deepIxV4_V_last+65)/18))).*deepIxV4_iNa_m_last;
  deepIxV4_iNa_h_k1 = ((.07*exp(-(deepIxV4_V_last+65)/20))).*(1-deepIxV4_iNa_h_last)-((1./(exp(3-.1*(deepIxV4_V_last+65))+1))).*deepIxV4_iNa_h_last;
  deepIxV4_iK_n_k1 = (((.1-.01*(deepIxV4_V_last+65))./(exp(1-.1*(deepIxV4_V_last+65))-1))).*(1-deepIxV4_iK_n_last)-((.125*exp(-(deepIxV4_V_last+65)/80))).*deepIxV4_iK_n_last;
  EAxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.EAxV4_t1).^2) - exp(- (t - p.EAxV4_t2).^2)) + p.EAxV4_noise*randn(1, p.EAxV4_Npop))/p.EAxV4_C;
  EAxV4_iNa_m_k1 = (((2.5-.1*(EAxV4_V_last+65))./(exp(2.5-.1*(EAxV4_V_last+65))-1))).*(1-EAxV4_iNa_m_last)-((4*exp(-(EAxV4_V_last+65)/18))).*EAxV4_iNa_m_last;
  EAxV4_iNa_h_k1 = ((.07*exp(-(EAxV4_V_last+65)/20))).*(1-EAxV4_iNa_h_last)-((1./(exp(3-.1*(EAxV4_V_last+65))+1))).*EAxV4_iNa_h_last;
  EAxV4_iK_n_k1 = (((.1-.01*(EAxV4_V_last+65))./(exp(1-.1*(EAxV4_V_last+65))-1))).*(1-EAxV4_iK_n_last)-((.125*exp(-(EAxV4_V_last+65)/80))).*EAxV4_iK_n_last;
  IAxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.IAxV4_t1).^2) - exp(- (t - p.IAxV4_t2).^2)) + p.IAxV4_noise*randn(1, p.IAxV4_Npop))/p.IAxV4_C;
  IAxV4_iNa_m_k1 = (((2.5-.1*(IAxV4_V_last+65))./(exp(2.5-.1*(IAxV4_V_last+65))-1))).*(1-IAxV4_iNa_m_last)-((4*exp(-(IAxV4_V_last+65)/18))).*IAxV4_iNa_m_last;
  IAxV4_iNa_h_k1 = ((.07*exp(-(IAxV4_V_last+65)/20))).*(1-IAxV4_iNa_h_last)-((1./(exp(3-.1*(IAxV4_V_last+65))+1))).*IAxV4_iNa_h_last;
  IAxV4_iK_n_k1 = (((.1-.01*(IAxV4_V_last+65))./(exp(1-.1*(IAxV4_V_last+65))-1))).*(1-IAxV4_iK_n_last)-((.125*exp(-(IAxV4_V_last+65)/80))).*IAxV4_iK_n_last;
  EBxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.EBxV4_t1).^2) - exp(- (t - p.EBxV4_t2).^2)) + p.EBxV4_noise*randn(1, p.EBxV4_Npop))/p.EBxV4_C;
  EBxV4_iNa_m_k1 = (((2.5-.1*(EBxV4_V_last+65))./(exp(2.5-.1*(EBxV4_V_last+65))-1))).*(1-EBxV4_iNa_m_last)-((4*exp(-(EBxV4_V_last+65)/18))).*EBxV4_iNa_m_last;
  EBxV4_iNa_h_k1 = ((.07*exp(-(EBxV4_V_last+65)/20))).*(1-EBxV4_iNa_h_last)-((1./(exp(3-.1*(EBxV4_V_last+65))+1))).*EBxV4_iNa_h_last;
  EBxV4_iK_n_k1 = (((.1-.01*(EBxV4_V_last+65))./(exp(1-.1*(EBxV4_V_last+65))-1))).*(1-EBxV4_iK_n_last)-((.125*exp(-(EBxV4_V_last+65)/80))).*EBxV4_iK_n_last;
  IBxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.IBxV4_t1).^2) - exp(- (t - p.IBxV4_t2).^2)) + p.IBxV4_noise*randn(1, p.IBxV4_Npop))/p.IBxV4_C;
  IBxV4_iNa_m_k1 = (((2.5-.1*(IBxV4_V_last+65))./(exp(2.5-.1*(IBxV4_V_last+65))-1))).*(1-IBxV4_iNa_m_last)-((4*exp(-(IBxV4_V_last+65)/18))).*IBxV4_iNa_m_last;
  IBxV4_iNa_h_k1 = ((.07*exp(-(IBxV4_V_last+65)/20))).*(1-IBxV4_iNa_h_last)-((1./(exp(3-.1*(IBxV4_V_last+65))+1))).*IBxV4_iNa_h_last;
  IBxV4_iK_n_k1 = (((.1-.01*(IBxV4_V_last+65))./(exp(1-.1*(IBxV4_V_last+65))-1))).*(1-IBxV4_iK_n_last)-((.125*exp(-(IBxV4_V_last+65)/80))).*IBxV4_iK_n_last;
  ECxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.ECxV4_t1).^2) - exp(- (t - p.ECxV4_t2).^2)) + p.ECxV4_noise*randn(1, p.ECxV4_Npop))/p.ECxV4_C;
  ECxV4_iNa_m_k1 = (((2.5-.1*(ECxV4_V_last+65))./(exp(2.5-.1*(ECxV4_V_last+65))-1))).*(1-ECxV4_iNa_m_last)-((4*exp(-(ECxV4_V_last+65)/18))).*ECxV4_iNa_m_last;
  ECxV4_iNa_h_k1 = ((.07*exp(-(ECxV4_V_last+65)/20))).*(1-ECxV4_iNa_h_last)-((1./(exp(3-.1*(ECxV4_V_last+65))+1))).*ECxV4_iNa_h_last;
  ECxV4_iK_n_k1 = (((.1-.01*(ECxV4_V_last+65))./(exp(1-.1*(ECxV4_V_last+65))-1))).*(1-ECxV4_iK_n_last)-((.125*exp(-(ECxV4_V_last+65)/80))).*ECxV4_iK_n_last;
  ICxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.ICxV4_t1).^2) - exp(- (t - p.ICxV4_t2).^2)) + p.ICxV4_noise*randn(1, p.ICxV4_Npop))/p.ICxV4_C;
  ICxV4_iNa_m_k1 = (((2.5-.1*(ICxV4_V_last+65))./(exp(2.5-.1*(ICxV4_V_last+65))-1))).*(1-ICxV4_iNa_m_last)-((4*exp(-(ICxV4_V_last+65)/18))).*ICxV4_iNa_m_last;
  ICxV4_iNa_h_k1 = ((.07*exp(-(ICxV4_V_last+65)/20))).*(1-ICxV4_iNa_h_last)-((1./(exp(3-.1*(ICxV4_V_last+65))+1))).*ICxV4_iNa_h_last;
  ICxV4_iK_n_k1 = (((.1-.01*(ICxV4_V_last+65))./(exp(1-.1*(ICxV4_V_last+65))-1))).*(1-ICxV4_iK_n_last)-((.125*exp(-(ICxV4_V_last+65)/80))).*ICxV4_iK_n_last;
  supExPFC_V_k1 = (p.supExPFC_Iapp + ((((-p.supExPFC_iNa_gNa.*supExPFC_iNa_m_last.^3.*supExPFC_iNa_h_last.*(supExPFC_V_last-p.supExPFC_iNa_ENa))))+((((-p.supExPFC_iK_gK.*supExPFC_iK_n_last.^4.*(supExPFC_V_last-p.supExPFC_iK_EK))))+((((-((p.supExPFC_ctx_iPoisson_g_poisson.*supExPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(supExPFC_V_last-p.supExPFC_ctx_iPoisson_E_poisson))))+((-(((p.supExPFC_supExPFC_iAMPActx_gAMPA.*(supExPFC_supExPFC_iAMPActx_s_last*p.supExPFC_supExPFC_iAMPActx_netcon).*(supExPFC_V_last-p.supExPFC_supExPFC_iAMPActx_EAMPA)))))+((((-p.supExPFC_supIxPFC_iGABActx_gGABAa.*(supExPFC_supIxPFC_iGABActx_s_last*p.supExPFC_supIxPFC_iGABActx_netcon).*(supExPFC_V_last-p.supExPFC_supIxPFC_iGABActx_EGABAa))))+((-(((p.supExPFC_midExPFC_iAMPActx_gAMPA.*(supExPFC_midExPFC_iAMPActx_s_last*p.supExPFC_midExPFC_iAMPActx_netcon).*(supExPFC_V_last-p.supExPFC_midExPFC_iAMPActx_EAMPA))))))))))) + p.supExPFC_noise*randn(1, p.supExPFC_Npop))/p.supExPFC_C;
  supExPFC_iNa_m_k1 = (((2.5-.1*(supExPFC_V_last+65))./(exp(2.5-.1*(supExPFC_V_last+65))-1))).*(1-supExPFC_iNa_m_last)-((4*exp(-(supExPFC_V_last+65)/18))).*supExPFC_iNa_m_last;
  supExPFC_iNa_h_k1 = ((.07*exp(-(supExPFC_V_last+65)/20))).*(1-supExPFC_iNa_h_last)-((1./(exp(3-.1*(supExPFC_V_last+65))+1))).*supExPFC_iNa_h_last;
  supExPFC_iK_n_k1 = (((.1-.01*(supExPFC_V_last+65))./(exp(1-.1*(supExPFC_V_last+65))-1))).*(1-supExPFC_iK_n_last)-((.125*exp(-(supExPFC_V_last+65)/80))).*supExPFC_iK_n_last;
  supIxPFC_V_k1 = (p.supIxPFC_Iapp + ((((-p.supIxPFC_iNa_gNa.*supIxPFC_iNa_m_last.^3.*supIxPFC_iNa_h_last.*(supIxPFC_V_last-p.supIxPFC_iNa_ENa))))+((((-p.supIxPFC_iK_gK.*supIxPFC_iK_n_last.^4.*(supIxPFC_V_last-p.supIxPFC_iK_EK))))+((((-((p.supIxPFC_ctx_iPoisson_g_poisson.*supIxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(supIxPFC_V_last-p.supIxPFC_ctx_iPoisson_E_poisson))))+((-(((p.supIxPFC_supExPFC_iAMPActx_gAMPA.*(supIxPFC_supExPFC_iAMPActx_s_last*p.supIxPFC_supExPFC_iAMPActx_netcon).*(supIxPFC_V_last-p.supIxPFC_supExPFC_iAMPActx_EAMPA)))))+((((-p.supIxPFC_supIxPFC_iGABActx_gGABAa.*(supIxPFC_supIxPFC_iGABActx_s_last*p.supIxPFC_supIxPFC_iGABActx_netcon).*(supIxPFC_V_last-p.supIxPFC_supIxPFC_iGABActx_EGABAa))))))))) + p.supIxPFC_noise*randn(1, p.supIxPFC_Npop))/p.supIxPFC_C;
  supIxPFC_iNa_m_k1 = (((2.5-.1*(supIxPFC_V_last+65))./(exp(2.5-.1*(supIxPFC_V_last+65))-1))).*(1-supIxPFC_iNa_m_last)-((4*exp(-(supIxPFC_V_last+65)/18))).*supIxPFC_iNa_m_last;
  supIxPFC_iNa_h_k1 = ((.07*exp(-(supIxPFC_V_last+65)/20))).*(1-supIxPFC_iNa_h_last)-((1./(exp(3-.1*(supIxPFC_V_last+65))+1))).*supIxPFC_iNa_h_last;
  supIxPFC_iK_n_k1 = (((.1-.01*(supIxPFC_V_last+65))./(exp(1-.1*(supIxPFC_V_last+65))-1))).*(1-supIxPFC_iK_n_last)-((.125*exp(-(supIxPFC_V_last+65)/80))).*supIxPFC_iK_n_last;
  midExPFC_V_k1 = (p.midExPFC_Iapp + ((((-p.midExPFC_iNa_gNa.*midExPFC_iNa_m_last.^3.*midExPFC_iNa_h_last.*(midExPFC_V_last-p.midExPFC_iNa_ENa))))+((((-p.midExPFC_iK_gK.*midExPFC_iK_n_last.^4.*(midExPFC_V_last-p.midExPFC_iK_EK))))+((((-((p.midExPFC_ctx_iPoisson_g_poisson.*midExPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(midExPFC_V_last-p.midExPFC_ctx_iPoisson_E_poisson))))+((-(((p.midExPFC_midExPFC_iAMPActx_gAMPA.*(midExPFC_midExPFC_iAMPActx_s_last*p.midExPFC_midExPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_midExPFC_iAMPActx_EAMPA)))))+((((-p.midExPFC_midIxPFC_iGABActx_gGABAa.*(midExPFC_midIxPFC_iGABActx_s_last*p.midExPFC_midIxPFC_iGABActx_netcon).*(midExPFC_V_last-p.midExPFC_midIxPFC_iGABActx_EGABAa))))+((((-((p.midExPFC_EAxPFC_iPoisson_gext.*midExPFC_EAxPFC_iPoisson_s(k,:))).*(midExPFC_V_last-p.midExPFC_EAxPFC_iPoisson_Eext))))+((((-((p.midExPFC_IAxPFC_iPoisson_gext.*midExPFC_IAxPFC_iPoisson_s(k,:))).*(midExPFC_V_last-p.midExPFC_IAxPFC_iPoisson_Eext))))+((((-((p.midExPFC_EBxPFC_iPoisson_gext.*midExPFC_EBxPFC_iPoisson_s(k,:))).*(midExPFC_V_last-p.midExPFC_EBxPFC_iPoisson_Eext))))+((((-((p.midExPFC_IBxPFC_iPoisson_gext.*midExPFC_IBxPFC_iPoisson_s(k,:))).*(midExPFC_V_last-p.midExPFC_IBxPFC_iPoisson_Eext))))+((((-((p.midExPFC_ECxPFC_iPoisson_gext.*midExPFC_ECxPFC_iPoisson_s(k,:))).*(midExPFC_V_last-p.midExPFC_ECxPFC_iPoisson_Eext))))+((((-((p.midExPFC_ICxPFC_iPoisson_gext.*midExPFC_ICxPFC_iPoisson_s(k,:))).*(midExPFC_V_last-p.midExPFC_ICxPFC_iPoisson_Eext))))+((((-((p.midExPFC_deepExV4_iPoisson_gext.*midExPFC_deepExV4_iPoisson_s(k,:))).*(midExPFC_V_last-p.midExPFC_deepExV4_iPoisson_Eext)))))))))))))))) + p.midExPFC_noise*randn(1, p.midExPFC_Npop))/p.midExPFC_C;
  midExPFC_iNa_m_k1 = (((2.5-.1*(midExPFC_V_last+65))./(exp(2.5-.1*(midExPFC_V_last+65))-1))).*(1-midExPFC_iNa_m_last)-((4*exp(-(midExPFC_V_last+65)/18))).*midExPFC_iNa_m_last;
  midExPFC_iNa_h_k1 = ((.07*exp(-(midExPFC_V_last+65)/20))).*(1-midExPFC_iNa_h_last)-((1./(exp(3-.1*(midExPFC_V_last+65))+1))).*midExPFC_iNa_h_last;
  midExPFC_iK_n_k1 = (((.1-.01*(midExPFC_V_last+65))./(exp(1-.1*(midExPFC_V_last+65))-1))).*(1-midExPFC_iK_n_last)-((.125*exp(-(midExPFC_V_last+65)/80))).*midExPFC_iK_n_last;
  midIxPFC_V_k1 = (p.midIxPFC_Iapp + ((((-p.midIxPFC_iNa_gNa.*midIxPFC_iNa_m_last.^3.*midIxPFC_iNa_h_last.*(midIxPFC_V_last-p.midIxPFC_iNa_ENa))))+((((-p.midIxPFC_iK_gK.*midIxPFC_iK_n_last.^4.*(midIxPFC_V_last-p.midIxPFC_iK_EK))))+((((-((p.midIxPFC_ctx_iPoisson_g_poisson.*midIxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(midIxPFC_V_last-p.midIxPFC_ctx_iPoisson_E_poisson))))+((-(((p.midIxPFC_midExPFC_iAMPActx_gAMPA.*(midIxPFC_midExPFC_iAMPActx_s_last*p.midIxPFC_midExPFC_iAMPActx_netcon).*(midIxPFC_V_last-p.midIxPFC_midExPFC_iAMPActx_EAMPA)))))+((((-p.midIxPFC_midIxPFC_iGABActx_gGABAa.*(midIxPFC_midIxPFC_iGABActx_s_last*p.midIxPFC_midIxPFC_iGABActx_netcon).*(midIxPFC_V_last-p.midIxPFC_midIxPFC_iGABActx_EGABAa))))+((((-((p.midIxPFC_deepIxV4_iPoisson_gext.*midIxPFC_deepIxV4_iPoisson_s(k,:))).*(midIxPFC_V_last-p.midIxPFC_deepIxV4_iPoisson_Eext)))))))))) + p.midIxPFC_noise*randn(1, p.midIxPFC_Npop))/p.midIxPFC_C;
  midIxPFC_iNa_m_k1 = (((2.5-.1*(midIxPFC_V_last+65))./(exp(2.5-.1*(midIxPFC_V_last+65))-1))).*(1-midIxPFC_iNa_m_last)-((4*exp(-(midIxPFC_V_last+65)/18))).*midIxPFC_iNa_m_last;
  midIxPFC_iNa_h_k1 = ((.07*exp(-(midIxPFC_V_last+65)/20))).*(1-midIxPFC_iNa_h_last)-((1./(exp(3-.1*(midIxPFC_V_last+65))+1))).*midIxPFC_iNa_h_last;
  midIxPFC_iK_n_k1 = (((.1-.01*(midIxPFC_V_last+65))./(exp(1-.1*(midIxPFC_V_last+65))-1))).*(1-midIxPFC_iK_n_last)-((.125*exp(-(midIxPFC_V_last+65)/80))).*midIxPFC_iK_n_last;
  deepExPFC_V_k1 = (p.deepExPFC_Iapp + ((((-p.deepExPFC_iNa_gNa.*deepExPFC_iNa_m_last.^3.*deepExPFC_iNa_h_last.*(deepExPFC_V_last-p.deepExPFC_iNa_ENa))))+((((-p.deepExPFC_iK_gK.*deepExPFC_iK_n_last.^4.*(deepExPFC_V_last-p.deepExPFC_iK_EK))))+((((-((p.deepExPFC_ctx_iPoisson_g_poisson.*deepExPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(deepExPFC_V_last-p.deepExPFC_ctx_iPoisson_E_poisson))))+((-(((p.deepExPFC_deepExPFC_iAMPActx_gAMPA.*(deepExPFC_deepExPFC_iAMPActx_s_last*p.deepExPFC_deepExPFC_iAMPActx_netcon).*(deepExPFC_V_last-p.deepExPFC_deepExPFC_iAMPActx_EAMPA)))))+((((-p.deepExPFC_deepIxPFC_iGABActx_gGABAa.*(deepExPFC_deepIxPFC_iGABActx_s_last*p.deepExPFC_deepIxPFC_iGABActx_netcon).*(deepExPFC_V_last-p.deepExPFC_deepIxPFC_iGABActx_EGABAa))))+((-(((p.deepExPFC_midExPFC_iAMPActx_gAMPA.*(deepExPFC_midExPFC_iAMPActx_s_last*p.deepExPFC_midExPFC_iAMPActx_netcon).*(deepExPFC_V_last-p.deepExPFC_midExPFC_iAMPActx_EAMPA)))))+((((-p.deepExPFC_midIxPFC_iGABActx_gGABAa.*(deepExPFC_midIxPFC_iGABActx_s_last*p.deepExPFC_midIxPFC_iGABActx_netcon).*(deepExPFC_V_last-p.deepExPFC_midIxPFC_iGABActx_EGABAa))))+((-(((p.deepExPFC_supExPFC_iAMPActx_gAMPA.*(deepExPFC_supExPFC_iAMPActx_s_last*p.deepExPFC_supExPFC_iAMPActx_netcon).*(deepExPFC_V_last-p.deepExPFC_supExPFC_iAMPActx_EAMPA))))))))))))) + p.deepExPFC_noise*randn(1, p.deepExPFC_Npop))/p.deepExPFC_C;
  deepExPFC_iNa_m_k1 = (((2.5-.1*(deepExPFC_V_last+65))./(exp(2.5-.1*(deepExPFC_V_last+65))-1))).*(1-deepExPFC_iNa_m_last)-((4*exp(-(deepExPFC_V_last+65)/18))).*deepExPFC_iNa_m_last;
  deepExPFC_iNa_h_k1 = ((.07*exp(-(deepExPFC_V_last+65)/20))).*(1-deepExPFC_iNa_h_last)-((1./(exp(3-.1*(deepExPFC_V_last+65))+1))).*deepExPFC_iNa_h_last;
  deepExPFC_iK_n_k1 = (((.1-.01*(deepExPFC_V_last+65))./(exp(1-.1*(deepExPFC_V_last+65))-1))).*(1-deepExPFC_iK_n_last)-((.125*exp(-(deepExPFC_V_last+65)/80))).*deepExPFC_iK_n_last;
  deepIxPFC_V_k1 = (p.deepIxPFC_Iapp + ((((-p.deepIxPFC_iNa_gNa.*deepIxPFC_iNa_m_last.^3.*deepIxPFC_iNa_h_last.*(deepIxPFC_V_last-p.deepIxPFC_iNa_ENa))))+((((-p.deepIxPFC_iK_gK.*deepIxPFC_iK_n_last.^4.*(deepIxPFC_V_last-p.deepIxPFC_iK_EK))))+((((-((p.deepIxPFC_ctx_iPoisson_g_poisson.*deepIxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(deepIxPFC_V_last-p.deepIxPFC_ctx_iPoisson_E_poisson))))+((-(((p.deepIxPFC_deepExPFC_iAMPActx_gAMPA.*(deepIxPFC_deepExPFC_iAMPActx_s_last*p.deepIxPFC_deepExPFC_iAMPActx_netcon).*(deepIxPFC_V_last-p.deepIxPFC_deepExPFC_iAMPActx_EAMPA)))))+((((-p.deepIxPFC_deepIxPFC_iGABActx_gGABAa.*(deepIxPFC_deepIxPFC_iGABActx_s_last*p.deepIxPFC_deepIxPFC_iGABActx_netcon).*(deepIxPFC_V_last-p.deepIxPFC_deepIxPFC_iGABActx_EGABAa))))))))) + p.deepIxPFC_noise*randn(1, p.deepIxPFC_Npop))/p.deepIxPFC_C;
  deepIxPFC_iNa_m_k1 = (((2.5-.1*(deepIxPFC_V_last+65))./(exp(2.5-.1*(deepIxPFC_V_last+65))-1))).*(1-deepIxPFC_iNa_m_last)-((4*exp(-(deepIxPFC_V_last+65)/18))).*deepIxPFC_iNa_m_last;
  deepIxPFC_iNa_h_k1 = ((.07*exp(-(deepIxPFC_V_last+65)/20))).*(1-deepIxPFC_iNa_h_last)-((1./(exp(3-.1*(deepIxPFC_V_last+65))+1))).*deepIxPFC_iNa_h_last;
  deepIxPFC_iK_n_k1 = (((.1-.01*(deepIxPFC_V_last+65))./(exp(1-.1*(deepIxPFC_V_last+65))-1))).*(1-deepIxPFC_iK_n_last)-((.125*exp(-(deepIxPFC_V_last+65)/80))).*deepIxPFC_iK_n_last;
  EAxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.EAxPFC_t1).^2) - exp(- (t - p.EAxPFC_t2).^2)) + p.EAxPFC_noise*randn(1, p.EAxPFC_Npop))/p.EAxPFC_C;
  EAxPFC_iNa_m_k1 = (((2.5-.1*(EAxPFC_V_last+65))./(exp(2.5-.1*(EAxPFC_V_last+65))-1))).*(1-EAxPFC_iNa_m_last)-((4*exp(-(EAxPFC_V_last+65)/18))).*EAxPFC_iNa_m_last;
  EAxPFC_iNa_h_k1 = ((.07*exp(-(EAxPFC_V_last+65)/20))).*(1-EAxPFC_iNa_h_last)-((1./(exp(3-.1*(EAxPFC_V_last+65))+1))).*EAxPFC_iNa_h_last;
  EAxPFC_iK_n_k1 = (((.1-.01*(EAxPFC_V_last+65))./(exp(1-.1*(EAxPFC_V_last+65))-1))).*(1-EAxPFC_iK_n_last)-((.125*exp(-(EAxPFC_V_last+65)/80))).*EAxPFC_iK_n_last;
  IAxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.IAxPFC_t1).^2) - exp(- (t - p.IAxPFC_t2).^2)) + p.IAxPFC_noise*randn(1, p.IAxPFC_Npop))/p.IAxPFC_C;
  IAxPFC_iNa_m_k1 = (((2.5-.1*(IAxPFC_V_last+65))./(exp(2.5-.1*(IAxPFC_V_last+65))-1))).*(1-IAxPFC_iNa_m_last)-((4*exp(-(IAxPFC_V_last+65)/18))).*IAxPFC_iNa_m_last;
  IAxPFC_iNa_h_k1 = ((.07*exp(-(IAxPFC_V_last+65)/20))).*(1-IAxPFC_iNa_h_last)-((1./(exp(3-.1*(IAxPFC_V_last+65))+1))).*IAxPFC_iNa_h_last;
  IAxPFC_iK_n_k1 = (((.1-.01*(IAxPFC_V_last+65))./(exp(1-.1*(IAxPFC_V_last+65))-1))).*(1-IAxPFC_iK_n_last)-((.125*exp(-(IAxPFC_V_last+65)/80))).*IAxPFC_iK_n_last;
  EBxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.EBxPFC_t1).^2) - exp(- (t - p.EBxPFC_t2).^2)) + p.EBxPFC_noise*randn(1, p.EBxPFC_Npop))/p.EBxPFC_C;
  EBxPFC_iNa_m_k1 = (((2.5-.1*(EBxPFC_V_last+65))./(exp(2.5-.1*(EBxPFC_V_last+65))-1))).*(1-EBxPFC_iNa_m_last)-((4*exp(-(EBxPFC_V_last+65)/18))).*EBxPFC_iNa_m_last;
  EBxPFC_iNa_h_k1 = ((.07*exp(-(EBxPFC_V_last+65)/20))).*(1-EBxPFC_iNa_h_last)-((1./(exp(3-.1*(EBxPFC_V_last+65))+1))).*EBxPFC_iNa_h_last;
  EBxPFC_iK_n_k1 = (((.1-.01*(EBxPFC_V_last+65))./(exp(1-.1*(EBxPFC_V_last+65))-1))).*(1-EBxPFC_iK_n_last)-((.125*exp(-(EBxPFC_V_last+65)/80))).*EBxPFC_iK_n_last;
  IBxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.IBxPFC_t1).^2) - exp(- (t - p.IBxPFC_t2).^2)) + p.IBxPFC_noise*randn(1, p.IBxPFC_Npop))/p.IBxPFC_C;
  IBxPFC_iNa_m_k1 = (((2.5-.1*(IBxPFC_V_last+65))./(exp(2.5-.1*(IBxPFC_V_last+65))-1))).*(1-IBxPFC_iNa_m_last)-((4*exp(-(IBxPFC_V_last+65)/18))).*IBxPFC_iNa_m_last;
  IBxPFC_iNa_h_k1 = ((.07*exp(-(IBxPFC_V_last+65)/20))).*(1-IBxPFC_iNa_h_last)-((1./(exp(3-.1*(IBxPFC_V_last+65))+1))).*IBxPFC_iNa_h_last;
  IBxPFC_iK_n_k1 = (((.1-.01*(IBxPFC_V_last+65))./(exp(1-.1*(IBxPFC_V_last+65))-1))).*(1-IBxPFC_iK_n_last)-((.125*exp(-(IBxPFC_V_last+65)/80))).*IBxPFC_iK_n_last;
  ECxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.ECxPFC_t1).^2) - exp(- (t - p.ECxPFC_t2).^2)) + p.ECxPFC_noise*randn(1, p.ECxPFC_Npop))/p.ECxPFC_C;
  ECxPFC_iNa_m_k1 = (((2.5-.1*(ECxPFC_V_last+65))./(exp(2.5-.1*(ECxPFC_V_last+65))-1))).*(1-ECxPFC_iNa_m_last)-((4*exp(-(ECxPFC_V_last+65)/18))).*ECxPFC_iNa_m_last;
  ECxPFC_iNa_h_k1 = ((.07*exp(-(ECxPFC_V_last+65)/20))).*(1-ECxPFC_iNa_h_last)-((1./(exp(3-.1*(ECxPFC_V_last+65))+1))).*ECxPFC_iNa_h_last;
  ECxPFC_iK_n_k1 = (((.1-.01*(ECxPFC_V_last+65))./(exp(1-.1*(ECxPFC_V_last+65))-1))).*(1-ECxPFC_iK_n_last)-((.125*exp(-(ECxPFC_V_last+65)/80))).*ECxPFC_iK_n_last;
  ICxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.ICxPFC_t1).^2) - exp(- (t - p.ICxPFC_t2).^2)) + p.ICxPFC_noise*randn(1, p.ICxPFC_Npop))/p.ICxPFC_C;
  ICxPFC_iNa_m_k1 = (((2.5-.1*(ICxPFC_V_last+65))./(exp(2.5-.1*(ICxPFC_V_last+65))-1))).*(1-ICxPFC_iNa_m_last)-((4*exp(-(ICxPFC_V_last+65)/18))).*ICxPFC_iNa_m_last;
  ICxPFC_iNa_h_k1 = ((.07*exp(-(ICxPFC_V_last+65)/20))).*(1-ICxPFC_iNa_h_last)-((1./(exp(3-.1*(ICxPFC_V_last+65))+1))).*ICxPFC_iNa_h_last;
  ICxPFC_iK_n_k1 = (((.1-.01*(ICxPFC_V_last+65))./(exp(1-.1*(ICxPFC_V_last+65))-1))).*(1-ICxPFC_iK_n_last)-((.125*exp(-(ICxPFC_V_last+65)/80))).*ICxPFC_iK_n_last;
  supIxV4_supExV4_iAMPActx_s_k1 = -supIxV4_supExV4_iAMPActx_s_last./p.supIxV4_supExV4_iAMPActx_tauAMPA + ((1-supIxV4_supExV4_iAMPActx_s_last)/p.supIxV4_supExV4_iAMPActx_tauAMPAr).*(1+tanh(supExV4_V_last/10));
  supExV4_supExV4_iAMPActx_s_k1 = -supExV4_supExV4_iAMPActx_s_last./p.supExV4_supExV4_iAMPActx_tauAMPA + ((1-supExV4_supExV4_iAMPActx_s_last)/p.supExV4_supExV4_iAMPActx_tauAMPAr).*(1+tanh(supExV4_V_last/10));
  supExV4_supIxV4_iGABActx_s_k1 = -supExV4_supIxV4_iGABActx_s_last./p.supExV4_supIxV4_iGABActx_tauGABA + 1/2*(1+tanh(supIxV4_V_last/10)).*((1-supExV4_supIxV4_iGABActx_s_last)/p.supExV4_supIxV4_iGABActx_tauGABAr);
  supIxV4_supIxV4_iGABActx_s_k1 = -supIxV4_supIxV4_iGABActx_s_last./p.supIxV4_supIxV4_iGABActx_tauGABA + 1/2*(1+tanh(supIxV4_V_last/10)).*((1-supIxV4_supIxV4_iGABActx_s_last)/p.supIxV4_supIxV4_iGABActx_tauGABAr);
  midIxV4_midExV4_iAMPActx_s_k1 = -midIxV4_midExV4_iAMPActx_s_last./p.midIxV4_midExV4_iAMPActx_tauAMPA + ((1-midIxV4_midExV4_iAMPActx_s_last)/p.midIxV4_midExV4_iAMPActx_tauAMPAr).*(1+tanh(midExV4_V_last/10));
  midExV4_midExV4_iAMPActx_s_k1 = -midExV4_midExV4_iAMPActx_s_last./p.midExV4_midExV4_iAMPActx_tauAMPA + ((1-midExV4_midExV4_iAMPActx_s_last)/p.midExV4_midExV4_iAMPActx_tauAMPAr).*(1+tanh(midExV4_V_last/10));
  midExV4_midIxV4_iGABActx_s_k1 = -midExV4_midIxV4_iGABActx_s_last./p.midExV4_midIxV4_iGABActx_tauGABA + 1/2*(1+tanh(midIxV4_V_last/10)).*((1-midExV4_midIxV4_iGABActx_s_last)/p.midExV4_midIxV4_iGABActx_tauGABAr);
  midIxV4_midIxV4_iGABActx_s_k1 = -midIxV4_midIxV4_iGABActx_s_last./p.midIxV4_midIxV4_iGABActx_tauGABA + 1/2*(1+tanh(midIxV4_V_last/10)).*((1-midIxV4_midIxV4_iGABActx_s_last)/p.midIxV4_midIxV4_iGABActx_tauGABAr);
  deepIxV4_deepExV4_iAMPActx_s_k1 = -deepIxV4_deepExV4_iAMPActx_s_last./p.deepIxV4_deepExV4_iAMPActx_tauAMPA + ((1-deepIxV4_deepExV4_iAMPActx_s_last)/p.deepIxV4_deepExV4_iAMPActx_tauAMPAr).*(1+tanh(deepExV4_V_last/10));
  deepExV4_deepExV4_iAMPActx_s_k1 = -deepExV4_deepExV4_iAMPActx_s_last./p.deepExV4_deepExV4_iAMPActx_tauAMPA + ((1-deepExV4_deepExV4_iAMPActx_s_last)/p.deepExV4_deepExV4_iAMPActx_tauAMPAr).*(1+tanh(deepExV4_V_last/10));
  deepExV4_deepIxV4_iGABActx_s_k1 = -deepExV4_deepIxV4_iGABActx_s_last./p.deepExV4_deepIxV4_iGABActx_tauGABA + 1/2*(1+tanh(deepIxV4_V_last/10)).*((1-deepExV4_deepIxV4_iGABActx_s_last)/p.deepExV4_deepIxV4_iGABActx_tauGABAr);
  deepIxV4_deepIxV4_iGABActx_s_k1 = -deepIxV4_deepIxV4_iGABActx_s_last./p.deepIxV4_deepIxV4_iGABActx_tauGABA + 1/2*(1+tanh(deepIxV4_V_last/10)).*((1-deepIxV4_deepIxV4_iGABActx_s_last)/p.deepIxV4_deepIxV4_iGABActx_tauGABAr);
  supExV4_midExV4_iAMPActx_s_k1 = -supExV4_midExV4_iAMPActx_s_last./p.supExV4_midExV4_iAMPActx_tauAMPA + ((1-supExV4_midExV4_iAMPActx_s_last)/p.supExV4_midExV4_iAMPActx_tauAMPAr).*(1+tanh(midExV4_V_last/10));
  deepExV4_midExV4_iAMPActx_s_k1 = -deepExV4_midExV4_iAMPActx_s_last./p.deepExV4_midExV4_iAMPActx_tauAMPA + ((1-deepExV4_midExV4_iAMPActx_s_last)/p.deepExV4_midExV4_iAMPActx_tauAMPAr).*(1+tanh(midExV4_V_last/10));
  deepExV4_midIxV4_iGABActx_s_k1 = -deepExV4_midIxV4_iGABActx_s_last./p.deepExV4_midIxV4_iGABActx_tauGABA + 1/2*(1+tanh(midIxV4_V_last/10)).*((1-deepExV4_midIxV4_iGABActx_s_last)/p.deepExV4_midIxV4_iGABActx_tauGABAr);
  deepExV4_supExV4_iAMPActx_s_k1 = -deepExV4_supExV4_iAMPActx_s_last./p.deepExV4_supExV4_iAMPActx_tauAMPA + ((1-deepExV4_supExV4_iAMPActx_s_last)/p.deepExV4_supExV4_iAMPActx_tauAMPAr).*(1+tanh(supExV4_V_last/10));
  supIxPFC_supExPFC_iAMPActx_s_k1 = -supIxPFC_supExPFC_iAMPActx_s_last./p.supIxPFC_supExPFC_iAMPActx_tauAMPA + ((1-supIxPFC_supExPFC_iAMPActx_s_last)/p.supIxPFC_supExPFC_iAMPActx_tauAMPAr).*(1+tanh(supExPFC_V_last/10));
  supExPFC_supExPFC_iAMPActx_s_k1 = -supExPFC_supExPFC_iAMPActx_s_last./p.supExPFC_supExPFC_iAMPActx_tauAMPA + ((1-supExPFC_supExPFC_iAMPActx_s_last)/p.supExPFC_supExPFC_iAMPActx_tauAMPAr).*(1+tanh(supExPFC_V_last/10));
  supExPFC_supIxPFC_iGABActx_s_k1 = -supExPFC_supIxPFC_iGABActx_s_last./p.supExPFC_supIxPFC_iGABActx_tauGABA + 1/2*(1+tanh(supIxPFC_V_last/10)).*((1-supExPFC_supIxPFC_iGABActx_s_last)/p.supExPFC_supIxPFC_iGABActx_tauGABAr);
  supIxPFC_supIxPFC_iGABActx_s_k1 = -supIxPFC_supIxPFC_iGABActx_s_last./p.supIxPFC_supIxPFC_iGABActx_tauGABA + 1/2*(1+tanh(supIxPFC_V_last/10)).*((1-supIxPFC_supIxPFC_iGABActx_s_last)/p.supIxPFC_supIxPFC_iGABActx_tauGABAr);
  midIxPFC_midExPFC_iAMPActx_s_k1 = -midIxPFC_midExPFC_iAMPActx_s_last./p.midIxPFC_midExPFC_iAMPActx_tauAMPA + ((1-midIxPFC_midExPFC_iAMPActx_s_last)/p.midIxPFC_midExPFC_iAMPActx_tauAMPAr).*(1+tanh(midExPFC_V_last/10));
  midExPFC_midExPFC_iAMPActx_s_k1 = -midExPFC_midExPFC_iAMPActx_s_last./p.midExPFC_midExPFC_iAMPActx_tauAMPA + ((1-midExPFC_midExPFC_iAMPActx_s_last)/p.midExPFC_midExPFC_iAMPActx_tauAMPAr).*(1+tanh(midExPFC_V_last/10));
  midExPFC_midIxPFC_iGABActx_s_k1 = -midExPFC_midIxPFC_iGABActx_s_last./p.midExPFC_midIxPFC_iGABActx_tauGABA + 1/2*(1+tanh(midIxPFC_V_last/10)).*((1-midExPFC_midIxPFC_iGABActx_s_last)/p.midExPFC_midIxPFC_iGABActx_tauGABAr);
  midIxPFC_midIxPFC_iGABActx_s_k1 = -midIxPFC_midIxPFC_iGABActx_s_last./p.midIxPFC_midIxPFC_iGABActx_tauGABA + 1/2*(1+tanh(midIxPFC_V_last/10)).*((1-midIxPFC_midIxPFC_iGABActx_s_last)/p.midIxPFC_midIxPFC_iGABActx_tauGABAr);
  deepIxPFC_deepExPFC_iAMPActx_s_k1 = -deepIxPFC_deepExPFC_iAMPActx_s_last./p.deepIxPFC_deepExPFC_iAMPActx_tauAMPA + ((1-deepIxPFC_deepExPFC_iAMPActx_s_last)/p.deepIxPFC_deepExPFC_iAMPActx_tauAMPAr).*(1+tanh(deepExPFC_V_last/10));
  deepExPFC_deepExPFC_iAMPActx_s_k1 = -deepExPFC_deepExPFC_iAMPActx_s_last./p.deepExPFC_deepExPFC_iAMPActx_tauAMPA + ((1-deepExPFC_deepExPFC_iAMPActx_s_last)/p.deepExPFC_deepExPFC_iAMPActx_tauAMPAr).*(1+tanh(deepExPFC_V_last/10));
  deepExPFC_deepIxPFC_iGABActx_s_k1 = -deepExPFC_deepIxPFC_iGABActx_s_last./p.deepExPFC_deepIxPFC_iGABActx_tauGABA + 1/2*(1+tanh(deepIxPFC_V_last/10)).*((1-deepExPFC_deepIxPFC_iGABActx_s_last)/p.deepExPFC_deepIxPFC_iGABActx_tauGABAr);
  deepIxPFC_deepIxPFC_iGABActx_s_k1 = -deepIxPFC_deepIxPFC_iGABActx_s_last./p.deepIxPFC_deepIxPFC_iGABActx_tauGABA + 1/2*(1+tanh(deepIxPFC_V_last/10)).*((1-deepIxPFC_deepIxPFC_iGABActx_s_last)/p.deepIxPFC_deepIxPFC_iGABActx_tauGABAr);
  supExPFC_midExPFC_iAMPActx_s_k1 = -supExPFC_midExPFC_iAMPActx_s_last./p.supExPFC_midExPFC_iAMPActx_tauAMPA + ((1-supExPFC_midExPFC_iAMPActx_s_last)/p.supExPFC_midExPFC_iAMPActx_tauAMPAr).*(1+tanh(midExPFC_V_last/10));
  deepExPFC_midExPFC_iAMPActx_s_k1 = -deepExPFC_midExPFC_iAMPActx_s_last./p.deepExPFC_midExPFC_iAMPActx_tauAMPA + ((1-deepExPFC_midExPFC_iAMPActx_s_last)/p.deepExPFC_midExPFC_iAMPActx_tauAMPAr).*(1+tanh(midExPFC_V_last/10));
  deepExPFC_midIxPFC_iGABActx_s_k1 = -deepExPFC_midIxPFC_iGABActx_s_last./p.deepExPFC_midIxPFC_iGABActx_tauGABA + 1/2*(1+tanh(midIxPFC_V_last/10)).*((1-deepExPFC_midIxPFC_iGABActx_s_last)/p.deepExPFC_midIxPFC_iGABActx_tauGABAr);
  deepExPFC_supExPFC_iAMPActx_s_k1 = -deepExPFC_supExPFC_iAMPActx_s_last./p.deepExPFC_supExPFC_iAMPActx_tauAMPA + ((1-deepExPFC_supExPFC_iAMPActx_s_last)/p.deepExPFC_supExPFC_iAMPActx_tauAMPAr).*(1+tanh(supExPFC_V_last/10));

  % ------------------------------------------------------------
  % Update state variables:
  % ------------------------------------------------------------
  supExV4_V_last = supExV4_V_last+dt*supExV4_V_k1;
  supExV4_iNa_m_last = supExV4_iNa_m_last+dt*supExV4_iNa_m_k1;
  supExV4_iNa_h_last = supExV4_iNa_h_last+dt*supExV4_iNa_h_k1;
  supExV4_iK_n_last = supExV4_iK_n_last+dt*supExV4_iK_n_k1;
  supIxV4_V_last = supIxV4_V_last+dt*supIxV4_V_k1;
  supIxV4_iNa_m_last = supIxV4_iNa_m_last+dt*supIxV4_iNa_m_k1;
  supIxV4_iNa_h_last = supIxV4_iNa_h_last+dt*supIxV4_iNa_h_k1;
  supIxV4_iK_n_last = supIxV4_iK_n_last+dt*supIxV4_iK_n_k1;
  midExV4_V_last = midExV4_V_last+dt*midExV4_V_k1;
  midExV4_iNa_m_last = midExV4_iNa_m_last+dt*midExV4_iNa_m_k1;
  midExV4_iNa_h_last = midExV4_iNa_h_last+dt*midExV4_iNa_h_k1;
  midExV4_iK_n_last = midExV4_iK_n_last+dt*midExV4_iK_n_k1;
  midIxV4_V_last = midIxV4_V_last+dt*midIxV4_V_k1;
  midIxV4_iNa_m_last = midIxV4_iNa_m_last+dt*midIxV4_iNa_m_k1;
  midIxV4_iNa_h_last = midIxV4_iNa_h_last+dt*midIxV4_iNa_h_k1;
  midIxV4_iK_n_last = midIxV4_iK_n_last+dt*midIxV4_iK_n_k1;
  deepExV4_V_last = deepExV4_V_last+dt*deepExV4_V_k1;
  deepExV4_iNa_m_last = deepExV4_iNa_m_last+dt*deepExV4_iNa_m_k1;
  deepExV4_iNa_h_last = deepExV4_iNa_h_last+dt*deepExV4_iNa_h_k1;
  deepExV4_iK_n_last = deepExV4_iK_n_last+dt*deepExV4_iK_n_k1;
  deepIxV4_V_last = deepIxV4_V_last+dt*deepIxV4_V_k1;
  deepIxV4_iNa_m_last = deepIxV4_iNa_m_last+dt*deepIxV4_iNa_m_k1;
  deepIxV4_iNa_h_last = deepIxV4_iNa_h_last+dt*deepIxV4_iNa_h_k1;
  deepIxV4_iK_n_last = deepIxV4_iK_n_last+dt*deepIxV4_iK_n_k1;
  EAxV4_V_last = EAxV4_V_last+dt*EAxV4_V_k1;
  EAxV4_iNa_m_last = EAxV4_iNa_m_last+dt*EAxV4_iNa_m_k1;
  EAxV4_iNa_h_last = EAxV4_iNa_h_last+dt*EAxV4_iNa_h_k1;
  EAxV4_iK_n_last = EAxV4_iK_n_last+dt*EAxV4_iK_n_k1;
  IAxV4_V_last = IAxV4_V_last+dt*IAxV4_V_k1;
  IAxV4_iNa_m_last = IAxV4_iNa_m_last+dt*IAxV4_iNa_m_k1;
  IAxV4_iNa_h_last = IAxV4_iNa_h_last+dt*IAxV4_iNa_h_k1;
  IAxV4_iK_n_last = IAxV4_iK_n_last+dt*IAxV4_iK_n_k1;
  EBxV4_V_last = EBxV4_V_last+dt*EBxV4_V_k1;
  EBxV4_iNa_m_last = EBxV4_iNa_m_last+dt*EBxV4_iNa_m_k1;
  EBxV4_iNa_h_last = EBxV4_iNa_h_last+dt*EBxV4_iNa_h_k1;
  EBxV4_iK_n_last = EBxV4_iK_n_last+dt*EBxV4_iK_n_k1;
  IBxV4_V_last = IBxV4_V_last+dt*IBxV4_V_k1;
  IBxV4_iNa_m_last = IBxV4_iNa_m_last+dt*IBxV4_iNa_m_k1;
  IBxV4_iNa_h_last = IBxV4_iNa_h_last+dt*IBxV4_iNa_h_k1;
  IBxV4_iK_n_last = IBxV4_iK_n_last+dt*IBxV4_iK_n_k1;
  ECxV4_V_last = ECxV4_V_last+dt*ECxV4_V_k1;
  ECxV4_iNa_m_last = ECxV4_iNa_m_last+dt*ECxV4_iNa_m_k1;
  ECxV4_iNa_h_last = ECxV4_iNa_h_last+dt*ECxV4_iNa_h_k1;
  ECxV4_iK_n_last = ECxV4_iK_n_last+dt*ECxV4_iK_n_k1;
  ICxV4_V_last = ICxV4_V_last+dt*ICxV4_V_k1;
  ICxV4_iNa_m_last = ICxV4_iNa_m_last+dt*ICxV4_iNa_m_k1;
  ICxV4_iNa_h_last = ICxV4_iNa_h_last+dt*ICxV4_iNa_h_k1;
  ICxV4_iK_n_last = ICxV4_iK_n_last+dt*ICxV4_iK_n_k1;
  supExPFC_V_last = supExPFC_V_last+dt*supExPFC_V_k1;
  supExPFC_iNa_m_last = supExPFC_iNa_m_last+dt*supExPFC_iNa_m_k1;
  supExPFC_iNa_h_last = supExPFC_iNa_h_last+dt*supExPFC_iNa_h_k1;
  supExPFC_iK_n_last = supExPFC_iK_n_last+dt*supExPFC_iK_n_k1;
  supIxPFC_V_last = supIxPFC_V_last+dt*supIxPFC_V_k1;
  supIxPFC_iNa_m_last = supIxPFC_iNa_m_last+dt*supIxPFC_iNa_m_k1;
  supIxPFC_iNa_h_last = supIxPFC_iNa_h_last+dt*supIxPFC_iNa_h_k1;
  supIxPFC_iK_n_last = supIxPFC_iK_n_last+dt*supIxPFC_iK_n_k1;
  midExPFC_V_last = midExPFC_V_last+dt*midExPFC_V_k1;
  midExPFC_iNa_m_last = midExPFC_iNa_m_last+dt*midExPFC_iNa_m_k1;
  midExPFC_iNa_h_last = midExPFC_iNa_h_last+dt*midExPFC_iNa_h_k1;
  midExPFC_iK_n_last = midExPFC_iK_n_last+dt*midExPFC_iK_n_k1;
  midIxPFC_V_last = midIxPFC_V_last+dt*midIxPFC_V_k1;
  midIxPFC_iNa_m_last = midIxPFC_iNa_m_last+dt*midIxPFC_iNa_m_k1;
  midIxPFC_iNa_h_last = midIxPFC_iNa_h_last+dt*midIxPFC_iNa_h_k1;
  midIxPFC_iK_n_last = midIxPFC_iK_n_last+dt*midIxPFC_iK_n_k1;
  deepExPFC_V_last = deepExPFC_V_last+dt*deepExPFC_V_k1;
  deepExPFC_iNa_m_last = deepExPFC_iNa_m_last+dt*deepExPFC_iNa_m_k1;
  deepExPFC_iNa_h_last = deepExPFC_iNa_h_last+dt*deepExPFC_iNa_h_k1;
  deepExPFC_iK_n_last = deepExPFC_iK_n_last+dt*deepExPFC_iK_n_k1;
  deepIxPFC_V_last = deepIxPFC_V_last+dt*deepIxPFC_V_k1;
  deepIxPFC_iNa_m_last = deepIxPFC_iNa_m_last+dt*deepIxPFC_iNa_m_k1;
  deepIxPFC_iNa_h_last = deepIxPFC_iNa_h_last+dt*deepIxPFC_iNa_h_k1;
  deepIxPFC_iK_n_last = deepIxPFC_iK_n_last+dt*deepIxPFC_iK_n_k1;
  EAxPFC_V_last = EAxPFC_V_last+dt*EAxPFC_V_k1;
  EAxPFC_iNa_m_last = EAxPFC_iNa_m_last+dt*EAxPFC_iNa_m_k1;
  EAxPFC_iNa_h_last = EAxPFC_iNa_h_last+dt*EAxPFC_iNa_h_k1;
  EAxPFC_iK_n_last = EAxPFC_iK_n_last+dt*EAxPFC_iK_n_k1;
  IAxPFC_V_last = IAxPFC_V_last+dt*IAxPFC_V_k1;
  IAxPFC_iNa_m_last = IAxPFC_iNa_m_last+dt*IAxPFC_iNa_m_k1;
  IAxPFC_iNa_h_last = IAxPFC_iNa_h_last+dt*IAxPFC_iNa_h_k1;
  IAxPFC_iK_n_last = IAxPFC_iK_n_last+dt*IAxPFC_iK_n_k1;
  EBxPFC_V_last = EBxPFC_V_last+dt*EBxPFC_V_k1;
  EBxPFC_iNa_m_last = EBxPFC_iNa_m_last+dt*EBxPFC_iNa_m_k1;
  EBxPFC_iNa_h_last = EBxPFC_iNa_h_last+dt*EBxPFC_iNa_h_k1;
  EBxPFC_iK_n_last = EBxPFC_iK_n_last+dt*EBxPFC_iK_n_k1;
  IBxPFC_V_last = IBxPFC_V_last+dt*IBxPFC_V_k1;
  IBxPFC_iNa_m_last = IBxPFC_iNa_m_last+dt*IBxPFC_iNa_m_k1;
  IBxPFC_iNa_h_last = IBxPFC_iNa_h_last+dt*IBxPFC_iNa_h_k1;
  IBxPFC_iK_n_last = IBxPFC_iK_n_last+dt*IBxPFC_iK_n_k1;
  ECxPFC_V_last = ECxPFC_V_last+dt*ECxPFC_V_k1;
  ECxPFC_iNa_m_last = ECxPFC_iNa_m_last+dt*ECxPFC_iNa_m_k1;
  ECxPFC_iNa_h_last = ECxPFC_iNa_h_last+dt*ECxPFC_iNa_h_k1;
  ECxPFC_iK_n_last = ECxPFC_iK_n_last+dt*ECxPFC_iK_n_k1;
  ICxPFC_V_last = ICxPFC_V_last+dt*ICxPFC_V_k1;
  ICxPFC_iNa_m_last = ICxPFC_iNa_m_last+dt*ICxPFC_iNa_m_k1;
  ICxPFC_iNa_h_last = ICxPFC_iNa_h_last+dt*ICxPFC_iNa_h_k1;
  ICxPFC_iK_n_last = ICxPFC_iK_n_last+dt*ICxPFC_iK_n_k1;
  supIxV4_supExV4_iAMPActx_s_last = supIxV4_supExV4_iAMPActx_s_last+dt*supIxV4_supExV4_iAMPActx_s_k1;
  supExV4_supExV4_iAMPActx_s_last = supExV4_supExV4_iAMPActx_s_last+dt*supExV4_supExV4_iAMPActx_s_k1;
  supExV4_supIxV4_iGABActx_s_last = supExV4_supIxV4_iGABActx_s_last+dt*supExV4_supIxV4_iGABActx_s_k1;
  supIxV4_supIxV4_iGABActx_s_last = supIxV4_supIxV4_iGABActx_s_last+dt*supIxV4_supIxV4_iGABActx_s_k1;
  midIxV4_midExV4_iAMPActx_s_last = midIxV4_midExV4_iAMPActx_s_last+dt*midIxV4_midExV4_iAMPActx_s_k1;
  midExV4_midExV4_iAMPActx_s_last = midExV4_midExV4_iAMPActx_s_last+dt*midExV4_midExV4_iAMPActx_s_k1;
  midExV4_midIxV4_iGABActx_s_last = midExV4_midIxV4_iGABActx_s_last+dt*midExV4_midIxV4_iGABActx_s_k1;
  midIxV4_midIxV4_iGABActx_s_last = midIxV4_midIxV4_iGABActx_s_last+dt*midIxV4_midIxV4_iGABActx_s_k1;
  deepIxV4_deepExV4_iAMPActx_s_last = deepIxV4_deepExV4_iAMPActx_s_last+dt*deepIxV4_deepExV4_iAMPActx_s_k1;
  deepExV4_deepExV4_iAMPActx_s_last = deepExV4_deepExV4_iAMPActx_s_last+dt*deepExV4_deepExV4_iAMPActx_s_k1;
  deepExV4_deepIxV4_iGABActx_s_last = deepExV4_deepIxV4_iGABActx_s_last+dt*deepExV4_deepIxV4_iGABActx_s_k1;
  deepIxV4_deepIxV4_iGABActx_s_last = deepIxV4_deepIxV4_iGABActx_s_last+dt*deepIxV4_deepIxV4_iGABActx_s_k1;
  supExV4_midExV4_iAMPActx_s_last = supExV4_midExV4_iAMPActx_s_last+dt*supExV4_midExV4_iAMPActx_s_k1;
  deepExV4_midExV4_iAMPActx_s_last = deepExV4_midExV4_iAMPActx_s_last+dt*deepExV4_midExV4_iAMPActx_s_k1;
  deepExV4_midIxV4_iGABActx_s_last = deepExV4_midIxV4_iGABActx_s_last+dt*deepExV4_midIxV4_iGABActx_s_k1;
  deepExV4_supExV4_iAMPActx_s_last = deepExV4_supExV4_iAMPActx_s_last+dt*deepExV4_supExV4_iAMPActx_s_k1;
  supIxPFC_supExPFC_iAMPActx_s_last = supIxPFC_supExPFC_iAMPActx_s_last+dt*supIxPFC_supExPFC_iAMPActx_s_k1;
  supExPFC_supExPFC_iAMPActx_s_last = supExPFC_supExPFC_iAMPActx_s_last+dt*supExPFC_supExPFC_iAMPActx_s_k1;
  supExPFC_supIxPFC_iGABActx_s_last = supExPFC_supIxPFC_iGABActx_s_last+dt*supExPFC_supIxPFC_iGABActx_s_k1;
  supIxPFC_supIxPFC_iGABActx_s_last = supIxPFC_supIxPFC_iGABActx_s_last+dt*supIxPFC_supIxPFC_iGABActx_s_k1;
  midIxPFC_midExPFC_iAMPActx_s_last = midIxPFC_midExPFC_iAMPActx_s_last+dt*midIxPFC_midExPFC_iAMPActx_s_k1;
  midExPFC_midExPFC_iAMPActx_s_last = midExPFC_midExPFC_iAMPActx_s_last+dt*midExPFC_midExPFC_iAMPActx_s_k1;
  midExPFC_midIxPFC_iGABActx_s_last = midExPFC_midIxPFC_iGABActx_s_last+dt*midExPFC_midIxPFC_iGABActx_s_k1;
  midIxPFC_midIxPFC_iGABActx_s_last = midIxPFC_midIxPFC_iGABActx_s_last+dt*midIxPFC_midIxPFC_iGABActx_s_k1;
  deepIxPFC_deepExPFC_iAMPActx_s_last = deepIxPFC_deepExPFC_iAMPActx_s_last+dt*deepIxPFC_deepExPFC_iAMPActx_s_k1;
  deepExPFC_deepExPFC_iAMPActx_s_last = deepExPFC_deepExPFC_iAMPActx_s_last+dt*deepExPFC_deepExPFC_iAMPActx_s_k1;
  deepExPFC_deepIxPFC_iGABActx_s_last = deepExPFC_deepIxPFC_iGABActx_s_last+dt*deepExPFC_deepIxPFC_iGABActx_s_k1;
  deepIxPFC_deepIxPFC_iGABActx_s_last = deepIxPFC_deepIxPFC_iGABActx_s_last+dt*deepIxPFC_deepIxPFC_iGABActx_s_k1;
  supExPFC_midExPFC_iAMPActx_s_last = supExPFC_midExPFC_iAMPActx_s_last+dt*supExPFC_midExPFC_iAMPActx_s_k1;
  deepExPFC_midExPFC_iAMPActx_s_last = deepExPFC_midExPFC_iAMPActx_s_last+dt*deepExPFC_midExPFC_iAMPActx_s_k1;
  deepExPFC_midIxPFC_iGABActx_s_last = deepExPFC_midIxPFC_iGABActx_s_last+dt*deepExPFC_midIxPFC_iGABActx_s_k1;
  deepExPFC_supExPFC_iAMPActx_s_last = deepExPFC_supExPFC_iAMPActx_s_last+dt*deepExPFC_supExPFC_iAMPActx_s_k1;

  if mod(k,downsample_factor)==0 % store this time point

  % ------------------------------------------------------------
  % Store state variables:
  % ------------------------------------------------------------
    supExV4_V(n,:) = supExV4_V_last;
    supExV4_iNa_m(n,:) = supExV4_iNa_m_last;
    supExV4_iNa_h(n,:) = supExV4_iNa_h_last;
    supExV4_iK_n(n,:) = supExV4_iK_n_last;
    supIxV4_V(n,:) = supIxV4_V_last;
    supIxV4_iNa_m(n,:) = supIxV4_iNa_m_last;
    supIxV4_iNa_h(n,:) = supIxV4_iNa_h_last;
    supIxV4_iK_n(n,:) = supIxV4_iK_n_last;
    midExV4_V(n,:) = midExV4_V_last;
    midExV4_iNa_m(n,:) = midExV4_iNa_m_last;
    midExV4_iNa_h(n,:) = midExV4_iNa_h_last;
    midExV4_iK_n(n,:) = midExV4_iK_n_last;
    midIxV4_V(n,:) = midIxV4_V_last;
    midIxV4_iNa_m(n,:) = midIxV4_iNa_m_last;
    midIxV4_iNa_h(n,:) = midIxV4_iNa_h_last;
    midIxV4_iK_n(n,:) = midIxV4_iK_n_last;
    deepExV4_V(n,:) = deepExV4_V_last;
    deepExV4_iNa_m(n,:) = deepExV4_iNa_m_last;
    deepExV4_iNa_h(n,:) = deepExV4_iNa_h_last;
    deepExV4_iK_n(n,:) = deepExV4_iK_n_last;
    deepIxV4_V(n,:) = deepIxV4_V_last;
    deepIxV4_iNa_m(n,:) = deepIxV4_iNa_m_last;
    deepIxV4_iNa_h(n,:) = deepIxV4_iNa_h_last;
    deepIxV4_iK_n(n,:) = deepIxV4_iK_n_last;
    EAxV4_V(n,:) = EAxV4_V_last;
    EAxV4_iNa_m(n,:) = EAxV4_iNa_m_last;
    EAxV4_iNa_h(n,:) = EAxV4_iNa_h_last;
    EAxV4_iK_n(n,:) = EAxV4_iK_n_last;
    IAxV4_V(n,:) = IAxV4_V_last;
    IAxV4_iNa_m(n,:) = IAxV4_iNa_m_last;
    IAxV4_iNa_h(n,:) = IAxV4_iNa_h_last;
    IAxV4_iK_n(n,:) = IAxV4_iK_n_last;
    EBxV4_V(n,:) = EBxV4_V_last;
    EBxV4_iNa_m(n,:) = EBxV4_iNa_m_last;
    EBxV4_iNa_h(n,:) = EBxV4_iNa_h_last;
    EBxV4_iK_n(n,:) = EBxV4_iK_n_last;
    IBxV4_V(n,:) = IBxV4_V_last;
    IBxV4_iNa_m(n,:) = IBxV4_iNa_m_last;
    IBxV4_iNa_h(n,:) = IBxV4_iNa_h_last;
    IBxV4_iK_n(n,:) = IBxV4_iK_n_last;
    ECxV4_V(n,:) = ECxV4_V_last;
    ECxV4_iNa_m(n,:) = ECxV4_iNa_m_last;
    ECxV4_iNa_h(n,:) = ECxV4_iNa_h_last;
    ECxV4_iK_n(n,:) = ECxV4_iK_n_last;
    ICxV4_V(n,:) = ICxV4_V_last;
    ICxV4_iNa_m(n,:) = ICxV4_iNa_m_last;
    ICxV4_iNa_h(n,:) = ICxV4_iNa_h_last;
    ICxV4_iK_n(n,:) = ICxV4_iK_n_last;
    supExPFC_V(n,:) = supExPFC_V_last;
    supExPFC_iNa_m(n,:) = supExPFC_iNa_m_last;
    supExPFC_iNa_h(n,:) = supExPFC_iNa_h_last;
    supExPFC_iK_n(n,:) = supExPFC_iK_n_last;
    supIxPFC_V(n,:) = supIxPFC_V_last;
    supIxPFC_iNa_m(n,:) = supIxPFC_iNa_m_last;
    supIxPFC_iNa_h(n,:) = supIxPFC_iNa_h_last;
    supIxPFC_iK_n(n,:) = supIxPFC_iK_n_last;
    midExPFC_V(n,:) = midExPFC_V_last;
    midExPFC_iNa_m(n,:) = midExPFC_iNa_m_last;
    midExPFC_iNa_h(n,:) = midExPFC_iNa_h_last;
    midExPFC_iK_n(n,:) = midExPFC_iK_n_last;
    midIxPFC_V(n,:) = midIxPFC_V_last;
    midIxPFC_iNa_m(n,:) = midIxPFC_iNa_m_last;
    midIxPFC_iNa_h(n,:) = midIxPFC_iNa_h_last;
    midIxPFC_iK_n(n,:) = midIxPFC_iK_n_last;
    deepExPFC_V(n,:) = deepExPFC_V_last;
    deepExPFC_iNa_m(n,:) = deepExPFC_iNa_m_last;
    deepExPFC_iNa_h(n,:) = deepExPFC_iNa_h_last;
    deepExPFC_iK_n(n,:) = deepExPFC_iK_n_last;
    deepIxPFC_V(n,:) = deepIxPFC_V_last;
    deepIxPFC_iNa_m(n,:) = deepIxPFC_iNa_m_last;
    deepIxPFC_iNa_h(n,:) = deepIxPFC_iNa_h_last;
    deepIxPFC_iK_n(n,:) = deepIxPFC_iK_n_last;
    EAxPFC_V(n,:) = EAxPFC_V_last;
    EAxPFC_iNa_m(n,:) = EAxPFC_iNa_m_last;
    EAxPFC_iNa_h(n,:) = EAxPFC_iNa_h_last;
    EAxPFC_iK_n(n,:) = EAxPFC_iK_n_last;
    IAxPFC_V(n,:) = IAxPFC_V_last;
    IAxPFC_iNa_m(n,:) = IAxPFC_iNa_m_last;
    IAxPFC_iNa_h(n,:) = IAxPFC_iNa_h_last;
    IAxPFC_iK_n(n,:) = IAxPFC_iK_n_last;
    EBxPFC_V(n,:) = EBxPFC_V_last;
    EBxPFC_iNa_m(n,:) = EBxPFC_iNa_m_last;
    EBxPFC_iNa_h(n,:) = EBxPFC_iNa_h_last;
    EBxPFC_iK_n(n,:) = EBxPFC_iK_n_last;
    IBxPFC_V(n,:) = IBxPFC_V_last;
    IBxPFC_iNa_m(n,:) = IBxPFC_iNa_m_last;
    IBxPFC_iNa_h(n,:) = IBxPFC_iNa_h_last;
    IBxPFC_iK_n(n,:) = IBxPFC_iK_n_last;
    ECxPFC_V(n,:) = ECxPFC_V_last;
    ECxPFC_iNa_m(n,:) = ECxPFC_iNa_m_last;
    ECxPFC_iNa_h(n,:) = ECxPFC_iNa_h_last;
    ECxPFC_iK_n(n,:) = ECxPFC_iK_n_last;
    ICxPFC_V(n,:) = ICxPFC_V_last;
    ICxPFC_iNa_m(n,:) = ICxPFC_iNa_m_last;
    ICxPFC_iNa_h(n,:) = ICxPFC_iNa_h_last;
    ICxPFC_iK_n(n,:) = ICxPFC_iK_n_last;
    supIxV4_supExV4_iAMPActx_s(n,:) = supIxV4_supExV4_iAMPActx_s_last;
    supExV4_supExV4_iAMPActx_s(n,:) = supExV4_supExV4_iAMPActx_s_last;
    supExV4_supIxV4_iGABActx_s(n,:) = supExV4_supIxV4_iGABActx_s_last;
    supIxV4_supIxV4_iGABActx_s(n,:) = supIxV4_supIxV4_iGABActx_s_last;
    midIxV4_midExV4_iAMPActx_s(n,:) = midIxV4_midExV4_iAMPActx_s_last;
    midExV4_midExV4_iAMPActx_s(n,:) = midExV4_midExV4_iAMPActx_s_last;
    midExV4_midIxV4_iGABActx_s(n,:) = midExV4_midIxV4_iGABActx_s_last;
    midIxV4_midIxV4_iGABActx_s(n,:) = midIxV4_midIxV4_iGABActx_s_last;
    deepIxV4_deepExV4_iAMPActx_s(n,:) = deepIxV4_deepExV4_iAMPActx_s_last;
    deepExV4_deepExV4_iAMPActx_s(n,:) = deepExV4_deepExV4_iAMPActx_s_last;
    deepExV4_deepIxV4_iGABActx_s(n,:) = deepExV4_deepIxV4_iGABActx_s_last;
    deepIxV4_deepIxV4_iGABActx_s(n,:) = deepIxV4_deepIxV4_iGABActx_s_last;
    supExV4_midExV4_iAMPActx_s(n,:) = supExV4_midExV4_iAMPActx_s_last;
    deepExV4_midExV4_iAMPActx_s(n,:) = deepExV4_midExV4_iAMPActx_s_last;
    deepExV4_midIxV4_iGABActx_s(n,:) = deepExV4_midIxV4_iGABActx_s_last;
    deepExV4_supExV4_iAMPActx_s(n,:) = deepExV4_supExV4_iAMPActx_s_last;
    supIxPFC_supExPFC_iAMPActx_s(n,:) = supIxPFC_supExPFC_iAMPActx_s_last;
    supExPFC_supExPFC_iAMPActx_s(n,:) = supExPFC_supExPFC_iAMPActx_s_last;
    supExPFC_supIxPFC_iGABActx_s(n,:) = supExPFC_supIxPFC_iGABActx_s_last;
    supIxPFC_supIxPFC_iGABActx_s(n,:) = supIxPFC_supIxPFC_iGABActx_s_last;
    midIxPFC_midExPFC_iAMPActx_s(n,:) = midIxPFC_midExPFC_iAMPActx_s_last;
    midExPFC_midExPFC_iAMPActx_s(n,:) = midExPFC_midExPFC_iAMPActx_s_last;
    midExPFC_midIxPFC_iGABActx_s(n,:) = midExPFC_midIxPFC_iGABActx_s_last;
    midIxPFC_midIxPFC_iGABActx_s(n,:) = midIxPFC_midIxPFC_iGABActx_s_last;
    deepIxPFC_deepExPFC_iAMPActx_s(n,:) = deepIxPFC_deepExPFC_iAMPActx_s_last;
    deepExPFC_deepExPFC_iAMPActx_s(n,:) = deepExPFC_deepExPFC_iAMPActx_s_last;
    deepExPFC_deepIxPFC_iGABActx_s(n,:) = deepExPFC_deepIxPFC_iGABActx_s_last;
    deepIxPFC_deepIxPFC_iGABActx_s(n,:) = deepIxPFC_deepIxPFC_iGABActx_s_last;
    supExPFC_midExPFC_iAMPActx_s(n,:) = supExPFC_midExPFC_iAMPActx_s_last;
    deepExPFC_midExPFC_iAMPActx_s(n,:) = deepExPFC_midExPFC_iAMPActx_s_last;
    deepExPFC_midIxPFC_iGABActx_s(n,:) = deepExPFC_midIxPFC_iGABActx_s_last;
    deepExPFC_supExPFC_iAMPActx_s(n,:) = deepExPFC_supExPFC_iAMPActx_s_last;

  % ------------------------------------------------------------
  % Update monitors:
  % ------------------------------------------------------------
  supExV4_ctx_iPoisson_g_poisson(n,:)=p.supExV4_ctx_iPoisson_g_poisson.*supExV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  supExV4_ctx_iPoisson_I_poisson(n,:)=-((p.supExV4_ctx_iPoisson_g_poisson.*supExV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(supExV4_V(n,:)-p.supExV4_ctx_iPoisson_E_poisson);
  supIxV4_ctx_iPoisson_g_poisson(n,:)=p.supIxV4_ctx_iPoisson_g_poisson.*supIxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  supIxV4_ctx_iPoisson_I_poisson(n,:)=-((p.supIxV4_ctx_iPoisson_g_poisson.*supIxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(supIxV4_V(n,:)-p.supIxV4_ctx_iPoisson_E_poisson);
  midExV4_ctx_iPoisson_g_poisson(n,:)=p.midExV4_ctx_iPoisson_g_poisson.*midExV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  midExV4_ctx_iPoisson_I_poisson(n,:)=-((p.midExV4_ctx_iPoisson_g_poisson.*midExV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(midExV4_V(n,:)-p.midExV4_ctx_iPoisson_E_poisson);
  midIxV4_ctx_iPoisson_g_poisson(n,:)=p.midIxV4_ctx_iPoisson_g_poisson.*midIxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  midIxV4_ctx_iPoisson_I_poisson(n,:)=-((p.midIxV4_ctx_iPoisson_g_poisson.*midIxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(midIxV4_V(n,:)-p.midIxV4_ctx_iPoisson_E_poisson);
  deepExV4_ctx_iPoisson_g_poisson(n,:)=p.deepExV4_ctx_iPoisson_g_poisson.*deepExV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  deepExV4_ctx_iPoisson_I_poisson(n,:)=-((p.deepExV4_ctx_iPoisson_g_poisson.*deepExV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(deepExV4_V(n,:)-p.deepExV4_ctx_iPoisson_E_poisson);
  deepIxV4_ctx_iPoisson_g_poisson(n,:)=p.deepIxV4_ctx_iPoisson_g_poisson.*deepIxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  deepIxV4_ctx_iPoisson_I_poisson(n,:)=-((p.deepIxV4_ctx_iPoisson_g_poisson.*deepIxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(deepIxV4_V(n,:)-p.deepIxV4_ctx_iPoisson_E_poisson);
  EAxV4_ctx_iPoisson_g_poisson(n,:)=p.EAxV4_ctx_iPoisson_g_poisson.*EAxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  EAxV4_ctx_iPoisson_I_poisson(n,:)=-((p.EAxV4_ctx_iPoisson_g_poisson.*EAxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(EAxV4_V(n,:)-p.EAxV4_ctx_iPoisson_E_poisson);
  IAxV4_ctx_iPoisson_g_poisson(n,:)=p.IAxV4_ctx_iPoisson_g_poisson.*IAxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  IAxV4_ctx_iPoisson_I_poisson(n,:)=-((p.IAxV4_ctx_iPoisson_g_poisson.*IAxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(IAxV4_V(n,:)-p.IAxV4_ctx_iPoisson_E_poisson);
  EBxV4_ctx_iPoisson_g_poisson(n,:)=p.EBxV4_ctx_iPoisson_g_poisson.*EBxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  EBxV4_ctx_iPoisson_I_poisson(n,:)=-((p.EBxV4_ctx_iPoisson_g_poisson.*EBxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(EBxV4_V(n,:)-p.EBxV4_ctx_iPoisson_E_poisson);
  IBxV4_ctx_iPoisson_g_poisson(n,:)=p.IBxV4_ctx_iPoisson_g_poisson.*IBxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  IBxV4_ctx_iPoisson_I_poisson(n,:)=-((p.IBxV4_ctx_iPoisson_g_poisson.*IBxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(IBxV4_V(n,:)-p.IBxV4_ctx_iPoisson_E_poisson);
  ECxV4_ctx_iPoisson_g_poisson(n,:)=p.ECxV4_ctx_iPoisson_g_poisson.*ECxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  ECxV4_ctx_iPoisson_I_poisson(n,:)=-((p.ECxV4_ctx_iPoisson_g_poisson.*ECxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(ECxV4_V(n,:)-p.ECxV4_ctx_iPoisson_E_poisson);
  ICxV4_ctx_iPoisson_g_poisson(n,:)=p.ICxV4_ctx_iPoisson_g_poisson.*ICxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  ICxV4_ctx_iPoisson_I_poisson(n,:)=-((p.ICxV4_ctx_iPoisson_g_poisson.*ICxV4_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(ICxV4_V(n,:)-p.ICxV4_ctx_iPoisson_E_poisson);
  supExPFC_ctx_iPoisson_g_poisson(n,:)=p.supExPFC_ctx_iPoisson_g_poisson.*supExPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  supExPFC_ctx_iPoisson_I_poisson(n,:)=-((p.supExPFC_ctx_iPoisson_g_poisson.*supExPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(supExPFC_V(n,:)-p.supExPFC_ctx_iPoisson_E_poisson);
  supIxPFC_ctx_iPoisson_g_poisson(n,:)=p.supIxPFC_ctx_iPoisson_g_poisson.*supIxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  supIxPFC_ctx_iPoisson_I_poisson(n,:)=-((p.supIxPFC_ctx_iPoisson_g_poisson.*supIxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(supIxPFC_V(n,:)-p.supIxPFC_ctx_iPoisson_E_poisson);
  midExPFC_ctx_iPoisson_g_poisson(n,:)=p.midExPFC_ctx_iPoisson_g_poisson.*midExPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  midExPFC_ctx_iPoisson_I_poisson(n,:)=-((p.midExPFC_ctx_iPoisson_g_poisson.*midExPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(midExPFC_V(n,:)-p.midExPFC_ctx_iPoisson_E_poisson);
  midIxPFC_ctx_iPoisson_g_poisson(n,:)=p.midIxPFC_ctx_iPoisson_g_poisson.*midIxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  midIxPFC_ctx_iPoisson_I_poisson(n,:)=-((p.midIxPFC_ctx_iPoisson_g_poisson.*midIxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(midIxPFC_V(n,:)-p.midIxPFC_ctx_iPoisson_E_poisson);
  deepExPFC_ctx_iPoisson_g_poisson(n,:)=p.deepExPFC_ctx_iPoisson_g_poisson.*deepExPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  deepExPFC_ctx_iPoisson_I_poisson(n,:)=-((p.deepExPFC_ctx_iPoisson_g_poisson.*deepExPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(deepExPFC_V(n,:)-p.deepExPFC_ctx_iPoisson_E_poisson);
  deepIxPFC_ctx_iPoisson_g_poisson(n,:)=p.deepIxPFC_ctx_iPoisson_g_poisson.*deepIxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  deepIxPFC_ctx_iPoisson_I_poisson(n,:)=-((p.deepIxPFC_ctx_iPoisson_g_poisson.*deepIxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(deepIxPFC_V(n,:)-p.deepIxPFC_ctx_iPoisson_E_poisson);
  EAxPFC_ctx_iPoisson_g_poisson(n,:)=p.EAxPFC_ctx_iPoisson_g_poisson.*EAxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  EAxPFC_ctx_iPoisson_I_poisson(n,:)=-((p.EAxPFC_ctx_iPoisson_g_poisson.*EAxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(EAxPFC_V(n,:)-p.EAxPFC_ctx_iPoisson_E_poisson);
  IAxPFC_ctx_iPoisson_g_poisson(n,:)=p.IAxPFC_ctx_iPoisson_g_poisson.*IAxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  IAxPFC_ctx_iPoisson_I_poisson(n,:)=-((p.IAxPFC_ctx_iPoisson_g_poisson.*IAxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(IAxPFC_V(n,:)-p.IAxPFC_ctx_iPoisson_E_poisson);
  EBxPFC_ctx_iPoisson_g_poisson(n,:)=p.EBxPFC_ctx_iPoisson_g_poisson.*EBxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  EBxPFC_ctx_iPoisson_I_poisson(n,:)=-((p.EBxPFC_ctx_iPoisson_g_poisson.*EBxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(EBxPFC_V(n,:)-p.EBxPFC_ctx_iPoisson_E_poisson);
  IBxPFC_ctx_iPoisson_g_poisson(n,:)=p.IBxPFC_ctx_iPoisson_g_poisson.*IBxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  IBxPFC_ctx_iPoisson_I_poisson(n,:)=-((p.IBxPFC_ctx_iPoisson_g_poisson.*IBxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(IBxPFC_V(n,:)-p.IBxPFC_ctx_iPoisson_E_poisson);
  ECxPFC_ctx_iPoisson_g_poisson(n,:)=p.ECxPFC_ctx_iPoisson_g_poisson.*ECxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  ECxPFC_ctx_iPoisson_I_poisson(n,:)=-((p.ECxPFC_ctx_iPoisson_g_poisson.*ECxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(ECxPFC_V(n,:)-p.ECxPFC_ctx_iPoisson_E_poisson);
  ICxPFC_ctx_iPoisson_g_poisson(n,:)=p.ICxPFC_ctx_iPoisson_g_poisson.*ICxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:);
  ICxPFC_ctx_iPoisson_I_poisson(n,:)=-((p.ICxPFC_ctx_iPoisson_g_poisson.*ICxPFC_ctx_iPoisson_s_poisson(1+floor(t/(0.5*dt)),:))).*(ICxPFC_V(n,:)-p.ICxPFC_ctx_iPoisson_E_poisson);
  IAxV4_EAxV4_iPoisson_gPoisson(n,:)=p.IAxV4_EAxV4_iPoisson_gext.*IAxV4_EAxV4_iPoisson_s(k,:);
  EAxV4_EAxV4_iPoisson_gPoisson(n,:)=p.EAxV4_EAxV4_iPoisson_gext.*EAxV4_EAxV4_iPoisson_s(k,:);
  EAxV4_IAxV4_iPoisson_gPoisson(n,:)=p.EAxV4_IAxV4_iPoisson_gext.*EAxV4_IAxV4_iPoisson_s(k,:);
  IAxV4_IAxV4_iPoisson_gPoisson(n,:)=p.IAxV4_IAxV4_iPoisson_gext.*IAxV4_IAxV4_iPoisson_s(k,:);
  IBxV4_EBxV4_iPoisson_gPoisson(n,:)=p.IBxV4_EBxV4_iPoisson_gext.*IBxV4_EBxV4_iPoisson_s(k,:);
  EBxV4_EBxV4_iPoisson_gPoisson(n,:)=p.EBxV4_EBxV4_iPoisson_gext.*EBxV4_EBxV4_iPoisson_s(k,:);
  EBxV4_IBxV4_iPoisson_gPoisson(n,:)=p.EBxV4_IBxV4_iPoisson_gext.*EBxV4_IBxV4_iPoisson_s(k,:);
  IBxV4_IBxV4_iPoisson_gPoisson(n,:)=p.IBxV4_IBxV4_iPoisson_gext.*IBxV4_IBxV4_iPoisson_s(k,:);
  ICxV4_ECxV4_iPoisson_gPoisson(n,:)=p.ICxV4_ECxV4_iPoisson_gext.*ICxV4_ECxV4_iPoisson_s(k,:);
  ECxV4_ECxV4_iPoisson_gPoisson(n,:)=p.ECxV4_ECxV4_iPoisson_gext.*ECxV4_ECxV4_iPoisson_s(k,:);
  ECxV4_ICxV4_iPoisson_gPoisson(n,:)=p.ECxV4_ICxV4_iPoisson_gext.*ECxV4_ICxV4_iPoisson_s(k,:);
  ICxV4_ICxV4_iPoisson_gPoisson(n,:)=p.ICxV4_ICxV4_iPoisson_gext.*ICxV4_ICxV4_iPoisson_s(k,:);
  midExV4_EAxV4_iPoisson_gPoisson(n,:)=p.midExV4_EAxV4_iPoisson_gext.*midExV4_EAxV4_iPoisson_s(k,:);
  midExV4_IAxV4_iPoisson_gPoisson(n,:)=p.midExV4_IAxV4_iPoisson_gext.*midExV4_IAxV4_iPoisson_s(k,:);
  midExV4_EBxV4_iPoisson_gPoisson(n,:)=p.midExV4_EBxV4_iPoisson_gext.*midExV4_EBxV4_iPoisson_s(k,:);
  midExV4_IBxV4_iPoisson_gPoisson(n,:)=p.midExV4_IBxV4_iPoisson_gext.*midExV4_IBxV4_iPoisson_s(k,:);
  midExV4_ECxV4_iPoisson_gPoisson(n,:)=p.midExV4_ECxV4_iPoisson_gext.*midExV4_ECxV4_iPoisson_s(k,:);
  midExV4_ICxV4_iPoisson_gPoisson(n,:)=p.midExV4_ICxV4_iPoisson_gext.*midExV4_ICxV4_iPoisson_s(k,:);
  IAxPFC_EAxPFC_iPoisson_gPoisson(n,:)=p.IAxPFC_EAxPFC_iPoisson_gext.*IAxPFC_EAxPFC_iPoisson_s(k,:);
  EAxPFC_EAxPFC_iPoisson_gPoisson(n,:)=p.EAxPFC_EAxPFC_iPoisson_gext.*EAxPFC_EAxPFC_iPoisson_s(k,:);
  EAxPFC_IAxPFC_iPoisson_gPoisson(n,:)=p.EAxPFC_IAxPFC_iPoisson_gext.*EAxPFC_IAxPFC_iPoisson_s(k,:);
  IAxPFC_IAxPFC_iPoisson_gPoisson(n,:)=p.IAxPFC_IAxPFC_iPoisson_gext.*IAxPFC_IAxPFC_iPoisson_s(k,:);
  IBxPFC_EBxPFC_iPoisson_gPoisson(n,:)=p.IBxPFC_EBxPFC_iPoisson_gext.*IBxPFC_EBxPFC_iPoisson_s(k,:);
  EBxPFC_EBxPFC_iPoisson_gPoisson(n,:)=p.EBxPFC_EBxPFC_iPoisson_gext.*EBxPFC_EBxPFC_iPoisson_s(k,:);
  EBxPFC_IBxPFC_iPoisson_gPoisson(n,:)=p.EBxPFC_IBxPFC_iPoisson_gext.*EBxPFC_IBxPFC_iPoisson_s(k,:);
  IBxPFC_IBxPFC_iPoisson_gPoisson(n,:)=p.IBxPFC_IBxPFC_iPoisson_gext.*IBxPFC_IBxPFC_iPoisson_s(k,:);
  ICxPFC_ECxPFC_iPoisson_gPoisson(n,:)=p.ICxPFC_ECxPFC_iPoisson_gext.*ICxPFC_ECxPFC_iPoisson_s(k,:);
  ECxPFC_ECxPFC_iPoisson_gPoisson(n,:)=p.ECxPFC_ECxPFC_iPoisson_gext.*ECxPFC_ECxPFC_iPoisson_s(k,:);
  ECxPFC_ICxPFC_iPoisson_gPoisson(n,:)=p.ECxPFC_ICxPFC_iPoisson_gext.*ECxPFC_ICxPFC_iPoisson_s(k,:);
  ICxPFC_ICxPFC_iPoisson_gPoisson(n,:)=p.ICxPFC_ICxPFC_iPoisson_gext.*ICxPFC_ICxPFC_iPoisson_s(k,:);
  midExPFC_EAxPFC_iPoisson_gPoisson(n,:)=p.midExPFC_EAxPFC_iPoisson_gext.*midExPFC_EAxPFC_iPoisson_s(k,:);
  midExPFC_IAxPFC_iPoisson_gPoisson(n,:)=p.midExPFC_IAxPFC_iPoisson_gext.*midExPFC_IAxPFC_iPoisson_s(k,:);
  midExPFC_EBxPFC_iPoisson_gPoisson(n,:)=p.midExPFC_EBxPFC_iPoisson_gext.*midExPFC_EBxPFC_iPoisson_s(k,:);
  midExPFC_IBxPFC_iPoisson_gPoisson(n,:)=p.midExPFC_IBxPFC_iPoisson_gext.*midExPFC_IBxPFC_iPoisson_s(k,:);
  midExPFC_ECxPFC_iPoisson_gPoisson(n,:)=p.midExPFC_ECxPFC_iPoisson_gext.*midExPFC_ECxPFC_iPoisson_s(k,:);
  midExPFC_ICxPFC_iPoisson_gPoisson(n,:)=p.midExPFC_ICxPFC_iPoisson_gext.*midExPFC_ICxPFC_iPoisson_s(k,:);
  midExPFC_deepExV4_iPoisson_gPoisson(n,:)=p.midExPFC_deepExV4_iPoisson_gext.*midExPFC_deepExV4_iPoisson_s(k,:);
  midIxPFC_deepIxV4_iPoisson_gPoisson(n,:)=p.midIxPFC_deepIxV4_iPoisson_gext.*midIxPFC_deepIxV4_iPoisson_s(k,:);

    n=n+1;
  end
end

T=T(1:downsample_factor:ntime);

end
