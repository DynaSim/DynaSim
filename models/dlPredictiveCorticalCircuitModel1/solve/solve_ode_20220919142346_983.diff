1c1
< function [T,supExV4_V,supExV4_iNa_m,supExV4_iNa_h,supExV4_iK_n,supIxV4_V,supIxV4_iNa_m,supIxV4_iNa_h,supIxV4_iK_n,midExV4_V,midExV4_iNa_m,midExV4_iNa_h,midExV4_iK_n,midIxV4_V,midIxV4_iNa_m,midIxV4_iNa_h,midIxV4_iK_n,deepExV4_V,deepExV4_iNa_m,deepExV4_iNa_h,deepExV4_iK_n,deepIxV4_V,deepIxV4_iNa_m,deepIxV4_iNa_h,deepIxV4_iK_n,EAxV4_V,EAxV4_iNa_m,EAxV4_iNa_h,EAxV4_iK_n,IAxV4_V,IAxV4_iNa_m,IAxV4_iNa_h,IAxV4_iK_n,EBxV4_V,EBxV4_iNa_m,EBxV4_iNa_h,EBxV4_iK_n,IBxV4_V,IBxV4_iNa_m,IBxV4_iNa_h,IBxV4_iK_n,ECxV4_V,ECxV4_iNa_m,ECxV4_iNa_h,ECxV4_iK_n,ICxV4_V,ICxV4_iNa_m,ICxV4_iNa_h,ICxV4_iK_n,supExPFC_V,supExPFC_iNa_m,supExPFC_iNa_h,supExPFC_iK_n,supIxPFC_V,supIxPFC_iNa_m,supIxPFC_iNa_h,supIxPFC_iK_n,midExPFC_V,midExPFC_iNa_m,midExPFC_iNa_h,midExPFC_iK_n,midIxPFC_V,midIxPFC_iNa_m,midIxPFC_iNa_h,midIxPFC_iK_n,deepExPFC_V,deepExPFC_iNa_m,deepExPFC_iNa_h,deepExPFC_iK_n,deepIxPFC_V,deepIxPFC_iNa_m,deepIxPFC_iNa_h,deepIxPFC_iK_n,EAxPFC_V,EAxPFC_iNa_m,EAxPFC_iNa_h,EAxPFC_iK_n,IAxPFC_V,IAxPFC_iNa_m,IAxPFC_iNa_h,IAxPFC_iK_n,EBxPFC_V,EBxPFC_iNa_m,EBxPFC_iNa_h,EBxPFC_iK_n,IBxPFC_V,IBxPFC_iNa_m,IBxPFC_iNa_h,IBxPFC_iK_n,ECxPFC_V,ECxPFC_iNa_m,ECxPFC_iNa_h,ECxPFC_iK_n,ICxPFC_V,ICxPFC_iNa_m,ICxPFC_iNa_h,ICxPFC_iK_n,supIxV4_supExV4_iAMPActx_s,supExV4_supExV4_iAMPActx_s,supExV4_supIxV4_iGABActx_s,supIxV4_supIxV4_iGABActx_s,midIxV4_midExV4_iAMPActx_s,midExV4_midExV4_iAMPActx_s,midExV4_midIxV4_iGABActx_s,midIxV4_midIxV4_iGABActx_s,deepIxV4_deepExV4_iAMPActx_s,deepExV4_deepExV4_iAMPActx_s,deepExV4_deepIxV4_iGABActx_s,deepIxV4_deepIxV4_iGABActx_s,IAxV4_EAxV4_iAMPActx_s,EAxV4_EAxV4_iAMPActx_s,EAxV4_IAxV4_iAMPActx_s,IAxV4_IAxV4_iAMPActx_s,IBxV4_EBxV4_iAMPActx_s,EBxV4_EBxV4_iAMPActx_s,EBxV4_IBxV4_iAMPActx_s,IBxV4_IBxV4_iAMPActx_s,ICxV4_ECxV4_iAMPActx_s,ECxV4_ECxV4_iAMPActx_s,ECxV4_ICxV4_iAMPActx_s,ICxV4_ICxV4_iAMPActx_s,midExV4_EAxV4_iAMPActx_s,midExV4_IAxV4_iAMPActx_s,midExV4_EBxV4_iAMPActx_s,midExV4_IBxV4_iAMPActx_s,midExV4_ECxV4_iAMPActx_s,midExV4_ICxV4_iAMPActx_s,supExV4_midExV4_iAMPActx_s,deepExV4_midExV4_iAMPActx_s,deepExV4_midIxV4_iGABActx_s,deepExV4_supExV4_iAMPActx_s,supIxPFC_supExPFC_iAMPActx_s,supExPFC_supExPFC_iAMPActx_s,supExPFC_supIxPFC_iGABActx_s,supIxPFC_supIxPFC_iGABActx_s,midIxPFC_midExPFC_iAMPActx_s,midExPFC_midExPFC_iAMPActx_s,midExPFC_midIxPFC_iGABActx_s,midIxPFC_midIxPFC_iGABActx_s,deepIxPFC_deepExPFC_iAMPActx_s,deepExPFC_deepExPFC_iAMPActx_s,deepExPFC_deepIxPFC_iGABActx_s,deepIxPFC_deepIxPFC_iGABActx_s,IAxPFC_EAxPFC_iAMPActx_s,EAxPFC_EAxPFC_iAMPActx_s,EAxPFC_IAxPFC_iAMPActx_s,IAxPFC_IAxPFC_iAMPActx_s,IBxPFC_EBxPFC_iAMPActx_s,EBxPFC_EBxPFC_iAMPActx_s,EBxPFC_IBxPFC_iAMPActx_s,IBxPFC_IBxPFC_iAMPActx_s,ICxPFC_ECxPFC_iAMPActx_s,ECxPFC_ECxPFC_iAMPActx_s,ECxPFC_ICxPFC_iAMPActx_s,ICxPFC_ICxPFC_iAMPActx_s,midExPFC_EAxPFC_iAMPActx_s,midExPFC_IAxPFC_iAMPActx_s,midExPFC_EBxPFC_iAMPActx_s,midExPFC_IBxPFC_iAMPActx_s,midExPFC_ECxPFC_iAMPActx_s,midExPFC_ICxPFC_iAMPActx_s,supExPFC_midExPFC_iAMPActx_s,deepExPFC_midExPFC_iAMPActx_s,deepExPFC_midIxPFC_iGABActx_s,deepExPFC_supExPFC_iAMPActx_s,midExPFC_supExV4_iAMPActx_s,midIxPFC_supIxV4_iAMPActx_s,midIxV4_deepIxPFC_iAMPActx_s,midExV4_deepExPFC_iAMPActx_s]=solve_ode
---
> function [T,supExV4_V,supExV4_iNa_m,supExV4_iNa_h,supExV4_iK_n,supIxV4_V,supIxV4_iNa_m,supIxV4_iNa_h,supIxV4_iK_n,midExV4_V,midExV4_iNa_m,midExV4_iNa_h,midExV4_iK_n,midIxV4_V,midIxV4_iNa_m,midIxV4_iNa_h,midIxV4_iK_n,deepExV4_V,deepExV4_iNa_m,deepExV4_iNa_h,deepExV4_iK_n,deepIxV4_V,deepIxV4_iNa_m,deepIxV4_iNa_h,deepIxV4_iK_n,EAxV4_V,EAxV4_iNa_m,EAxV4_iNa_h,EAxV4_iK_n,IAxV4_V,IAxV4_iNa_m,IAxV4_iNa_h,IAxV4_iK_n,EBxV4_V,EBxV4_iNa_m,EBxV4_iNa_h,EBxV4_iK_n,IBxV4_V,IBxV4_iNa_m,IBxV4_iNa_h,IBxV4_iK_n,ECxV4_V,ECxV4_iNa_m,ECxV4_iNa_h,ECxV4_iK_n,ICxV4_V,ICxV4_iNa_m,ICxV4_iNa_h,ICxV4_iK_n,supExPFC_V,supExPFC_iNa_m,supExPFC_iNa_h,supExPFC_iK_n,supIxPFC_V,supIxPFC_iNa_m,supIxPFC_iNa_h,supIxPFC_iK_n,midExPFC_V,midExPFC_iNa_m,midExPFC_iNa_h,midExPFC_iK_n,midIxPFC_V,midIxPFC_iNa_m,midIxPFC_iNa_h,midIxPFC_iK_n,deepExPFC_V,deepExPFC_iNa_m,deepExPFC_iNa_h,deepExPFC_iK_n,deepIxPFC_V,deepIxPFC_iNa_m,deepIxPFC_iNa_h,deepIxPFC_iK_n,EAxPFC_V,EAxPFC_iNa_m,EAxPFC_iNa_h,EAxPFC_iK_n,IAxPFC_V,IAxPFC_iNa_m,IAxPFC_iNa_h,IAxPFC_iK_n,EBxPFC_V,EBxPFC_iNa_m,EBxPFC_iNa_h,EBxPFC_iK_n,IBxPFC_V,IBxPFC_iNa_m,IBxPFC_iNa_h,IBxPFC_iK_n,ECxPFC_V,ECxPFC_iNa_m,ECxPFC_iNa_h,ECxPFC_iK_n,ICxPFC_V,ICxPFC_iNa_m,ICxPFC_iNa_h,ICxPFC_iK_n,supIxV4_supExV4_iAMPActx_s,supExV4_supExV4_iAMPActx_s,supExV4_supIxV4_iGABActx_s,supIxV4_supIxV4_iGABActx_s,midIxV4_midExV4_iAMPActx_s,midExV4_midExV4_iAMPActx_s,midExV4_midIxV4_iGABActx_s,midIxV4_midIxV4_iGABActx_s,deepIxV4_deepExV4_iAMPActx_s,deepExV4_deepExV4_iAMPActx_s,deepExV4_deepIxV4_iGABActx_s,deepIxV4_deepIxV4_iGABActx_s,IAxV4_EAxV4_iAMPActx_s,EAxV4_EAxV4_iAMPActx_s,EAxV4_IAxV4_iAMPActx_s,IAxV4_IAxV4_iAMPActx_s,IBxV4_EBxV4_iAMPActx_s,EBxV4_EBxV4_iAMPActx_s,EBxV4_IBxV4_iAMPActx_s,IBxV4_IBxV4_iAMPActx_s,ICxV4_ECxV4_iAMPActx_s,ECxV4_ECxV4_iAMPActx_s,ECxV4_ICxV4_iAMPActx_s,ICxV4_ICxV4_iAMPActx_s,midExV4_EAxV4_iAMPActx_s,midExV4_IAxV4_iAMPActx_s,midExV4_EBxV4_iAMPActx_s,midExV4_IBxV4_iAMPActx_s,midExV4_ECxV4_iAMPActx_s,midExV4_ICxV4_iAMPActx_s,supExV4_midExV4_iAMPActx_s,deepExV4_midExV4_iAMPActx_s,deepExV4_midIxV4_iGABActx_s,deepExV4_supExV4_iAMPActx_s,supIxPFC_supExPFC_iAMPActx_s,supExPFC_supExPFC_iAMPActx_s,supExPFC_supIxPFC_iGABActx_s,supIxPFC_supIxPFC_iGABActx_s,midIxPFC_midExPFC_iAMPActx_s,midExPFC_midExPFC_iAMPActx_s,midExPFC_midIxPFC_iGABActx_s,midIxPFC_midIxPFC_iGABActx_s,deepIxPFC_deepExPFC_iAMPActx_s,deepExPFC_deepExPFC_iAMPActx_s,deepExPFC_deepIxPFC_iGABActx_s,deepIxPFC_deepIxPFC_iGABActx_s,IAxPFC_EAxPFC_iAMPActx_s,EAxPFC_EAxPFC_iAMPActx_s,EAxPFC_IAxPFC_iAMPActx_s,IAxPFC_IAxPFC_iAMPActx_s,IBxPFC_EBxPFC_iAMPActx_s,EBxPFC_EBxPFC_iAMPActx_s,EBxPFC_IBxPFC_iAMPActx_s,IBxPFC_IBxPFC_iAMPActx_s,ICxPFC_ECxPFC_iAMPActx_s,ECxPFC_ECxPFC_iAMPActx_s,ECxPFC_ICxPFC_iAMPActx_s,ICxPFC_ICxPFC_iAMPActx_s,midExPFC_EAxPFC_iAMPActx_s,midExPFC_IAxPFC_iAMPActx_s,midExPFC_EBxPFC_iAMPActx_s,midExPFC_IBxPFC_iAMPActx_s,midExPFC_ECxPFC_iAMPActx_s,midExPFC_ICxPFC_iAMPActx_s,supExPFC_midExPFC_iAMPActx_s,deepExPFC_midExPFC_iAMPActx_s,deepExPFC_midIxPFC_iGABActx_s,deepExPFC_supExPFC_iAMPActx_s,midExPFC_deepExV4_iAMPActx_s,midIxPFC_deepIxV4_iAMPActx_s]=solve_ode
515,526c515,520
< midExPFC_supExV4_iAMPActx_s_last =  p.midExPFC_supExV4_iAMPActx_IC+p.midExPFC_supExV4_iAMPActx_IC_noise.*rand(1,p.supExV4_Npop);
< midExPFC_supExV4_iAMPActx_s = zeros(nsamp,p.supExV4_Npop);
< midExPFC_supExV4_iAMPActx_s(1,:) = midExPFC_supExV4_iAMPActx_s_last;
< midIxPFC_supIxV4_iAMPActx_s_last =  p.midIxPFC_supIxV4_iAMPActx_IC+p.midIxPFC_supIxV4_iAMPActx_IC_noise.*rand(1,p.supIxV4_Npop);
< midIxPFC_supIxV4_iAMPActx_s = zeros(nsamp,p.supIxV4_Npop);
< midIxPFC_supIxV4_iAMPActx_s(1,:) = midIxPFC_supIxV4_iAMPActx_s_last;
< midIxV4_deepIxPFC_iAMPActx_s_last =  p.midIxV4_deepIxPFC_iAMPActx_IC+p.midIxV4_deepIxPFC_iAMPActx_IC_noise.*rand(1,p.deepIxPFC_Npop);
< midIxV4_deepIxPFC_iAMPActx_s = zeros(nsamp,p.deepIxPFC_Npop);
< midIxV4_deepIxPFC_iAMPActx_s(1,:) = midIxV4_deepIxPFC_iAMPActx_s_last;
< midExV4_deepExPFC_iAMPActx_s_last =  p.midExV4_deepExPFC_iAMPActx_IC+p.midExV4_deepExPFC_iAMPActx_IC_noise.*rand(1,p.deepExPFC_Npop);
< midExV4_deepExPFC_iAMPActx_s = zeros(nsamp,p.deepExPFC_Npop);
< midExV4_deepExPFC_iAMPActx_s(1,:) = midExV4_deepExPFC_iAMPActx_s_last;
---
> midExPFC_deepExV4_iAMPActx_s_last =  p.midExPFC_deepExV4_iAMPActx_IC+p.midExPFC_deepExV4_iAMPActx_IC_noise.*rand(1,p.deepExV4_Npop);
> midExPFC_deepExV4_iAMPActx_s = zeros(nsamp,p.deepExV4_Npop);
> midExPFC_deepExV4_iAMPActx_s(1,:) = midExPFC_deepExV4_iAMPActx_s_last;
> midIxPFC_deepIxV4_iAMPActx_s_last =  p.midIxPFC_deepIxV4_iAMPActx_IC+p.midIxPFC_deepIxV4_iAMPActx_IC_noise.*rand(1,p.deepIxV4_Npop);
> midIxPFC_deepIxV4_iAMPActx_s = zeros(nsamp,p.deepIxV4_Npop);
> midIxPFC_deepIxV4_iAMPActx_s(1,:) = midIxPFC_deepIxV4_iAMPActx_s_last;
542c536
< midExV4_V_k1 = (p.midExV4_Iapp + ((((-p.midExV4_iNa_gNa.*midExV4_iNa_m_last.^3.*midExV4_iNa_h_last.*(midExV4_V_last-p.midExV4_iNa_ENa))))+((((-p.midExV4_iK_gK.*midExV4_iK_n_last.^4.*(midExV4_V_last-p.midExV4_iK_EK))))+((-(((p.midExV4_midExV4_iAMPActx_gAMPA.*(midExV4_midExV4_iAMPActx_s_last*p.midExV4_midExV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_midExV4_iAMPActx_EAMPA)))))+((((-p.midExV4_midIxV4_iGABActx_gGABAa.*(midExV4_midIxV4_iGABActx_s_last*p.midExV4_midIxV4_iGABActx_netcon).*(midExV4_V_last-p.midExV4_midIxV4_iGABActx_EGABAa))))+((-(((p.midExV4_EAxV4_iAMPActx_gAMPA.*(midExV4_EAxV4_iAMPActx_s_last*p.midExV4_EAxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_EAxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_IAxV4_iAMPActx_gAMPA.*(midExV4_IAxV4_iAMPActx_s_last*p.midExV4_IAxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_IAxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_EBxV4_iAMPActx_gAMPA.*(midExV4_EBxV4_iAMPActx_s_last*p.midExV4_EBxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_EBxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_IBxV4_iAMPActx_gAMPA.*(midExV4_IBxV4_iAMPActx_s_last*p.midExV4_IBxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_IBxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_ECxV4_iAMPActx_gAMPA.*(midExV4_ECxV4_iAMPActx_s_last*p.midExV4_ECxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_ECxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_ICxV4_iAMPActx_gAMPA.*(midExV4_ICxV4_iAMPActx_s_last*p.midExV4_ICxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_ICxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_deepExPFC_iAMPActx_gAMPA.*(midExV4_deepExPFC_iAMPActx_s_last*p.midExV4_deepExPFC_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_deepExPFC_iAMPActx_EAMPA)))))))))))))))) + p.midExV4_noise*randn(1, p.midExV4_Npop))/p.midExV4_C;
---
> midExV4_V_k1 = (p.midExV4_Iapp + ((((-p.midExV4_iNa_gNa.*midExV4_iNa_m_last.^3.*midExV4_iNa_h_last.*(midExV4_V_last-p.midExV4_iNa_ENa))))+((((-p.midExV4_iK_gK.*midExV4_iK_n_last.^4.*(midExV4_V_last-p.midExV4_iK_EK))))+((-(((p.midExV4_midExV4_iAMPActx_gAMPA.*(midExV4_midExV4_iAMPActx_s_last*p.midExV4_midExV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_midExV4_iAMPActx_EAMPA)))))+((((-p.midExV4_midIxV4_iGABActx_gGABAa.*(midExV4_midIxV4_iGABActx_s_last*p.midExV4_midIxV4_iGABActx_netcon).*(midExV4_V_last-p.midExV4_midIxV4_iGABActx_EGABAa))))+((-(((p.midExV4_EAxV4_iAMPActx_gAMPA.*(midExV4_EAxV4_iAMPActx_s_last*p.midExV4_EAxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_EAxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_IAxV4_iAMPActx_gAMPA.*(midExV4_IAxV4_iAMPActx_s_last*p.midExV4_IAxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_IAxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_EBxV4_iAMPActx_gAMPA.*(midExV4_EBxV4_iAMPActx_s_last*p.midExV4_EBxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_EBxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_IBxV4_iAMPActx_gAMPA.*(midExV4_IBxV4_iAMPActx_s_last*p.midExV4_IBxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_IBxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_ECxV4_iAMPActx_gAMPA.*(midExV4_ECxV4_iAMPActx_s_last*p.midExV4_ECxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_ECxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_ICxV4_iAMPActx_gAMPA.*(midExV4_ICxV4_iAMPActx_s_last*p.midExV4_ICxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_ICxV4_iAMPActx_EAMPA))))))))))))))) + p.midExV4_noise*randn(1, p.midExV4_Npop))/p.midExV4_C;
546c540
< midIxV4_V_k1 = (p.midIxV4_Iapp + ((((-p.midIxV4_iNa_gNa.*midIxV4_iNa_m_last.^3.*midIxV4_iNa_h_last.*(midIxV4_V_last-p.midIxV4_iNa_ENa))))+((((-p.midIxV4_iK_gK.*midIxV4_iK_n_last.^4.*(midIxV4_V_last-p.midIxV4_iK_EK))))+((-(((p.midIxV4_midExV4_iAMPActx_gAMPA.*(midIxV4_midExV4_iAMPActx_s_last*p.midIxV4_midExV4_iAMPActx_netcon).*(midIxV4_V_last-p.midIxV4_midExV4_iAMPActx_EAMPA)))))+((((-p.midIxV4_midIxV4_iGABActx_gGABAa.*(midIxV4_midIxV4_iGABActx_s_last*p.midIxV4_midIxV4_iGABActx_netcon).*(midIxV4_V_last-p.midIxV4_midIxV4_iGABActx_EGABAa))))+((-(((p.midIxV4_deepIxPFC_iAMPActx_gAMPA.*(midIxV4_deepIxPFC_iAMPActx_s_last*p.midIxV4_deepIxPFC_iAMPActx_netcon).*(midIxV4_V_last-p.midIxV4_deepIxPFC_iAMPActx_EAMPA)))))))))) + p.midIxV4_noise*randn(1, p.midIxV4_Npop))/p.midIxV4_C;
---
> midIxV4_V_k1 = (p.midIxV4_Iapp + ((((-p.midIxV4_iNa_gNa.*midIxV4_iNa_m_last.^3.*midIxV4_iNa_h_last.*(midIxV4_V_last-p.midIxV4_iNa_ENa))))+((((-p.midIxV4_iK_gK.*midIxV4_iK_n_last.^4.*(midIxV4_V_last-p.midIxV4_iK_EK))))+((-(((p.midIxV4_midExV4_iAMPActx_gAMPA.*(midIxV4_midExV4_iAMPActx_s_last*p.midIxV4_midExV4_iAMPActx_netcon).*(midIxV4_V_last-p.midIxV4_midExV4_iAMPActx_EAMPA)))))+((((-p.midIxV4_midIxV4_iGABActx_gGABAa.*(midIxV4_midIxV4_iGABActx_s_last*p.midIxV4_midIxV4_iGABActx_netcon).*(midIxV4_V_last-p.midIxV4_midIxV4_iGABActx_EGABAa)))))))) + p.midIxV4_noise*randn(1, p.midIxV4_Npop))/p.midIxV4_C;
590c584
< midExPFC_V_k1 = (p.midExPFC_Iapp + ((((-p.midExPFC_iNa_gNa.*midExPFC_iNa_m_last.^3.*midExPFC_iNa_h_last.*(midExPFC_V_last-p.midExPFC_iNa_ENa))))+((((-p.midExPFC_iK_gK.*midExPFC_iK_n_last.^4.*(midExPFC_V_last-p.midExPFC_iK_EK))))+((-(((p.midExPFC_midExPFC_iAMPActx_gAMPA.*(midExPFC_midExPFC_iAMPActx_s_last*p.midExPFC_midExPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_midExPFC_iAMPActx_EAMPA)))))+((((-p.midExPFC_midIxPFC_iGABActx_gGABAa.*(midExPFC_midIxPFC_iGABActx_s_last*p.midExPFC_midIxPFC_iGABActx_netcon).*(midExPFC_V_last-p.midExPFC_midIxPFC_iGABActx_EGABAa))))+((-(((p.midExPFC_EAxPFC_iAMPActx_gAMPA.*(midExPFC_EAxPFC_iAMPActx_s_last*p.midExPFC_EAxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_EAxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_IAxPFC_iAMPActx_gAMPA.*(midExPFC_IAxPFC_iAMPActx_s_last*p.midExPFC_IAxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_IAxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_EBxPFC_iAMPActx_gAMPA.*(midExPFC_EBxPFC_iAMPActx_s_last*p.midExPFC_EBxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_EBxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_IBxPFC_iAMPActx_gAMPA.*(midExPFC_IBxPFC_iAMPActx_s_last*p.midExPFC_IBxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_IBxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_ECxPFC_iAMPActx_gAMPA.*(midExPFC_ECxPFC_iAMPActx_s_last*p.midExPFC_ECxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_ECxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_ICxPFC_iAMPActx_gAMPA.*(midExPFC_ICxPFC_iAMPActx_s_last*p.midExPFC_ICxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_ICxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_supExV4_iAMPActx_gAMPA.*(midExPFC_supExV4_iAMPActx_s_last*p.midExPFC_supExV4_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_supExV4_iAMPActx_EAMPA)))))))))))))))) + p.midExPFC_noise*randn(1, p.midExPFC_Npop))/p.midExPFC_C;
---
> midExPFC_V_k1 = (p.midExPFC_Iapp + ((((-p.midExPFC_iNa_gNa.*midExPFC_iNa_m_last.^3.*midExPFC_iNa_h_last.*(midExPFC_V_last-p.midExPFC_iNa_ENa))))+((((-p.midExPFC_iK_gK.*midExPFC_iK_n_last.^4.*(midExPFC_V_last-p.midExPFC_iK_EK))))+((-(((p.midExPFC_midExPFC_iAMPActx_gAMPA.*(midExPFC_midExPFC_iAMPActx_s_last*p.midExPFC_midExPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_midExPFC_iAMPActx_EAMPA)))))+((((-p.midExPFC_midIxPFC_iGABActx_gGABAa.*(midExPFC_midIxPFC_iGABActx_s_last*p.midExPFC_midIxPFC_iGABActx_netcon).*(midExPFC_V_last-p.midExPFC_midIxPFC_iGABActx_EGABAa))))+((-(((p.midExPFC_EAxPFC_iAMPActx_gAMPA.*(midExPFC_EAxPFC_iAMPActx_s_last*p.midExPFC_EAxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_EAxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_IAxPFC_iAMPActx_gAMPA.*(midExPFC_IAxPFC_iAMPActx_s_last*p.midExPFC_IAxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_IAxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_EBxPFC_iAMPActx_gAMPA.*(midExPFC_EBxPFC_iAMPActx_s_last*p.midExPFC_EBxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_EBxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_IBxPFC_iAMPActx_gAMPA.*(midExPFC_IBxPFC_iAMPActx_s_last*p.midExPFC_IBxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_IBxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_ECxPFC_iAMPActx_gAMPA.*(midExPFC_ECxPFC_iAMPActx_s_last*p.midExPFC_ECxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_ECxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_ICxPFC_iAMPActx_gAMPA.*(midExPFC_ICxPFC_iAMPActx_s_last*p.midExPFC_ICxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_ICxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_deepExV4_iAMPActx_gAMPA.*(midExPFC_deepExV4_iAMPActx_s_last*p.midExPFC_deepExV4_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_deepExV4_iAMPActx_EAMPA)))))))))))))))) + p.midExPFC_noise*randn(1, p.midExPFC_Npop))/p.midExPFC_C;
594c588
< midIxPFC_V_k1 = (p.midIxPFC_Iapp + ((((-p.midIxPFC_iNa_gNa.*midIxPFC_iNa_m_last.^3.*midIxPFC_iNa_h_last.*(midIxPFC_V_last-p.midIxPFC_iNa_ENa))))+((((-p.midIxPFC_iK_gK.*midIxPFC_iK_n_last.^4.*(midIxPFC_V_last-p.midIxPFC_iK_EK))))+((-(((p.midIxPFC_midExPFC_iAMPActx_gAMPA.*(midIxPFC_midExPFC_iAMPActx_s_last*p.midIxPFC_midExPFC_iAMPActx_netcon).*(midIxPFC_V_last-p.midIxPFC_midExPFC_iAMPActx_EAMPA)))))+((((-p.midIxPFC_midIxPFC_iGABActx_gGABAa.*(midIxPFC_midIxPFC_iGABActx_s_last*p.midIxPFC_midIxPFC_iGABActx_netcon).*(midIxPFC_V_last-p.midIxPFC_midIxPFC_iGABActx_EGABAa))))+((-(((p.midIxPFC_supIxV4_iAMPActx_gAMPA.*(midIxPFC_supIxV4_iAMPActx_s_last*p.midIxPFC_supIxV4_iAMPActx_netcon).*(midIxPFC_V_last-p.midIxPFC_supIxV4_iAMPActx_EAMPA)))))))))) + p.midIxPFC_noise*randn(1, p.midIxPFC_Npop))/p.midIxPFC_C;
---
> midIxPFC_V_k1 = (p.midIxPFC_Iapp + ((((-p.midIxPFC_iNa_gNa.*midIxPFC_iNa_m_last.^3.*midIxPFC_iNa_h_last.*(midIxPFC_V_last-p.midIxPFC_iNa_ENa))))+((((-p.midIxPFC_iK_gK.*midIxPFC_iK_n_last.^4.*(midIxPFC_V_last-p.midIxPFC_iK_EK))))+((-(((p.midIxPFC_midExPFC_iAMPActx_gAMPA.*(midIxPFC_midExPFC_iAMPActx_s_last*p.midIxPFC_midExPFC_iAMPActx_netcon).*(midIxPFC_V_last-p.midIxPFC_midExPFC_iAMPActx_EAMPA)))))+((((-p.midIxPFC_midIxPFC_iGABActx_gGABAa.*(midIxPFC_midIxPFC_iGABActx_s_last*p.midIxPFC_midIxPFC_iGABActx_netcon).*(midIxPFC_V_last-p.midIxPFC_midIxPFC_iGABActx_EGABAa))))+((-(((p.midIxPFC_deepIxV4_iAMPActx_gAMPA.*(midIxPFC_deepIxV4_iAMPActx_s_last*p.midIxPFC_deepIxV4_iAMPActx_netcon).*(midIxPFC_V_last-p.midIxPFC_deepIxV4_iAMPActx_EAMPA)))))))))) + p.midIxPFC_noise*randn(1, p.midIxPFC_Npop))/p.midIxPFC_C;
698,701c692,693
< midExPFC_supExV4_iAMPActx_s_k1 = -midExPFC_supExV4_iAMPActx_s_last./p.midExPFC_supExV4_iAMPActx_tauAMPA + ((1-midExPFC_supExV4_iAMPActx_s_last)/p.midExPFC_supExV4_iAMPActx_tauAMPAr).*(1+tanh(supExV4_V_last/10));
< midIxPFC_supIxV4_iAMPActx_s_k1 = -midIxPFC_supIxV4_iAMPActx_s_last./p.midIxPFC_supIxV4_iAMPActx_tauAMPA + ((1-midIxPFC_supIxV4_iAMPActx_s_last)/p.midIxPFC_supIxV4_iAMPActx_tauAMPAr).*(1+tanh(supIxV4_V_last/10));
< midIxV4_deepIxPFC_iAMPActx_s_k1 = -midIxV4_deepIxPFC_iAMPActx_s_last./p.midIxV4_deepIxPFC_iAMPActx_tauAMPA + ((1-midIxV4_deepIxPFC_iAMPActx_s_last)/p.midIxV4_deepIxPFC_iAMPActx_tauAMPAr).*(1+tanh(deepIxPFC_V_last/10));
< midExV4_deepExPFC_iAMPActx_s_k1 = -midExV4_deepExPFC_iAMPActx_s_last./p.midExV4_deepExPFC_iAMPActx_tauAMPA + ((1-midExV4_deepExPFC_iAMPActx_s_last)/p.midExV4_deepExPFC_iAMPActx_tauAMPAr).*(1+tanh(deepExPFC_V_last/10));
---
> midExPFC_deepExV4_iAMPActx_s_k1 = -midExPFC_deepExV4_iAMPActx_s_last./p.midExPFC_deepExV4_iAMPActx_tauAMPA + ((1-midExPFC_deepExV4_iAMPActx_s_last)/p.midExPFC_deepExV4_iAMPActx_tauAMPAr).*(1+tanh(deepExV4_V_last/10));
> midIxPFC_deepIxV4_iAMPActx_s_k1 = -midIxPFC_deepIxV4_iAMPActx_s_last./p.midIxPFC_deepIxV4_iAMPActx_tauAMPA + ((1-midIxPFC_deepIxV4_iAMPActx_s_last)/p.midIxPFC_deepIxV4_iAMPActx_tauAMPAr).*(1+tanh(deepIxV4_V_last/10));
870,873c862,863
< midExPFC_supExV4_iAMPActx_s_last = midExPFC_supExV4_iAMPActx_s_last+dt*midExPFC_supExV4_iAMPActx_s_k1;
< midIxPFC_supIxV4_iAMPActx_s_last = midIxPFC_supIxV4_iAMPActx_s_last+dt*midIxPFC_supIxV4_iAMPActx_s_k1;
< midIxV4_deepIxPFC_iAMPActx_s_last = midIxV4_deepIxPFC_iAMPActx_s_last+dt*midIxV4_deepIxPFC_iAMPActx_s_k1;
< midExV4_deepExPFC_iAMPActx_s_last = midExV4_deepExPFC_iAMPActx_s_last+dt*midExV4_deepExPFC_iAMPActx_s_k1;
---
> midExPFC_deepExV4_iAMPActx_s_last = midExPFC_deepExV4_iAMPActx_s_last+dt*midExPFC_deepExV4_iAMPActx_s_k1;
> midIxPFC_deepIxV4_iAMPActx_s_last = midIxPFC_deepIxV4_iAMPActx_s_last+dt*midIxPFC_deepIxV4_iAMPActx_s_k1;
1044,1047c1034,1035
< midExPFC_supExV4_iAMPActx_s(n,:) = midExPFC_supExV4_iAMPActx_s_last;
< midIxPFC_supIxV4_iAMPActx_s(n,:) = midIxPFC_supIxV4_iAMPActx_s_last;
< midIxV4_deepIxPFC_iAMPActx_s(n,:) = midIxV4_deepIxPFC_iAMPActx_s_last;
< midExV4_deepExPFC_iAMPActx_s(n,:) = midExV4_deepExPFC_iAMPActx_s_last;
---
> midExPFC_deepExV4_iAMPActx_s(n,:) = midExPFC_deepExV4_iAMPActx_s_last;
> midIxPFC_deepIxV4_iAMPActx_s(n,:) = midIxPFC_deepIxV4_iAMPActx_s_last;

