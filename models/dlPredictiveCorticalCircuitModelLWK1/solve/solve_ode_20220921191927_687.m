function [T,supExV4_V,supExV4_iNa_m,supExV4_iNa_h,supExV4_iK_n,supISOMxV4_V,supISOMxV4_iNa_m,supISOMxV4_iNa_h,supISOMxV4_iK_n,supIPVxV4_V,supIPVxV4_iNa_m,supIPVxV4_iNa_h,supIPVxV4_iK_n,midExV4_V,midExV4_iNa_m,midExV4_iNa_h,midExV4_iK_n,midIPVxV4_V,midIPVxV4_iNa_m,midIPVxV4_iNa_h,midIPVxV4_iK_n,deepExV4_V,deepExV4_iNa_m,deepExV4_iNa_h,deepExV4_iK_n,deepISOMxV4_V,deepISOMxV4_iNa_m,deepISOMxV4_iNa_h,deepISOMxV4_iK_n,deepIPVxV4_V,deepIPVxV4_iNa_m,deepIPVxV4_iNa_h,deepIPVxV4_iK_n,PreStimuliAxV4_V,PreStimuliAxV4_iNa_m,PreStimuliAxV4_iNa_h,PreStimuliAxV4_iK_n,PostStimuliAxV4_V,PostStimuliAxV4_iNa_m,PostStimuliAxV4_iNa_h,PostStimuliAxV4_iK_n,PreStimuliBxV4_V,PreStimuliBxV4_iNa_m,PreStimuliBxV4_iNa_h,PreStimuliBxV4_iK_n,PostStimuliBxV4_V,PostStimuliBxV4_iNa_m,PostStimuliBxV4_iNa_h,PostStimuliBxV4_iK_n,PreStimuliCxV4_V,PreStimuliCxV4_iNa_m,PreStimuliCxV4_iNa_h,PreStimuliCxV4_iK_n,PostStimuliCxV4_V,PostStimuliCxV4_iNa_m,PostStimuliCxV4_iNa_h,PostStimuliCxV4_iK_n,supExPFC_V,supExPFC_iNa_m,supExPFC_iNa_h,supExPFC_iK_n,supISOMxPFC_V,supISOMxPFC_iNa_m,supISOMxPFC_iNa_h,supISOMxPFC_iK_n,supIPVxPFC_V,supIPVxPFC_iNa_m,supIPVxPFC_iNa_h,supIPVxPFC_iK_n,midExPFC_V,midExPFC_iNa_m,midExPFC_iNa_h,midExPFC_iK_n,midIPVxPFC_V,midIPVxPFC_iNa_m,midIPVxPFC_iNa_h,midIPVxPFC_iK_n,deepExPFC_V,deepExPFC_iNa_m,deepExPFC_iNa_h,deepExPFC_iK_n,deepISOMxPFC_V,deepISOMxPFC_iNa_m,deepISOMxPFC_iNa_h,deepISOMxPFC_iK_n,deepIPVxPFC_V,deepIPVxPFC_iNa_m,deepIPVxPFC_iNa_h,deepIPVxPFC_iK_n,PreStimuliAxPFC_V,PreStimuliAxPFC_iNa_m,PreStimuliAxPFC_iNa_h,PreStimuliAxPFC_iK_n,PostStimuliAxPFC_V,PostStimuliAxPFC_iNa_m,PostStimuliAxPFC_iNa_h,PostStimuliAxPFC_iK_n,PreStimuliBxPFC_V,PreStimuliBxPFC_iNa_m,PreStimuliBxPFC_iNa_h,PreStimuliBxPFC_iK_n,PostStimuliBxPFC_V,PostStimuliBxPFC_iNa_m,PostStimuliBxPFC_iNa_h,PostStimuliBxPFC_iK_n,PreStimuliCxPFC_V,PreStimuliCxPFC_iNa_m,PreStimuliCxPFC_iNa_h,PreStimuliCxPFC_iK_n,PostStimuliCxPFC_V,PostStimuliCxPFC_iNa_m,PostStimuliCxPFC_iNa_h,PostStimuliCxPFC_iK_n,supISOMxV4_supExV4_iAMPActx_s,supIPVxV4_supExV4_iAMPActx_s,supISOMxV4_supExV4_iNMDActx_s,supIPVxV4_supExV4_iNMDActx_s,supExV4_supISOMxV4_iGABActx_s,supIPVxV4_supISOMxV4_iGABActx_s,supExV4_supIPVxV4_iGABActx_s,supISOMxV4_supIPVxV4_iGABActx_s,midIPVxV4_midExV4_iAMPActx_s,midExV4_midIPVxV4_iGABActx_s,deepISOMxV4_deepExV4_iAMPActx_s,deepIPVxV4_deepExV4_iAMPActx_s,deepExV4_deepISOMxV4_iGABActx_s,deepIPVxV4_deepISOMxV4_iGABActx_s,deepExV4_deepIPVxV4_iGABActx_s,deepISOMxV4_deepIPVxV4_iGABActx_s,PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s,PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s,PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s,midExV4_PreStimuliAxV4_iAMPActx_s,midExV4_PostStimuliAxV4_iAMPActx_s,midExV4_PreStimuliBxV4_iAMPActx_s,midExV4_PostStimuliBxV4_iAMPActx_s,midExV4_PreStimuliCxV4_iAMPActx_s,midExV4_PostStimuliCxV4_iAMPActx_s,deepExV4_supExV4_iAMPActx_s,supISOMxV4_midExV4_iAMPActx_s,supExV4_midExV4_iAMPActx_s,deepExV4_midExV4_iAMPActx_s,deepIPVxV4_midExV4_iAMPActx_s,supExV4_midIPVxV4_iGABActx_s,supISOMxV4_deepExV4_iAMPActx_s,supIPVxV4_deepExV4_iAMPActx_s,midIPVxV4_deepISOMxV4_iGABActx_s,supISOMxPFC_supExPFC_iAMPActx_s,supIPVxPFC_supExPFC_iAMPActx_s,supISOMxPFC_supExPFC_iNMDActx_s,supIPVxPFC_supExPFC_iNMDActx_s,supExPFC_supISOMxPFC_iGABActx_s,supIPVxPFC_supISOMxPFC_iGABActx_s,supExPFC_supIPVxPFC_iGABActx_s,supISOMxPFC_supIPVxPFC_iGABActx_s,midIPVxPFC_midExPFC_iAMPActx_s,midExPFC_midIPVxPFC_iGABActx_s,deepISOMxPFC_deepExPFC_iAMPActx_s,deepIPVxPFC_deepExPFC_iAMPActx_s,deepExPFC_deepISOMxPFC_iGABActx_s,deepIPVxPFC_deepISOMxPFC_iGABActx_s,deepExPFC_deepIPVxPFC_iGABActx_s,deepISOMxPFC_deepIPVxPFC_iGABActx_s,PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s,PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s,PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s,midExPFC_PreStimuliAxPFC_iAMPActx_s,midExPFC_PostStimuliAxPFC_iAMPActx_s,midExPFC_PreStimuliBxPFC_iAMPActx_s,midExPFC_PostStimuliBxPFC_iAMPActx_s,midExPFC_PreStimuliCxPFC_iAMPActx_s,midExPFC_PostStimuliCxPFC_iAMPActx_s,deepExPFC_supExPFC_iAMPActx_s,supISOMxPFC_midExPFC_iAMPActx_s,supExPFC_midExPFC_iAMPActx_s,deepExPFC_midExPFC_iAMPActx_s,deepIPVxPFC_midExPFC_iAMPActx_s,supExPFC_midIPVxPFC_iGABActx_s,supISOMxPFC_deepExPFC_iAMPActx_s,supIPVxPFC_deepExPFC_iAMPActx_s,midIPVxPFC_deepISOMxPFC_iGABActx_s,midExPFC_supExV4_iAMPActx_s,midIPVxPFC_supExV4_iAMPActx_s,supISOMxV4_deepExPFC_iAMPActx_s]=solve_ode

% ------------------------------------------------------------
% Parameters:
% ------------------------------------------------------------
params = load('params.mat','p');
p = params.p;
downsample_factor=p.downsample_factor;
dt=p.dt;
T=(p.tspan(1):dt:p.tspan(2))';
ntime=length(T);
nsamp=length(1:downsample_factor:ntime);

% seed the random number generator
rng(p.random_seed);

% ------------------------------------------------------------
% Initial conditions:
% ------------------------------------------------------------
t=0; k=1;

% STATE_VARIABLES:
supExV4_V_last =  -rand(1, p.supExV4_Npop)*74;
supExV4_V = zeros(nsamp,p.supExV4_Npop);
supExV4_V(1,:) = supExV4_V_last;
supExV4_iNa_m_last = p.supExV4_iNa_m_IC+p.supExV4_iNa_IC_noise*rand(1,p.supExV4_Npop);
supExV4_iNa_m = zeros(nsamp,p.supExV4_Npop);
supExV4_iNa_m(1,:) = supExV4_iNa_m_last;
supExV4_iNa_h_last = p.supExV4_iNa_h_IC+p.supExV4_iNa_IC_noise*rand(1,p.supExV4_Npop);
supExV4_iNa_h = zeros(nsamp,p.supExV4_Npop);
supExV4_iNa_h(1,:) = supExV4_iNa_h_last;
supExV4_iK_n_last = p.supExV4_iK_n_IC+p.supExV4_iK_IC_noise*rand(1,p.supExV4_Npop);
supExV4_iK_n = zeros(nsamp,p.supExV4_Npop);
supExV4_iK_n(1,:) = supExV4_iK_n_last;
supISOMxV4_V_last =  -rand(1, p.supISOMxV4_Npop)*74;
supISOMxV4_V = zeros(nsamp,p.supISOMxV4_Npop);
supISOMxV4_V(1,:) = supISOMxV4_V_last;
supISOMxV4_iNa_m_last = p.supISOMxV4_iNa_m_IC+p.supISOMxV4_iNa_IC_noise*rand(1,p.supISOMxV4_Npop);
supISOMxV4_iNa_m = zeros(nsamp,p.supISOMxV4_Npop);
supISOMxV4_iNa_m(1,:) = supISOMxV4_iNa_m_last;
supISOMxV4_iNa_h_last = p.supISOMxV4_iNa_h_IC+p.supISOMxV4_iNa_IC_noise*rand(1,p.supISOMxV4_Npop);
supISOMxV4_iNa_h = zeros(nsamp,p.supISOMxV4_Npop);
supISOMxV4_iNa_h(1,:) = supISOMxV4_iNa_h_last;
supISOMxV4_iK_n_last = p.supISOMxV4_iK_n_IC+p.supISOMxV4_iK_IC_noise*rand(1,p.supISOMxV4_Npop);
supISOMxV4_iK_n = zeros(nsamp,p.supISOMxV4_Npop);
supISOMxV4_iK_n(1,:) = supISOMxV4_iK_n_last;
supIPVxV4_V_last =  -rand(1, p.supIPVxV4_Npop)*74;
supIPVxV4_V = zeros(nsamp,p.supIPVxV4_Npop);
supIPVxV4_V(1,:) = supIPVxV4_V_last;
supIPVxV4_iNa_m_last = p.supIPVxV4_iNa_m_IC+p.supIPVxV4_iNa_IC_noise*rand(1,p.supIPVxV4_Npop);
supIPVxV4_iNa_m = zeros(nsamp,p.supIPVxV4_Npop);
supIPVxV4_iNa_m(1,:) = supIPVxV4_iNa_m_last;
supIPVxV4_iNa_h_last = p.supIPVxV4_iNa_h_IC+p.supIPVxV4_iNa_IC_noise*rand(1,p.supIPVxV4_Npop);
supIPVxV4_iNa_h = zeros(nsamp,p.supIPVxV4_Npop);
supIPVxV4_iNa_h(1,:) = supIPVxV4_iNa_h_last;
supIPVxV4_iK_n_last = p.supIPVxV4_iK_n_IC+p.supIPVxV4_iK_IC_noise*rand(1,p.supIPVxV4_Npop);
supIPVxV4_iK_n = zeros(nsamp,p.supIPVxV4_Npop);
supIPVxV4_iK_n(1,:) = supIPVxV4_iK_n_last;
midExV4_V_last =  -rand(1, p.midExV4_Npop)*74;
midExV4_V = zeros(nsamp,p.midExV4_Npop);
midExV4_V(1,:) = midExV4_V_last;
midExV4_iNa_m_last = p.midExV4_iNa_m_IC+p.midExV4_iNa_IC_noise*rand(1,p.midExV4_Npop);
midExV4_iNa_m = zeros(nsamp,p.midExV4_Npop);
midExV4_iNa_m(1,:) = midExV4_iNa_m_last;
midExV4_iNa_h_last = p.midExV4_iNa_h_IC+p.midExV4_iNa_IC_noise*rand(1,p.midExV4_Npop);
midExV4_iNa_h = zeros(nsamp,p.midExV4_Npop);
midExV4_iNa_h(1,:) = midExV4_iNa_h_last;
midExV4_iK_n_last = p.midExV4_iK_n_IC+p.midExV4_iK_IC_noise*rand(1,p.midExV4_Npop);
midExV4_iK_n = zeros(nsamp,p.midExV4_Npop);
midExV4_iK_n(1,:) = midExV4_iK_n_last;
midIPVxV4_V_last =  -rand(1, p.midIPVxV4_Npop)*74;
midIPVxV4_V = zeros(nsamp,p.midIPVxV4_Npop);
midIPVxV4_V(1,:) = midIPVxV4_V_last;
midIPVxV4_iNa_m_last = p.midIPVxV4_iNa_m_IC+p.midIPVxV4_iNa_IC_noise*rand(1,p.midIPVxV4_Npop);
midIPVxV4_iNa_m = zeros(nsamp,p.midIPVxV4_Npop);
midIPVxV4_iNa_m(1,:) = midIPVxV4_iNa_m_last;
midIPVxV4_iNa_h_last = p.midIPVxV4_iNa_h_IC+p.midIPVxV4_iNa_IC_noise*rand(1,p.midIPVxV4_Npop);
midIPVxV4_iNa_h = zeros(nsamp,p.midIPVxV4_Npop);
midIPVxV4_iNa_h(1,:) = midIPVxV4_iNa_h_last;
midIPVxV4_iK_n_last = p.midIPVxV4_iK_n_IC+p.midIPVxV4_iK_IC_noise*rand(1,p.midIPVxV4_Npop);
midIPVxV4_iK_n = zeros(nsamp,p.midIPVxV4_Npop);
midIPVxV4_iK_n(1,:) = midIPVxV4_iK_n_last;
deepExV4_V_last =  -rand(1, p.deepExV4_Npop)*74;
deepExV4_V = zeros(nsamp,p.deepExV4_Npop);
deepExV4_V(1,:) = deepExV4_V_last;
deepExV4_iNa_m_last = p.deepExV4_iNa_m_IC+p.deepExV4_iNa_IC_noise*rand(1,p.deepExV4_Npop);
deepExV4_iNa_m = zeros(nsamp,p.deepExV4_Npop);
deepExV4_iNa_m(1,:) = deepExV4_iNa_m_last;
deepExV4_iNa_h_last = p.deepExV4_iNa_h_IC+p.deepExV4_iNa_IC_noise*rand(1,p.deepExV4_Npop);
deepExV4_iNa_h = zeros(nsamp,p.deepExV4_Npop);
deepExV4_iNa_h(1,:) = deepExV4_iNa_h_last;
deepExV4_iK_n_last = p.deepExV4_iK_n_IC+p.deepExV4_iK_IC_noise*rand(1,p.deepExV4_Npop);
deepExV4_iK_n = zeros(nsamp,p.deepExV4_Npop);
deepExV4_iK_n(1,:) = deepExV4_iK_n_last;
deepISOMxV4_V_last =  -rand(1, p.deepISOMxV4_Npop)*74;
deepISOMxV4_V = zeros(nsamp,p.deepISOMxV4_Npop);
deepISOMxV4_V(1,:) = deepISOMxV4_V_last;
deepISOMxV4_iNa_m_last = p.deepISOMxV4_iNa_m_IC+p.deepISOMxV4_iNa_IC_noise*rand(1,p.deepISOMxV4_Npop);
deepISOMxV4_iNa_m = zeros(nsamp,p.deepISOMxV4_Npop);
deepISOMxV4_iNa_m(1,:) = deepISOMxV4_iNa_m_last;
deepISOMxV4_iNa_h_last = p.deepISOMxV4_iNa_h_IC+p.deepISOMxV4_iNa_IC_noise*rand(1,p.deepISOMxV4_Npop);
deepISOMxV4_iNa_h = zeros(nsamp,p.deepISOMxV4_Npop);
deepISOMxV4_iNa_h(1,:) = deepISOMxV4_iNa_h_last;
deepISOMxV4_iK_n_last = p.deepISOMxV4_iK_n_IC+p.deepISOMxV4_iK_IC_noise*rand(1,p.deepISOMxV4_Npop);
deepISOMxV4_iK_n = zeros(nsamp,p.deepISOMxV4_Npop);
deepISOMxV4_iK_n(1,:) = deepISOMxV4_iK_n_last;
deepIPVxV4_V_last =  -rand(1, p.deepIPVxV4_Npop)*74;
deepIPVxV4_V = zeros(nsamp,p.deepIPVxV4_Npop);
deepIPVxV4_V(1,:) = deepIPVxV4_V_last;
deepIPVxV4_iNa_m_last = p.deepIPVxV4_iNa_m_IC+p.deepIPVxV4_iNa_IC_noise*rand(1,p.deepIPVxV4_Npop);
deepIPVxV4_iNa_m = zeros(nsamp,p.deepIPVxV4_Npop);
deepIPVxV4_iNa_m(1,:) = deepIPVxV4_iNa_m_last;
deepIPVxV4_iNa_h_last = p.deepIPVxV4_iNa_h_IC+p.deepIPVxV4_iNa_IC_noise*rand(1,p.deepIPVxV4_Npop);
deepIPVxV4_iNa_h = zeros(nsamp,p.deepIPVxV4_Npop);
deepIPVxV4_iNa_h(1,:) = deepIPVxV4_iNa_h_last;
deepIPVxV4_iK_n_last = p.deepIPVxV4_iK_n_IC+p.deepIPVxV4_iK_IC_noise*rand(1,p.deepIPVxV4_Npop);
deepIPVxV4_iK_n = zeros(nsamp,p.deepIPVxV4_Npop);
deepIPVxV4_iK_n(1,:) = deepIPVxV4_iK_n_last;
PreStimuliAxV4_V_last =  -60 - rand(1, p.PreStimuliAxV4_Npop)*17;
PreStimuliAxV4_V = zeros(nsamp,p.PreStimuliAxV4_Npop);
PreStimuliAxV4_V(1,:) = PreStimuliAxV4_V_last;
PreStimuliAxV4_iNa_m_last = p.PreStimuliAxV4_iNa_m_IC+p.PreStimuliAxV4_iNa_IC_noise*rand(1,p.PreStimuliAxV4_Npop);
PreStimuliAxV4_iNa_m = zeros(nsamp,p.PreStimuliAxV4_Npop);
PreStimuliAxV4_iNa_m(1,:) = PreStimuliAxV4_iNa_m_last;
PreStimuliAxV4_iNa_h_last = p.PreStimuliAxV4_iNa_h_IC+p.PreStimuliAxV4_iNa_IC_noise*rand(1,p.PreStimuliAxV4_Npop);
PreStimuliAxV4_iNa_h = zeros(nsamp,p.PreStimuliAxV4_Npop);
PreStimuliAxV4_iNa_h(1,:) = PreStimuliAxV4_iNa_h_last;
PreStimuliAxV4_iK_n_last = p.PreStimuliAxV4_iK_n_IC+p.PreStimuliAxV4_iK_IC_noise*rand(1,p.PreStimuliAxV4_Npop);
PreStimuliAxV4_iK_n = zeros(nsamp,p.PreStimuliAxV4_Npop);
PreStimuliAxV4_iK_n(1,:) = PreStimuliAxV4_iK_n_last;
PostStimuliAxV4_V_last =  -60 - rand(1, p.PostStimuliAxV4_Npop)*17;
PostStimuliAxV4_V = zeros(nsamp,p.PostStimuliAxV4_Npop);
PostStimuliAxV4_V(1,:) = PostStimuliAxV4_V_last;
PostStimuliAxV4_iNa_m_last = p.PostStimuliAxV4_iNa_m_IC+p.PostStimuliAxV4_iNa_IC_noise*rand(1,p.PostStimuliAxV4_Npop);
PostStimuliAxV4_iNa_m = zeros(nsamp,p.PostStimuliAxV4_Npop);
PostStimuliAxV4_iNa_m(1,:) = PostStimuliAxV4_iNa_m_last;
PostStimuliAxV4_iNa_h_last = p.PostStimuliAxV4_iNa_h_IC+p.PostStimuliAxV4_iNa_IC_noise*rand(1,p.PostStimuliAxV4_Npop);
PostStimuliAxV4_iNa_h = zeros(nsamp,p.PostStimuliAxV4_Npop);
PostStimuliAxV4_iNa_h(1,:) = PostStimuliAxV4_iNa_h_last;
PostStimuliAxV4_iK_n_last = p.PostStimuliAxV4_iK_n_IC+p.PostStimuliAxV4_iK_IC_noise*rand(1,p.PostStimuliAxV4_Npop);
PostStimuliAxV4_iK_n = zeros(nsamp,p.PostStimuliAxV4_Npop);
PostStimuliAxV4_iK_n(1,:) = PostStimuliAxV4_iK_n_last;
PreStimuliBxV4_V_last =  -60 - rand(1, p.PreStimuliBxV4_Npop)*17;
PreStimuliBxV4_V = zeros(nsamp,p.PreStimuliBxV4_Npop);
PreStimuliBxV4_V(1,:) = PreStimuliBxV4_V_last;
PreStimuliBxV4_iNa_m_last = p.PreStimuliBxV4_iNa_m_IC+p.PreStimuliBxV4_iNa_IC_noise*rand(1,p.PreStimuliBxV4_Npop);
PreStimuliBxV4_iNa_m = zeros(nsamp,p.PreStimuliBxV4_Npop);
PreStimuliBxV4_iNa_m(1,:) = PreStimuliBxV4_iNa_m_last;
PreStimuliBxV4_iNa_h_last = p.PreStimuliBxV4_iNa_h_IC+p.PreStimuliBxV4_iNa_IC_noise*rand(1,p.PreStimuliBxV4_Npop);
PreStimuliBxV4_iNa_h = zeros(nsamp,p.PreStimuliBxV4_Npop);
PreStimuliBxV4_iNa_h(1,:) = PreStimuliBxV4_iNa_h_last;
PreStimuliBxV4_iK_n_last = p.PreStimuliBxV4_iK_n_IC+p.PreStimuliBxV4_iK_IC_noise*rand(1,p.PreStimuliBxV4_Npop);
PreStimuliBxV4_iK_n = zeros(nsamp,p.PreStimuliBxV4_Npop);
PreStimuliBxV4_iK_n(1,:) = PreStimuliBxV4_iK_n_last;
PostStimuliBxV4_V_last =  -60 - rand(1, p.PostStimuliBxV4_Npop)*17;
PostStimuliBxV4_V = zeros(nsamp,p.PostStimuliBxV4_Npop);
PostStimuliBxV4_V(1,:) = PostStimuliBxV4_V_last;
PostStimuliBxV4_iNa_m_last = p.PostStimuliBxV4_iNa_m_IC+p.PostStimuliBxV4_iNa_IC_noise*rand(1,p.PostStimuliBxV4_Npop);
PostStimuliBxV4_iNa_m = zeros(nsamp,p.PostStimuliBxV4_Npop);
PostStimuliBxV4_iNa_m(1,:) = PostStimuliBxV4_iNa_m_last;
PostStimuliBxV4_iNa_h_last = p.PostStimuliBxV4_iNa_h_IC+p.PostStimuliBxV4_iNa_IC_noise*rand(1,p.PostStimuliBxV4_Npop);
PostStimuliBxV4_iNa_h = zeros(nsamp,p.PostStimuliBxV4_Npop);
PostStimuliBxV4_iNa_h(1,:) = PostStimuliBxV4_iNa_h_last;
PostStimuliBxV4_iK_n_last = p.PostStimuliBxV4_iK_n_IC+p.PostStimuliBxV4_iK_IC_noise*rand(1,p.PostStimuliBxV4_Npop);
PostStimuliBxV4_iK_n = zeros(nsamp,p.PostStimuliBxV4_Npop);
PostStimuliBxV4_iK_n(1,:) = PostStimuliBxV4_iK_n_last;
PreStimuliCxV4_V_last =  -60 - rand(1, p.PreStimuliCxV4_Npop)*17;
PreStimuliCxV4_V = zeros(nsamp,p.PreStimuliCxV4_Npop);
PreStimuliCxV4_V(1,:) = PreStimuliCxV4_V_last;
PreStimuliCxV4_iNa_m_last = p.PreStimuliCxV4_iNa_m_IC+p.PreStimuliCxV4_iNa_IC_noise*rand(1,p.PreStimuliCxV4_Npop);
PreStimuliCxV4_iNa_m = zeros(nsamp,p.PreStimuliCxV4_Npop);
PreStimuliCxV4_iNa_m(1,:) = PreStimuliCxV4_iNa_m_last;
PreStimuliCxV4_iNa_h_last = p.PreStimuliCxV4_iNa_h_IC+p.PreStimuliCxV4_iNa_IC_noise*rand(1,p.PreStimuliCxV4_Npop);
PreStimuliCxV4_iNa_h = zeros(nsamp,p.PreStimuliCxV4_Npop);
PreStimuliCxV4_iNa_h(1,:) = PreStimuliCxV4_iNa_h_last;
PreStimuliCxV4_iK_n_last = p.PreStimuliCxV4_iK_n_IC+p.PreStimuliCxV4_iK_IC_noise*rand(1,p.PreStimuliCxV4_Npop);
PreStimuliCxV4_iK_n = zeros(nsamp,p.PreStimuliCxV4_Npop);
PreStimuliCxV4_iK_n(1,:) = PreStimuliCxV4_iK_n_last;
PostStimuliCxV4_V_last =  -60 - rand(1, p.PostStimuliCxV4_Npop)*17;
PostStimuliCxV4_V = zeros(nsamp,p.PostStimuliCxV4_Npop);
PostStimuliCxV4_V(1,:) = PostStimuliCxV4_V_last;
PostStimuliCxV4_iNa_m_last = p.PostStimuliCxV4_iNa_m_IC+p.PostStimuliCxV4_iNa_IC_noise*rand(1,p.PostStimuliCxV4_Npop);
PostStimuliCxV4_iNa_m = zeros(nsamp,p.PostStimuliCxV4_Npop);
PostStimuliCxV4_iNa_m(1,:) = PostStimuliCxV4_iNa_m_last;
PostStimuliCxV4_iNa_h_last = p.PostStimuliCxV4_iNa_h_IC+p.PostStimuliCxV4_iNa_IC_noise*rand(1,p.PostStimuliCxV4_Npop);
PostStimuliCxV4_iNa_h = zeros(nsamp,p.PostStimuliCxV4_Npop);
PostStimuliCxV4_iNa_h(1,:) = PostStimuliCxV4_iNa_h_last;
PostStimuliCxV4_iK_n_last = p.PostStimuliCxV4_iK_n_IC+p.PostStimuliCxV4_iK_IC_noise*rand(1,p.PostStimuliCxV4_Npop);
PostStimuliCxV4_iK_n = zeros(nsamp,p.PostStimuliCxV4_Npop);
PostStimuliCxV4_iK_n(1,:) = PostStimuliCxV4_iK_n_last;
supExPFC_V_last =  -rand(1, p.supExPFC_Npop)*74;
supExPFC_V = zeros(nsamp,p.supExPFC_Npop);
supExPFC_V(1,:) = supExPFC_V_last;
supExPFC_iNa_m_last = p.supExPFC_iNa_m_IC+p.supExPFC_iNa_IC_noise*rand(1,p.supExPFC_Npop);
supExPFC_iNa_m = zeros(nsamp,p.supExPFC_Npop);
supExPFC_iNa_m(1,:) = supExPFC_iNa_m_last;
supExPFC_iNa_h_last = p.supExPFC_iNa_h_IC+p.supExPFC_iNa_IC_noise*rand(1,p.supExPFC_Npop);
supExPFC_iNa_h = zeros(nsamp,p.supExPFC_Npop);
supExPFC_iNa_h(1,:) = supExPFC_iNa_h_last;
supExPFC_iK_n_last = p.supExPFC_iK_n_IC+p.supExPFC_iK_IC_noise*rand(1,p.supExPFC_Npop);
supExPFC_iK_n = zeros(nsamp,p.supExPFC_Npop);
supExPFC_iK_n(1,:) = supExPFC_iK_n_last;
supISOMxPFC_V_last =  -rand(1, p.supISOMxPFC_Npop)*74;
supISOMxPFC_V = zeros(nsamp,p.supISOMxPFC_Npop);
supISOMxPFC_V(1,:) = supISOMxPFC_V_last;
supISOMxPFC_iNa_m_last = p.supISOMxPFC_iNa_m_IC+p.supISOMxPFC_iNa_IC_noise*rand(1,p.supISOMxPFC_Npop);
supISOMxPFC_iNa_m = zeros(nsamp,p.supISOMxPFC_Npop);
supISOMxPFC_iNa_m(1,:) = supISOMxPFC_iNa_m_last;
supISOMxPFC_iNa_h_last = p.supISOMxPFC_iNa_h_IC+p.supISOMxPFC_iNa_IC_noise*rand(1,p.supISOMxPFC_Npop);
supISOMxPFC_iNa_h = zeros(nsamp,p.supISOMxPFC_Npop);
supISOMxPFC_iNa_h(1,:) = supISOMxPFC_iNa_h_last;
supISOMxPFC_iK_n_last = p.supISOMxPFC_iK_n_IC+p.supISOMxPFC_iK_IC_noise*rand(1,p.supISOMxPFC_Npop);
supISOMxPFC_iK_n = zeros(nsamp,p.supISOMxPFC_Npop);
supISOMxPFC_iK_n(1,:) = supISOMxPFC_iK_n_last;
supIPVxPFC_V_last =  -rand(1, p.supIPVxPFC_Npop)*74;
supIPVxPFC_V = zeros(nsamp,p.supIPVxPFC_Npop);
supIPVxPFC_V(1,:) = supIPVxPFC_V_last;
supIPVxPFC_iNa_m_last = p.supIPVxPFC_iNa_m_IC+p.supIPVxPFC_iNa_IC_noise*rand(1,p.supIPVxPFC_Npop);
supIPVxPFC_iNa_m = zeros(nsamp,p.supIPVxPFC_Npop);
supIPVxPFC_iNa_m(1,:) = supIPVxPFC_iNa_m_last;
supIPVxPFC_iNa_h_last = p.supIPVxPFC_iNa_h_IC+p.supIPVxPFC_iNa_IC_noise*rand(1,p.supIPVxPFC_Npop);
supIPVxPFC_iNa_h = zeros(nsamp,p.supIPVxPFC_Npop);
supIPVxPFC_iNa_h(1,:) = supIPVxPFC_iNa_h_last;
supIPVxPFC_iK_n_last = p.supIPVxPFC_iK_n_IC+p.supIPVxPFC_iK_IC_noise*rand(1,p.supIPVxPFC_Npop);
supIPVxPFC_iK_n = zeros(nsamp,p.supIPVxPFC_Npop);
supIPVxPFC_iK_n(1,:) = supIPVxPFC_iK_n_last;
midExPFC_V_last =  -rand(1, p.midExPFC_Npop)*74;
midExPFC_V = zeros(nsamp,p.midExPFC_Npop);
midExPFC_V(1,:) = midExPFC_V_last;
midExPFC_iNa_m_last = p.midExPFC_iNa_m_IC+p.midExPFC_iNa_IC_noise*rand(1,p.midExPFC_Npop);
midExPFC_iNa_m = zeros(nsamp,p.midExPFC_Npop);
midExPFC_iNa_m(1,:) = midExPFC_iNa_m_last;
midExPFC_iNa_h_last = p.midExPFC_iNa_h_IC+p.midExPFC_iNa_IC_noise*rand(1,p.midExPFC_Npop);
midExPFC_iNa_h = zeros(nsamp,p.midExPFC_Npop);
midExPFC_iNa_h(1,:) = midExPFC_iNa_h_last;
midExPFC_iK_n_last = p.midExPFC_iK_n_IC+p.midExPFC_iK_IC_noise*rand(1,p.midExPFC_Npop);
midExPFC_iK_n = zeros(nsamp,p.midExPFC_Npop);
midExPFC_iK_n(1,:) = midExPFC_iK_n_last;
midIPVxPFC_V_last =  -rand(1, p.midIPVxPFC_Npop)*74;
midIPVxPFC_V = zeros(nsamp,p.midIPVxPFC_Npop);
midIPVxPFC_V(1,:) = midIPVxPFC_V_last;
midIPVxPFC_iNa_m_last = p.midIPVxPFC_iNa_m_IC+p.midIPVxPFC_iNa_IC_noise*rand(1,p.midIPVxPFC_Npop);
midIPVxPFC_iNa_m = zeros(nsamp,p.midIPVxPFC_Npop);
midIPVxPFC_iNa_m(1,:) = midIPVxPFC_iNa_m_last;
midIPVxPFC_iNa_h_last = p.midIPVxPFC_iNa_h_IC+p.midIPVxPFC_iNa_IC_noise*rand(1,p.midIPVxPFC_Npop);
midIPVxPFC_iNa_h = zeros(nsamp,p.midIPVxPFC_Npop);
midIPVxPFC_iNa_h(1,:) = midIPVxPFC_iNa_h_last;
midIPVxPFC_iK_n_last = p.midIPVxPFC_iK_n_IC+p.midIPVxPFC_iK_IC_noise*rand(1,p.midIPVxPFC_Npop);
midIPVxPFC_iK_n = zeros(nsamp,p.midIPVxPFC_Npop);
midIPVxPFC_iK_n(1,:) = midIPVxPFC_iK_n_last;
deepExPFC_V_last =  -rand(1, p.deepExPFC_Npop)*74;
deepExPFC_V = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_V(1,:) = deepExPFC_V_last;
deepExPFC_iNa_m_last = p.deepExPFC_iNa_m_IC+p.deepExPFC_iNa_IC_noise*rand(1,p.deepExPFC_Npop);
deepExPFC_iNa_m = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_iNa_m(1,:) = deepExPFC_iNa_m_last;
deepExPFC_iNa_h_last = p.deepExPFC_iNa_h_IC+p.deepExPFC_iNa_IC_noise*rand(1,p.deepExPFC_Npop);
deepExPFC_iNa_h = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_iNa_h(1,:) = deepExPFC_iNa_h_last;
deepExPFC_iK_n_last = p.deepExPFC_iK_n_IC+p.deepExPFC_iK_IC_noise*rand(1,p.deepExPFC_Npop);
deepExPFC_iK_n = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_iK_n(1,:) = deepExPFC_iK_n_last;
deepISOMxPFC_V_last =  -rand(1, p.deepISOMxPFC_Npop)*74;
deepISOMxPFC_V = zeros(nsamp,p.deepISOMxPFC_Npop);
deepISOMxPFC_V(1,:) = deepISOMxPFC_V_last;
deepISOMxPFC_iNa_m_last = p.deepISOMxPFC_iNa_m_IC+p.deepISOMxPFC_iNa_IC_noise*rand(1,p.deepISOMxPFC_Npop);
deepISOMxPFC_iNa_m = zeros(nsamp,p.deepISOMxPFC_Npop);
deepISOMxPFC_iNa_m(1,:) = deepISOMxPFC_iNa_m_last;
deepISOMxPFC_iNa_h_last = p.deepISOMxPFC_iNa_h_IC+p.deepISOMxPFC_iNa_IC_noise*rand(1,p.deepISOMxPFC_Npop);
deepISOMxPFC_iNa_h = zeros(nsamp,p.deepISOMxPFC_Npop);
deepISOMxPFC_iNa_h(1,:) = deepISOMxPFC_iNa_h_last;
deepISOMxPFC_iK_n_last = p.deepISOMxPFC_iK_n_IC+p.deepISOMxPFC_iK_IC_noise*rand(1,p.deepISOMxPFC_Npop);
deepISOMxPFC_iK_n = zeros(nsamp,p.deepISOMxPFC_Npop);
deepISOMxPFC_iK_n(1,:) = deepISOMxPFC_iK_n_last;
deepIPVxPFC_V_last =  -rand(1, p.deepIPVxPFC_Npop)*74;
deepIPVxPFC_V = zeros(nsamp,p.deepIPVxPFC_Npop);
deepIPVxPFC_V(1,:) = deepIPVxPFC_V_last;
deepIPVxPFC_iNa_m_last = p.deepIPVxPFC_iNa_m_IC+p.deepIPVxPFC_iNa_IC_noise*rand(1,p.deepIPVxPFC_Npop);
deepIPVxPFC_iNa_m = zeros(nsamp,p.deepIPVxPFC_Npop);
deepIPVxPFC_iNa_m(1,:) = deepIPVxPFC_iNa_m_last;
deepIPVxPFC_iNa_h_last = p.deepIPVxPFC_iNa_h_IC+p.deepIPVxPFC_iNa_IC_noise*rand(1,p.deepIPVxPFC_Npop);
deepIPVxPFC_iNa_h = zeros(nsamp,p.deepIPVxPFC_Npop);
deepIPVxPFC_iNa_h(1,:) = deepIPVxPFC_iNa_h_last;
deepIPVxPFC_iK_n_last = p.deepIPVxPFC_iK_n_IC+p.deepIPVxPFC_iK_IC_noise*rand(1,p.deepIPVxPFC_Npop);
deepIPVxPFC_iK_n = zeros(nsamp,p.deepIPVxPFC_Npop);
deepIPVxPFC_iK_n(1,:) = deepIPVxPFC_iK_n_last;
PreStimuliAxPFC_V_last =  -60 - rand(1, p.PreStimuliAxPFC_Npop)*17;
PreStimuliAxPFC_V = zeros(nsamp,p.PreStimuliAxPFC_Npop);
PreStimuliAxPFC_V(1,:) = PreStimuliAxPFC_V_last;
PreStimuliAxPFC_iNa_m_last = p.PreStimuliAxPFC_iNa_m_IC+p.PreStimuliAxPFC_iNa_IC_noise*rand(1,p.PreStimuliAxPFC_Npop);
PreStimuliAxPFC_iNa_m = zeros(nsamp,p.PreStimuliAxPFC_Npop);
PreStimuliAxPFC_iNa_m(1,:) = PreStimuliAxPFC_iNa_m_last;
PreStimuliAxPFC_iNa_h_last = p.PreStimuliAxPFC_iNa_h_IC+p.PreStimuliAxPFC_iNa_IC_noise*rand(1,p.PreStimuliAxPFC_Npop);
PreStimuliAxPFC_iNa_h = zeros(nsamp,p.PreStimuliAxPFC_Npop);
PreStimuliAxPFC_iNa_h(1,:) = PreStimuliAxPFC_iNa_h_last;
PreStimuliAxPFC_iK_n_last = p.PreStimuliAxPFC_iK_n_IC+p.PreStimuliAxPFC_iK_IC_noise*rand(1,p.PreStimuliAxPFC_Npop);
PreStimuliAxPFC_iK_n = zeros(nsamp,p.PreStimuliAxPFC_Npop);
PreStimuliAxPFC_iK_n(1,:) = PreStimuliAxPFC_iK_n_last;
PostStimuliAxPFC_V_last =  -60 - rand(1, p.PostStimuliAxPFC_Npop)*17;
PostStimuliAxPFC_V = zeros(nsamp,p.PostStimuliAxPFC_Npop);
PostStimuliAxPFC_V(1,:) = PostStimuliAxPFC_V_last;
PostStimuliAxPFC_iNa_m_last = p.PostStimuliAxPFC_iNa_m_IC+p.PostStimuliAxPFC_iNa_IC_noise*rand(1,p.PostStimuliAxPFC_Npop);
PostStimuliAxPFC_iNa_m = zeros(nsamp,p.PostStimuliAxPFC_Npop);
PostStimuliAxPFC_iNa_m(1,:) = PostStimuliAxPFC_iNa_m_last;
PostStimuliAxPFC_iNa_h_last = p.PostStimuliAxPFC_iNa_h_IC+p.PostStimuliAxPFC_iNa_IC_noise*rand(1,p.PostStimuliAxPFC_Npop);
PostStimuliAxPFC_iNa_h = zeros(nsamp,p.PostStimuliAxPFC_Npop);
PostStimuliAxPFC_iNa_h(1,:) = PostStimuliAxPFC_iNa_h_last;
PostStimuliAxPFC_iK_n_last = p.PostStimuliAxPFC_iK_n_IC+p.PostStimuliAxPFC_iK_IC_noise*rand(1,p.PostStimuliAxPFC_Npop);
PostStimuliAxPFC_iK_n = zeros(nsamp,p.PostStimuliAxPFC_Npop);
PostStimuliAxPFC_iK_n(1,:) = PostStimuliAxPFC_iK_n_last;
PreStimuliBxPFC_V_last =  -60 - rand(1, p.PreStimuliBxPFC_Npop)*17;
PreStimuliBxPFC_V = zeros(nsamp,p.PreStimuliBxPFC_Npop);
PreStimuliBxPFC_V(1,:) = PreStimuliBxPFC_V_last;
PreStimuliBxPFC_iNa_m_last = p.PreStimuliBxPFC_iNa_m_IC+p.PreStimuliBxPFC_iNa_IC_noise*rand(1,p.PreStimuliBxPFC_Npop);
PreStimuliBxPFC_iNa_m = zeros(nsamp,p.PreStimuliBxPFC_Npop);
PreStimuliBxPFC_iNa_m(1,:) = PreStimuliBxPFC_iNa_m_last;
PreStimuliBxPFC_iNa_h_last = p.PreStimuliBxPFC_iNa_h_IC+p.PreStimuliBxPFC_iNa_IC_noise*rand(1,p.PreStimuliBxPFC_Npop);
PreStimuliBxPFC_iNa_h = zeros(nsamp,p.PreStimuliBxPFC_Npop);
PreStimuliBxPFC_iNa_h(1,:) = PreStimuliBxPFC_iNa_h_last;
PreStimuliBxPFC_iK_n_last = p.PreStimuliBxPFC_iK_n_IC+p.PreStimuliBxPFC_iK_IC_noise*rand(1,p.PreStimuliBxPFC_Npop);
PreStimuliBxPFC_iK_n = zeros(nsamp,p.PreStimuliBxPFC_Npop);
PreStimuliBxPFC_iK_n(1,:) = PreStimuliBxPFC_iK_n_last;
PostStimuliBxPFC_V_last =  -60 - rand(1, p.PostStimuliBxPFC_Npop)*17;
PostStimuliBxPFC_V = zeros(nsamp,p.PostStimuliBxPFC_Npop);
PostStimuliBxPFC_V(1,:) = PostStimuliBxPFC_V_last;
PostStimuliBxPFC_iNa_m_last = p.PostStimuliBxPFC_iNa_m_IC+p.PostStimuliBxPFC_iNa_IC_noise*rand(1,p.PostStimuliBxPFC_Npop);
PostStimuliBxPFC_iNa_m = zeros(nsamp,p.PostStimuliBxPFC_Npop);
PostStimuliBxPFC_iNa_m(1,:) = PostStimuliBxPFC_iNa_m_last;
PostStimuliBxPFC_iNa_h_last = p.PostStimuliBxPFC_iNa_h_IC+p.PostStimuliBxPFC_iNa_IC_noise*rand(1,p.PostStimuliBxPFC_Npop);
PostStimuliBxPFC_iNa_h = zeros(nsamp,p.PostStimuliBxPFC_Npop);
PostStimuliBxPFC_iNa_h(1,:) = PostStimuliBxPFC_iNa_h_last;
PostStimuliBxPFC_iK_n_last = p.PostStimuliBxPFC_iK_n_IC+p.PostStimuliBxPFC_iK_IC_noise*rand(1,p.PostStimuliBxPFC_Npop);
PostStimuliBxPFC_iK_n = zeros(nsamp,p.PostStimuliBxPFC_Npop);
PostStimuliBxPFC_iK_n(1,:) = PostStimuliBxPFC_iK_n_last;
PreStimuliCxPFC_V_last =  -60 - rand(1, p.PreStimuliCxPFC_Npop)*17;
PreStimuliCxPFC_V = zeros(nsamp,p.PreStimuliCxPFC_Npop);
PreStimuliCxPFC_V(1,:) = PreStimuliCxPFC_V_last;
PreStimuliCxPFC_iNa_m_last = p.PreStimuliCxPFC_iNa_m_IC+p.PreStimuliCxPFC_iNa_IC_noise*rand(1,p.PreStimuliCxPFC_Npop);
PreStimuliCxPFC_iNa_m = zeros(nsamp,p.PreStimuliCxPFC_Npop);
PreStimuliCxPFC_iNa_m(1,:) = PreStimuliCxPFC_iNa_m_last;
PreStimuliCxPFC_iNa_h_last = p.PreStimuliCxPFC_iNa_h_IC+p.PreStimuliCxPFC_iNa_IC_noise*rand(1,p.PreStimuliCxPFC_Npop);
PreStimuliCxPFC_iNa_h = zeros(nsamp,p.PreStimuliCxPFC_Npop);
PreStimuliCxPFC_iNa_h(1,:) = PreStimuliCxPFC_iNa_h_last;
PreStimuliCxPFC_iK_n_last = p.PreStimuliCxPFC_iK_n_IC+p.PreStimuliCxPFC_iK_IC_noise*rand(1,p.PreStimuliCxPFC_Npop);
PreStimuliCxPFC_iK_n = zeros(nsamp,p.PreStimuliCxPFC_Npop);
PreStimuliCxPFC_iK_n(1,:) = PreStimuliCxPFC_iK_n_last;
PostStimuliCxPFC_V_last =  -60 - rand(1, p.PostStimuliCxPFC_Npop)*17;
PostStimuliCxPFC_V = zeros(nsamp,p.PostStimuliCxPFC_Npop);
PostStimuliCxPFC_V(1,:) = PostStimuliCxPFC_V_last;
PostStimuliCxPFC_iNa_m_last = p.PostStimuliCxPFC_iNa_m_IC+p.PostStimuliCxPFC_iNa_IC_noise*rand(1,p.PostStimuliCxPFC_Npop);
PostStimuliCxPFC_iNa_m = zeros(nsamp,p.PostStimuliCxPFC_Npop);
PostStimuliCxPFC_iNa_m(1,:) = PostStimuliCxPFC_iNa_m_last;
PostStimuliCxPFC_iNa_h_last = p.PostStimuliCxPFC_iNa_h_IC+p.PostStimuliCxPFC_iNa_IC_noise*rand(1,p.PostStimuliCxPFC_Npop);
PostStimuliCxPFC_iNa_h = zeros(nsamp,p.PostStimuliCxPFC_Npop);
PostStimuliCxPFC_iNa_h(1,:) = PostStimuliCxPFC_iNa_h_last;
PostStimuliCxPFC_iK_n_last = p.PostStimuliCxPFC_iK_n_IC+p.PostStimuliCxPFC_iK_IC_noise*rand(1,p.PostStimuliCxPFC_Npop);
PostStimuliCxPFC_iK_n = zeros(nsamp,p.PostStimuliCxPFC_Npop);
PostStimuliCxPFC_iK_n(1,:) = PostStimuliCxPFC_iK_n_last;
supISOMxV4_supExV4_iAMPActx_s_last =  p.supISOMxV4_supExV4_iAMPActx_IC+p.supISOMxV4_supExV4_iAMPActx_IC_noise.*rand(1,p.supExV4_Npop);
supISOMxV4_supExV4_iAMPActx_s = zeros(nsamp,p.supExV4_Npop);
supISOMxV4_supExV4_iAMPActx_s(1,:) = supISOMxV4_supExV4_iAMPActx_s_last;
supIPVxV4_supExV4_iAMPActx_s_last =  p.supIPVxV4_supExV4_iAMPActx_IC+p.supIPVxV4_supExV4_iAMPActx_IC_noise.*rand(1,p.supExV4_Npop);
supIPVxV4_supExV4_iAMPActx_s = zeros(nsamp,p.supExV4_Npop);
supIPVxV4_supExV4_iAMPActx_s(1,:) = supIPVxV4_supExV4_iAMPActx_s_last;
supISOMxV4_supExV4_iNMDActx_s_last =  p.supISOMxV4_supExV4_iNMDActx_IC+p.supISOMxV4_supExV4_iNMDActx_IC_noise*rand(1,p.supExV4_Npop);
supISOMxV4_supExV4_iNMDActx_s = zeros(nsamp,p.supExV4_Npop);
supISOMxV4_supExV4_iNMDActx_s(1,:) = supISOMxV4_supExV4_iNMDActx_s_last;
supIPVxV4_supExV4_iNMDActx_s_last =  p.supIPVxV4_supExV4_iNMDActx_IC+p.supIPVxV4_supExV4_iNMDActx_IC_noise*rand(1,p.supExV4_Npop);
supIPVxV4_supExV4_iNMDActx_s = zeros(nsamp,p.supExV4_Npop);
supIPVxV4_supExV4_iNMDActx_s(1,:) = supIPVxV4_supExV4_iNMDActx_s_last;
supExV4_supISOMxV4_iGABActx_s_last =  p.supExV4_supISOMxV4_iGABActx_IC+p.supExV4_supISOMxV4_iGABActx_IC_noise.*rand(1,p.supISOMxV4_Npop);
supExV4_supISOMxV4_iGABActx_s = zeros(nsamp,p.supISOMxV4_Npop);
supExV4_supISOMxV4_iGABActx_s(1,:) = supExV4_supISOMxV4_iGABActx_s_last;
supIPVxV4_supISOMxV4_iGABActx_s_last =  p.supIPVxV4_supISOMxV4_iGABActx_IC+p.supIPVxV4_supISOMxV4_iGABActx_IC_noise.*rand(1,p.supISOMxV4_Npop);
supIPVxV4_supISOMxV4_iGABActx_s = zeros(nsamp,p.supISOMxV4_Npop);
supIPVxV4_supISOMxV4_iGABActx_s(1,:) = supIPVxV4_supISOMxV4_iGABActx_s_last;
supExV4_supIPVxV4_iGABActx_s_last =  p.supExV4_supIPVxV4_iGABActx_IC+p.supExV4_supIPVxV4_iGABActx_IC_noise.*rand(1,p.supIPVxV4_Npop);
supExV4_supIPVxV4_iGABActx_s = zeros(nsamp,p.supIPVxV4_Npop);
supExV4_supIPVxV4_iGABActx_s(1,:) = supExV4_supIPVxV4_iGABActx_s_last;
supISOMxV4_supIPVxV4_iGABActx_s_last =  p.supISOMxV4_supIPVxV4_iGABActx_IC+p.supISOMxV4_supIPVxV4_iGABActx_IC_noise.*rand(1,p.supIPVxV4_Npop);
supISOMxV4_supIPVxV4_iGABActx_s = zeros(nsamp,p.supIPVxV4_Npop);
supISOMxV4_supIPVxV4_iGABActx_s(1,:) = supISOMxV4_supIPVxV4_iGABActx_s_last;
midIPVxV4_midExV4_iAMPActx_s_last =  p.midIPVxV4_midExV4_iAMPActx_IC+p.midIPVxV4_midExV4_iAMPActx_IC_noise.*rand(1,p.midExV4_Npop);
midIPVxV4_midExV4_iAMPActx_s = zeros(nsamp,p.midExV4_Npop);
midIPVxV4_midExV4_iAMPActx_s(1,:) = midIPVxV4_midExV4_iAMPActx_s_last;
midExV4_midIPVxV4_iGABActx_s_last =  p.midExV4_midIPVxV4_iGABActx_IC+p.midExV4_midIPVxV4_iGABActx_IC_noise.*rand(1,p.midIPVxV4_Npop);
midExV4_midIPVxV4_iGABActx_s = zeros(nsamp,p.midIPVxV4_Npop);
midExV4_midIPVxV4_iGABActx_s(1,:) = midExV4_midIPVxV4_iGABActx_s_last;
deepISOMxV4_deepExV4_iAMPActx_s_last =  p.deepISOMxV4_deepExV4_iAMPActx_IC+p.deepISOMxV4_deepExV4_iAMPActx_IC_noise.*rand(1,p.deepExV4_Npop);
deepISOMxV4_deepExV4_iAMPActx_s = zeros(nsamp,p.deepExV4_Npop);
deepISOMxV4_deepExV4_iAMPActx_s(1,:) = deepISOMxV4_deepExV4_iAMPActx_s_last;
deepIPVxV4_deepExV4_iAMPActx_s_last =  p.deepIPVxV4_deepExV4_iAMPActx_IC+p.deepIPVxV4_deepExV4_iAMPActx_IC_noise.*rand(1,p.deepExV4_Npop);
deepIPVxV4_deepExV4_iAMPActx_s = zeros(nsamp,p.deepExV4_Npop);
deepIPVxV4_deepExV4_iAMPActx_s(1,:) = deepIPVxV4_deepExV4_iAMPActx_s_last;
deepExV4_deepISOMxV4_iGABActx_s_last =  p.deepExV4_deepISOMxV4_iGABActx_IC+p.deepExV4_deepISOMxV4_iGABActx_IC_noise.*rand(1,p.deepISOMxV4_Npop);
deepExV4_deepISOMxV4_iGABActx_s = zeros(nsamp,p.deepISOMxV4_Npop);
deepExV4_deepISOMxV4_iGABActx_s(1,:) = deepExV4_deepISOMxV4_iGABActx_s_last;
deepIPVxV4_deepISOMxV4_iGABActx_s_last =  p.deepIPVxV4_deepISOMxV4_iGABActx_IC+p.deepIPVxV4_deepISOMxV4_iGABActx_IC_noise.*rand(1,p.deepISOMxV4_Npop);
deepIPVxV4_deepISOMxV4_iGABActx_s = zeros(nsamp,p.deepISOMxV4_Npop);
deepIPVxV4_deepISOMxV4_iGABActx_s(1,:) = deepIPVxV4_deepISOMxV4_iGABActx_s_last;
deepExV4_deepIPVxV4_iGABActx_s_last =  p.deepExV4_deepIPVxV4_iGABActx_IC+p.deepExV4_deepIPVxV4_iGABActx_IC_noise.*rand(1,p.deepIPVxV4_Npop);
deepExV4_deepIPVxV4_iGABActx_s = zeros(nsamp,p.deepIPVxV4_Npop);
deepExV4_deepIPVxV4_iGABActx_s(1,:) = deepExV4_deepIPVxV4_iGABActx_s_last;
deepISOMxV4_deepIPVxV4_iGABActx_s_last =  p.deepISOMxV4_deepIPVxV4_iGABActx_IC+p.deepISOMxV4_deepIPVxV4_iGABActx_IC_noise.*rand(1,p.deepIPVxV4_Npop);
deepISOMxV4_deepIPVxV4_iGABActx_s = zeros(nsamp,p.deepIPVxV4_Npop);
deepISOMxV4_deepIPVxV4_iGABActx_s(1,:) = deepISOMxV4_deepIPVxV4_iGABActx_s_last;
PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last =  p.PostStimuliAxV4_PreStimuliAxV4_iAMPActx_IC+p.PostStimuliAxV4_PreStimuliAxV4_iAMPActx_IC_noise.*rand(1,p.PreStimuliAxV4_Npop);
PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s = zeros(nsamp,p.PreStimuliAxV4_Npop);
PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s(1,:) = PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last;
PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last =  p.PostStimuliBxV4_PreStimuliBxV4_iAMPActx_IC+p.PostStimuliBxV4_PreStimuliBxV4_iAMPActx_IC_noise.*rand(1,p.PreStimuliBxV4_Npop);
PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s = zeros(nsamp,p.PreStimuliBxV4_Npop);
PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s(1,:) = PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last;
PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last =  p.PostStimuliCxV4_PreStimuliCxV4_iAMPActx_IC+p.PostStimuliCxV4_PreStimuliCxV4_iAMPActx_IC_noise.*rand(1,p.PreStimuliCxV4_Npop);
PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s = zeros(nsamp,p.PreStimuliCxV4_Npop);
PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s(1,:) = PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last;
midExV4_PreStimuliAxV4_iAMPActx_s_last =  p.midExV4_PreStimuliAxV4_iAMPActx_IC+p.midExV4_PreStimuliAxV4_iAMPActx_IC_noise.*rand(1,p.PreStimuliAxV4_Npop);
midExV4_PreStimuliAxV4_iAMPActx_s = zeros(nsamp,p.PreStimuliAxV4_Npop);
midExV4_PreStimuliAxV4_iAMPActx_s(1,:) = midExV4_PreStimuliAxV4_iAMPActx_s_last;
midExV4_PostStimuliAxV4_iAMPActx_s_last =  p.midExV4_PostStimuliAxV4_iAMPActx_IC+p.midExV4_PostStimuliAxV4_iAMPActx_IC_noise.*rand(1,p.PostStimuliAxV4_Npop);
midExV4_PostStimuliAxV4_iAMPActx_s = zeros(nsamp,p.PostStimuliAxV4_Npop);
midExV4_PostStimuliAxV4_iAMPActx_s(1,:) = midExV4_PostStimuliAxV4_iAMPActx_s_last;
midExV4_PreStimuliBxV4_iAMPActx_s_last =  p.midExV4_PreStimuliBxV4_iAMPActx_IC+p.midExV4_PreStimuliBxV4_iAMPActx_IC_noise.*rand(1,p.PreStimuliBxV4_Npop);
midExV4_PreStimuliBxV4_iAMPActx_s = zeros(nsamp,p.PreStimuliBxV4_Npop);
midExV4_PreStimuliBxV4_iAMPActx_s(1,:) = midExV4_PreStimuliBxV4_iAMPActx_s_last;
midExV4_PostStimuliBxV4_iAMPActx_s_last =  p.midExV4_PostStimuliBxV4_iAMPActx_IC+p.midExV4_PostStimuliBxV4_iAMPActx_IC_noise.*rand(1,p.PostStimuliBxV4_Npop);
midExV4_PostStimuliBxV4_iAMPActx_s = zeros(nsamp,p.PostStimuliBxV4_Npop);
midExV4_PostStimuliBxV4_iAMPActx_s(1,:) = midExV4_PostStimuliBxV4_iAMPActx_s_last;
midExV4_PreStimuliCxV4_iAMPActx_s_last =  p.midExV4_PreStimuliCxV4_iAMPActx_IC+p.midExV4_PreStimuliCxV4_iAMPActx_IC_noise.*rand(1,p.PreStimuliCxV4_Npop);
midExV4_PreStimuliCxV4_iAMPActx_s = zeros(nsamp,p.PreStimuliCxV4_Npop);
midExV4_PreStimuliCxV4_iAMPActx_s(1,:) = midExV4_PreStimuliCxV4_iAMPActx_s_last;
midExV4_PostStimuliCxV4_iAMPActx_s_last =  p.midExV4_PostStimuliCxV4_iAMPActx_IC+p.midExV4_PostStimuliCxV4_iAMPActx_IC_noise.*rand(1,p.PostStimuliCxV4_Npop);
midExV4_PostStimuliCxV4_iAMPActx_s = zeros(nsamp,p.PostStimuliCxV4_Npop);
midExV4_PostStimuliCxV4_iAMPActx_s(1,:) = midExV4_PostStimuliCxV4_iAMPActx_s_last;
deepExV4_supExV4_iAMPActx_s_last =  p.deepExV4_supExV4_iAMPActx_IC+p.deepExV4_supExV4_iAMPActx_IC_noise.*rand(1,p.supExV4_Npop);
deepExV4_supExV4_iAMPActx_s = zeros(nsamp,p.supExV4_Npop);
deepExV4_supExV4_iAMPActx_s(1,:) = deepExV4_supExV4_iAMPActx_s_last;
supISOMxV4_midExV4_iAMPActx_s_last =  p.supISOMxV4_midExV4_iAMPActx_IC+p.supISOMxV4_midExV4_iAMPActx_IC_noise.*rand(1,p.midExV4_Npop);
supISOMxV4_midExV4_iAMPActx_s = zeros(nsamp,p.midExV4_Npop);
supISOMxV4_midExV4_iAMPActx_s(1,:) = supISOMxV4_midExV4_iAMPActx_s_last;
supExV4_midExV4_iAMPActx_s_last =  p.supExV4_midExV4_iAMPActx_IC+p.supExV4_midExV4_iAMPActx_IC_noise.*rand(1,p.midExV4_Npop);
supExV4_midExV4_iAMPActx_s = zeros(nsamp,p.midExV4_Npop);
supExV4_midExV4_iAMPActx_s(1,:) = supExV4_midExV4_iAMPActx_s_last;
deepExV4_midExV4_iAMPActx_s_last =  p.deepExV4_midExV4_iAMPActx_IC+p.deepExV4_midExV4_iAMPActx_IC_noise.*rand(1,p.midExV4_Npop);
deepExV4_midExV4_iAMPActx_s = zeros(nsamp,p.midExV4_Npop);
deepExV4_midExV4_iAMPActx_s(1,:) = deepExV4_midExV4_iAMPActx_s_last;
deepIPVxV4_midExV4_iAMPActx_s_last =  p.deepIPVxV4_midExV4_iAMPActx_IC+p.deepIPVxV4_midExV4_iAMPActx_IC_noise.*rand(1,p.midExV4_Npop);
deepIPVxV4_midExV4_iAMPActx_s = zeros(nsamp,p.midExV4_Npop);
deepIPVxV4_midExV4_iAMPActx_s(1,:) = deepIPVxV4_midExV4_iAMPActx_s_last;
supExV4_midIPVxV4_iGABActx_s_last =  p.supExV4_midIPVxV4_iGABActx_IC+p.supExV4_midIPVxV4_iGABActx_IC_noise.*rand(1,p.midIPVxV4_Npop);
supExV4_midIPVxV4_iGABActx_s = zeros(nsamp,p.midIPVxV4_Npop);
supExV4_midIPVxV4_iGABActx_s(1,:) = supExV4_midIPVxV4_iGABActx_s_last;
supISOMxV4_deepExV4_iAMPActx_s_last =  p.supISOMxV4_deepExV4_iAMPActx_IC+p.supISOMxV4_deepExV4_iAMPActx_IC_noise.*rand(1,p.deepExV4_Npop);
supISOMxV4_deepExV4_iAMPActx_s = zeros(nsamp,p.deepExV4_Npop);
supISOMxV4_deepExV4_iAMPActx_s(1,:) = supISOMxV4_deepExV4_iAMPActx_s_last;
supIPVxV4_deepExV4_iAMPActx_s_last =  p.supIPVxV4_deepExV4_iAMPActx_IC+p.supIPVxV4_deepExV4_iAMPActx_IC_noise.*rand(1,p.deepExV4_Npop);
supIPVxV4_deepExV4_iAMPActx_s = zeros(nsamp,p.deepExV4_Npop);
supIPVxV4_deepExV4_iAMPActx_s(1,:) = supIPVxV4_deepExV4_iAMPActx_s_last;
midIPVxV4_deepISOMxV4_iGABActx_s_last =  p.midIPVxV4_deepISOMxV4_iGABActx_IC+p.midIPVxV4_deepISOMxV4_iGABActx_IC_noise.*rand(1,p.deepISOMxV4_Npop);
midIPVxV4_deepISOMxV4_iGABActx_s = zeros(nsamp,p.deepISOMxV4_Npop);
midIPVxV4_deepISOMxV4_iGABActx_s(1,:) = midIPVxV4_deepISOMxV4_iGABActx_s_last;
supISOMxPFC_supExPFC_iAMPActx_s_last =  p.supISOMxPFC_supExPFC_iAMPActx_IC+p.supISOMxPFC_supExPFC_iAMPActx_IC_noise.*rand(1,p.supExPFC_Npop);
supISOMxPFC_supExPFC_iAMPActx_s = zeros(nsamp,p.supExPFC_Npop);
supISOMxPFC_supExPFC_iAMPActx_s(1,:) = supISOMxPFC_supExPFC_iAMPActx_s_last;
supIPVxPFC_supExPFC_iAMPActx_s_last =  p.supIPVxPFC_supExPFC_iAMPActx_IC+p.supIPVxPFC_supExPFC_iAMPActx_IC_noise.*rand(1,p.supExPFC_Npop);
supIPVxPFC_supExPFC_iAMPActx_s = zeros(nsamp,p.supExPFC_Npop);
supIPVxPFC_supExPFC_iAMPActx_s(1,:) = supIPVxPFC_supExPFC_iAMPActx_s_last;
supISOMxPFC_supExPFC_iNMDActx_s_last =  p.supISOMxPFC_supExPFC_iNMDActx_IC+p.supISOMxPFC_supExPFC_iNMDActx_IC_noise*rand(1,p.supExPFC_Npop);
supISOMxPFC_supExPFC_iNMDActx_s = zeros(nsamp,p.supExPFC_Npop);
supISOMxPFC_supExPFC_iNMDActx_s(1,:) = supISOMxPFC_supExPFC_iNMDActx_s_last;
supIPVxPFC_supExPFC_iNMDActx_s_last =  p.supIPVxPFC_supExPFC_iNMDActx_IC+p.supIPVxPFC_supExPFC_iNMDActx_IC_noise*rand(1,p.supExPFC_Npop);
supIPVxPFC_supExPFC_iNMDActx_s = zeros(nsamp,p.supExPFC_Npop);
supIPVxPFC_supExPFC_iNMDActx_s(1,:) = supIPVxPFC_supExPFC_iNMDActx_s_last;
supExPFC_supISOMxPFC_iGABActx_s_last =  p.supExPFC_supISOMxPFC_iGABActx_IC+p.supExPFC_supISOMxPFC_iGABActx_IC_noise.*rand(1,p.supISOMxPFC_Npop);
supExPFC_supISOMxPFC_iGABActx_s = zeros(nsamp,p.supISOMxPFC_Npop);
supExPFC_supISOMxPFC_iGABActx_s(1,:) = supExPFC_supISOMxPFC_iGABActx_s_last;
supIPVxPFC_supISOMxPFC_iGABActx_s_last =  p.supIPVxPFC_supISOMxPFC_iGABActx_IC+p.supIPVxPFC_supISOMxPFC_iGABActx_IC_noise.*rand(1,p.supISOMxPFC_Npop);
supIPVxPFC_supISOMxPFC_iGABActx_s = zeros(nsamp,p.supISOMxPFC_Npop);
supIPVxPFC_supISOMxPFC_iGABActx_s(1,:) = supIPVxPFC_supISOMxPFC_iGABActx_s_last;
supExPFC_supIPVxPFC_iGABActx_s_last =  p.supExPFC_supIPVxPFC_iGABActx_IC+p.supExPFC_supIPVxPFC_iGABActx_IC_noise.*rand(1,p.supIPVxPFC_Npop);
supExPFC_supIPVxPFC_iGABActx_s = zeros(nsamp,p.supIPVxPFC_Npop);
supExPFC_supIPVxPFC_iGABActx_s(1,:) = supExPFC_supIPVxPFC_iGABActx_s_last;
supISOMxPFC_supIPVxPFC_iGABActx_s_last =  p.supISOMxPFC_supIPVxPFC_iGABActx_IC+p.supISOMxPFC_supIPVxPFC_iGABActx_IC_noise.*rand(1,p.supIPVxPFC_Npop);
supISOMxPFC_supIPVxPFC_iGABActx_s = zeros(nsamp,p.supIPVxPFC_Npop);
supISOMxPFC_supIPVxPFC_iGABActx_s(1,:) = supISOMxPFC_supIPVxPFC_iGABActx_s_last;
midIPVxPFC_midExPFC_iAMPActx_s_last =  p.midIPVxPFC_midExPFC_iAMPActx_IC+p.midIPVxPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
midIPVxPFC_midExPFC_iAMPActx_s = zeros(nsamp,p.midExPFC_Npop);
midIPVxPFC_midExPFC_iAMPActx_s(1,:) = midIPVxPFC_midExPFC_iAMPActx_s_last;
midExPFC_midIPVxPFC_iGABActx_s_last =  p.midExPFC_midIPVxPFC_iGABActx_IC+p.midExPFC_midIPVxPFC_iGABActx_IC_noise.*rand(1,p.midIPVxPFC_Npop);
midExPFC_midIPVxPFC_iGABActx_s = zeros(nsamp,p.midIPVxPFC_Npop);
midExPFC_midIPVxPFC_iGABActx_s(1,:) = midExPFC_midIPVxPFC_iGABActx_s_last;
deepISOMxPFC_deepExPFC_iAMPActx_s_last =  p.deepISOMxPFC_deepExPFC_iAMPActx_IC+p.deepISOMxPFC_deepExPFC_iAMPActx_IC_noise.*rand(1,p.deepExPFC_Npop);
deepISOMxPFC_deepExPFC_iAMPActx_s = zeros(nsamp,p.deepExPFC_Npop);
deepISOMxPFC_deepExPFC_iAMPActx_s(1,:) = deepISOMxPFC_deepExPFC_iAMPActx_s_last;
deepIPVxPFC_deepExPFC_iAMPActx_s_last =  p.deepIPVxPFC_deepExPFC_iAMPActx_IC+p.deepIPVxPFC_deepExPFC_iAMPActx_IC_noise.*rand(1,p.deepExPFC_Npop);
deepIPVxPFC_deepExPFC_iAMPActx_s = zeros(nsamp,p.deepExPFC_Npop);
deepIPVxPFC_deepExPFC_iAMPActx_s(1,:) = deepIPVxPFC_deepExPFC_iAMPActx_s_last;
deepExPFC_deepISOMxPFC_iGABActx_s_last =  p.deepExPFC_deepISOMxPFC_iGABActx_IC+p.deepExPFC_deepISOMxPFC_iGABActx_IC_noise.*rand(1,p.deepISOMxPFC_Npop);
deepExPFC_deepISOMxPFC_iGABActx_s = zeros(nsamp,p.deepISOMxPFC_Npop);
deepExPFC_deepISOMxPFC_iGABActx_s(1,:) = deepExPFC_deepISOMxPFC_iGABActx_s_last;
deepIPVxPFC_deepISOMxPFC_iGABActx_s_last =  p.deepIPVxPFC_deepISOMxPFC_iGABActx_IC+p.deepIPVxPFC_deepISOMxPFC_iGABActx_IC_noise.*rand(1,p.deepISOMxPFC_Npop);
deepIPVxPFC_deepISOMxPFC_iGABActx_s = zeros(nsamp,p.deepISOMxPFC_Npop);
deepIPVxPFC_deepISOMxPFC_iGABActx_s(1,:) = deepIPVxPFC_deepISOMxPFC_iGABActx_s_last;
deepExPFC_deepIPVxPFC_iGABActx_s_last =  p.deepExPFC_deepIPVxPFC_iGABActx_IC+p.deepExPFC_deepIPVxPFC_iGABActx_IC_noise.*rand(1,p.deepIPVxPFC_Npop);
deepExPFC_deepIPVxPFC_iGABActx_s = zeros(nsamp,p.deepIPVxPFC_Npop);
deepExPFC_deepIPVxPFC_iGABActx_s(1,:) = deepExPFC_deepIPVxPFC_iGABActx_s_last;
deepISOMxPFC_deepIPVxPFC_iGABActx_s_last =  p.deepISOMxPFC_deepIPVxPFC_iGABActx_IC+p.deepISOMxPFC_deepIPVxPFC_iGABActx_IC_noise.*rand(1,p.deepIPVxPFC_Npop);
deepISOMxPFC_deepIPVxPFC_iGABActx_s = zeros(nsamp,p.deepIPVxPFC_Npop);
deepISOMxPFC_deepIPVxPFC_iGABActx_s(1,:) = deepISOMxPFC_deepIPVxPFC_iGABActx_s_last;
PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last =  p.PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_IC+p.PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_IC_noise.*rand(1,p.PreStimuliAxPFC_Npop);
PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s = zeros(nsamp,p.PreStimuliAxPFC_Npop);
PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s(1,:) = PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last;
PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last =  p.PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_IC+p.PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_IC_noise.*rand(1,p.PreStimuliBxPFC_Npop);
PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s = zeros(nsamp,p.PreStimuliBxPFC_Npop);
PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s(1,:) = PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last;
PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last =  p.PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_IC+p.PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_IC_noise.*rand(1,p.PreStimuliCxPFC_Npop);
PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s = zeros(nsamp,p.PreStimuliCxPFC_Npop);
PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s(1,:) = PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last;
midExPFC_PreStimuliAxPFC_iAMPActx_s_last =  p.midExPFC_PreStimuliAxPFC_iAMPActx_IC+p.midExPFC_PreStimuliAxPFC_iAMPActx_IC_noise.*rand(1,p.PreStimuliAxPFC_Npop);
midExPFC_PreStimuliAxPFC_iAMPActx_s = zeros(nsamp,p.PreStimuliAxPFC_Npop);
midExPFC_PreStimuliAxPFC_iAMPActx_s(1,:) = midExPFC_PreStimuliAxPFC_iAMPActx_s_last;
midExPFC_PostStimuliAxPFC_iAMPActx_s_last =  p.midExPFC_PostStimuliAxPFC_iAMPActx_IC+p.midExPFC_PostStimuliAxPFC_iAMPActx_IC_noise.*rand(1,p.PostStimuliAxPFC_Npop);
midExPFC_PostStimuliAxPFC_iAMPActx_s = zeros(nsamp,p.PostStimuliAxPFC_Npop);
midExPFC_PostStimuliAxPFC_iAMPActx_s(1,:) = midExPFC_PostStimuliAxPFC_iAMPActx_s_last;
midExPFC_PreStimuliBxPFC_iAMPActx_s_last =  p.midExPFC_PreStimuliBxPFC_iAMPActx_IC+p.midExPFC_PreStimuliBxPFC_iAMPActx_IC_noise.*rand(1,p.PreStimuliBxPFC_Npop);
midExPFC_PreStimuliBxPFC_iAMPActx_s = zeros(nsamp,p.PreStimuliBxPFC_Npop);
midExPFC_PreStimuliBxPFC_iAMPActx_s(1,:) = midExPFC_PreStimuliBxPFC_iAMPActx_s_last;
midExPFC_PostStimuliBxPFC_iAMPActx_s_last =  p.midExPFC_PostStimuliBxPFC_iAMPActx_IC+p.midExPFC_PostStimuliBxPFC_iAMPActx_IC_noise.*rand(1,p.PostStimuliBxPFC_Npop);
midExPFC_PostStimuliBxPFC_iAMPActx_s = zeros(nsamp,p.PostStimuliBxPFC_Npop);
midExPFC_PostStimuliBxPFC_iAMPActx_s(1,:) = midExPFC_PostStimuliBxPFC_iAMPActx_s_last;
midExPFC_PreStimuliCxPFC_iAMPActx_s_last =  p.midExPFC_PreStimuliCxPFC_iAMPActx_IC+p.midExPFC_PreStimuliCxPFC_iAMPActx_IC_noise.*rand(1,p.PreStimuliCxPFC_Npop);
midExPFC_PreStimuliCxPFC_iAMPActx_s = zeros(nsamp,p.PreStimuliCxPFC_Npop);
midExPFC_PreStimuliCxPFC_iAMPActx_s(1,:) = midExPFC_PreStimuliCxPFC_iAMPActx_s_last;
midExPFC_PostStimuliCxPFC_iAMPActx_s_last =  p.midExPFC_PostStimuliCxPFC_iAMPActx_IC+p.midExPFC_PostStimuliCxPFC_iAMPActx_IC_noise.*rand(1,p.PostStimuliCxPFC_Npop);
midExPFC_PostStimuliCxPFC_iAMPActx_s = zeros(nsamp,p.PostStimuliCxPFC_Npop);
midExPFC_PostStimuliCxPFC_iAMPActx_s(1,:) = midExPFC_PostStimuliCxPFC_iAMPActx_s_last;
deepExPFC_supExPFC_iAMPActx_s_last =  p.deepExPFC_supExPFC_iAMPActx_IC+p.deepExPFC_supExPFC_iAMPActx_IC_noise.*rand(1,p.supExPFC_Npop);
deepExPFC_supExPFC_iAMPActx_s = zeros(nsamp,p.supExPFC_Npop);
deepExPFC_supExPFC_iAMPActx_s(1,:) = deepExPFC_supExPFC_iAMPActx_s_last;
supISOMxPFC_midExPFC_iAMPActx_s_last =  p.supISOMxPFC_midExPFC_iAMPActx_IC+p.supISOMxPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
supISOMxPFC_midExPFC_iAMPActx_s = zeros(nsamp,p.midExPFC_Npop);
supISOMxPFC_midExPFC_iAMPActx_s(1,:) = supISOMxPFC_midExPFC_iAMPActx_s_last;
supExPFC_midExPFC_iAMPActx_s_last =  p.supExPFC_midExPFC_iAMPActx_IC+p.supExPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
supExPFC_midExPFC_iAMPActx_s = zeros(nsamp,p.midExPFC_Npop);
supExPFC_midExPFC_iAMPActx_s(1,:) = supExPFC_midExPFC_iAMPActx_s_last;
deepExPFC_midExPFC_iAMPActx_s_last =  p.deepExPFC_midExPFC_iAMPActx_IC+p.deepExPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
deepExPFC_midExPFC_iAMPActx_s = zeros(nsamp,p.midExPFC_Npop);
deepExPFC_midExPFC_iAMPActx_s(1,:) = deepExPFC_midExPFC_iAMPActx_s_last;
deepIPVxPFC_midExPFC_iAMPActx_s_last =  p.deepIPVxPFC_midExPFC_iAMPActx_IC+p.deepIPVxPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
deepIPVxPFC_midExPFC_iAMPActx_s = zeros(nsamp,p.midExPFC_Npop);
deepIPVxPFC_midExPFC_iAMPActx_s(1,:) = deepIPVxPFC_midExPFC_iAMPActx_s_last;
supExPFC_midIPVxPFC_iGABActx_s_last =  p.supExPFC_midIPVxPFC_iGABActx_IC+p.supExPFC_midIPVxPFC_iGABActx_IC_noise.*rand(1,p.midIPVxPFC_Npop);
supExPFC_midIPVxPFC_iGABActx_s = zeros(nsamp,p.midIPVxPFC_Npop);
supExPFC_midIPVxPFC_iGABActx_s(1,:) = supExPFC_midIPVxPFC_iGABActx_s_last;
supISOMxPFC_deepExPFC_iAMPActx_s_last =  p.supISOMxPFC_deepExPFC_iAMPActx_IC+p.supISOMxPFC_deepExPFC_iAMPActx_IC_noise.*rand(1,p.deepExPFC_Npop);
supISOMxPFC_deepExPFC_iAMPActx_s = zeros(nsamp,p.deepExPFC_Npop);
supISOMxPFC_deepExPFC_iAMPActx_s(1,:) = supISOMxPFC_deepExPFC_iAMPActx_s_last;
supIPVxPFC_deepExPFC_iAMPActx_s_last =  p.supIPVxPFC_deepExPFC_iAMPActx_IC+p.supIPVxPFC_deepExPFC_iAMPActx_IC_noise.*rand(1,p.deepExPFC_Npop);
supIPVxPFC_deepExPFC_iAMPActx_s = zeros(nsamp,p.deepExPFC_Npop);
supIPVxPFC_deepExPFC_iAMPActx_s(1,:) = supIPVxPFC_deepExPFC_iAMPActx_s_last;
midIPVxPFC_deepISOMxPFC_iGABActx_s_last =  p.midIPVxPFC_deepISOMxPFC_iGABActx_IC+p.midIPVxPFC_deepISOMxPFC_iGABActx_IC_noise.*rand(1,p.deepISOMxPFC_Npop);
midIPVxPFC_deepISOMxPFC_iGABActx_s = zeros(nsamp,p.deepISOMxPFC_Npop);
midIPVxPFC_deepISOMxPFC_iGABActx_s(1,:) = midIPVxPFC_deepISOMxPFC_iGABActx_s_last;
midExPFC_supExV4_iAMPActx_s_last =  p.midExPFC_supExV4_iAMPActx_IC+p.midExPFC_supExV4_iAMPActx_IC_noise.*rand(1,p.supExV4_Npop);
midExPFC_supExV4_iAMPActx_s = zeros(nsamp,p.supExV4_Npop);
midExPFC_supExV4_iAMPActx_s(1,:) = midExPFC_supExV4_iAMPActx_s_last;
midIPVxPFC_supExV4_iAMPActx_s_last =  p.midIPVxPFC_supExV4_iAMPActx_IC+p.midIPVxPFC_supExV4_iAMPActx_IC_noise.*rand(1,p.supExV4_Npop);
midIPVxPFC_supExV4_iAMPActx_s = zeros(nsamp,p.supExV4_Npop);
midIPVxPFC_supExV4_iAMPActx_s(1,:) = midIPVxPFC_supExV4_iAMPActx_s_last;
supISOMxV4_deepExPFC_iAMPActx_s_last =  p.supISOMxV4_deepExPFC_iAMPActx_IC+p.supISOMxV4_deepExPFC_iAMPActx_IC_noise.*rand(1,p.deepExPFC_Npop);
supISOMxV4_deepExPFC_iAMPActx_s = zeros(nsamp,p.deepExPFC_Npop);
supISOMxV4_deepExPFC_iAMPActx_s(1,:) = supISOMxV4_deepExPFC_iAMPActx_s_last;

% ###########################################################
% Numerical integration:
% ###########################################################
n=2;
for k=2:ntime
  t=T(k-1);
  supExV4_V_k1 = (p.supExV4_Iapp + ((((-p.supExV4_iNa_gNa.*supExV4_iNa_m_last.^3.*supExV4_iNa_h_last.*(supExV4_V_last-p.supExV4_iNa_ENa))))+((((-p.supExV4_iK_gK.*supExV4_iK_n_last.^4.*(supExV4_V_last-p.supExV4_iK_EK))))+((((-p.supExV4_supISOMxV4_iGABActx_gGABAa.*(supExV4_supISOMxV4_iGABActx_s_last*p.supExV4_supISOMxV4_iGABActx_netcon).*(supExV4_V_last-p.supExV4_supISOMxV4_iGABActx_EGABAa))))+((((-p.supExV4_supIPVxV4_iGABActx_gGABAa.*(supExV4_supIPVxV4_iGABActx_s_last*p.supExV4_supIPVxV4_iGABActx_netcon).*(supExV4_V_last-p.supExV4_supIPVxV4_iGABActx_EGABAa))))+((-(((p.supExV4_midExV4_iAMPActx_gAMPA.*(supExV4_midExV4_iAMPActx_s_last*p.supExV4_midExV4_iAMPActx_netcon).*(supExV4_V_last-p.supExV4_midExV4_iAMPActx_EAMPA)))))+((((-p.supExV4_midIPVxV4_iGABActx_gGABAa.*(supExV4_midIPVxV4_iGABActx_s_last*p.supExV4_midIPVxV4_iGABActx_netcon).*(supExV4_V_last-p.supExV4_midIPVxV4_iGABActx_EGABAa)))))))))) + p.supExV4_noise*randn(1, p.supExV4_Npop))/p.supExV4_C;
  supExV4_iNa_m_k1 = (((2.5-.1*(supExV4_V_last+65))./(exp(2.5-.1*(supExV4_V_last+65))-1))).*(1-supExV4_iNa_m_last)-((4*exp(-(supExV4_V_last+65)/18))).*supExV4_iNa_m_last;
  supExV4_iNa_h_k1 = ((.07*exp(-(supExV4_V_last+65)/20))).*(1-supExV4_iNa_h_last)-((1./(exp(3-.1*(supExV4_V_last+65))+1))).*supExV4_iNa_h_last;
  supExV4_iK_n_k1 = (((.1-.01*(supExV4_V_last+65))./(exp(1-.1*(supExV4_V_last+65))-1))).*(1-supExV4_iK_n_last)-((.125*exp(-(supExV4_V_last+65)/80))).*supExV4_iK_n_last;
  supISOMxV4_V_k1 = (p.supISOMxV4_Iapp + ((((-p.supISOMxV4_iNa_gNa.*supISOMxV4_iNa_m_last.^3.*supISOMxV4_iNa_h_last.*(supISOMxV4_V_last-p.supISOMxV4_iNa_ENa))))+((((-p.supISOMxV4_iK_gK.*supISOMxV4_iK_n_last.^4.*(supISOMxV4_V_last-p.supISOMxV4_iK_EK))))+((-(((p.supISOMxV4_supExV4_iAMPActx_gAMPA.*(supISOMxV4_supExV4_iAMPActx_s_last*p.supISOMxV4_supExV4_iAMPActx_netcon).*(supISOMxV4_V_last-p.supISOMxV4_supExV4_iAMPActx_EAMPA)))))+((((-p.supISOMxV4_supExV4_iNMDActx_gNMDA.*(((1.50265./(1+0.33*exp(supISOMxV4_V_last./(-16)))))).*(supISOMxV4_supExV4_iNMDActx_s_last*p.supISOMxV4_supExV4_iNMDActx_netcon).*(supISOMxV4_V_last-p.supISOMxV4_supExV4_iNMDActx_ENMDA))))+((((-p.supISOMxV4_supIPVxV4_iGABActx_gGABAa.*(supISOMxV4_supIPVxV4_iGABActx_s_last*p.supISOMxV4_supIPVxV4_iGABActx_netcon).*(supISOMxV4_V_last-p.supISOMxV4_supIPVxV4_iGABActx_EGABAa))))+((-(((p.supISOMxV4_midExV4_iAMPActx_gAMPA.*(supISOMxV4_midExV4_iAMPActx_s_last*p.supISOMxV4_midExV4_iAMPActx_netcon).*(supISOMxV4_V_last-p.supISOMxV4_midExV4_iAMPActx_EAMPA)))))+((-(((p.supISOMxV4_deepExV4_iAMPActx_gAMPA.*(supISOMxV4_deepExV4_iAMPActx_s_last*p.supISOMxV4_deepExV4_iAMPActx_netcon).*(supISOMxV4_V_last-p.supISOMxV4_deepExV4_iAMPActx_EAMPA)))))+((-(((p.supISOMxV4_deepExPFC_iAMPActx_gAMPA.*(supISOMxV4_deepExPFC_iAMPActx_s_last*p.supISOMxV4_deepExPFC_iAMPActx_netcon).*(supISOMxV4_V_last-p.supISOMxV4_deepExPFC_iAMPActx_EAMPA))))))))))))) + p.supISOMxV4_noise*randn(1, p.supISOMxV4_Npop))/p.supISOMxV4_C;
  supISOMxV4_iNa_m_k1 = (((2.5-.1*(supISOMxV4_V_last+65))./(exp(2.5-.1*(supISOMxV4_V_last+65))-1))).*(1-supISOMxV4_iNa_m_last)-((4*exp(-(supISOMxV4_V_last+65)/18))).*supISOMxV4_iNa_m_last;
  supISOMxV4_iNa_h_k1 = ((.07*exp(-(supISOMxV4_V_last+65)/20))).*(1-supISOMxV4_iNa_h_last)-((1./(exp(3-.1*(supISOMxV4_V_last+65))+1))).*supISOMxV4_iNa_h_last;
  supISOMxV4_iK_n_k1 = (((.1-.01*(supISOMxV4_V_last+65))./(exp(1-.1*(supISOMxV4_V_last+65))-1))).*(1-supISOMxV4_iK_n_last)-((.125*exp(-(supISOMxV4_V_last+65)/80))).*supISOMxV4_iK_n_last;
  supIPVxV4_V_k1 = (p.supIPVxV4_Iapp + ((((-p.supIPVxV4_iNa_gNa.*supIPVxV4_iNa_m_last.^3.*supIPVxV4_iNa_h_last.*(supIPVxV4_V_last-p.supIPVxV4_iNa_ENa))))+((((-p.supIPVxV4_iK_gK.*supIPVxV4_iK_n_last.^4.*(supIPVxV4_V_last-p.supIPVxV4_iK_EK))))+((-(((p.supIPVxV4_supExV4_iAMPActx_gAMPA.*(supIPVxV4_supExV4_iAMPActx_s_last*p.supIPVxV4_supExV4_iAMPActx_netcon).*(supIPVxV4_V_last-p.supIPVxV4_supExV4_iAMPActx_EAMPA)))))+((((-p.supIPVxV4_supExV4_iNMDActx_gNMDA.*(((1.50265./(1+0.33*exp(supIPVxV4_V_last./(-16)))))).*(supIPVxV4_supExV4_iNMDActx_s_last*p.supIPVxV4_supExV4_iNMDActx_netcon).*(supIPVxV4_V_last-p.supIPVxV4_supExV4_iNMDActx_ENMDA))))+((((-p.supIPVxV4_supISOMxV4_iGABActx_gGABAa.*(supIPVxV4_supISOMxV4_iGABActx_s_last*p.supIPVxV4_supISOMxV4_iGABActx_netcon).*(supIPVxV4_V_last-p.supIPVxV4_supISOMxV4_iGABActx_EGABAa))))+((-(((p.supIPVxV4_deepExV4_iAMPActx_gAMPA.*(supIPVxV4_deepExV4_iAMPActx_s_last*p.supIPVxV4_deepExV4_iAMPActx_netcon).*(supIPVxV4_V_last-p.supIPVxV4_deepExV4_iAMPActx_EAMPA))))))))))) + p.supIPVxV4_noise*randn(1, p.supIPVxV4_Npop))/p.supIPVxV4_C;
  supIPVxV4_iNa_m_k1 = (((2.5-.1*(supIPVxV4_V_last+65))./(exp(2.5-.1*(supIPVxV4_V_last+65))-1))).*(1-supIPVxV4_iNa_m_last)-((4*exp(-(supIPVxV4_V_last+65)/18))).*supIPVxV4_iNa_m_last;
  supIPVxV4_iNa_h_k1 = ((.07*exp(-(supIPVxV4_V_last+65)/20))).*(1-supIPVxV4_iNa_h_last)-((1./(exp(3-.1*(supIPVxV4_V_last+65))+1))).*supIPVxV4_iNa_h_last;
  supIPVxV4_iK_n_k1 = (((.1-.01*(supIPVxV4_V_last+65))./(exp(1-.1*(supIPVxV4_V_last+65))-1))).*(1-supIPVxV4_iK_n_last)-((.125*exp(-(supIPVxV4_V_last+65)/80))).*supIPVxV4_iK_n_last;
  midExV4_V_k1 = (p.midExV4_Iapp + ((((-p.midExV4_iNa_gNa.*midExV4_iNa_m_last.^3.*midExV4_iNa_h_last.*(midExV4_V_last-p.midExV4_iNa_ENa))))+((((-p.midExV4_iK_gK.*midExV4_iK_n_last.^4.*(midExV4_V_last-p.midExV4_iK_EK))))+((((-p.midExV4_midIPVxV4_iGABActx_gGABAa.*(midExV4_midIPVxV4_iGABActx_s_last*p.midExV4_midIPVxV4_iGABActx_netcon).*(midExV4_V_last-p.midExV4_midIPVxV4_iGABActx_EGABAa))))+((-(((p.midExV4_PreStimuliAxV4_iAMPActx_gAMPA.*(midExV4_PreStimuliAxV4_iAMPActx_s_last*p.midExV4_PreStimuliAxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_PreStimuliAxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_PostStimuliAxV4_iAMPActx_gAMPA.*(midExV4_PostStimuliAxV4_iAMPActx_s_last*p.midExV4_PostStimuliAxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_PostStimuliAxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_PreStimuliBxV4_iAMPActx_gAMPA.*(midExV4_PreStimuliBxV4_iAMPActx_s_last*p.midExV4_PreStimuliBxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_PreStimuliBxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_PostStimuliBxV4_iAMPActx_gAMPA.*(midExV4_PostStimuliBxV4_iAMPActx_s_last*p.midExV4_PostStimuliBxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_PostStimuliBxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_PreStimuliCxV4_iAMPActx_gAMPA.*(midExV4_PreStimuliCxV4_iAMPActx_s_last*p.midExV4_PreStimuliCxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_PreStimuliCxV4_iAMPActx_EAMPA)))))+((-(((p.midExV4_PostStimuliCxV4_iAMPActx_gAMPA.*(midExV4_PostStimuliCxV4_iAMPActx_s_last*p.midExV4_PostStimuliCxV4_iAMPActx_netcon).*(midExV4_V_last-p.midExV4_PostStimuliCxV4_iAMPActx_EAMPA)))))))))))))) + p.midExV4_noise*randn(1, p.midExV4_Npop))/p.midExV4_C;
  midExV4_iNa_m_k1 = (((2.5-.1*(midExV4_V_last+65))./(exp(2.5-.1*(midExV4_V_last+65))-1))).*(1-midExV4_iNa_m_last)-((4*exp(-(midExV4_V_last+65)/18))).*midExV4_iNa_m_last;
  midExV4_iNa_h_k1 = ((.07*exp(-(midExV4_V_last+65)/20))).*(1-midExV4_iNa_h_last)-((1./(exp(3-.1*(midExV4_V_last+65))+1))).*midExV4_iNa_h_last;
  midExV4_iK_n_k1 = (((.1-.01*(midExV4_V_last+65))./(exp(1-.1*(midExV4_V_last+65))-1))).*(1-midExV4_iK_n_last)-((.125*exp(-(midExV4_V_last+65)/80))).*midExV4_iK_n_last;
  midIPVxV4_V_k1 = (p.midIPVxV4_Iapp + ((((-p.midIPVxV4_iNa_gNa.*midIPVxV4_iNa_m_last.^3.*midIPVxV4_iNa_h_last.*(midIPVxV4_V_last-p.midIPVxV4_iNa_ENa))))+((((-p.midIPVxV4_iK_gK.*midIPVxV4_iK_n_last.^4.*(midIPVxV4_V_last-p.midIPVxV4_iK_EK))))+((-(((p.midIPVxV4_midExV4_iAMPActx_gAMPA.*(midIPVxV4_midExV4_iAMPActx_s_last*p.midIPVxV4_midExV4_iAMPActx_netcon).*(midIPVxV4_V_last-p.midIPVxV4_midExV4_iAMPActx_EAMPA)))))+((((-p.midIPVxV4_deepISOMxV4_iGABActx_gGABAa.*(midIPVxV4_deepISOMxV4_iGABActx_s_last*p.midIPVxV4_deepISOMxV4_iGABActx_netcon).*(midIPVxV4_V_last-p.midIPVxV4_deepISOMxV4_iGABActx_EGABAa)))))))) + p.midIPVxV4_noise*randn(1, p.midIPVxV4_Npop))/p.midIPVxV4_C;
  midIPVxV4_iNa_m_k1 = (((2.5-.1*(midIPVxV4_V_last+65))./(exp(2.5-.1*(midIPVxV4_V_last+65))-1))).*(1-midIPVxV4_iNa_m_last)-((4*exp(-(midIPVxV4_V_last+65)/18))).*midIPVxV4_iNa_m_last;
  midIPVxV4_iNa_h_k1 = ((.07*exp(-(midIPVxV4_V_last+65)/20))).*(1-midIPVxV4_iNa_h_last)-((1./(exp(3-.1*(midIPVxV4_V_last+65))+1))).*midIPVxV4_iNa_h_last;
  midIPVxV4_iK_n_k1 = (((.1-.01*(midIPVxV4_V_last+65))./(exp(1-.1*(midIPVxV4_V_last+65))-1))).*(1-midIPVxV4_iK_n_last)-((.125*exp(-(midIPVxV4_V_last+65)/80))).*midIPVxV4_iK_n_last;
  deepExV4_V_k1 = (p.deepExV4_Iapp + ((((-p.deepExV4_iNa_gNa.*deepExV4_iNa_m_last.^3.*deepExV4_iNa_h_last.*(deepExV4_V_last-p.deepExV4_iNa_ENa))))+((((-p.deepExV4_iK_gK.*deepExV4_iK_n_last.^4.*(deepExV4_V_last-p.deepExV4_iK_EK))))+((((-p.deepExV4_deepISOMxV4_iGABActx_gGABAa.*(deepExV4_deepISOMxV4_iGABActx_s_last*p.deepExV4_deepISOMxV4_iGABActx_netcon).*(deepExV4_V_last-p.deepExV4_deepISOMxV4_iGABActx_EGABAa))))+((((-p.deepExV4_deepIPVxV4_iGABActx_gGABAa.*(deepExV4_deepIPVxV4_iGABActx_s_last*p.deepExV4_deepIPVxV4_iGABActx_netcon).*(deepExV4_V_last-p.deepExV4_deepIPVxV4_iGABActx_EGABAa))))+((-(((p.deepExV4_supExV4_iAMPActx_gAMPA.*(deepExV4_supExV4_iAMPActx_s_last*p.deepExV4_supExV4_iAMPActx_netcon).*(deepExV4_V_last-p.deepExV4_supExV4_iAMPActx_EAMPA)))))+((-(((p.deepExV4_midExV4_iAMPActx_gAMPA.*(deepExV4_midExV4_iAMPActx_s_last*p.deepExV4_midExV4_iAMPActx_netcon).*(deepExV4_V_last-p.deepExV4_midExV4_iAMPActx_EAMPA))))))))))) + p.deepExV4_noise*randn(1, p.deepExV4_Npop))/p.deepExV4_C;
  deepExV4_iNa_m_k1 = (((2.5-.1*(deepExV4_V_last+65))./(exp(2.5-.1*(deepExV4_V_last+65))-1))).*(1-deepExV4_iNa_m_last)-((4*exp(-(deepExV4_V_last+65)/18))).*deepExV4_iNa_m_last;
  deepExV4_iNa_h_k1 = ((.07*exp(-(deepExV4_V_last+65)/20))).*(1-deepExV4_iNa_h_last)-((1./(exp(3-.1*(deepExV4_V_last+65))+1))).*deepExV4_iNa_h_last;
  deepExV4_iK_n_k1 = (((.1-.01*(deepExV4_V_last+65))./(exp(1-.1*(deepExV4_V_last+65))-1))).*(1-deepExV4_iK_n_last)-((.125*exp(-(deepExV4_V_last+65)/80))).*deepExV4_iK_n_last;
  deepISOMxV4_V_k1 = (p.deepISOMxV4_Iapp + ((((-p.deepISOMxV4_iNa_gNa.*deepISOMxV4_iNa_m_last.^3.*deepISOMxV4_iNa_h_last.*(deepISOMxV4_V_last-p.deepISOMxV4_iNa_ENa))))+((((-p.deepISOMxV4_iK_gK.*deepISOMxV4_iK_n_last.^4.*(deepISOMxV4_V_last-p.deepISOMxV4_iK_EK))))+((-(((p.deepISOMxV4_deepExV4_iAMPActx_gAMPA.*(deepISOMxV4_deepExV4_iAMPActx_s_last*p.deepISOMxV4_deepExV4_iAMPActx_netcon).*(deepISOMxV4_V_last-p.deepISOMxV4_deepExV4_iAMPActx_EAMPA)))))+((((-p.deepISOMxV4_deepIPVxV4_iGABActx_gGABAa.*(deepISOMxV4_deepIPVxV4_iGABActx_s_last*p.deepISOMxV4_deepIPVxV4_iGABActx_netcon).*(deepISOMxV4_V_last-p.deepISOMxV4_deepIPVxV4_iGABActx_EGABAa)))))))) + p.deepISOMxV4_noise*randn(1, p.deepISOMxV4_Npop))/p.deepISOMxV4_C;
  deepISOMxV4_iNa_m_k1 = (((2.5-.1*(deepISOMxV4_V_last+65))./(exp(2.5-.1*(deepISOMxV4_V_last+65))-1))).*(1-deepISOMxV4_iNa_m_last)-((4*exp(-(deepISOMxV4_V_last+65)/18))).*deepISOMxV4_iNa_m_last;
  deepISOMxV4_iNa_h_k1 = ((.07*exp(-(deepISOMxV4_V_last+65)/20))).*(1-deepISOMxV4_iNa_h_last)-((1./(exp(3-.1*(deepISOMxV4_V_last+65))+1))).*deepISOMxV4_iNa_h_last;
  deepISOMxV4_iK_n_k1 = (((.1-.01*(deepISOMxV4_V_last+65))./(exp(1-.1*(deepISOMxV4_V_last+65))-1))).*(1-deepISOMxV4_iK_n_last)-((.125*exp(-(deepISOMxV4_V_last+65)/80))).*deepISOMxV4_iK_n_last;
  deepIPVxV4_V_k1 = (p.deepIPVxV4_Iapp + ((((-p.deepIPVxV4_iNa_gNa.*deepIPVxV4_iNa_m_last.^3.*deepIPVxV4_iNa_h_last.*(deepIPVxV4_V_last-p.deepIPVxV4_iNa_ENa))))+((((-p.deepIPVxV4_iK_gK.*deepIPVxV4_iK_n_last.^4.*(deepIPVxV4_V_last-p.deepIPVxV4_iK_EK))))+((-(((p.deepIPVxV4_deepExV4_iAMPActx_gAMPA.*(deepIPVxV4_deepExV4_iAMPActx_s_last*p.deepIPVxV4_deepExV4_iAMPActx_netcon).*(deepIPVxV4_V_last-p.deepIPVxV4_deepExV4_iAMPActx_EAMPA)))))+((((-p.deepIPVxV4_deepISOMxV4_iGABActx_gGABAa.*(deepIPVxV4_deepISOMxV4_iGABActx_s_last*p.deepIPVxV4_deepISOMxV4_iGABActx_netcon).*(deepIPVxV4_V_last-p.deepIPVxV4_deepISOMxV4_iGABActx_EGABAa))))+((-(((p.deepIPVxV4_midExV4_iAMPActx_gAMPA.*(deepIPVxV4_midExV4_iAMPActx_s_last*p.deepIPVxV4_midExV4_iAMPActx_netcon).*(deepIPVxV4_V_last-p.deepIPVxV4_midExV4_iAMPActx_EAMPA)))))))))) + p.deepIPVxV4_noise*randn(1, p.deepIPVxV4_Npop))/p.deepIPVxV4_C;
  deepIPVxV4_iNa_m_k1 = (((2.5-.1*(deepIPVxV4_V_last+65))./(exp(2.5-.1*(deepIPVxV4_V_last+65))-1))).*(1-deepIPVxV4_iNa_m_last)-((4*exp(-(deepIPVxV4_V_last+65)/18))).*deepIPVxV4_iNa_m_last;
  deepIPVxV4_iNa_h_k1 = ((.07*exp(-(deepIPVxV4_V_last+65)/20))).*(1-deepIPVxV4_iNa_h_last)-((1./(exp(3-.1*(deepIPVxV4_V_last+65))+1))).*deepIPVxV4_iNa_h_last;
  deepIPVxV4_iK_n_k1 = (((.1-.01*(deepIPVxV4_V_last+65))./(exp(1-.1*(deepIPVxV4_V_last+65))-1))).*(1-deepIPVxV4_iK_n_last)-((.125*exp(-(deepIPVxV4_V_last+65)/80))).*deepIPVxV4_iK_n_last;
  PreStimuliAxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PreStimuliAxV4_t1).^2) - exp(- (t - p.PreStimuliAxV4_t2).^2)) + p.PreStimuliAxV4_noise*randn(1, p.PreStimuliAxV4_Npop))/p.PreStimuliAxV4_C;
  PreStimuliAxV4_iNa_m_k1 = (((2.5-.1*(PreStimuliAxV4_V_last+65))./(exp(2.5-.1*(PreStimuliAxV4_V_last+65))-1))).*(1-PreStimuliAxV4_iNa_m_last)-((4*exp(-(PreStimuliAxV4_V_last+65)/18))).*PreStimuliAxV4_iNa_m_last;
  PreStimuliAxV4_iNa_h_k1 = ((.07*exp(-(PreStimuliAxV4_V_last+65)/20))).*(1-PreStimuliAxV4_iNa_h_last)-((1./(exp(3-.1*(PreStimuliAxV4_V_last+65))+1))).*PreStimuliAxV4_iNa_h_last;
  PreStimuliAxV4_iK_n_k1 = (((.1-.01*(PreStimuliAxV4_V_last+65))./(exp(1-.1*(PreStimuliAxV4_V_last+65))-1))).*(1-PreStimuliAxV4_iK_n_last)-((.125*exp(-(PreStimuliAxV4_V_last+65)/80))).*PreStimuliAxV4_iK_n_last;
  PostStimuliAxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PostStimuliAxV4_t1).^2) - exp(- (t - p.PostStimuliAxV4_t2).^2)) + p.PostStimuliAxV4_noise*randn(1, p.PostStimuliAxV4_Npop))/p.PostStimuliAxV4_C;
  PostStimuliAxV4_iNa_m_k1 = (((2.5-.1*(PostStimuliAxV4_V_last+65))./(exp(2.5-.1*(PostStimuliAxV4_V_last+65))-1))).*(1-PostStimuliAxV4_iNa_m_last)-((4*exp(-(PostStimuliAxV4_V_last+65)/18))).*PostStimuliAxV4_iNa_m_last;
  PostStimuliAxV4_iNa_h_k1 = ((.07*exp(-(PostStimuliAxV4_V_last+65)/20))).*(1-PostStimuliAxV4_iNa_h_last)-((1./(exp(3-.1*(PostStimuliAxV4_V_last+65))+1))).*PostStimuliAxV4_iNa_h_last;
  PostStimuliAxV4_iK_n_k1 = (((.1-.01*(PostStimuliAxV4_V_last+65))./(exp(1-.1*(PostStimuliAxV4_V_last+65))-1))).*(1-PostStimuliAxV4_iK_n_last)-((.125*exp(-(PostStimuliAxV4_V_last+65)/80))).*PostStimuliAxV4_iK_n_last;
  PreStimuliBxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PreStimuliBxV4_t1).^2) - exp(- (t - p.PreStimuliBxV4_t2).^2)) + p.PreStimuliBxV4_noise*randn(1, p.PreStimuliBxV4_Npop))/p.PreStimuliBxV4_C;
  PreStimuliBxV4_iNa_m_k1 = (((2.5-.1*(PreStimuliBxV4_V_last+65))./(exp(2.5-.1*(PreStimuliBxV4_V_last+65))-1))).*(1-PreStimuliBxV4_iNa_m_last)-((4*exp(-(PreStimuliBxV4_V_last+65)/18))).*PreStimuliBxV4_iNa_m_last;
  PreStimuliBxV4_iNa_h_k1 = ((.07*exp(-(PreStimuliBxV4_V_last+65)/20))).*(1-PreStimuliBxV4_iNa_h_last)-((1./(exp(3-.1*(PreStimuliBxV4_V_last+65))+1))).*PreStimuliBxV4_iNa_h_last;
  PreStimuliBxV4_iK_n_k1 = (((.1-.01*(PreStimuliBxV4_V_last+65))./(exp(1-.1*(PreStimuliBxV4_V_last+65))-1))).*(1-PreStimuliBxV4_iK_n_last)-((.125*exp(-(PreStimuliBxV4_V_last+65)/80))).*PreStimuliBxV4_iK_n_last;
  PostStimuliBxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PostStimuliBxV4_t1).^2) - exp(- (t - p.PostStimuliBxV4_t2).^2)) + p.PostStimuliBxV4_noise*randn(1, p.PostStimuliBxV4_Npop))/p.PostStimuliBxV4_C;
  PostStimuliBxV4_iNa_m_k1 = (((2.5-.1*(PostStimuliBxV4_V_last+65))./(exp(2.5-.1*(PostStimuliBxV4_V_last+65))-1))).*(1-PostStimuliBxV4_iNa_m_last)-((4*exp(-(PostStimuliBxV4_V_last+65)/18))).*PostStimuliBxV4_iNa_m_last;
  PostStimuliBxV4_iNa_h_k1 = ((.07*exp(-(PostStimuliBxV4_V_last+65)/20))).*(1-PostStimuliBxV4_iNa_h_last)-((1./(exp(3-.1*(PostStimuliBxV4_V_last+65))+1))).*PostStimuliBxV4_iNa_h_last;
  PostStimuliBxV4_iK_n_k1 = (((.1-.01*(PostStimuliBxV4_V_last+65))./(exp(1-.1*(PostStimuliBxV4_V_last+65))-1))).*(1-PostStimuliBxV4_iK_n_last)-((.125*exp(-(PostStimuliBxV4_V_last+65)/80))).*PostStimuliBxV4_iK_n_last;
  PreStimuliCxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PreStimuliCxV4_t1).^2) - exp(- (t - p.PreStimuliCxV4_t2).^2)) + p.PreStimuliCxV4_noise*randn(1, p.PreStimuliCxV4_Npop))/p.PreStimuliCxV4_C;
  PreStimuliCxV4_iNa_m_k1 = (((2.5-.1*(PreStimuliCxV4_V_last+65))./(exp(2.5-.1*(PreStimuliCxV4_V_last+65))-1))).*(1-PreStimuliCxV4_iNa_m_last)-((4*exp(-(PreStimuliCxV4_V_last+65)/18))).*PreStimuliCxV4_iNa_m_last;
  PreStimuliCxV4_iNa_h_k1 = ((.07*exp(-(PreStimuliCxV4_V_last+65)/20))).*(1-PreStimuliCxV4_iNa_h_last)-((1./(exp(3-.1*(PreStimuliCxV4_V_last+65))+1))).*PreStimuliCxV4_iNa_h_last;
  PreStimuliCxV4_iK_n_k1 = (((.1-.01*(PreStimuliCxV4_V_last+65))./(exp(1-.1*(PreStimuliCxV4_V_last+65))-1))).*(1-PreStimuliCxV4_iK_n_last)-((.125*exp(-(PreStimuliCxV4_V_last+65)/80))).*PreStimuliCxV4_iK_n_last;
  PostStimuliCxV4_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PostStimuliCxV4_t1).^2) - exp(- (t - p.PostStimuliCxV4_t2).^2)) + p.PostStimuliCxV4_noise*randn(1, p.PostStimuliCxV4_Npop))/p.PostStimuliCxV4_C;
  PostStimuliCxV4_iNa_m_k1 = (((2.5-.1*(PostStimuliCxV4_V_last+65))./(exp(2.5-.1*(PostStimuliCxV4_V_last+65))-1))).*(1-PostStimuliCxV4_iNa_m_last)-((4*exp(-(PostStimuliCxV4_V_last+65)/18))).*PostStimuliCxV4_iNa_m_last;
  PostStimuliCxV4_iNa_h_k1 = ((.07*exp(-(PostStimuliCxV4_V_last+65)/20))).*(1-PostStimuliCxV4_iNa_h_last)-((1./(exp(3-.1*(PostStimuliCxV4_V_last+65))+1))).*PostStimuliCxV4_iNa_h_last;
  PostStimuliCxV4_iK_n_k1 = (((.1-.01*(PostStimuliCxV4_V_last+65))./(exp(1-.1*(PostStimuliCxV4_V_last+65))-1))).*(1-PostStimuliCxV4_iK_n_last)-((.125*exp(-(PostStimuliCxV4_V_last+65)/80))).*PostStimuliCxV4_iK_n_last;
  supExPFC_V_k1 = (p.supExPFC_Iapp + ((((-p.supExPFC_iNa_gNa.*supExPFC_iNa_m_last.^3.*supExPFC_iNa_h_last.*(supExPFC_V_last-p.supExPFC_iNa_ENa))))+((((-p.supExPFC_iK_gK.*supExPFC_iK_n_last.^4.*(supExPFC_V_last-p.supExPFC_iK_EK))))+((((-p.supExPFC_supISOMxPFC_iGABActx_gGABAa.*(supExPFC_supISOMxPFC_iGABActx_s_last*p.supExPFC_supISOMxPFC_iGABActx_netcon).*(supExPFC_V_last-p.supExPFC_supISOMxPFC_iGABActx_EGABAa))))+((((-p.supExPFC_supIPVxPFC_iGABActx_gGABAa.*(supExPFC_supIPVxPFC_iGABActx_s_last*p.supExPFC_supIPVxPFC_iGABActx_netcon).*(supExPFC_V_last-p.supExPFC_supIPVxPFC_iGABActx_EGABAa))))+((-(((p.supExPFC_midExPFC_iAMPActx_gAMPA.*(supExPFC_midExPFC_iAMPActx_s_last*p.supExPFC_midExPFC_iAMPActx_netcon).*(supExPFC_V_last-p.supExPFC_midExPFC_iAMPActx_EAMPA)))))+((((-p.supExPFC_midIPVxPFC_iGABActx_gGABAa.*(supExPFC_midIPVxPFC_iGABActx_s_last*p.supExPFC_midIPVxPFC_iGABActx_netcon).*(supExPFC_V_last-p.supExPFC_midIPVxPFC_iGABActx_EGABAa)))))))))) + p.supExPFC_noise*randn(1, p.supExPFC_Npop))/p.supExPFC_C;
  supExPFC_iNa_m_k1 = (((2.5-.1*(supExPFC_V_last+65))./(exp(2.5-.1*(supExPFC_V_last+65))-1))).*(1-supExPFC_iNa_m_last)-((4*exp(-(supExPFC_V_last+65)/18))).*supExPFC_iNa_m_last;
  supExPFC_iNa_h_k1 = ((.07*exp(-(supExPFC_V_last+65)/20))).*(1-supExPFC_iNa_h_last)-((1./(exp(3-.1*(supExPFC_V_last+65))+1))).*supExPFC_iNa_h_last;
  supExPFC_iK_n_k1 = (((.1-.01*(supExPFC_V_last+65))./(exp(1-.1*(supExPFC_V_last+65))-1))).*(1-supExPFC_iK_n_last)-((.125*exp(-(supExPFC_V_last+65)/80))).*supExPFC_iK_n_last;
  supISOMxPFC_V_k1 = (p.supISOMxPFC_Iapp + ((((-p.supISOMxPFC_iNa_gNa.*supISOMxPFC_iNa_m_last.^3.*supISOMxPFC_iNa_h_last.*(supISOMxPFC_V_last-p.supISOMxPFC_iNa_ENa))))+((((-p.supISOMxPFC_iK_gK.*supISOMxPFC_iK_n_last.^4.*(supISOMxPFC_V_last-p.supISOMxPFC_iK_EK))))+((-(((p.supISOMxPFC_supExPFC_iAMPActx_gAMPA.*(supISOMxPFC_supExPFC_iAMPActx_s_last*p.supISOMxPFC_supExPFC_iAMPActx_netcon).*(supISOMxPFC_V_last-p.supISOMxPFC_supExPFC_iAMPActx_EAMPA)))))+((((-p.supISOMxPFC_supExPFC_iNMDActx_gNMDA.*(((1.50265./(1+0.33*exp(supISOMxPFC_V_last./(-16)))))).*(supISOMxPFC_supExPFC_iNMDActx_s_last*p.supISOMxPFC_supExPFC_iNMDActx_netcon).*(supISOMxPFC_V_last-p.supISOMxPFC_supExPFC_iNMDActx_ENMDA))))+((((-p.supISOMxPFC_supIPVxPFC_iGABActx_gGABAa.*(supISOMxPFC_supIPVxPFC_iGABActx_s_last*p.supISOMxPFC_supIPVxPFC_iGABActx_netcon).*(supISOMxPFC_V_last-p.supISOMxPFC_supIPVxPFC_iGABActx_EGABAa))))+((-(((p.supISOMxPFC_midExPFC_iAMPActx_gAMPA.*(supISOMxPFC_midExPFC_iAMPActx_s_last*p.supISOMxPFC_midExPFC_iAMPActx_netcon).*(supISOMxPFC_V_last-p.supISOMxPFC_midExPFC_iAMPActx_EAMPA)))))+((-(((p.supISOMxPFC_deepExPFC_iAMPActx_gAMPA.*(supISOMxPFC_deepExPFC_iAMPActx_s_last*p.supISOMxPFC_deepExPFC_iAMPActx_netcon).*(supISOMxPFC_V_last-p.supISOMxPFC_deepExPFC_iAMPActx_EAMPA)))))))))))) + p.supISOMxPFC_noise*randn(1, p.supISOMxPFC_Npop))/p.supISOMxPFC_C;
  supISOMxPFC_iNa_m_k1 = (((2.5-.1*(supISOMxPFC_V_last+65))./(exp(2.5-.1*(supISOMxPFC_V_last+65))-1))).*(1-supISOMxPFC_iNa_m_last)-((4*exp(-(supISOMxPFC_V_last+65)/18))).*supISOMxPFC_iNa_m_last;
  supISOMxPFC_iNa_h_k1 = ((.07*exp(-(supISOMxPFC_V_last+65)/20))).*(1-supISOMxPFC_iNa_h_last)-((1./(exp(3-.1*(supISOMxPFC_V_last+65))+1))).*supISOMxPFC_iNa_h_last;
  supISOMxPFC_iK_n_k1 = (((.1-.01*(supISOMxPFC_V_last+65))./(exp(1-.1*(supISOMxPFC_V_last+65))-1))).*(1-supISOMxPFC_iK_n_last)-((.125*exp(-(supISOMxPFC_V_last+65)/80))).*supISOMxPFC_iK_n_last;
  supIPVxPFC_V_k1 = (p.supIPVxPFC_Iapp + ((((-p.supIPVxPFC_iNa_gNa.*supIPVxPFC_iNa_m_last.^3.*supIPVxPFC_iNa_h_last.*(supIPVxPFC_V_last-p.supIPVxPFC_iNa_ENa))))+((((-p.supIPVxPFC_iK_gK.*supIPVxPFC_iK_n_last.^4.*(supIPVxPFC_V_last-p.supIPVxPFC_iK_EK))))+((-(((p.supIPVxPFC_supExPFC_iAMPActx_gAMPA.*(supIPVxPFC_supExPFC_iAMPActx_s_last*p.supIPVxPFC_supExPFC_iAMPActx_netcon).*(supIPVxPFC_V_last-p.supIPVxPFC_supExPFC_iAMPActx_EAMPA)))))+((((-p.supIPVxPFC_supExPFC_iNMDActx_gNMDA.*(((1.50265./(1+0.33*exp(supIPVxPFC_V_last./(-16)))))).*(supIPVxPFC_supExPFC_iNMDActx_s_last*p.supIPVxPFC_supExPFC_iNMDActx_netcon).*(supIPVxPFC_V_last-p.supIPVxPFC_supExPFC_iNMDActx_ENMDA))))+((((-p.supIPVxPFC_supISOMxPFC_iGABActx_gGABAa.*(supIPVxPFC_supISOMxPFC_iGABActx_s_last*p.supIPVxPFC_supISOMxPFC_iGABActx_netcon).*(supIPVxPFC_V_last-p.supIPVxPFC_supISOMxPFC_iGABActx_EGABAa))))+((-(((p.supIPVxPFC_deepExPFC_iAMPActx_gAMPA.*(supIPVxPFC_deepExPFC_iAMPActx_s_last*p.supIPVxPFC_deepExPFC_iAMPActx_netcon).*(supIPVxPFC_V_last-p.supIPVxPFC_deepExPFC_iAMPActx_EAMPA))))))))))) + p.supIPVxPFC_noise*randn(1, p.supIPVxPFC_Npop))/p.supIPVxPFC_C;
  supIPVxPFC_iNa_m_k1 = (((2.5-.1*(supIPVxPFC_V_last+65))./(exp(2.5-.1*(supIPVxPFC_V_last+65))-1))).*(1-supIPVxPFC_iNa_m_last)-((4*exp(-(supIPVxPFC_V_last+65)/18))).*supIPVxPFC_iNa_m_last;
  supIPVxPFC_iNa_h_k1 = ((.07*exp(-(supIPVxPFC_V_last+65)/20))).*(1-supIPVxPFC_iNa_h_last)-((1./(exp(3-.1*(supIPVxPFC_V_last+65))+1))).*supIPVxPFC_iNa_h_last;
  supIPVxPFC_iK_n_k1 = (((.1-.01*(supIPVxPFC_V_last+65))./(exp(1-.1*(supIPVxPFC_V_last+65))-1))).*(1-supIPVxPFC_iK_n_last)-((.125*exp(-(supIPVxPFC_V_last+65)/80))).*supIPVxPFC_iK_n_last;
  midExPFC_V_k1 = (p.midExPFC_Iapp + ((((-p.midExPFC_iNa_gNa.*midExPFC_iNa_m_last.^3.*midExPFC_iNa_h_last.*(midExPFC_V_last-p.midExPFC_iNa_ENa))))+((((-p.midExPFC_iK_gK.*midExPFC_iK_n_last.^4.*(midExPFC_V_last-p.midExPFC_iK_EK))))+((((-p.midExPFC_midIPVxPFC_iGABActx_gGABAa.*(midExPFC_midIPVxPFC_iGABActx_s_last*p.midExPFC_midIPVxPFC_iGABActx_netcon).*(midExPFC_V_last-p.midExPFC_midIPVxPFC_iGABActx_EGABAa))))+((-(((p.midExPFC_PreStimuliAxPFC_iAMPActx_gAMPA.*(midExPFC_PreStimuliAxPFC_iAMPActx_s_last*p.midExPFC_PreStimuliAxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_PreStimuliAxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_PostStimuliAxPFC_iAMPActx_gAMPA.*(midExPFC_PostStimuliAxPFC_iAMPActx_s_last*p.midExPFC_PostStimuliAxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_PostStimuliAxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_PreStimuliBxPFC_iAMPActx_gAMPA.*(midExPFC_PreStimuliBxPFC_iAMPActx_s_last*p.midExPFC_PreStimuliBxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_PreStimuliBxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_PostStimuliBxPFC_iAMPActx_gAMPA.*(midExPFC_PostStimuliBxPFC_iAMPActx_s_last*p.midExPFC_PostStimuliBxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_PostStimuliBxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_PreStimuliCxPFC_iAMPActx_gAMPA.*(midExPFC_PreStimuliCxPFC_iAMPActx_s_last*p.midExPFC_PreStimuliCxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_PreStimuliCxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_PostStimuliCxPFC_iAMPActx_gAMPA.*(midExPFC_PostStimuliCxPFC_iAMPActx_s_last*p.midExPFC_PostStimuliCxPFC_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_PostStimuliCxPFC_iAMPActx_EAMPA)))))+((-(((p.midExPFC_supExV4_iAMPActx_gAMPA.*(midExPFC_supExV4_iAMPActx_s_last*p.midExPFC_supExV4_iAMPActx_netcon).*(midExPFC_V_last-p.midExPFC_supExV4_iAMPActx_EAMPA))))))))))))))) + p.midExPFC_noise*randn(1, p.midExPFC_Npop))/p.midExPFC_C;
  midExPFC_iNa_m_k1 = (((2.5-.1*(midExPFC_V_last+65))./(exp(2.5-.1*(midExPFC_V_last+65))-1))).*(1-midExPFC_iNa_m_last)-((4*exp(-(midExPFC_V_last+65)/18))).*midExPFC_iNa_m_last;
  midExPFC_iNa_h_k1 = ((.07*exp(-(midExPFC_V_last+65)/20))).*(1-midExPFC_iNa_h_last)-((1./(exp(3-.1*(midExPFC_V_last+65))+1))).*midExPFC_iNa_h_last;
  midExPFC_iK_n_k1 = (((.1-.01*(midExPFC_V_last+65))./(exp(1-.1*(midExPFC_V_last+65))-1))).*(1-midExPFC_iK_n_last)-((.125*exp(-(midExPFC_V_last+65)/80))).*midExPFC_iK_n_last;
  midIPVxPFC_V_k1 = (p.midIPVxPFC_Iapp + ((((-p.midIPVxPFC_iNa_gNa.*midIPVxPFC_iNa_m_last.^3.*midIPVxPFC_iNa_h_last.*(midIPVxPFC_V_last-p.midIPVxPFC_iNa_ENa))))+((((-p.midIPVxPFC_iK_gK.*midIPVxPFC_iK_n_last.^4.*(midIPVxPFC_V_last-p.midIPVxPFC_iK_EK))))+((-(((p.midIPVxPFC_midExPFC_iAMPActx_gAMPA.*(midIPVxPFC_midExPFC_iAMPActx_s_last*p.midIPVxPFC_midExPFC_iAMPActx_netcon).*(midIPVxPFC_V_last-p.midIPVxPFC_midExPFC_iAMPActx_EAMPA)))))+((((-p.midIPVxPFC_deepISOMxPFC_iGABActx_gGABAa.*(midIPVxPFC_deepISOMxPFC_iGABActx_s_last*p.midIPVxPFC_deepISOMxPFC_iGABActx_netcon).*(midIPVxPFC_V_last-p.midIPVxPFC_deepISOMxPFC_iGABActx_EGABAa))))+((-(((p.midIPVxPFC_supExV4_iAMPActx_gAMPA.*(midIPVxPFC_supExV4_iAMPActx_s_last*p.midIPVxPFC_supExV4_iAMPActx_netcon).*(midIPVxPFC_V_last-p.midIPVxPFC_supExV4_iAMPActx_EAMPA)))))))))) + p.midIPVxPFC_noise*randn(1, p.midIPVxPFC_Npop))/p.midIPVxPFC_C;
  midIPVxPFC_iNa_m_k1 = (((2.5-.1*(midIPVxPFC_V_last+65))./(exp(2.5-.1*(midIPVxPFC_V_last+65))-1))).*(1-midIPVxPFC_iNa_m_last)-((4*exp(-(midIPVxPFC_V_last+65)/18))).*midIPVxPFC_iNa_m_last;
  midIPVxPFC_iNa_h_k1 = ((.07*exp(-(midIPVxPFC_V_last+65)/20))).*(1-midIPVxPFC_iNa_h_last)-((1./(exp(3-.1*(midIPVxPFC_V_last+65))+1))).*midIPVxPFC_iNa_h_last;
  midIPVxPFC_iK_n_k1 = (((.1-.01*(midIPVxPFC_V_last+65))./(exp(1-.1*(midIPVxPFC_V_last+65))-1))).*(1-midIPVxPFC_iK_n_last)-((.125*exp(-(midIPVxPFC_V_last+65)/80))).*midIPVxPFC_iK_n_last;
  deepExPFC_V_k1 = (p.deepExPFC_Iapp + ((((-p.deepExPFC_iNa_gNa.*deepExPFC_iNa_m_last.^3.*deepExPFC_iNa_h_last.*(deepExPFC_V_last-p.deepExPFC_iNa_ENa))))+((((-p.deepExPFC_iK_gK.*deepExPFC_iK_n_last.^4.*(deepExPFC_V_last-p.deepExPFC_iK_EK))))+((((-p.deepExPFC_deepISOMxPFC_iGABActx_gGABAa.*(deepExPFC_deepISOMxPFC_iGABActx_s_last*p.deepExPFC_deepISOMxPFC_iGABActx_netcon).*(deepExPFC_V_last-p.deepExPFC_deepISOMxPFC_iGABActx_EGABAa))))+((((-p.deepExPFC_deepIPVxPFC_iGABActx_gGABAa.*(deepExPFC_deepIPVxPFC_iGABActx_s_last*p.deepExPFC_deepIPVxPFC_iGABActx_netcon).*(deepExPFC_V_last-p.deepExPFC_deepIPVxPFC_iGABActx_EGABAa))))+((-(((p.deepExPFC_supExPFC_iAMPActx_gAMPA.*(deepExPFC_supExPFC_iAMPActx_s_last*p.deepExPFC_supExPFC_iAMPActx_netcon).*(deepExPFC_V_last-p.deepExPFC_supExPFC_iAMPActx_EAMPA)))))+((-(((p.deepExPFC_midExPFC_iAMPActx_gAMPA.*(deepExPFC_midExPFC_iAMPActx_s_last*p.deepExPFC_midExPFC_iAMPActx_netcon).*(deepExPFC_V_last-p.deepExPFC_midExPFC_iAMPActx_EAMPA))))))))))) + p.deepExPFC_noise*randn(1, p.deepExPFC_Npop))/p.deepExPFC_C;
  deepExPFC_iNa_m_k1 = (((2.5-.1*(deepExPFC_V_last+65))./(exp(2.5-.1*(deepExPFC_V_last+65))-1))).*(1-deepExPFC_iNa_m_last)-((4*exp(-(deepExPFC_V_last+65)/18))).*deepExPFC_iNa_m_last;
  deepExPFC_iNa_h_k1 = ((.07*exp(-(deepExPFC_V_last+65)/20))).*(1-deepExPFC_iNa_h_last)-((1./(exp(3-.1*(deepExPFC_V_last+65))+1))).*deepExPFC_iNa_h_last;
  deepExPFC_iK_n_k1 = (((.1-.01*(deepExPFC_V_last+65))./(exp(1-.1*(deepExPFC_V_last+65))-1))).*(1-deepExPFC_iK_n_last)-((.125*exp(-(deepExPFC_V_last+65)/80))).*deepExPFC_iK_n_last;
  deepISOMxPFC_V_k1 = (p.deepISOMxPFC_Iapp + ((((-p.deepISOMxPFC_iNa_gNa.*deepISOMxPFC_iNa_m_last.^3.*deepISOMxPFC_iNa_h_last.*(deepISOMxPFC_V_last-p.deepISOMxPFC_iNa_ENa))))+((((-p.deepISOMxPFC_iK_gK.*deepISOMxPFC_iK_n_last.^4.*(deepISOMxPFC_V_last-p.deepISOMxPFC_iK_EK))))+((-(((p.deepISOMxPFC_deepExPFC_iAMPActx_gAMPA.*(deepISOMxPFC_deepExPFC_iAMPActx_s_last*p.deepISOMxPFC_deepExPFC_iAMPActx_netcon).*(deepISOMxPFC_V_last-p.deepISOMxPFC_deepExPFC_iAMPActx_EAMPA)))))+((((-p.deepISOMxPFC_deepIPVxPFC_iGABActx_gGABAa.*(deepISOMxPFC_deepIPVxPFC_iGABActx_s_last*p.deepISOMxPFC_deepIPVxPFC_iGABActx_netcon).*(deepISOMxPFC_V_last-p.deepISOMxPFC_deepIPVxPFC_iGABActx_EGABAa)))))))) + p.deepISOMxPFC_noise*randn(1, p.deepISOMxPFC_Npop))/p.deepISOMxPFC_C;
  deepISOMxPFC_iNa_m_k1 = (((2.5-.1*(deepISOMxPFC_V_last+65))./(exp(2.5-.1*(deepISOMxPFC_V_last+65))-1))).*(1-deepISOMxPFC_iNa_m_last)-((4*exp(-(deepISOMxPFC_V_last+65)/18))).*deepISOMxPFC_iNa_m_last;
  deepISOMxPFC_iNa_h_k1 = ((.07*exp(-(deepISOMxPFC_V_last+65)/20))).*(1-deepISOMxPFC_iNa_h_last)-((1./(exp(3-.1*(deepISOMxPFC_V_last+65))+1))).*deepISOMxPFC_iNa_h_last;
  deepISOMxPFC_iK_n_k1 = (((.1-.01*(deepISOMxPFC_V_last+65))./(exp(1-.1*(deepISOMxPFC_V_last+65))-1))).*(1-deepISOMxPFC_iK_n_last)-((.125*exp(-(deepISOMxPFC_V_last+65)/80))).*deepISOMxPFC_iK_n_last;
  deepIPVxPFC_V_k1 = (p.deepIPVxPFC_Iapp + ((((-p.deepIPVxPFC_iNa_gNa.*deepIPVxPFC_iNa_m_last.^3.*deepIPVxPFC_iNa_h_last.*(deepIPVxPFC_V_last-p.deepIPVxPFC_iNa_ENa))))+((((-p.deepIPVxPFC_iK_gK.*deepIPVxPFC_iK_n_last.^4.*(deepIPVxPFC_V_last-p.deepIPVxPFC_iK_EK))))+((-(((p.deepIPVxPFC_deepExPFC_iAMPActx_gAMPA.*(deepIPVxPFC_deepExPFC_iAMPActx_s_last*p.deepIPVxPFC_deepExPFC_iAMPActx_netcon).*(deepIPVxPFC_V_last-p.deepIPVxPFC_deepExPFC_iAMPActx_EAMPA)))))+((((-p.deepIPVxPFC_deepISOMxPFC_iGABActx_gGABAa.*(deepIPVxPFC_deepISOMxPFC_iGABActx_s_last*p.deepIPVxPFC_deepISOMxPFC_iGABActx_netcon).*(deepIPVxPFC_V_last-p.deepIPVxPFC_deepISOMxPFC_iGABActx_EGABAa))))+((-(((p.deepIPVxPFC_midExPFC_iAMPActx_gAMPA.*(deepIPVxPFC_midExPFC_iAMPActx_s_last*p.deepIPVxPFC_midExPFC_iAMPActx_netcon).*(deepIPVxPFC_V_last-p.deepIPVxPFC_midExPFC_iAMPActx_EAMPA)))))))))) + p.deepIPVxPFC_noise*randn(1, p.deepIPVxPFC_Npop))/p.deepIPVxPFC_C;
  deepIPVxPFC_iNa_m_k1 = (((2.5-.1*(deepIPVxPFC_V_last+65))./(exp(2.5-.1*(deepIPVxPFC_V_last+65))-1))).*(1-deepIPVxPFC_iNa_m_last)-((4*exp(-(deepIPVxPFC_V_last+65)/18))).*deepIPVxPFC_iNa_m_last;
  deepIPVxPFC_iNa_h_k1 = ((.07*exp(-(deepIPVxPFC_V_last+65)/20))).*(1-deepIPVxPFC_iNa_h_last)-((1./(exp(3-.1*(deepIPVxPFC_V_last+65))+1))).*deepIPVxPFC_iNa_h_last;
  deepIPVxPFC_iK_n_k1 = (((.1-.01*(deepIPVxPFC_V_last+65))./(exp(1-.1*(deepIPVxPFC_V_last+65))-1))).*(1-deepIPVxPFC_iK_n_last)-((.125*exp(-(deepIPVxPFC_V_last+65)/80))).*deepIPVxPFC_iK_n_last;
  PreStimuliAxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PreStimuliAxPFC_t1).^2) - exp(- (t - p.PreStimuliAxPFC_t2).^2)) + p.PreStimuliAxPFC_noise*randn(1, p.PreStimuliAxPFC_Npop))/p.PreStimuliAxPFC_C;
  PreStimuliAxPFC_iNa_m_k1 = (((2.5-.1*(PreStimuliAxPFC_V_last+65))./(exp(2.5-.1*(PreStimuliAxPFC_V_last+65))-1))).*(1-PreStimuliAxPFC_iNa_m_last)-((4*exp(-(PreStimuliAxPFC_V_last+65)/18))).*PreStimuliAxPFC_iNa_m_last;
  PreStimuliAxPFC_iNa_h_k1 = ((.07*exp(-(PreStimuliAxPFC_V_last+65)/20))).*(1-PreStimuliAxPFC_iNa_h_last)-((1./(exp(3-.1*(PreStimuliAxPFC_V_last+65))+1))).*PreStimuliAxPFC_iNa_h_last;
  PreStimuliAxPFC_iK_n_k1 = (((.1-.01*(PreStimuliAxPFC_V_last+65))./(exp(1-.1*(PreStimuliAxPFC_V_last+65))-1))).*(1-PreStimuliAxPFC_iK_n_last)-((.125*exp(-(PreStimuliAxPFC_V_last+65)/80))).*PreStimuliAxPFC_iK_n_last;
  PostStimuliAxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PostStimuliAxPFC_t1).^2) - exp(- (t - p.PostStimuliAxPFC_t2).^2)) + p.PostStimuliAxPFC_noise*randn(1, p.PostStimuliAxPFC_Npop))/p.PostStimuliAxPFC_C;
  PostStimuliAxPFC_iNa_m_k1 = (((2.5-.1*(PostStimuliAxPFC_V_last+65))./(exp(2.5-.1*(PostStimuliAxPFC_V_last+65))-1))).*(1-PostStimuliAxPFC_iNa_m_last)-((4*exp(-(PostStimuliAxPFC_V_last+65)/18))).*PostStimuliAxPFC_iNa_m_last;
  PostStimuliAxPFC_iNa_h_k1 = ((.07*exp(-(PostStimuliAxPFC_V_last+65)/20))).*(1-PostStimuliAxPFC_iNa_h_last)-((1./(exp(3-.1*(PostStimuliAxPFC_V_last+65))+1))).*PostStimuliAxPFC_iNa_h_last;
  PostStimuliAxPFC_iK_n_k1 = (((.1-.01*(PostStimuliAxPFC_V_last+65))./(exp(1-.1*(PostStimuliAxPFC_V_last+65))-1))).*(1-PostStimuliAxPFC_iK_n_last)-((.125*exp(-(PostStimuliAxPFC_V_last+65)/80))).*PostStimuliAxPFC_iK_n_last;
  PreStimuliBxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PreStimuliBxPFC_t1).^2) - exp(- (t - p.PreStimuliBxPFC_t2).^2)) + p.PreStimuliBxPFC_noise*randn(1, p.PreStimuliBxPFC_Npop))/p.PreStimuliBxPFC_C;
  PreStimuliBxPFC_iNa_m_k1 = (((2.5-.1*(PreStimuliBxPFC_V_last+65))./(exp(2.5-.1*(PreStimuliBxPFC_V_last+65))-1))).*(1-PreStimuliBxPFC_iNa_m_last)-((4*exp(-(PreStimuliBxPFC_V_last+65)/18))).*PreStimuliBxPFC_iNa_m_last;
  PreStimuliBxPFC_iNa_h_k1 = ((.07*exp(-(PreStimuliBxPFC_V_last+65)/20))).*(1-PreStimuliBxPFC_iNa_h_last)-((1./(exp(3-.1*(PreStimuliBxPFC_V_last+65))+1))).*PreStimuliBxPFC_iNa_h_last;
  PreStimuliBxPFC_iK_n_k1 = (((.1-.01*(PreStimuliBxPFC_V_last+65))./(exp(1-.1*(PreStimuliBxPFC_V_last+65))-1))).*(1-PreStimuliBxPFC_iK_n_last)-((.125*exp(-(PreStimuliBxPFC_V_last+65)/80))).*PreStimuliBxPFC_iK_n_last;
  PostStimuliBxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PostStimuliBxPFC_t1).^2) - exp(- (t - p.PostStimuliBxPFC_t2).^2)) + p.PostStimuliBxPFC_noise*randn(1, p.PostStimuliBxPFC_Npop))/p.PostStimuliBxPFC_C;
  PostStimuliBxPFC_iNa_m_k1 = (((2.5-.1*(PostStimuliBxPFC_V_last+65))./(exp(2.5-.1*(PostStimuliBxPFC_V_last+65))-1))).*(1-PostStimuliBxPFC_iNa_m_last)-((4*exp(-(PostStimuliBxPFC_V_last+65)/18))).*PostStimuliBxPFC_iNa_m_last;
  PostStimuliBxPFC_iNa_h_k1 = ((.07*exp(-(PostStimuliBxPFC_V_last+65)/20))).*(1-PostStimuliBxPFC_iNa_h_last)-((1./(exp(3-.1*(PostStimuliBxPFC_V_last+65))+1))).*PostStimuliBxPFC_iNa_h_last;
  PostStimuliBxPFC_iK_n_k1 = (((.1-.01*(PostStimuliBxPFC_V_last+65))./(exp(1-.1*(PostStimuliBxPFC_V_last+65))-1))).*(1-PostStimuliBxPFC_iK_n_last)-((.125*exp(-(PostStimuliBxPFC_V_last+65)/80))).*PostStimuliBxPFC_iK_n_last;
  PreStimuliCxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PreStimuliCxPFC_t1).^2) - exp(- (t - p.PreStimuliCxPFC_t2).^2)) + p.PreStimuliCxPFC_noise*randn(1, p.PreStimuliCxPFC_Npop))/p.PreStimuliCxPFC_C;
  PreStimuliCxPFC_iNa_m_k1 = (((2.5-.1*(PreStimuliCxPFC_V_last+65))./(exp(2.5-.1*(PreStimuliCxPFC_V_last+65))-1))).*(1-PreStimuliCxPFC_iNa_m_last)-((4*exp(-(PreStimuliCxPFC_V_last+65)/18))).*PreStimuliCxPFC_iNa_m_last;
  PreStimuliCxPFC_iNa_h_k1 = ((.07*exp(-(PreStimuliCxPFC_V_last+65)/20))).*(1-PreStimuliCxPFC_iNa_h_last)-((1./(exp(3-.1*(PreStimuliCxPFC_V_last+65))+1))).*PreStimuliCxPFC_iNa_h_last;
  PreStimuliCxPFC_iK_n_k1 = (((.1-.01*(PreStimuliCxPFC_V_last+65))./(exp(1-.1*(PreStimuliCxPFC_V_last+65))-1))).*(1-PreStimuliCxPFC_iK_n_last)-((.125*exp(-(PreStimuliCxPFC_V_last+65)/80))).*PreStimuliCxPFC_iK_n_last;
  PostStimuliCxPFC_V_k1 = (rand(1) + 4.5)*(20*(exp(- (t - p.PostStimuliCxPFC_t1).^2) - exp(- (t - p.PostStimuliCxPFC_t2).^2)) + p.PostStimuliCxPFC_noise*randn(1, p.PostStimuliCxPFC_Npop))/p.PostStimuliCxPFC_C;
  PostStimuliCxPFC_iNa_m_k1 = (((2.5-.1*(PostStimuliCxPFC_V_last+65))./(exp(2.5-.1*(PostStimuliCxPFC_V_last+65))-1))).*(1-PostStimuliCxPFC_iNa_m_last)-((4*exp(-(PostStimuliCxPFC_V_last+65)/18))).*PostStimuliCxPFC_iNa_m_last;
  PostStimuliCxPFC_iNa_h_k1 = ((.07*exp(-(PostStimuliCxPFC_V_last+65)/20))).*(1-PostStimuliCxPFC_iNa_h_last)-((1./(exp(3-.1*(PostStimuliCxPFC_V_last+65))+1))).*PostStimuliCxPFC_iNa_h_last;
  PostStimuliCxPFC_iK_n_k1 = (((.1-.01*(PostStimuliCxPFC_V_last+65))./(exp(1-.1*(PostStimuliCxPFC_V_last+65))-1))).*(1-PostStimuliCxPFC_iK_n_last)-((.125*exp(-(PostStimuliCxPFC_V_last+65)/80))).*PostStimuliCxPFC_iK_n_last;
  supISOMxV4_supExV4_iAMPActx_s_k1 = -supISOMxV4_supExV4_iAMPActx_s_last./p.supISOMxV4_supExV4_iAMPActx_tauAMPA + ((1-supISOMxV4_supExV4_iAMPActx_s_last)/p.supISOMxV4_supExV4_iAMPActx_tauAMPAr).*(1+tanh(supExV4_V_last/10));
  supIPVxV4_supExV4_iAMPActx_s_k1 = -supIPVxV4_supExV4_iAMPActx_s_last./p.supIPVxV4_supExV4_iAMPActx_tauAMPA + ((1-supIPVxV4_supExV4_iAMPActx_s_last)/p.supIPVxV4_supExV4_iAMPActx_tauAMPAr).*(1+tanh(supExV4_V_last/10));
  supISOMxV4_supExV4_iNMDActx_s_k1 = ((p.supISOMxV4_supExV4_iNMDActx_Tmax./(1+exp(-((supExV4_V_last)-p.supISOMxV4_supExV4_iNMDActx_Vpp)/p.supISOMxV4_supExV4_iNMDActx_Kp)))).*(1-supISOMxV4_supExV4_iNMDActx_s_last)/p.supISOMxV4_supExV4_iNMDActx_tauNMDAr-supISOMxV4_supExV4_iNMDActx_s_last/p.supISOMxV4_supExV4_iNMDActx_tauNMDA;
  supIPVxV4_supExV4_iNMDActx_s_k1 = ((p.supIPVxV4_supExV4_iNMDActx_Tmax./(1+exp(-((supExV4_V_last)-p.supIPVxV4_supExV4_iNMDActx_Vpp)/p.supIPVxV4_supExV4_iNMDActx_Kp)))).*(1-supIPVxV4_supExV4_iNMDActx_s_last)/p.supIPVxV4_supExV4_iNMDActx_tauNMDAr-supIPVxV4_supExV4_iNMDActx_s_last/p.supIPVxV4_supExV4_iNMDActx_tauNMDA;
  supExV4_supISOMxV4_iGABActx_s_k1 = -supExV4_supISOMxV4_iGABActx_s_last./p.supExV4_supISOMxV4_iGABActx_tauGABA + 1/2*(1+tanh(supISOMxV4_V_last/10)).*((1-supExV4_supISOMxV4_iGABActx_s_last)/p.supExV4_supISOMxV4_iGABActx_tauGABAr);
  supIPVxV4_supISOMxV4_iGABActx_s_k1 = -supIPVxV4_supISOMxV4_iGABActx_s_last./p.supIPVxV4_supISOMxV4_iGABActx_tauGABA + 1/2*(1+tanh(supISOMxV4_V_last/10)).*((1-supIPVxV4_supISOMxV4_iGABActx_s_last)/p.supIPVxV4_supISOMxV4_iGABActx_tauGABAr);
  supExV4_supIPVxV4_iGABActx_s_k1 = -supExV4_supIPVxV4_iGABActx_s_last./p.supExV4_supIPVxV4_iGABActx_tauGABA + 1/2*(1+tanh(supIPVxV4_V_last/10)).*((1-supExV4_supIPVxV4_iGABActx_s_last)/p.supExV4_supIPVxV4_iGABActx_tauGABAr);
  supISOMxV4_supIPVxV4_iGABActx_s_k1 = -supISOMxV4_supIPVxV4_iGABActx_s_last./p.supISOMxV4_supIPVxV4_iGABActx_tauGABA + 1/2*(1+tanh(supIPVxV4_V_last/10)).*((1-supISOMxV4_supIPVxV4_iGABActx_s_last)/p.supISOMxV4_supIPVxV4_iGABActx_tauGABAr);
  midIPVxV4_midExV4_iAMPActx_s_k1 = -midIPVxV4_midExV4_iAMPActx_s_last./p.midIPVxV4_midExV4_iAMPActx_tauAMPA + ((1-midIPVxV4_midExV4_iAMPActx_s_last)/p.midIPVxV4_midExV4_iAMPActx_tauAMPAr).*(1+tanh(midExV4_V_last/10));
  midExV4_midIPVxV4_iGABActx_s_k1 = -midExV4_midIPVxV4_iGABActx_s_last./p.midExV4_midIPVxV4_iGABActx_tauGABA + 1/2*(1+tanh(midIPVxV4_V_last/10)).*((1-midExV4_midIPVxV4_iGABActx_s_last)/p.midExV4_midIPVxV4_iGABActx_tauGABAr);
  deepISOMxV4_deepExV4_iAMPActx_s_k1 = -deepISOMxV4_deepExV4_iAMPActx_s_last./p.deepISOMxV4_deepExV4_iAMPActx_tauAMPA + ((1-deepISOMxV4_deepExV4_iAMPActx_s_last)/p.deepISOMxV4_deepExV4_iAMPActx_tauAMPAr).*(1+tanh(deepExV4_V_last/10));
  deepIPVxV4_deepExV4_iAMPActx_s_k1 = -deepIPVxV4_deepExV4_iAMPActx_s_last./p.deepIPVxV4_deepExV4_iAMPActx_tauAMPA + ((1-deepIPVxV4_deepExV4_iAMPActx_s_last)/p.deepIPVxV4_deepExV4_iAMPActx_tauAMPAr).*(1+tanh(deepExV4_V_last/10));
  deepExV4_deepISOMxV4_iGABActx_s_k1 = -deepExV4_deepISOMxV4_iGABActx_s_last./p.deepExV4_deepISOMxV4_iGABActx_tauGABA + 1/2*(1+tanh(deepISOMxV4_V_last/10)).*((1-deepExV4_deepISOMxV4_iGABActx_s_last)/p.deepExV4_deepISOMxV4_iGABActx_tauGABAr);
  deepIPVxV4_deepISOMxV4_iGABActx_s_k1 = -deepIPVxV4_deepISOMxV4_iGABActx_s_last./p.deepIPVxV4_deepISOMxV4_iGABActx_tauGABA + 1/2*(1+tanh(deepISOMxV4_V_last/10)).*((1-deepIPVxV4_deepISOMxV4_iGABActx_s_last)/p.deepIPVxV4_deepISOMxV4_iGABActx_tauGABAr);
  deepExV4_deepIPVxV4_iGABActx_s_k1 = -deepExV4_deepIPVxV4_iGABActx_s_last./p.deepExV4_deepIPVxV4_iGABActx_tauGABA + 1/2*(1+tanh(deepIPVxV4_V_last/10)).*((1-deepExV4_deepIPVxV4_iGABActx_s_last)/p.deepExV4_deepIPVxV4_iGABActx_tauGABAr);
  deepISOMxV4_deepIPVxV4_iGABActx_s_k1 = -deepISOMxV4_deepIPVxV4_iGABActx_s_last./p.deepISOMxV4_deepIPVxV4_iGABActx_tauGABA + 1/2*(1+tanh(deepIPVxV4_V_last/10)).*((1-deepISOMxV4_deepIPVxV4_iGABActx_s_last)/p.deepISOMxV4_deepIPVxV4_iGABActx_tauGABAr);
  PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_k1 = -PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last./p.PostStimuliAxV4_PreStimuliAxV4_iAMPActx_tauAMPA + ((1-PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last)/p.PostStimuliAxV4_PreStimuliAxV4_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliAxV4_V_last/10));
  PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_k1 = -PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last./p.PostStimuliBxV4_PreStimuliBxV4_iAMPActx_tauAMPA + ((1-PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last)/p.PostStimuliBxV4_PreStimuliBxV4_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliBxV4_V_last/10));
  PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_k1 = -PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last./p.PostStimuliCxV4_PreStimuliCxV4_iAMPActx_tauAMPA + ((1-PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last)/p.PostStimuliCxV4_PreStimuliCxV4_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliCxV4_V_last/10));
  midExV4_PreStimuliAxV4_iAMPActx_s_k1 = -midExV4_PreStimuliAxV4_iAMPActx_s_last./p.midExV4_PreStimuliAxV4_iAMPActx_tauAMPA + ((1-midExV4_PreStimuliAxV4_iAMPActx_s_last)/p.midExV4_PreStimuliAxV4_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliAxV4_V_last/10));
  midExV4_PostStimuliAxV4_iAMPActx_s_k1 = -midExV4_PostStimuliAxV4_iAMPActx_s_last./p.midExV4_PostStimuliAxV4_iAMPActx_tauAMPA + ((1-midExV4_PostStimuliAxV4_iAMPActx_s_last)/p.midExV4_PostStimuliAxV4_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliAxV4_V_last/10));
  midExV4_PreStimuliBxV4_iAMPActx_s_k1 = -midExV4_PreStimuliBxV4_iAMPActx_s_last./p.midExV4_PreStimuliBxV4_iAMPActx_tauAMPA + ((1-midExV4_PreStimuliBxV4_iAMPActx_s_last)/p.midExV4_PreStimuliBxV4_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliBxV4_V_last/10));
  midExV4_PostStimuliBxV4_iAMPActx_s_k1 = -midExV4_PostStimuliBxV4_iAMPActx_s_last./p.midExV4_PostStimuliBxV4_iAMPActx_tauAMPA + ((1-midExV4_PostStimuliBxV4_iAMPActx_s_last)/p.midExV4_PostStimuliBxV4_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliBxV4_V_last/10));
  midExV4_PreStimuliCxV4_iAMPActx_s_k1 = -midExV4_PreStimuliCxV4_iAMPActx_s_last./p.midExV4_PreStimuliCxV4_iAMPActx_tauAMPA + ((1-midExV4_PreStimuliCxV4_iAMPActx_s_last)/p.midExV4_PreStimuliCxV4_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliCxV4_V_last/10));
  midExV4_PostStimuliCxV4_iAMPActx_s_k1 = -midExV4_PostStimuliCxV4_iAMPActx_s_last./p.midExV4_PostStimuliCxV4_iAMPActx_tauAMPA + ((1-midExV4_PostStimuliCxV4_iAMPActx_s_last)/p.midExV4_PostStimuliCxV4_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliCxV4_V_last/10));
  deepExV4_supExV4_iAMPActx_s_k1 = -deepExV4_supExV4_iAMPActx_s_last./p.deepExV4_supExV4_iAMPActx_tauAMPA + ((1-deepExV4_supExV4_iAMPActx_s_last)/p.deepExV4_supExV4_iAMPActx_tauAMPAr).*(1+tanh(supExV4_V_last/10));
  supISOMxV4_midExV4_iAMPActx_s_k1 = -supISOMxV4_midExV4_iAMPActx_s_last./p.supISOMxV4_midExV4_iAMPActx_tauAMPA + ((1-supISOMxV4_midExV4_iAMPActx_s_last)/p.supISOMxV4_midExV4_iAMPActx_tauAMPAr).*(1+tanh(midExV4_V_last/10));
  supExV4_midExV4_iAMPActx_s_k1 = -supExV4_midExV4_iAMPActx_s_last./p.supExV4_midExV4_iAMPActx_tauAMPA + ((1-supExV4_midExV4_iAMPActx_s_last)/p.supExV4_midExV4_iAMPActx_tauAMPAr).*(1+tanh(midExV4_V_last/10));
  deepExV4_midExV4_iAMPActx_s_k1 = -deepExV4_midExV4_iAMPActx_s_last./p.deepExV4_midExV4_iAMPActx_tauAMPA + ((1-deepExV4_midExV4_iAMPActx_s_last)/p.deepExV4_midExV4_iAMPActx_tauAMPAr).*(1+tanh(midExV4_V_last/10));
  deepIPVxV4_midExV4_iAMPActx_s_k1 = -deepIPVxV4_midExV4_iAMPActx_s_last./p.deepIPVxV4_midExV4_iAMPActx_tauAMPA + ((1-deepIPVxV4_midExV4_iAMPActx_s_last)/p.deepIPVxV4_midExV4_iAMPActx_tauAMPAr).*(1+tanh(midExV4_V_last/10));
  supExV4_midIPVxV4_iGABActx_s_k1 = -supExV4_midIPVxV4_iGABActx_s_last./p.supExV4_midIPVxV4_iGABActx_tauGABA + 1/2*(1+tanh(midIPVxV4_V_last/10)).*((1-supExV4_midIPVxV4_iGABActx_s_last)/p.supExV4_midIPVxV4_iGABActx_tauGABAr);
  supISOMxV4_deepExV4_iAMPActx_s_k1 = -supISOMxV4_deepExV4_iAMPActx_s_last./p.supISOMxV4_deepExV4_iAMPActx_tauAMPA + ((1-supISOMxV4_deepExV4_iAMPActx_s_last)/p.supISOMxV4_deepExV4_iAMPActx_tauAMPAr).*(1+tanh(deepExV4_V_last/10));
  supIPVxV4_deepExV4_iAMPActx_s_k1 = -supIPVxV4_deepExV4_iAMPActx_s_last./p.supIPVxV4_deepExV4_iAMPActx_tauAMPA + ((1-supIPVxV4_deepExV4_iAMPActx_s_last)/p.supIPVxV4_deepExV4_iAMPActx_tauAMPAr).*(1+tanh(deepExV4_V_last/10));
  midIPVxV4_deepISOMxV4_iGABActx_s_k1 = -midIPVxV4_deepISOMxV4_iGABActx_s_last./p.midIPVxV4_deepISOMxV4_iGABActx_tauGABA + 1/2*(1+tanh(deepISOMxV4_V_last/10)).*((1-midIPVxV4_deepISOMxV4_iGABActx_s_last)/p.midIPVxV4_deepISOMxV4_iGABActx_tauGABAr);
  supISOMxPFC_supExPFC_iAMPActx_s_k1 = -supISOMxPFC_supExPFC_iAMPActx_s_last./p.supISOMxPFC_supExPFC_iAMPActx_tauAMPA + ((1-supISOMxPFC_supExPFC_iAMPActx_s_last)/p.supISOMxPFC_supExPFC_iAMPActx_tauAMPAr).*(1+tanh(supExPFC_V_last/10));
  supIPVxPFC_supExPFC_iAMPActx_s_k1 = -supIPVxPFC_supExPFC_iAMPActx_s_last./p.supIPVxPFC_supExPFC_iAMPActx_tauAMPA + ((1-supIPVxPFC_supExPFC_iAMPActx_s_last)/p.supIPVxPFC_supExPFC_iAMPActx_tauAMPAr).*(1+tanh(supExPFC_V_last/10));
  supISOMxPFC_supExPFC_iNMDActx_s_k1 = ((p.supISOMxPFC_supExPFC_iNMDActx_Tmax./(1+exp(-((supExPFC_V_last)-p.supISOMxPFC_supExPFC_iNMDActx_Vpp)/p.supISOMxPFC_supExPFC_iNMDActx_Kp)))).*(1-supISOMxPFC_supExPFC_iNMDActx_s_last)/p.supISOMxPFC_supExPFC_iNMDActx_tauNMDAr-supISOMxPFC_supExPFC_iNMDActx_s_last/p.supISOMxPFC_supExPFC_iNMDActx_tauNMDA;
  supIPVxPFC_supExPFC_iNMDActx_s_k1 = ((p.supIPVxPFC_supExPFC_iNMDActx_Tmax./(1+exp(-((supExPFC_V_last)-p.supIPVxPFC_supExPFC_iNMDActx_Vpp)/p.supIPVxPFC_supExPFC_iNMDActx_Kp)))).*(1-supIPVxPFC_supExPFC_iNMDActx_s_last)/p.supIPVxPFC_supExPFC_iNMDActx_tauNMDAr-supIPVxPFC_supExPFC_iNMDActx_s_last/p.supIPVxPFC_supExPFC_iNMDActx_tauNMDA;
  supExPFC_supISOMxPFC_iGABActx_s_k1 = -supExPFC_supISOMxPFC_iGABActx_s_last./p.supExPFC_supISOMxPFC_iGABActx_tauGABA + 1/2*(1+tanh(supISOMxPFC_V_last/10)).*((1-supExPFC_supISOMxPFC_iGABActx_s_last)/p.supExPFC_supISOMxPFC_iGABActx_tauGABAr);
  supIPVxPFC_supISOMxPFC_iGABActx_s_k1 = -supIPVxPFC_supISOMxPFC_iGABActx_s_last./p.supIPVxPFC_supISOMxPFC_iGABActx_tauGABA + 1/2*(1+tanh(supISOMxPFC_V_last/10)).*((1-supIPVxPFC_supISOMxPFC_iGABActx_s_last)/p.supIPVxPFC_supISOMxPFC_iGABActx_tauGABAr);
  supExPFC_supIPVxPFC_iGABActx_s_k1 = -supExPFC_supIPVxPFC_iGABActx_s_last./p.supExPFC_supIPVxPFC_iGABActx_tauGABA + 1/2*(1+tanh(supIPVxPFC_V_last/10)).*((1-supExPFC_supIPVxPFC_iGABActx_s_last)/p.supExPFC_supIPVxPFC_iGABActx_tauGABAr);
  supISOMxPFC_supIPVxPFC_iGABActx_s_k1 = -supISOMxPFC_supIPVxPFC_iGABActx_s_last./p.supISOMxPFC_supIPVxPFC_iGABActx_tauGABA + 1/2*(1+tanh(supIPVxPFC_V_last/10)).*((1-supISOMxPFC_supIPVxPFC_iGABActx_s_last)/p.supISOMxPFC_supIPVxPFC_iGABActx_tauGABAr);
  midIPVxPFC_midExPFC_iAMPActx_s_k1 = -midIPVxPFC_midExPFC_iAMPActx_s_last./p.midIPVxPFC_midExPFC_iAMPActx_tauAMPA + ((1-midIPVxPFC_midExPFC_iAMPActx_s_last)/p.midIPVxPFC_midExPFC_iAMPActx_tauAMPAr).*(1+tanh(midExPFC_V_last/10));
  midExPFC_midIPVxPFC_iGABActx_s_k1 = -midExPFC_midIPVxPFC_iGABActx_s_last./p.midExPFC_midIPVxPFC_iGABActx_tauGABA + 1/2*(1+tanh(midIPVxPFC_V_last/10)).*((1-midExPFC_midIPVxPFC_iGABActx_s_last)/p.midExPFC_midIPVxPFC_iGABActx_tauGABAr);
  deepISOMxPFC_deepExPFC_iAMPActx_s_k1 = -deepISOMxPFC_deepExPFC_iAMPActx_s_last./p.deepISOMxPFC_deepExPFC_iAMPActx_tauAMPA + ((1-deepISOMxPFC_deepExPFC_iAMPActx_s_last)/p.deepISOMxPFC_deepExPFC_iAMPActx_tauAMPAr).*(1+tanh(deepExPFC_V_last/10));
  deepIPVxPFC_deepExPFC_iAMPActx_s_k1 = -deepIPVxPFC_deepExPFC_iAMPActx_s_last./p.deepIPVxPFC_deepExPFC_iAMPActx_tauAMPA + ((1-deepIPVxPFC_deepExPFC_iAMPActx_s_last)/p.deepIPVxPFC_deepExPFC_iAMPActx_tauAMPAr).*(1+tanh(deepExPFC_V_last/10));
  deepExPFC_deepISOMxPFC_iGABActx_s_k1 = -deepExPFC_deepISOMxPFC_iGABActx_s_last./p.deepExPFC_deepISOMxPFC_iGABActx_tauGABA + 1/2*(1+tanh(deepISOMxPFC_V_last/10)).*((1-deepExPFC_deepISOMxPFC_iGABActx_s_last)/p.deepExPFC_deepISOMxPFC_iGABActx_tauGABAr);
  deepIPVxPFC_deepISOMxPFC_iGABActx_s_k1 = -deepIPVxPFC_deepISOMxPFC_iGABActx_s_last./p.deepIPVxPFC_deepISOMxPFC_iGABActx_tauGABA + 1/2*(1+tanh(deepISOMxPFC_V_last/10)).*((1-deepIPVxPFC_deepISOMxPFC_iGABActx_s_last)/p.deepIPVxPFC_deepISOMxPFC_iGABActx_tauGABAr);
  deepExPFC_deepIPVxPFC_iGABActx_s_k1 = -deepExPFC_deepIPVxPFC_iGABActx_s_last./p.deepExPFC_deepIPVxPFC_iGABActx_tauGABA + 1/2*(1+tanh(deepIPVxPFC_V_last/10)).*((1-deepExPFC_deepIPVxPFC_iGABActx_s_last)/p.deepExPFC_deepIPVxPFC_iGABActx_tauGABAr);
  deepISOMxPFC_deepIPVxPFC_iGABActx_s_k1 = -deepISOMxPFC_deepIPVxPFC_iGABActx_s_last./p.deepISOMxPFC_deepIPVxPFC_iGABActx_tauGABA + 1/2*(1+tanh(deepIPVxPFC_V_last/10)).*((1-deepISOMxPFC_deepIPVxPFC_iGABActx_s_last)/p.deepISOMxPFC_deepIPVxPFC_iGABActx_tauGABAr);
  PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_k1 = -PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last./p.PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_tauAMPA + ((1-PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last)/p.PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliAxPFC_V_last/10));
  PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_k1 = -PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last./p.PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_tauAMPA + ((1-PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last)/p.PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliBxPFC_V_last/10));
  PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_k1 = -PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last./p.PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_tauAMPA + ((1-PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last)/p.PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliCxPFC_V_last/10));
  midExPFC_PreStimuliAxPFC_iAMPActx_s_k1 = -midExPFC_PreStimuliAxPFC_iAMPActx_s_last./p.midExPFC_PreStimuliAxPFC_iAMPActx_tauAMPA + ((1-midExPFC_PreStimuliAxPFC_iAMPActx_s_last)/p.midExPFC_PreStimuliAxPFC_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliAxPFC_V_last/10));
  midExPFC_PostStimuliAxPFC_iAMPActx_s_k1 = -midExPFC_PostStimuliAxPFC_iAMPActx_s_last./p.midExPFC_PostStimuliAxPFC_iAMPActx_tauAMPA + ((1-midExPFC_PostStimuliAxPFC_iAMPActx_s_last)/p.midExPFC_PostStimuliAxPFC_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliAxPFC_V_last/10));
  midExPFC_PreStimuliBxPFC_iAMPActx_s_k1 = -midExPFC_PreStimuliBxPFC_iAMPActx_s_last./p.midExPFC_PreStimuliBxPFC_iAMPActx_tauAMPA + ((1-midExPFC_PreStimuliBxPFC_iAMPActx_s_last)/p.midExPFC_PreStimuliBxPFC_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliBxPFC_V_last/10));
  midExPFC_PostStimuliBxPFC_iAMPActx_s_k1 = -midExPFC_PostStimuliBxPFC_iAMPActx_s_last./p.midExPFC_PostStimuliBxPFC_iAMPActx_tauAMPA + ((1-midExPFC_PostStimuliBxPFC_iAMPActx_s_last)/p.midExPFC_PostStimuliBxPFC_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliBxPFC_V_last/10));
  midExPFC_PreStimuliCxPFC_iAMPActx_s_k1 = -midExPFC_PreStimuliCxPFC_iAMPActx_s_last./p.midExPFC_PreStimuliCxPFC_iAMPActx_tauAMPA + ((1-midExPFC_PreStimuliCxPFC_iAMPActx_s_last)/p.midExPFC_PreStimuliCxPFC_iAMPActx_tauAMPAr).*(1+tanh(PreStimuliCxPFC_V_last/10));
  midExPFC_PostStimuliCxPFC_iAMPActx_s_k1 = -midExPFC_PostStimuliCxPFC_iAMPActx_s_last./p.midExPFC_PostStimuliCxPFC_iAMPActx_tauAMPA + ((1-midExPFC_PostStimuliCxPFC_iAMPActx_s_last)/p.midExPFC_PostStimuliCxPFC_iAMPActx_tauAMPAr).*(1+tanh(PostStimuliCxPFC_V_last/10));
  deepExPFC_supExPFC_iAMPActx_s_k1 = -deepExPFC_supExPFC_iAMPActx_s_last./p.deepExPFC_supExPFC_iAMPActx_tauAMPA + ((1-deepExPFC_supExPFC_iAMPActx_s_last)/p.deepExPFC_supExPFC_iAMPActx_tauAMPAr).*(1+tanh(supExPFC_V_last/10));
  supISOMxPFC_midExPFC_iAMPActx_s_k1 = -supISOMxPFC_midExPFC_iAMPActx_s_last./p.supISOMxPFC_midExPFC_iAMPActx_tauAMPA + ((1-supISOMxPFC_midExPFC_iAMPActx_s_last)/p.supISOMxPFC_midExPFC_iAMPActx_tauAMPAr).*(1+tanh(midExPFC_V_last/10));
  supExPFC_midExPFC_iAMPActx_s_k1 = -supExPFC_midExPFC_iAMPActx_s_last./p.supExPFC_midExPFC_iAMPActx_tauAMPA + ((1-supExPFC_midExPFC_iAMPActx_s_last)/p.supExPFC_midExPFC_iAMPActx_tauAMPAr).*(1+tanh(midExPFC_V_last/10));
  deepExPFC_midExPFC_iAMPActx_s_k1 = -deepExPFC_midExPFC_iAMPActx_s_last./p.deepExPFC_midExPFC_iAMPActx_tauAMPA + ((1-deepExPFC_midExPFC_iAMPActx_s_last)/p.deepExPFC_midExPFC_iAMPActx_tauAMPAr).*(1+tanh(midExPFC_V_last/10));
  deepIPVxPFC_midExPFC_iAMPActx_s_k1 = -deepIPVxPFC_midExPFC_iAMPActx_s_last./p.deepIPVxPFC_midExPFC_iAMPActx_tauAMPA + ((1-deepIPVxPFC_midExPFC_iAMPActx_s_last)/p.deepIPVxPFC_midExPFC_iAMPActx_tauAMPAr).*(1+tanh(midExPFC_V_last/10));
  supExPFC_midIPVxPFC_iGABActx_s_k1 = -supExPFC_midIPVxPFC_iGABActx_s_last./p.supExPFC_midIPVxPFC_iGABActx_tauGABA + 1/2*(1+tanh(midIPVxPFC_V_last/10)).*((1-supExPFC_midIPVxPFC_iGABActx_s_last)/p.supExPFC_midIPVxPFC_iGABActx_tauGABAr);
  supISOMxPFC_deepExPFC_iAMPActx_s_k1 = -supISOMxPFC_deepExPFC_iAMPActx_s_last./p.supISOMxPFC_deepExPFC_iAMPActx_tauAMPA + ((1-supISOMxPFC_deepExPFC_iAMPActx_s_last)/p.supISOMxPFC_deepExPFC_iAMPActx_tauAMPAr).*(1+tanh(deepExPFC_V_last/10));
  supIPVxPFC_deepExPFC_iAMPActx_s_k1 = -supIPVxPFC_deepExPFC_iAMPActx_s_last./p.supIPVxPFC_deepExPFC_iAMPActx_tauAMPA + ((1-supIPVxPFC_deepExPFC_iAMPActx_s_last)/p.supIPVxPFC_deepExPFC_iAMPActx_tauAMPAr).*(1+tanh(deepExPFC_V_last/10));
  midIPVxPFC_deepISOMxPFC_iGABActx_s_k1 = -midIPVxPFC_deepISOMxPFC_iGABActx_s_last./p.midIPVxPFC_deepISOMxPFC_iGABActx_tauGABA + 1/2*(1+tanh(deepISOMxPFC_V_last/10)).*((1-midIPVxPFC_deepISOMxPFC_iGABActx_s_last)/p.midIPVxPFC_deepISOMxPFC_iGABActx_tauGABAr);
  midExPFC_supExV4_iAMPActx_s_k1 = -midExPFC_supExV4_iAMPActx_s_last./p.midExPFC_supExV4_iAMPActx_tauAMPA + ((1-midExPFC_supExV4_iAMPActx_s_last)/p.midExPFC_supExV4_iAMPActx_tauAMPAr).*(1+tanh(supExV4_V_last/10));
  midIPVxPFC_supExV4_iAMPActx_s_k1 = -midIPVxPFC_supExV4_iAMPActx_s_last./p.midIPVxPFC_supExV4_iAMPActx_tauAMPA + ((1-midIPVxPFC_supExV4_iAMPActx_s_last)/p.midIPVxPFC_supExV4_iAMPActx_tauAMPAr).*(1+tanh(supExV4_V_last/10));
  supISOMxV4_deepExPFC_iAMPActx_s_k1 = -supISOMxV4_deepExPFC_iAMPActx_s_last./p.supISOMxV4_deepExPFC_iAMPActx_tauAMPA + ((1-supISOMxV4_deepExPFC_iAMPActx_s_last)/p.supISOMxV4_deepExPFC_iAMPActx_tauAMPAr).*(1+tanh(deepExPFC_V_last/10));

  % ------------------------------------------------------------
  % Update state variables:
  % ------------------------------------------------------------
  supExV4_V_last = supExV4_V_last+dt*supExV4_V_k1;
  supExV4_iNa_m_last = supExV4_iNa_m_last+dt*supExV4_iNa_m_k1;
  supExV4_iNa_h_last = supExV4_iNa_h_last+dt*supExV4_iNa_h_k1;
  supExV4_iK_n_last = supExV4_iK_n_last+dt*supExV4_iK_n_k1;
  supISOMxV4_V_last = supISOMxV4_V_last+dt*supISOMxV4_V_k1;
  supISOMxV4_iNa_m_last = supISOMxV4_iNa_m_last+dt*supISOMxV4_iNa_m_k1;
  supISOMxV4_iNa_h_last = supISOMxV4_iNa_h_last+dt*supISOMxV4_iNa_h_k1;
  supISOMxV4_iK_n_last = supISOMxV4_iK_n_last+dt*supISOMxV4_iK_n_k1;
  supIPVxV4_V_last = supIPVxV4_V_last+dt*supIPVxV4_V_k1;
  supIPVxV4_iNa_m_last = supIPVxV4_iNa_m_last+dt*supIPVxV4_iNa_m_k1;
  supIPVxV4_iNa_h_last = supIPVxV4_iNa_h_last+dt*supIPVxV4_iNa_h_k1;
  supIPVxV4_iK_n_last = supIPVxV4_iK_n_last+dt*supIPVxV4_iK_n_k1;
  midExV4_V_last = midExV4_V_last+dt*midExV4_V_k1;
  midExV4_iNa_m_last = midExV4_iNa_m_last+dt*midExV4_iNa_m_k1;
  midExV4_iNa_h_last = midExV4_iNa_h_last+dt*midExV4_iNa_h_k1;
  midExV4_iK_n_last = midExV4_iK_n_last+dt*midExV4_iK_n_k1;
  midIPVxV4_V_last = midIPVxV4_V_last+dt*midIPVxV4_V_k1;
  midIPVxV4_iNa_m_last = midIPVxV4_iNa_m_last+dt*midIPVxV4_iNa_m_k1;
  midIPVxV4_iNa_h_last = midIPVxV4_iNa_h_last+dt*midIPVxV4_iNa_h_k1;
  midIPVxV4_iK_n_last = midIPVxV4_iK_n_last+dt*midIPVxV4_iK_n_k1;
  deepExV4_V_last = deepExV4_V_last+dt*deepExV4_V_k1;
  deepExV4_iNa_m_last = deepExV4_iNa_m_last+dt*deepExV4_iNa_m_k1;
  deepExV4_iNa_h_last = deepExV4_iNa_h_last+dt*deepExV4_iNa_h_k1;
  deepExV4_iK_n_last = deepExV4_iK_n_last+dt*deepExV4_iK_n_k1;
  deepISOMxV4_V_last = deepISOMxV4_V_last+dt*deepISOMxV4_V_k1;
  deepISOMxV4_iNa_m_last = deepISOMxV4_iNa_m_last+dt*deepISOMxV4_iNa_m_k1;
  deepISOMxV4_iNa_h_last = deepISOMxV4_iNa_h_last+dt*deepISOMxV4_iNa_h_k1;
  deepISOMxV4_iK_n_last = deepISOMxV4_iK_n_last+dt*deepISOMxV4_iK_n_k1;
  deepIPVxV4_V_last = deepIPVxV4_V_last+dt*deepIPVxV4_V_k1;
  deepIPVxV4_iNa_m_last = deepIPVxV4_iNa_m_last+dt*deepIPVxV4_iNa_m_k1;
  deepIPVxV4_iNa_h_last = deepIPVxV4_iNa_h_last+dt*deepIPVxV4_iNa_h_k1;
  deepIPVxV4_iK_n_last = deepIPVxV4_iK_n_last+dt*deepIPVxV4_iK_n_k1;
  PreStimuliAxV4_V_last = PreStimuliAxV4_V_last+dt*PreStimuliAxV4_V_k1;
  PreStimuliAxV4_iNa_m_last = PreStimuliAxV4_iNa_m_last+dt*PreStimuliAxV4_iNa_m_k1;
  PreStimuliAxV4_iNa_h_last = PreStimuliAxV4_iNa_h_last+dt*PreStimuliAxV4_iNa_h_k1;
  PreStimuliAxV4_iK_n_last = PreStimuliAxV4_iK_n_last+dt*PreStimuliAxV4_iK_n_k1;
  PostStimuliAxV4_V_last = PostStimuliAxV4_V_last+dt*PostStimuliAxV4_V_k1;
  PostStimuliAxV4_iNa_m_last = PostStimuliAxV4_iNa_m_last+dt*PostStimuliAxV4_iNa_m_k1;
  PostStimuliAxV4_iNa_h_last = PostStimuliAxV4_iNa_h_last+dt*PostStimuliAxV4_iNa_h_k1;
  PostStimuliAxV4_iK_n_last = PostStimuliAxV4_iK_n_last+dt*PostStimuliAxV4_iK_n_k1;
  PreStimuliBxV4_V_last = PreStimuliBxV4_V_last+dt*PreStimuliBxV4_V_k1;
  PreStimuliBxV4_iNa_m_last = PreStimuliBxV4_iNa_m_last+dt*PreStimuliBxV4_iNa_m_k1;
  PreStimuliBxV4_iNa_h_last = PreStimuliBxV4_iNa_h_last+dt*PreStimuliBxV4_iNa_h_k1;
  PreStimuliBxV4_iK_n_last = PreStimuliBxV4_iK_n_last+dt*PreStimuliBxV4_iK_n_k1;
  PostStimuliBxV4_V_last = PostStimuliBxV4_V_last+dt*PostStimuliBxV4_V_k1;
  PostStimuliBxV4_iNa_m_last = PostStimuliBxV4_iNa_m_last+dt*PostStimuliBxV4_iNa_m_k1;
  PostStimuliBxV4_iNa_h_last = PostStimuliBxV4_iNa_h_last+dt*PostStimuliBxV4_iNa_h_k1;
  PostStimuliBxV4_iK_n_last = PostStimuliBxV4_iK_n_last+dt*PostStimuliBxV4_iK_n_k1;
  PreStimuliCxV4_V_last = PreStimuliCxV4_V_last+dt*PreStimuliCxV4_V_k1;
  PreStimuliCxV4_iNa_m_last = PreStimuliCxV4_iNa_m_last+dt*PreStimuliCxV4_iNa_m_k1;
  PreStimuliCxV4_iNa_h_last = PreStimuliCxV4_iNa_h_last+dt*PreStimuliCxV4_iNa_h_k1;
  PreStimuliCxV4_iK_n_last = PreStimuliCxV4_iK_n_last+dt*PreStimuliCxV4_iK_n_k1;
  PostStimuliCxV4_V_last = PostStimuliCxV4_V_last+dt*PostStimuliCxV4_V_k1;
  PostStimuliCxV4_iNa_m_last = PostStimuliCxV4_iNa_m_last+dt*PostStimuliCxV4_iNa_m_k1;
  PostStimuliCxV4_iNa_h_last = PostStimuliCxV4_iNa_h_last+dt*PostStimuliCxV4_iNa_h_k1;
  PostStimuliCxV4_iK_n_last = PostStimuliCxV4_iK_n_last+dt*PostStimuliCxV4_iK_n_k1;
  supExPFC_V_last = supExPFC_V_last+dt*supExPFC_V_k1;
  supExPFC_iNa_m_last = supExPFC_iNa_m_last+dt*supExPFC_iNa_m_k1;
  supExPFC_iNa_h_last = supExPFC_iNa_h_last+dt*supExPFC_iNa_h_k1;
  supExPFC_iK_n_last = supExPFC_iK_n_last+dt*supExPFC_iK_n_k1;
  supISOMxPFC_V_last = supISOMxPFC_V_last+dt*supISOMxPFC_V_k1;
  supISOMxPFC_iNa_m_last = supISOMxPFC_iNa_m_last+dt*supISOMxPFC_iNa_m_k1;
  supISOMxPFC_iNa_h_last = supISOMxPFC_iNa_h_last+dt*supISOMxPFC_iNa_h_k1;
  supISOMxPFC_iK_n_last = supISOMxPFC_iK_n_last+dt*supISOMxPFC_iK_n_k1;
  supIPVxPFC_V_last = supIPVxPFC_V_last+dt*supIPVxPFC_V_k1;
  supIPVxPFC_iNa_m_last = supIPVxPFC_iNa_m_last+dt*supIPVxPFC_iNa_m_k1;
  supIPVxPFC_iNa_h_last = supIPVxPFC_iNa_h_last+dt*supIPVxPFC_iNa_h_k1;
  supIPVxPFC_iK_n_last = supIPVxPFC_iK_n_last+dt*supIPVxPFC_iK_n_k1;
  midExPFC_V_last = midExPFC_V_last+dt*midExPFC_V_k1;
  midExPFC_iNa_m_last = midExPFC_iNa_m_last+dt*midExPFC_iNa_m_k1;
  midExPFC_iNa_h_last = midExPFC_iNa_h_last+dt*midExPFC_iNa_h_k1;
  midExPFC_iK_n_last = midExPFC_iK_n_last+dt*midExPFC_iK_n_k1;
  midIPVxPFC_V_last = midIPVxPFC_V_last+dt*midIPVxPFC_V_k1;
  midIPVxPFC_iNa_m_last = midIPVxPFC_iNa_m_last+dt*midIPVxPFC_iNa_m_k1;
  midIPVxPFC_iNa_h_last = midIPVxPFC_iNa_h_last+dt*midIPVxPFC_iNa_h_k1;
  midIPVxPFC_iK_n_last = midIPVxPFC_iK_n_last+dt*midIPVxPFC_iK_n_k1;
  deepExPFC_V_last = deepExPFC_V_last+dt*deepExPFC_V_k1;
  deepExPFC_iNa_m_last = deepExPFC_iNa_m_last+dt*deepExPFC_iNa_m_k1;
  deepExPFC_iNa_h_last = deepExPFC_iNa_h_last+dt*deepExPFC_iNa_h_k1;
  deepExPFC_iK_n_last = deepExPFC_iK_n_last+dt*deepExPFC_iK_n_k1;
  deepISOMxPFC_V_last = deepISOMxPFC_V_last+dt*deepISOMxPFC_V_k1;
  deepISOMxPFC_iNa_m_last = deepISOMxPFC_iNa_m_last+dt*deepISOMxPFC_iNa_m_k1;
  deepISOMxPFC_iNa_h_last = deepISOMxPFC_iNa_h_last+dt*deepISOMxPFC_iNa_h_k1;
  deepISOMxPFC_iK_n_last = deepISOMxPFC_iK_n_last+dt*deepISOMxPFC_iK_n_k1;
  deepIPVxPFC_V_last = deepIPVxPFC_V_last+dt*deepIPVxPFC_V_k1;
  deepIPVxPFC_iNa_m_last = deepIPVxPFC_iNa_m_last+dt*deepIPVxPFC_iNa_m_k1;
  deepIPVxPFC_iNa_h_last = deepIPVxPFC_iNa_h_last+dt*deepIPVxPFC_iNa_h_k1;
  deepIPVxPFC_iK_n_last = deepIPVxPFC_iK_n_last+dt*deepIPVxPFC_iK_n_k1;
  PreStimuliAxPFC_V_last = PreStimuliAxPFC_V_last+dt*PreStimuliAxPFC_V_k1;
  PreStimuliAxPFC_iNa_m_last = PreStimuliAxPFC_iNa_m_last+dt*PreStimuliAxPFC_iNa_m_k1;
  PreStimuliAxPFC_iNa_h_last = PreStimuliAxPFC_iNa_h_last+dt*PreStimuliAxPFC_iNa_h_k1;
  PreStimuliAxPFC_iK_n_last = PreStimuliAxPFC_iK_n_last+dt*PreStimuliAxPFC_iK_n_k1;
  PostStimuliAxPFC_V_last = PostStimuliAxPFC_V_last+dt*PostStimuliAxPFC_V_k1;
  PostStimuliAxPFC_iNa_m_last = PostStimuliAxPFC_iNa_m_last+dt*PostStimuliAxPFC_iNa_m_k1;
  PostStimuliAxPFC_iNa_h_last = PostStimuliAxPFC_iNa_h_last+dt*PostStimuliAxPFC_iNa_h_k1;
  PostStimuliAxPFC_iK_n_last = PostStimuliAxPFC_iK_n_last+dt*PostStimuliAxPFC_iK_n_k1;
  PreStimuliBxPFC_V_last = PreStimuliBxPFC_V_last+dt*PreStimuliBxPFC_V_k1;
  PreStimuliBxPFC_iNa_m_last = PreStimuliBxPFC_iNa_m_last+dt*PreStimuliBxPFC_iNa_m_k1;
  PreStimuliBxPFC_iNa_h_last = PreStimuliBxPFC_iNa_h_last+dt*PreStimuliBxPFC_iNa_h_k1;
  PreStimuliBxPFC_iK_n_last = PreStimuliBxPFC_iK_n_last+dt*PreStimuliBxPFC_iK_n_k1;
  PostStimuliBxPFC_V_last = PostStimuliBxPFC_V_last+dt*PostStimuliBxPFC_V_k1;
  PostStimuliBxPFC_iNa_m_last = PostStimuliBxPFC_iNa_m_last+dt*PostStimuliBxPFC_iNa_m_k1;
  PostStimuliBxPFC_iNa_h_last = PostStimuliBxPFC_iNa_h_last+dt*PostStimuliBxPFC_iNa_h_k1;
  PostStimuliBxPFC_iK_n_last = PostStimuliBxPFC_iK_n_last+dt*PostStimuliBxPFC_iK_n_k1;
  PreStimuliCxPFC_V_last = PreStimuliCxPFC_V_last+dt*PreStimuliCxPFC_V_k1;
  PreStimuliCxPFC_iNa_m_last = PreStimuliCxPFC_iNa_m_last+dt*PreStimuliCxPFC_iNa_m_k1;
  PreStimuliCxPFC_iNa_h_last = PreStimuliCxPFC_iNa_h_last+dt*PreStimuliCxPFC_iNa_h_k1;
  PreStimuliCxPFC_iK_n_last = PreStimuliCxPFC_iK_n_last+dt*PreStimuliCxPFC_iK_n_k1;
  PostStimuliCxPFC_V_last = PostStimuliCxPFC_V_last+dt*PostStimuliCxPFC_V_k1;
  PostStimuliCxPFC_iNa_m_last = PostStimuliCxPFC_iNa_m_last+dt*PostStimuliCxPFC_iNa_m_k1;
  PostStimuliCxPFC_iNa_h_last = PostStimuliCxPFC_iNa_h_last+dt*PostStimuliCxPFC_iNa_h_k1;
  PostStimuliCxPFC_iK_n_last = PostStimuliCxPFC_iK_n_last+dt*PostStimuliCxPFC_iK_n_k1;
  supISOMxV4_supExV4_iAMPActx_s_last = supISOMxV4_supExV4_iAMPActx_s_last+dt*supISOMxV4_supExV4_iAMPActx_s_k1;
  supIPVxV4_supExV4_iAMPActx_s_last = supIPVxV4_supExV4_iAMPActx_s_last+dt*supIPVxV4_supExV4_iAMPActx_s_k1;
  supISOMxV4_supExV4_iNMDActx_s_last = supISOMxV4_supExV4_iNMDActx_s_last+dt*supISOMxV4_supExV4_iNMDActx_s_k1;
  supIPVxV4_supExV4_iNMDActx_s_last = supIPVxV4_supExV4_iNMDActx_s_last+dt*supIPVxV4_supExV4_iNMDActx_s_k1;
  supExV4_supISOMxV4_iGABActx_s_last = supExV4_supISOMxV4_iGABActx_s_last+dt*supExV4_supISOMxV4_iGABActx_s_k1;
  supIPVxV4_supISOMxV4_iGABActx_s_last = supIPVxV4_supISOMxV4_iGABActx_s_last+dt*supIPVxV4_supISOMxV4_iGABActx_s_k1;
  supExV4_supIPVxV4_iGABActx_s_last = supExV4_supIPVxV4_iGABActx_s_last+dt*supExV4_supIPVxV4_iGABActx_s_k1;
  supISOMxV4_supIPVxV4_iGABActx_s_last = supISOMxV4_supIPVxV4_iGABActx_s_last+dt*supISOMxV4_supIPVxV4_iGABActx_s_k1;
  midIPVxV4_midExV4_iAMPActx_s_last = midIPVxV4_midExV4_iAMPActx_s_last+dt*midIPVxV4_midExV4_iAMPActx_s_k1;
  midExV4_midIPVxV4_iGABActx_s_last = midExV4_midIPVxV4_iGABActx_s_last+dt*midExV4_midIPVxV4_iGABActx_s_k1;
  deepISOMxV4_deepExV4_iAMPActx_s_last = deepISOMxV4_deepExV4_iAMPActx_s_last+dt*deepISOMxV4_deepExV4_iAMPActx_s_k1;
  deepIPVxV4_deepExV4_iAMPActx_s_last = deepIPVxV4_deepExV4_iAMPActx_s_last+dt*deepIPVxV4_deepExV4_iAMPActx_s_k1;
  deepExV4_deepISOMxV4_iGABActx_s_last = deepExV4_deepISOMxV4_iGABActx_s_last+dt*deepExV4_deepISOMxV4_iGABActx_s_k1;
  deepIPVxV4_deepISOMxV4_iGABActx_s_last = deepIPVxV4_deepISOMxV4_iGABActx_s_last+dt*deepIPVxV4_deepISOMxV4_iGABActx_s_k1;
  deepExV4_deepIPVxV4_iGABActx_s_last = deepExV4_deepIPVxV4_iGABActx_s_last+dt*deepExV4_deepIPVxV4_iGABActx_s_k1;
  deepISOMxV4_deepIPVxV4_iGABActx_s_last = deepISOMxV4_deepIPVxV4_iGABActx_s_last+dt*deepISOMxV4_deepIPVxV4_iGABActx_s_k1;
  PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last = PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last+dt*PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_k1;
  PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last = PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last+dt*PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_k1;
  PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last = PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last+dt*PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_k1;
  midExV4_PreStimuliAxV4_iAMPActx_s_last = midExV4_PreStimuliAxV4_iAMPActx_s_last+dt*midExV4_PreStimuliAxV4_iAMPActx_s_k1;
  midExV4_PostStimuliAxV4_iAMPActx_s_last = midExV4_PostStimuliAxV4_iAMPActx_s_last+dt*midExV4_PostStimuliAxV4_iAMPActx_s_k1;
  midExV4_PreStimuliBxV4_iAMPActx_s_last = midExV4_PreStimuliBxV4_iAMPActx_s_last+dt*midExV4_PreStimuliBxV4_iAMPActx_s_k1;
  midExV4_PostStimuliBxV4_iAMPActx_s_last = midExV4_PostStimuliBxV4_iAMPActx_s_last+dt*midExV4_PostStimuliBxV4_iAMPActx_s_k1;
  midExV4_PreStimuliCxV4_iAMPActx_s_last = midExV4_PreStimuliCxV4_iAMPActx_s_last+dt*midExV4_PreStimuliCxV4_iAMPActx_s_k1;
  midExV4_PostStimuliCxV4_iAMPActx_s_last = midExV4_PostStimuliCxV4_iAMPActx_s_last+dt*midExV4_PostStimuliCxV4_iAMPActx_s_k1;
  deepExV4_supExV4_iAMPActx_s_last = deepExV4_supExV4_iAMPActx_s_last+dt*deepExV4_supExV4_iAMPActx_s_k1;
  supISOMxV4_midExV4_iAMPActx_s_last = supISOMxV4_midExV4_iAMPActx_s_last+dt*supISOMxV4_midExV4_iAMPActx_s_k1;
  supExV4_midExV4_iAMPActx_s_last = supExV4_midExV4_iAMPActx_s_last+dt*supExV4_midExV4_iAMPActx_s_k1;
  deepExV4_midExV4_iAMPActx_s_last = deepExV4_midExV4_iAMPActx_s_last+dt*deepExV4_midExV4_iAMPActx_s_k1;
  deepIPVxV4_midExV4_iAMPActx_s_last = deepIPVxV4_midExV4_iAMPActx_s_last+dt*deepIPVxV4_midExV4_iAMPActx_s_k1;
  supExV4_midIPVxV4_iGABActx_s_last = supExV4_midIPVxV4_iGABActx_s_last+dt*supExV4_midIPVxV4_iGABActx_s_k1;
  supISOMxV4_deepExV4_iAMPActx_s_last = supISOMxV4_deepExV4_iAMPActx_s_last+dt*supISOMxV4_deepExV4_iAMPActx_s_k1;
  supIPVxV4_deepExV4_iAMPActx_s_last = supIPVxV4_deepExV4_iAMPActx_s_last+dt*supIPVxV4_deepExV4_iAMPActx_s_k1;
  midIPVxV4_deepISOMxV4_iGABActx_s_last = midIPVxV4_deepISOMxV4_iGABActx_s_last+dt*midIPVxV4_deepISOMxV4_iGABActx_s_k1;
  supISOMxPFC_supExPFC_iAMPActx_s_last = supISOMxPFC_supExPFC_iAMPActx_s_last+dt*supISOMxPFC_supExPFC_iAMPActx_s_k1;
  supIPVxPFC_supExPFC_iAMPActx_s_last = supIPVxPFC_supExPFC_iAMPActx_s_last+dt*supIPVxPFC_supExPFC_iAMPActx_s_k1;
  supISOMxPFC_supExPFC_iNMDActx_s_last = supISOMxPFC_supExPFC_iNMDActx_s_last+dt*supISOMxPFC_supExPFC_iNMDActx_s_k1;
  supIPVxPFC_supExPFC_iNMDActx_s_last = supIPVxPFC_supExPFC_iNMDActx_s_last+dt*supIPVxPFC_supExPFC_iNMDActx_s_k1;
  supExPFC_supISOMxPFC_iGABActx_s_last = supExPFC_supISOMxPFC_iGABActx_s_last+dt*supExPFC_supISOMxPFC_iGABActx_s_k1;
  supIPVxPFC_supISOMxPFC_iGABActx_s_last = supIPVxPFC_supISOMxPFC_iGABActx_s_last+dt*supIPVxPFC_supISOMxPFC_iGABActx_s_k1;
  supExPFC_supIPVxPFC_iGABActx_s_last = supExPFC_supIPVxPFC_iGABActx_s_last+dt*supExPFC_supIPVxPFC_iGABActx_s_k1;
  supISOMxPFC_supIPVxPFC_iGABActx_s_last = supISOMxPFC_supIPVxPFC_iGABActx_s_last+dt*supISOMxPFC_supIPVxPFC_iGABActx_s_k1;
  midIPVxPFC_midExPFC_iAMPActx_s_last = midIPVxPFC_midExPFC_iAMPActx_s_last+dt*midIPVxPFC_midExPFC_iAMPActx_s_k1;
  midExPFC_midIPVxPFC_iGABActx_s_last = midExPFC_midIPVxPFC_iGABActx_s_last+dt*midExPFC_midIPVxPFC_iGABActx_s_k1;
  deepISOMxPFC_deepExPFC_iAMPActx_s_last = deepISOMxPFC_deepExPFC_iAMPActx_s_last+dt*deepISOMxPFC_deepExPFC_iAMPActx_s_k1;
  deepIPVxPFC_deepExPFC_iAMPActx_s_last = deepIPVxPFC_deepExPFC_iAMPActx_s_last+dt*deepIPVxPFC_deepExPFC_iAMPActx_s_k1;
  deepExPFC_deepISOMxPFC_iGABActx_s_last = deepExPFC_deepISOMxPFC_iGABActx_s_last+dt*deepExPFC_deepISOMxPFC_iGABActx_s_k1;
  deepIPVxPFC_deepISOMxPFC_iGABActx_s_last = deepIPVxPFC_deepISOMxPFC_iGABActx_s_last+dt*deepIPVxPFC_deepISOMxPFC_iGABActx_s_k1;
  deepExPFC_deepIPVxPFC_iGABActx_s_last = deepExPFC_deepIPVxPFC_iGABActx_s_last+dt*deepExPFC_deepIPVxPFC_iGABActx_s_k1;
  deepISOMxPFC_deepIPVxPFC_iGABActx_s_last = deepISOMxPFC_deepIPVxPFC_iGABActx_s_last+dt*deepISOMxPFC_deepIPVxPFC_iGABActx_s_k1;
  PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last = PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last+dt*PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_k1;
  PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last = PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last+dt*PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_k1;
  PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last = PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last+dt*PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_k1;
  midExPFC_PreStimuliAxPFC_iAMPActx_s_last = midExPFC_PreStimuliAxPFC_iAMPActx_s_last+dt*midExPFC_PreStimuliAxPFC_iAMPActx_s_k1;
  midExPFC_PostStimuliAxPFC_iAMPActx_s_last = midExPFC_PostStimuliAxPFC_iAMPActx_s_last+dt*midExPFC_PostStimuliAxPFC_iAMPActx_s_k1;
  midExPFC_PreStimuliBxPFC_iAMPActx_s_last = midExPFC_PreStimuliBxPFC_iAMPActx_s_last+dt*midExPFC_PreStimuliBxPFC_iAMPActx_s_k1;
  midExPFC_PostStimuliBxPFC_iAMPActx_s_last = midExPFC_PostStimuliBxPFC_iAMPActx_s_last+dt*midExPFC_PostStimuliBxPFC_iAMPActx_s_k1;
  midExPFC_PreStimuliCxPFC_iAMPActx_s_last = midExPFC_PreStimuliCxPFC_iAMPActx_s_last+dt*midExPFC_PreStimuliCxPFC_iAMPActx_s_k1;
  midExPFC_PostStimuliCxPFC_iAMPActx_s_last = midExPFC_PostStimuliCxPFC_iAMPActx_s_last+dt*midExPFC_PostStimuliCxPFC_iAMPActx_s_k1;
  deepExPFC_supExPFC_iAMPActx_s_last = deepExPFC_supExPFC_iAMPActx_s_last+dt*deepExPFC_supExPFC_iAMPActx_s_k1;
  supISOMxPFC_midExPFC_iAMPActx_s_last = supISOMxPFC_midExPFC_iAMPActx_s_last+dt*supISOMxPFC_midExPFC_iAMPActx_s_k1;
  supExPFC_midExPFC_iAMPActx_s_last = supExPFC_midExPFC_iAMPActx_s_last+dt*supExPFC_midExPFC_iAMPActx_s_k1;
  deepExPFC_midExPFC_iAMPActx_s_last = deepExPFC_midExPFC_iAMPActx_s_last+dt*deepExPFC_midExPFC_iAMPActx_s_k1;
  deepIPVxPFC_midExPFC_iAMPActx_s_last = deepIPVxPFC_midExPFC_iAMPActx_s_last+dt*deepIPVxPFC_midExPFC_iAMPActx_s_k1;
  supExPFC_midIPVxPFC_iGABActx_s_last = supExPFC_midIPVxPFC_iGABActx_s_last+dt*supExPFC_midIPVxPFC_iGABActx_s_k1;
  supISOMxPFC_deepExPFC_iAMPActx_s_last = supISOMxPFC_deepExPFC_iAMPActx_s_last+dt*supISOMxPFC_deepExPFC_iAMPActx_s_k1;
  supIPVxPFC_deepExPFC_iAMPActx_s_last = supIPVxPFC_deepExPFC_iAMPActx_s_last+dt*supIPVxPFC_deepExPFC_iAMPActx_s_k1;
  midIPVxPFC_deepISOMxPFC_iGABActx_s_last = midIPVxPFC_deepISOMxPFC_iGABActx_s_last+dt*midIPVxPFC_deepISOMxPFC_iGABActx_s_k1;
  midExPFC_supExV4_iAMPActx_s_last = midExPFC_supExV4_iAMPActx_s_last+dt*midExPFC_supExV4_iAMPActx_s_k1;
  midIPVxPFC_supExV4_iAMPActx_s_last = midIPVxPFC_supExV4_iAMPActx_s_last+dt*midIPVxPFC_supExV4_iAMPActx_s_k1;
  supISOMxV4_deepExPFC_iAMPActx_s_last = supISOMxV4_deepExPFC_iAMPActx_s_last+dt*supISOMxV4_deepExPFC_iAMPActx_s_k1;

  if mod(k,downsample_factor)==0 % store this time point

  % ------------------------------------------------------------
  % Store state variables:
  % ------------------------------------------------------------
    supExV4_V(n,:) = supExV4_V_last;
    supExV4_iNa_m(n,:) = supExV4_iNa_m_last;
    supExV4_iNa_h(n,:) = supExV4_iNa_h_last;
    supExV4_iK_n(n,:) = supExV4_iK_n_last;
    supISOMxV4_V(n,:) = supISOMxV4_V_last;
    supISOMxV4_iNa_m(n,:) = supISOMxV4_iNa_m_last;
    supISOMxV4_iNa_h(n,:) = supISOMxV4_iNa_h_last;
    supISOMxV4_iK_n(n,:) = supISOMxV4_iK_n_last;
    supIPVxV4_V(n,:) = supIPVxV4_V_last;
    supIPVxV4_iNa_m(n,:) = supIPVxV4_iNa_m_last;
    supIPVxV4_iNa_h(n,:) = supIPVxV4_iNa_h_last;
    supIPVxV4_iK_n(n,:) = supIPVxV4_iK_n_last;
    midExV4_V(n,:) = midExV4_V_last;
    midExV4_iNa_m(n,:) = midExV4_iNa_m_last;
    midExV4_iNa_h(n,:) = midExV4_iNa_h_last;
    midExV4_iK_n(n,:) = midExV4_iK_n_last;
    midIPVxV4_V(n,:) = midIPVxV4_V_last;
    midIPVxV4_iNa_m(n,:) = midIPVxV4_iNa_m_last;
    midIPVxV4_iNa_h(n,:) = midIPVxV4_iNa_h_last;
    midIPVxV4_iK_n(n,:) = midIPVxV4_iK_n_last;
    deepExV4_V(n,:) = deepExV4_V_last;
    deepExV4_iNa_m(n,:) = deepExV4_iNa_m_last;
    deepExV4_iNa_h(n,:) = deepExV4_iNa_h_last;
    deepExV4_iK_n(n,:) = deepExV4_iK_n_last;
    deepISOMxV4_V(n,:) = deepISOMxV4_V_last;
    deepISOMxV4_iNa_m(n,:) = deepISOMxV4_iNa_m_last;
    deepISOMxV4_iNa_h(n,:) = deepISOMxV4_iNa_h_last;
    deepISOMxV4_iK_n(n,:) = deepISOMxV4_iK_n_last;
    deepIPVxV4_V(n,:) = deepIPVxV4_V_last;
    deepIPVxV4_iNa_m(n,:) = deepIPVxV4_iNa_m_last;
    deepIPVxV4_iNa_h(n,:) = deepIPVxV4_iNa_h_last;
    deepIPVxV4_iK_n(n,:) = deepIPVxV4_iK_n_last;
    PreStimuliAxV4_V(n,:) = PreStimuliAxV4_V_last;
    PreStimuliAxV4_iNa_m(n,:) = PreStimuliAxV4_iNa_m_last;
    PreStimuliAxV4_iNa_h(n,:) = PreStimuliAxV4_iNa_h_last;
    PreStimuliAxV4_iK_n(n,:) = PreStimuliAxV4_iK_n_last;
    PostStimuliAxV4_V(n,:) = PostStimuliAxV4_V_last;
    PostStimuliAxV4_iNa_m(n,:) = PostStimuliAxV4_iNa_m_last;
    PostStimuliAxV4_iNa_h(n,:) = PostStimuliAxV4_iNa_h_last;
    PostStimuliAxV4_iK_n(n,:) = PostStimuliAxV4_iK_n_last;
    PreStimuliBxV4_V(n,:) = PreStimuliBxV4_V_last;
    PreStimuliBxV4_iNa_m(n,:) = PreStimuliBxV4_iNa_m_last;
    PreStimuliBxV4_iNa_h(n,:) = PreStimuliBxV4_iNa_h_last;
    PreStimuliBxV4_iK_n(n,:) = PreStimuliBxV4_iK_n_last;
    PostStimuliBxV4_V(n,:) = PostStimuliBxV4_V_last;
    PostStimuliBxV4_iNa_m(n,:) = PostStimuliBxV4_iNa_m_last;
    PostStimuliBxV4_iNa_h(n,:) = PostStimuliBxV4_iNa_h_last;
    PostStimuliBxV4_iK_n(n,:) = PostStimuliBxV4_iK_n_last;
    PreStimuliCxV4_V(n,:) = PreStimuliCxV4_V_last;
    PreStimuliCxV4_iNa_m(n,:) = PreStimuliCxV4_iNa_m_last;
    PreStimuliCxV4_iNa_h(n,:) = PreStimuliCxV4_iNa_h_last;
    PreStimuliCxV4_iK_n(n,:) = PreStimuliCxV4_iK_n_last;
    PostStimuliCxV4_V(n,:) = PostStimuliCxV4_V_last;
    PostStimuliCxV4_iNa_m(n,:) = PostStimuliCxV4_iNa_m_last;
    PostStimuliCxV4_iNa_h(n,:) = PostStimuliCxV4_iNa_h_last;
    PostStimuliCxV4_iK_n(n,:) = PostStimuliCxV4_iK_n_last;
    supExPFC_V(n,:) = supExPFC_V_last;
    supExPFC_iNa_m(n,:) = supExPFC_iNa_m_last;
    supExPFC_iNa_h(n,:) = supExPFC_iNa_h_last;
    supExPFC_iK_n(n,:) = supExPFC_iK_n_last;
    supISOMxPFC_V(n,:) = supISOMxPFC_V_last;
    supISOMxPFC_iNa_m(n,:) = supISOMxPFC_iNa_m_last;
    supISOMxPFC_iNa_h(n,:) = supISOMxPFC_iNa_h_last;
    supISOMxPFC_iK_n(n,:) = supISOMxPFC_iK_n_last;
    supIPVxPFC_V(n,:) = supIPVxPFC_V_last;
    supIPVxPFC_iNa_m(n,:) = supIPVxPFC_iNa_m_last;
    supIPVxPFC_iNa_h(n,:) = supIPVxPFC_iNa_h_last;
    supIPVxPFC_iK_n(n,:) = supIPVxPFC_iK_n_last;
    midExPFC_V(n,:) = midExPFC_V_last;
    midExPFC_iNa_m(n,:) = midExPFC_iNa_m_last;
    midExPFC_iNa_h(n,:) = midExPFC_iNa_h_last;
    midExPFC_iK_n(n,:) = midExPFC_iK_n_last;
    midIPVxPFC_V(n,:) = midIPVxPFC_V_last;
    midIPVxPFC_iNa_m(n,:) = midIPVxPFC_iNa_m_last;
    midIPVxPFC_iNa_h(n,:) = midIPVxPFC_iNa_h_last;
    midIPVxPFC_iK_n(n,:) = midIPVxPFC_iK_n_last;
    deepExPFC_V(n,:) = deepExPFC_V_last;
    deepExPFC_iNa_m(n,:) = deepExPFC_iNa_m_last;
    deepExPFC_iNa_h(n,:) = deepExPFC_iNa_h_last;
    deepExPFC_iK_n(n,:) = deepExPFC_iK_n_last;
    deepISOMxPFC_V(n,:) = deepISOMxPFC_V_last;
    deepISOMxPFC_iNa_m(n,:) = deepISOMxPFC_iNa_m_last;
    deepISOMxPFC_iNa_h(n,:) = deepISOMxPFC_iNa_h_last;
    deepISOMxPFC_iK_n(n,:) = deepISOMxPFC_iK_n_last;
    deepIPVxPFC_V(n,:) = deepIPVxPFC_V_last;
    deepIPVxPFC_iNa_m(n,:) = deepIPVxPFC_iNa_m_last;
    deepIPVxPFC_iNa_h(n,:) = deepIPVxPFC_iNa_h_last;
    deepIPVxPFC_iK_n(n,:) = deepIPVxPFC_iK_n_last;
    PreStimuliAxPFC_V(n,:) = PreStimuliAxPFC_V_last;
    PreStimuliAxPFC_iNa_m(n,:) = PreStimuliAxPFC_iNa_m_last;
    PreStimuliAxPFC_iNa_h(n,:) = PreStimuliAxPFC_iNa_h_last;
    PreStimuliAxPFC_iK_n(n,:) = PreStimuliAxPFC_iK_n_last;
    PostStimuliAxPFC_V(n,:) = PostStimuliAxPFC_V_last;
    PostStimuliAxPFC_iNa_m(n,:) = PostStimuliAxPFC_iNa_m_last;
    PostStimuliAxPFC_iNa_h(n,:) = PostStimuliAxPFC_iNa_h_last;
    PostStimuliAxPFC_iK_n(n,:) = PostStimuliAxPFC_iK_n_last;
    PreStimuliBxPFC_V(n,:) = PreStimuliBxPFC_V_last;
    PreStimuliBxPFC_iNa_m(n,:) = PreStimuliBxPFC_iNa_m_last;
    PreStimuliBxPFC_iNa_h(n,:) = PreStimuliBxPFC_iNa_h_last;
    PreStimuliBxPFC_iK_n(n,:) = PreStimuliBxPFC_iK_n_last;
    PostStimuliBxPFC_V(n,:) = PostStimuliBxPFC_V_last;
    PostStimuliBxPFC_iNa_m(n,:) = PostStimuliBxPFC_iNa_m_last;
    PostStimuliBxPFC_iNa_h(n,:) = PostStimuliBxPFC_iNa_h_last;
    PostStimuliBxPFC_iK_n(n,:) = PostStimuliBxPFC_iK_n_last;
    PreStimuliCxPFC_V(n,:) = PreStimuliCxPFC_V_last;
    PreStimuliCxPFC_iNa_m(n,:) = PreStimuliCxPFC_iNa_m_last;
    PreStimuliCxPFC_iNa_h(n,:) = PreStimuliCxPFC_iNa_h_last;
    PreStimuliCxPFC_iK_n(n,:) = PreStimuliCxPFC_iK_n_last;
    PostStimuliCxPFC_V(n,:) = PostStimuliCxPFC_V_last;
    PostStimuliCxPFC_iNa_m(n,:) = PostStimuliCxPFC_iNa_m_last;
    PostStimuliCxPFC_iNa_h(n,:) = PostStimuliCxPFC_iNa_h_last;
    PostStimuliCxPFC_iK_n(n,:) = PostStimuliCxPFC_iK_n_last;
    supISOMxV4_supExV4_iAMPActx_s(n,:) = supISOMxV4_supExV4_iAMPActx_s_last;
    supIPVxV4_supExV4_iAMPActx_s(n,:) = supIPVxV4_supExV4_iAMPActx_s_last;
    supISOMxV4_supExV4_iNMDActx_s(n,:) = supISOMxV4_supExV4_iNMDActx_s_last;
    supIPVxV4_supExV4_iNMDActx_s(n,:) = supIPVxV4_supExV4_iNMDActx_s_last;
    supExV4_supISOMxV4_iGABActx_s(n,:) = supExV4_supISOMxV4_iGABActx_s_last;
    supIPVxV4_supISOMxV4_iGABActx_s(n,:) = supIPVxV4_supISOMxV4_iGABActx_s_last;
    supExV4_supIPVxV4_iGABActx_s(n,:) = supExV4_supIPVxV4_iGABActx_s_last;
    supISOMxV4_supIPVxV4_iGABActx_s(n,:) = supISOMxV4_supIPVxV4_iGABActx_s_last;
    midIPVxV4_midExV4_iAMPActx_s(n,:) = midIPVxV4_midExV4_iAMPActx_s_last;
    midExV4_midIPVxV4_iGABActx_s(n,:) = midExV4_midIPVxV4_iGABActx_s_last;
    deepISOMxV4_deepExV4_iAMPActx_s(n,:) = deepISOMxV4_deepExV4_iAMPActx_s_last;
    deepIPVxV4_deepExV4_iAMPActx_s(n,:) = deepIPVxV4_deepExV4_iAMPActx_s_last;
    deepExV4_deepISOMxV4_iGABActx_s(n,:) = deepExV4_deepISOMxV4_iGABActx_s_last;
    deepIPVxV4_deepISOMxV4_iGABActx_s(n,:) = deepIPVxV4_deepISOMxV4_iGABActx_s_last;
    deepExV4_deepIPVxV4_iGABActx_s(n,:) = deepExV4_deepIPVxV4_iGABActx_s_last;
    deepISOMxV4_deepIPVxV4_iGABActx_s(n,:) = deepISOMxV4_deepIPVxV4_iGABActx_s_last;
    PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s(n,:) = PostStimuliAxV4_PreStimuliAxV4_iAMPActx_s_last;
    PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s(n,:) = PostStimuliBxV4_PreStimuliBxV4_iAMPActx_s_last;
    PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s(n,:) = PostStimuliCxV4_PreStimuliCxV4_iAMPActx_s_last;
    midExV4_PreStimuliAxV4_iAMPActx_s(n,:) = midExV4_PreStimuliAxV4_iAMPActx_s_last;
    midExV4_PostStimuliAxV4_iAMPActx_s(n,:) = midExV4_PostStimuliAxV4_iAMPActx_s_last;
    midExV4_PreStimuliBxV4_iAMPActx_s(n,:) = midExV4_PreStimuliBxV4_iAMPActx_s_last;
    midExV4_PostStimuliBxV4_iAMPActx_s(n,:) = midExV4_PostStimuliBxV4_iAMPActx_s_last;
    midExV4_PreStimuliCxV4_iAMPActx_s(n,:) = midExV4_PreStimuliCxV4_iAMPActx_s_last;
    midExV4_PostStimuliCxV4_iAMPActx_s(n,:) = midExV4_PostStimuliCxV4_iAMPActx_s_last;
    deepExV4_supExV4_iAMPActx_s(n,:) = deepExV4_supExV4_iAMPActx_s_last;
    supISOMxV4_midExV4_iAMPActx_s(n,:) = supISOMxV4_midExV4_iAMPActx_s_last;
    supExV4_midExV4_iAMPActx_s(n,:) = supExV4_midExV4_iAMPActx_s_last;
    deepExV4_midExV4_iAMPActx_s(n,:) = deepExV4_midExV4_iAMPActx_s_last;
    deepIPVxV4_midExV4_iAMPActx_s(n,:) = deepIPVxV4_midExV4_iAMPActx_s_last;
    supExV4_midIPVxV4_iGABActx_s(n,:) = supExV4_midIPVxV4_iGABActx_s_last;
    supISOMxV4_deepExV4_iAMPActx_s(n,:) = supISOMxV4_deepExV4_iAMPActx_s_last;
    supIPVxV4_deepExV4_iAMPActx_s(n,:) = supIPVxV4_deepExV4_iAMPActx_s_last;
    midIPVxV4_deepISOMxV4_iGABActx_s(n,:) = midIPVxV4_deepISOMxV4_iGABActx_s_last;
    supISOMxPFC_supExPFC_iAMPActx_s(n,:) = supISOMxPFC_supExPFC_iAMPActx_s_last;
    supIPVxPFC_supExPFC_iAMPActx_s(n,:) = supIPVxPFC_supExPFC_iAMPActx_s_last;
    supISOMxPFC_supExPFC_iNMDActx_s(n,:) = supISOMxPFC_supExPFC_iNMDActx_s_last;
    supIPVxPFC_supExPFC_iNMDActx_s(n,:) = supIPVxPFC_supExPFC_iNMDActx_s_last;
    supExPFC_supISOMxPFC_iGABActx_s(n,:) = supExPFC_supISOMxPFC_iGABActx_s_last;
    supIPVxPFC_supISOMxPFC_iGABActx_s(n,:) = supIPVxPFC_supISOMxPFC_iGABActx_s_last;
    supExPFC_supIPVxPFC_iGABActx_s(n,:) = supExPFC_supIPVxPFC_iGABActx_s_last;
    supISOMxPFC_supIPVxPFC_iGABActx_s(n,:) = supISOMxPFC_supIPVxPFC_iGABActx_s_last;
    midIPVxPFC_midExPFC_iAMPActx_s(n,:) = midIPVxPFC_midExPFC_iAMPActx_s_last;
    midExPFC_midIPVxPFC_iGABActx_s(n,:) = midExPFC_midIPVxPFC_iGABActx_s_last;
    deepISOMxPFC_deepExPFC_iAMPActx_s(n,:) = deepISOMxPFC_deepExPFC_iAMPActx_s_last;
    deepIPVxPFC_deepExPFC_iAMPActx_s(n,:) = deepIPVxPFC_deepExPFC_iAMPActx_s_last;
    deepExPFC_deepISOMxPFC_iGABActx_s(n,:) = deepExPFC_deepISOMxPFC_iGABActx_s_last;
    deepIPVxPFC_deepISOMxPFC_iGABActx_s(n,:) = deepIPVxPFC_deepISOMxPFC_iGABActx_s_last;
    deepExPFC_deepIPVxPFC_iGABActx_s(n,:) = deepExPFC_deepIPVxPFC_iGABActx_s_last;
    deepISOMxPFC_deepIPVxPFC_iGABActx_s(n,:) = deepISOMxPFC_deepIPVxPFC_iGABActx_s_last;
    PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s(n,:) = PostStimuliAxPFC_PreStimuliAxPFC_iAMPActx_s_last;
    PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s(n,:) = PostStimuliBxPFC_PreStimuliBxPFC_iAMPActx_s_last;
    PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s(n,:) = PostStimuliCxPFC_PreStimuliCxPFC_iAMPActx_s_last;
    midExPFC_PreStimuliAxPFC_iAMPActx_s(n,:) = midExPFC_PreStimuliAxPFC_iAMPActx_s_last;
    midExPFC_PostStimuliAxPFC_iAMPActx_s(n,:) = midExPFC_PostStimuliAxPFC_iAMPActx_s_last;
    midExPFC_PreStimuliBxPFC_iAMPActx_s(n,:) = midExPFC_PreStimuliBxPFC_iAMPActx_s_last;
    midExPFC_PostStimuliBxPFC_iAMPActx_s(n,:) = midExPFC_PostStimuliBxPFC_iAMPActx_s_last;
    midExPFC_PreStimuliCxPFC_iAMPActx_s(n,:) = midExPFC_PreStimuliCxPFC_iAMPActx_s_last;
    midExPFC_PostStimuliCxPFC_iAMPActx_s(n,:) = midExPFC_PostStimuliCxPFC_iAMPActx_s_last;
    deepExPFC_supExPFC_iAMPActx_s(n,:) = deepExPFC_supExPFC_iAMPActx_s_last;
    supISOMxPFC_midExPFC_iAMPActx_s(n,:) = supISOMxPFC_midExPFC_iAMPActx_s_last;
    supExPFC_midExPFC_iAMPActx_s(n,:) = supExPFC_midExPFC_iAMPActx_s_last;
    deepExPFC_midExPFC_iAMPActx_s(n,:) = deepExPFC_midExPFC_iAMPActx_s_last;
    deepIPVxPFC_midExPFC_iAMPActx_s(n,:) = deepIPVxPFC_midExPFC_iAMPActx_s_last;
    supExPFC_midIPVxPFC_iGABActx_s(n,:) = supExPFC_midIPVxPFC_iGABActx_s_last;
    supISOMxPFC_deepExPFC_iAMPActx_s(n,:) = supISOMxPFC_deepExPFC_iAMPActx_s_last;
    supIPVxPFC_deepExPFC_iAMPActx_s(n,:) = supIPVxPFC_deepExPFC_iAMPActx_s_last;
    midIPVxPFC_deepISOMxPFC_iGABActx_s(n,:) = midIPVxPFC_deepISOMxPFC_iGABActx_s_last;
    midExPFC_supExV4_iAMPActx_s(n,:) = midExPFC_supExV4_iAMPActx_s_last;
    midIPVxPFC_supExV4_iAMPActx_s(n,:) = midIPVxPFC_supExV4_iAMPActx_s_last;
    supISOMxV4_deepExPFC_iAMPActx_s(n,:) = supISOMxV4_deepExPFC_iAMPActx_s_last;

    n=n+1;
  end
end

T=T(1:downsample_factor:ntime);

end
