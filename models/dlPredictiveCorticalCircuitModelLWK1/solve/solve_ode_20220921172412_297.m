function [T,supExPFC_V,supExPFC_iNa_m,supExPFC_iNa_h,supExPFC_iK_n,supISOMxPFC_V,supISOMxPFC_iNa_m,supISOMxPFC_iNa_h,supISOMxPFC_iK_n,supIPVxPFC_V,supIPVxPFC_iNa_m,supIPVxPFC_iNa_h,supIPVxPFC_iK_n,midExPFC_V,midExPFC_iNa_m,midExPFC_iNa_h,midExPFC_iK_n,midIPVxPFC_V,midIPVxPFC_iNa_m,midIPVxPFC_iNa_h,midIPVxPFC_iK_n,deepExPFC_V,deepExPFC_iNa_m,deepExPFC_iNa_h,deepExPFC_iK_n,deepISOMxPFC_V,deepISOMxPFC_iNa_m,deepISOMxPFC_iNa_h,deepISOMxPFC_iK_n,deepIPVxPFC_V,deepIPVxPFC_iNa_m,deepIPVxPFC_iNa_h,deepIPVxPFC_iK_n,StimAxPFC_V,StimAxPFC_iNa_m,StimAxPFC_iNa_h,StimAxPFC_iK_n,StimAxPFC_V,StimAxPFC_iNa_m,StimAxPFC_iNa_h,StimAxPFC_iK_n,StimBxPFC_V,StimBxPFC_iNa_m,StimBxPFC_iNa_h,StimBxPFC_iK_n,StimBxPFC_V,StimBxPFC_iNa_m,StimBxPFC_iNa_h,StimBxPFC_iK_n,StimCxPFC_V,StimCxPFC_iNa_m,StimCxPFC_iNa_h,StimCxPFC_iK_n,StimCxPFC_V,StimCxPFC_iNa_m,StimCxPFC_iNa_h,StimCxPFC_iK_n,supISOMxPFC_supExPFC_iAMPActx_s,supIPVxPFC_supExPFC_iAMPActx_s,supISOMxPFC_supExPFC_iAMPActx_s,supIPVxPFC_supExPFC_iAMPActx_s,supExPFC_supISOMxPFC_iGABActx_s,supIPVxPFC_supISOMxPFC_iGABActx_s,supExPFC_supIPVxPFC_iGABActx_s,supISOMxPFC_supIPVxPFC_iGABActx_s,midIPVxPFC_midExPFC_iAMPActx_s,midExPFC_midIPVxPFC_iGABActx_s,deepISOMxPFC_deepExPFC_iAMPActx_s,deepIPVxPFC_deepExPFC_iAMPActx_s,deepExPFC_deepISOMxPFC_iGABActx_s,deepIPVxPFC_deepISOMxPFC_iGABActx_s,deepExPFC_deepIPVxPFC_iGABActx_s,deepISOMxPFC_deepIPVxPFC_iGABActx_s,StimAxPFC_StimAxPFC_iAMPActx_s,StimAxPFC_StimAxPFC_iAMPActx_s,StimAxPFC_StimAxPFC_iAMPActx_s,StimAxPFC_StimAxPFC_iAMPActx_s,StimBxPFC_StimBxPFC_iAMPActx_s,StimBxPFC_StimBxPFC_iAMPActx_s,StimBxPFC_StimBxPFC_iAMPActx_s,StimBxPFC_StimBxPFC_iAMPActx_s,StimCxPFC_StimCxPFC_iAMPActx_s,StimCxPFC_StimCxPFC_iAMPActx_s,StimCxPFC_StimCxPFC_iAMPActx_s,StimCxPFC_StimCxPFC_iAMPActx_s,midExPFC_StimAxPFC_iAMPActx_s,midExPFC_StimAxPFC_iAMPActx_s,midExPFC_StimBxPFC_iAMPActx_s,midExPFC_StimBxPFC_iAMPActx_s,midExPFC_StimCxPFC_iAMPActx_s,midExPFC_StimCxPFC_iAMPActx_s,deepExPFC_supExPFC_iAMPActx_s,supISOMxPFC_midExPFC_iAMPActx_s,supExPFC_midExPFC_iAMPActx_s,deepExPFC_midExPFC_iAMPActx_s,deepIPVxPFC_midExPFC_iAMPActx_s,supExPFC_midIPVxPFC_iGABActx_s,supISOMxPFC_deepExPFC_iAMPActx_s,supIPVxPFC_deepExPFC_iAMPActx_s,midIPVxPFC_deepISOMxPFC_iGABActx_s]=solve_ode

% ------------------------------------------------------------
% Parameters:
% ------------------------------------------------------------
params = load('params.mat','p');
p = params.p;
downsample_factor=p.downsample_factor;
dt=p.dt;
T=(p.tspan(1):dt:p.tspan(2))';
ntime=length(T);
nsamp=length(1:downsample_factor:ntime);

% seed the random number generator
rng(p.random_seed);

% ------------------------------------------------------------
% Initial conditions:
% ------------------------------------------------------------
t=0; k=1;

% STATE_VARIABLES:
supExPFC_V_last =  p.StimAxPFC_StimAxPFC_iAMPActx_IC+p.StimAxPFC_StimAxPFC_iAMPActx_IC_noise.*rand(1,p.StimAxPFC_Npop);
supExPFC_V = zeros(nsamp,6);
supExPFC_V(1,:) = supExPFC_V_last;
supExPFC_iNa_m_last =  -60 - rand(1, p.StimAxPFC_Npop)*17;
supExPFC_iNa_m = zeros(nsamp,6);
supExPFC_iNa_m(1,:) = supExPFC_iNa_m_last;
supExPFC_iNa_h_last = p.StimAxPFC_iK_n_IC+p.StimAxPFC_iK_IC_noise*rand(1,p.StimAxPFC_Npop);
supExPFC_iNa_h = zeros(nsamp,6);
supExPFC_iNa_h(1,:) = supExPFC_iNa_h_last;
supExPFC_iK_n_last = p.StimAxPFC_iNa_h_IC+p.StimAxPFC_iNa_IC_noise*rand(1,p.StimAxPFC_Npop);
supExPFC_iK_n = zeros(nsamp,6);
supExPFC_iK_n(1,:) = supExPFC_iK_n_last;
supISOMxPFC_V_last = p.StimAxPFC_iNa_m_IC+p.StimAxPFC_iNa_IC_noise*rand(1,p.StimAxPFC_Npop);
supISOMxPFC_V = zeros(nsamp,6);
supISOMxPFC_V(1,:) = supISOMxPFC_V_last;
supISOMxPFC_iNa_m_last =  p.StimBxPFC_StimBxPFC_iAMPActx_IC+p.StimBxPFC_StimBxPFC_iAMPActx_IC_noise.*rand(1,p.StimBxPFC_Npop);
supISOMxPFC_iNa_m = zeros(nsamp,6);
supISOMxPFC_iNa_m(1,:) = supISOMxPFC_iNa_m_last;
supISOMxPFC_iNa_h_last =  -60 - rand(1, p.StimBxPFC_Npop)*17;
supISOMxPFC_iNa_h = zeros(nsamp,6);
supISOMxPFC_iNa_h(1,:) = supISOMxPFC_iNa_h_last;
supISOMxPFC_iK_n_last = p.StimBxPFC_iK_n_IC+p.StimBxPFC_iK_IC_noise*rand(1,p.StimBxPFC_Npop);
supISOMxPFC_iK_n = zeros(nsamp,6);
supISOMxPFC_iK_n(1,:) = supISOMxPFC_iK_n_last;
supIPVxPFC_V_last = p.StimBxPFC_iNa_h_IC+p.StimBxPFC_iNa_IC_noise*rand(1,p.StimBxPFC_Npop);
supIPVxPFC_V = zeros(nsamp,6);
supIPVxPFC_V(1,:) = supIPVxPFC_V_last;
supIPVxPFC_iNa_m_last = p.StimBxPFC_iNa_m_IC+p.StimBxPFC_iNa_IC_noise*rand(1,p.StimBxPFC_Npop);
supIPVxPFC_iNa_m = zeros(nsamp,6);
supIPVxPFC_iNa_m(1,:) = supIPVxPFC_iNa_m_last;
supIPVxPFC_iNa_h_last =  p.StimCxPFC_StimCxPFC_iAMPActx_IC+p.StimCxPFC_StimCxPFC_iAMPActx_IC_noise.*rand(1,p.StimCxPFC_Npop);
supIPVxPFC_iNa_h = zeros(nsamp,6);
supIPVxPFC_iNa_h(1,:) = supIPVxPFC_iNa_h_last;
supIPVxPFC_iK_n_last =  -60 - rand(1, p.StimCxPFC_Npop)*17;
supIPVxPFC_iK_n = zeros(nsamp,6);
supIPVxPFC_iK_n(1,:) = supIPVxPFC_iK_n_last;
midExPFC_V_last = p.StimCxPFC_iK_n_IC+p.StimCxPFC_iK_IC_noise*rand(1,p.StimCxPFC_Npop);
midExPFC_V = zeros(nsamp,6);
midExPFC_V(1,:) = midExPFC_V_last;
midExPFC_iNa_m_last = p.StimCxPFC_iNa_h_IC+p.StimCxPFC_iNa_IC_noise*rand(1,p.StimCxPFC_Npop);
midExPFC_iNa_m = zeros(nsamp,6);
midExPFC_iNa_m(1,:) = midExPFC_iNa_m_last;
midExPFC_iNa_h_last = p.StimCxPFC_iNa_m_IC+p.StimCxPFC_iNa_IC_noise*rand(1,p.StimCxPFC_Npop);
midExPFC_iNa_h = zeros(nsamp,6);
midExPFC_iNa_h(1,:) = midExPFC_iNa_h_last;
midExPFC_iK_n_last =  -rand(1, p.deepExPFC_Npop)*74;
midExPFC_iK_n = zeros(nsamp,74);
midExPFC_iK_n(1,:) = midExPFC_iK_n_last;
midIPVxPFC_V_last =  p.deepExPFC_deepIPVxPFC_iGABActx_IC+p.deepExPFC_deepIPVxPFC_iGABActx_IC_noise.*rand(1,p.deepIPVxPFC_Npop);
midIPVxPFC_V = zeros(nsamp,1);
midIPVxPFC_V(1,:) = midIPVxPFC_V_last;
midIPVxPFC_iNa_m_last =  p.deepExPFC_deepISOMxPFC_iGABActx_IC+p.deepExPFC_deepISOMxPFC_iGABActx_IC_noise.*rand(1,p.deepISOMxPFC_Npop);
midIPVxPFC_iNa_m = zeros(nsamp,3);
midIPVxPFC_iNa_m(1,:) = midIPVxPFC_iNa_m_last;
midIPVxPFC_iNa_h_last = p.deepExPFC_iK_n_IC+p.deepExPFC_iK_IC_noise*rand(1,p.deepExPFC_Npop);
midIPVxPFC_iNa_h = zeros(nsamp,74);
midIPVxPFC_iNa_h(1,:) = midIPVxPFC_iNa_h_last;
midIPVxPFC_iK_n_last = p.deepExPFC_iNa_h_IC+p.deepExPFC_iNa_IC_noise*rand(1,p.deepExPFC_Npop);
midIPVxPFC_iK_n = zeros(nsamp,74);
midIPVxPFC_iK_n(1,:) = midIPVxPFC_iK_n_last;
deepExPFC_V_last = p.deepExPFC_iNa_m_IC+p.deepExPFC_iNa_IC_noise*rand(1,p.deepExPFC_Npop);
deepExPFC_V = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_V(1,:) = deepExPFC_V_last;
deepExPFC_iNa_m_last =  -rand(1, p.deepIPVxPFC_Npop)*74;
deepExPFC_iNa_m = zeros(nsamp,1);
deepExPFC_iNa_m(1,:) = deepExPFC_iNa_m_last;
deepExPFC_iNa_h_last =  p.deepIPVxPFC_deepExPFC_iAMPActx_IC+p.deepIPVxPFC_deepExPFC_iAMPActx_IC_noise.*rand(1,p.deepExPFC_Npop);
deepExPFC_iNa_h = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_iNa_h(1,:) = deepExPFC_iNa_h_last;
deepExPFC_iK_n_last =  p.deepIPVxPFC_deepISOMxPFC_iGABActx_IC+p.deepIPVxPFC_deepISOMxPFC_iGABActx_IC_noise.*rand(1,p.deepISOMxPFC_Npop);
deepExPFC_iK_n = zeros(nsamp,3);
deepExPFC_iK_n(1,:) = deepExPFC_iK_n_last;
deepISOMxPFC_V_last = p.deepIPVxPFC_iK_n_IC+p.deepIPVxPFC_iK_IC_noise*rand(1,p.deepIPVxPFC_Npop);
deepISOMxPFC_V = zeros(nsamp,1);
deepISOMxPFC_V(1,:) = deepISOMxPFC_V_last;
deepISOMxPFC_iNa_m_last = p.deepIPVxPFC_iNa_h_IC+p.deepIPVxPFC_iNa_IC_noise*rand(1,p.deepIPVxPFC_Npop);
deepISOMxPFC_iNa_m = zeros(nsamp,1);
deepISOMxPFC_iNa_m(1,:) = deepISOMxPFC_iNa_m_last;
deepISOMxPFC_iNa_h_last = p.deepIPVxPFC_iNa_m_IC+p.deepIPVxPFC_iNa_IC_noise*rand(1,p.deepIPVxPFC_Npop);
deepISOMxPFC_iNa_h = zeros(nsamp,1);
deepISOMxPFC_iNa_h(1,:) = deepISOMxPFC_iNa_h_last;
deepISOMxPFC_iK_n_last =  -rand(1, p.deepISOMxPFC_Npop)*74;
deepISOMxPFC_iK_n = zeros(nsamp,p.deepISOMxPFC_Npop);
deepISOMxPFC_iK_n(1,:) = deepISOMxPFC_iK_n_last;
deepIPVxPFC_V_last =  p.deepISOMxPFC_deepExPFC_iAMPActx_IC+p.deepISOMxPFC_deepExPFC_iAMPActx_IC_noise.*rand(1,p.deepExPFC_Npop);
deepIPVxPFC_V = zeros(nsamp,74);
deepIPVxPFC_V(1,:) = deepIPVxPFC_V_last;
deepIPVxPFC_iNa_m_last =  p.deepISOMxPFC_deepIPVxPFC_iGABActx_IC+p.deepISOMxPFC_deepIPVxPFC_iGABActx_IC_noise.*rand(1,p.deepIPVxPFC_Npop);
deepIPVxPFC_iNa_m = zeros(nsamp,p.deepIPVxPFC_Npop);
deepIPVxPFC_iNa_m(1,:) = deepIPVxPFC_iNa_m_last;
deepIPVxPFC_iNa_h_last = p.deepISOMxPFC_iK_n_IC+p.deepISOMxPFC_iK_IC_noise*rand(1,p.deepISOMxPFC_Npop);
deepIPVxPFC_iNa_h = zeros(nsamp,3);
deepIPVxPFC_iNa_h(1,:) = deepIPVxPFC_iNa_h_last;
deepIPVxPFC_iK_n_last = p.deepISOMxPFC_iNa_h_IC+p.deepISOMxPFC_iNa_IC_noise*rand(1,p.deepISOMxPFC_Npop);
deepIPVxPFC_iK_n = zeros(nsamp,3);
deepIPVxPFC_iK_n(1,:) = deepIPVxPFC_iK_n_last;
StimAxPFC_V_last = p.deepISOMxPFC_iNa_m_IC+p.deepISOMxPFC_iNa_IC_noise*rand(1,p.deepISOMxPFC_Npop);
StimAxPFC_V = zeros(nsamp,3);
StimAxPFC_V(1,:) = StimAxPFC_V_last;
StimAxPFC_iNa_m_last =  p.midExPFC_StimAxPFC_iAMPActx_IC+p.midExPFC_StimAxPFC_iAMPActx_IC_noise.*rand(1,p.StimAxPFC_Npop);
StimAxPFC_iNa_m = zeros(nsamp,p.StimAxPFC_Npop);
StimAxPFC_iNa_m(1,:) = StimAxPFC_iNa_m_last;
StimAxPFC_iNa_h_last =  p.midExPFC_StimBxPFC_iAMPActx_IC+p.midExPFC_StimBxPFC_iAMPActx_IC_noise.*rand(1,p.StimBxPFC_Npop);
StimAxPFC_iNa_h = zeros(nsamp,p.StimAxPFC_Npop);
StimAxPFC_iNa_h(1,:) = StimAxPFC_iNa_h_last;
StimAxPFC_iK_n_last =  p.midExPFC_StimCxPFC_iAMPActx_IC+p.midExPFC_StimCxPFC_iAMPActx_IC_noise.*rand(1,p.StimCxPFC_Npop);
StimAxPFC_iK_n = zeros(nsamp,p.StimAxPFC_Npop);
StimAxPFC_iK_n(1,:) = StimAxPFC_iK_n_last;
StimAxPFC_V_last =  -rand(1, p.midExPFC_Npop)*74;
StimAxPFC_V = zeros(nsamp,27);
StimAxPFC_V(1,:) = StimAxPFC_V_last;
StimAxPFC_iNa_m_last = p.midExPFC_iK_n_IC+p.midExPFC_iK_IC_noise*rand(1,p.midExPFC_Npop);
StimAxPFC_iNa_m = zeros(nsamp,27);
StimAxPFC_iNa_m(1,:) = StimAxPFC_iNa_m_last;
StimAxPFC_iNa_h_last = p.midExPFC_iNa_h_IC+p.midExPFC_iNa_IC_noise*rand(1,p.midExPFC_Npop);
StimAxPFC_iNa_h = zeros(nsamp,27);
StimAxPFC_iNa_h(1,:) = StimAxPFC_iNa_h_last;
StimAxPFC_iK_n_last = p.midExPFC_iNa_m_IC+p.midExPFC_iNa_IC_noise*rand(1,p.midExPFC_Npop);
StimAxPFC_iK_n = zeros(nsamp,27);
StimAxPFC_iK_n(1,:) = StimAxPFC_iK_n_last;
StimBxPFC_V_last =  p.midExPFC_midIPVxPFC_iGABActx_IC+p.midExPFC_midIPVxPFC_iGABActx_IC_noise.*rand(1,p.midIPVxPFC_Npop);
StimBxPFC_V = zeros(nsamp,4);
StimBxPFC_V(1,:) = StimBxPFC_V_last;
StimBxPFC_iNa_m_last =  -rand(1, p.midIPVxPFC_Npop)*74;
StimBxPFC_iNa_m = zeros(nsamp,4);
StimBxPFC_iNa_m(1,:) = StimBxPFC_iNa_m_last;
StimBxPFC_iNa_h_last = p.midIPVxPFC_iK_n_IC+p.midIPVxPFC_iK_IC_noise*rand(1,p.midIPVxPFC_Npop);
StimBxPFC_iNa_h = zeros(nsamp,4);
StimBxPFC_iNa_h(1,:) = StimBxPFC_iNa_h_last;
StimBxPFC_iK_n_last = p.midIPVxPFC_iNa_h_IC+p.midIPVxPFC_iNa_IC_noise*rand(1,p.midIPVxPFC_Npop);
StimBxPFC_iK_n = zeros(nsamp,4);
StimBxPFC_iK_n(1,:) = StimBxPFC_iK_n_last;
StimBxPFC_V_last = p.midIPVxPFC_iNa_m_IC+p.midIPVxPFC_iNa_IC_noise*rand(1,p.midIPVxPFC_Npop);
StimBxPFC_V = zeros(nsamp,4);
StimBxPFC_V(1,:) = StimBxPFC_V_last;
StimBxPFC_iNa_m_last =  p.midIPVxPFC_midExPFC_iAMPActx_IC+p.midIPVxPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
StimBxPFC_iNa_m = zeros(nsamp,27);
StimBxPFC_iNa_m(1,:) = StimBxPFC_iNa_m_last;
StimBxPFC_iNa_h_last =  -rand(1, p.supExPFC_Npop)*74;
StimBxPFC_iNa_h = zeros(nsamp,41);
StimBxPFC_iNa_h(1,:) = StimBxPFC_iNa_h_last;
StimBxPFC_iK_n_last = p.supExPFC_iK_n_IC+p.supExPFC_iK_IC_noise*rand(1,p.supExPFC_Npop);
StimBxPFC_iK_n = zeros(nsamp,41);
StimBxPFC_iK_n(1,:) = StimBxPFC_iK_n_last;
StimCxPFC_V_last = p.supExPFC_iNa_h_IC+p.supExPFC_iNa_IC_noise*rand(1,p.supExPFC_Npop);
StimCxPFC_V = zeros(nsamp,41);
StimCxPFC_V(1,:) = StimCxPFC_V_last;
StimCxPFC_iNa_m_last = p.supExPFC_iNa_m_IC+p.supExPFC_iNa_IC_noise*rand(1,p.supExPFC_Npop);
StimCxPFC_iNa_m = zeros(nsamp,41);
StimCxPFC_iNa_m(1,:) = StimCxPFC_iNa_m_last;
StimCxPFC_iNa_h_last =  p.supExPFC_supIPVxPFC_iGABActx_IC+p.supExPFC_supIPVxPFC_iGABActx_IC_noise.*rand(1,p.supIPVxPFC_Npop);
StimCxPFC_iNa_h = zeros(nsamp,11);
StimCxPFC_iNa_h(1,:) = StimCxPFC_iNa_h_last;
StimCxPFC_iK_n_last =  p.supExPFC_supISOMxPFC_iGABActx_IC+p.supExPFC_supISOMxPFC_iGABActx_IC_noise.*rand(1,p.supISOMxPFC_Npop);
StimCxPFC_iK_n = zeros(nsamp,4);
StimCxPFC_iK_n(1,:) = StimCxPFC_iK_n_last;
StimCxPFC_V_last =  -rand(1, p.supIPVxPFC_Npop)*74;
StimCxPFC_V = zeros(nsamp,11);
StimCxPFC_V(1,:) = StimCxPFC_V_last;
StimCxPFC_iNa_m_last = p.supIPVxPFC_iK_n_IC+p.supIPVxPFC_iK_IC_noise*rand(1,p.supIPVxPFC_Npop);
StimCxPFC_iNa_m = zeros(nsamp,11);
StimCxPFC_iNa_m(1,:) = StimCxPFC_iNa_m_last;
StimCxPFC_iNa_h_last = p.supIPVxPFC_iNa_h_IC+p.supIPVxPFC_iNa_IC_noise*rand(1,p.supIPVxPFC_Npop);
StimCxPFC_iNa_h = zeros(nsamp,11);
StimCxPFC_iNa_h(1,:) = StimCxPFC_iNa_h_last;
StimCxPFC_iK_n_last = p.supIPVxPFC_iNa_m_IC+p.supIPVxPFC_iNa_IC_noise*rand(1,p.supIPVxPFC_Npop);
StimCxPFC_iK_n = zeros(nsamp,11);
StimCxPFC_iK_n(1,:) = StimCxPFC_iK_n_last;
supISOMxPFC_supExPFC_iAMPActx_s_last =  p.supIPVxPFC_supExPFC_iAMPActx_IC+p.supIPVxPFC_supExPFC_iAMPActx_IC_noise.*rand(1,p.supExPFC_Npop);
supISOMxPFC_supExPFC_iAMPActx_s = zeros(nsamp,p.supExPFC_Npop);
supISOMxPFC_supExPFC_iAMPActx_s(1,:) = supISOMxPFC_supExPFC_iAMPActx_s_last;
supIPVxPFC_supExPFC_iAMPActx_s_last =  p.supIPVxPFC_supISOMxPFC_iGABActx_IC+p.supIPVxPFC_supISOMxPFC_iGABActx_IC_noise.*rand(1,p.supISOMxPFC_Npop);
supIPVxPFC_supExPFC_iAMPActx_s = zeros(nsamp,4);
supIPVxPFC_supExPFC_iAMPActx_s(1,:) = supIPVxPFC_supExPFC_iAMPActx_s_last;
supISOMxPFC_supExPFC_iAMPActx_s_last =  -rand(1, p.supISOMxPFC_Npop)*74;
supISOMxPFC_supExPFC_iAMPActx_s = zeros(nsamp,p.supISOMxPFC_Npop);
supISOMxPFC_supExPFC_iAMPActx_s(1,:) = supISOMxPFC_supExPFC_iAMPActx_s_last;
supIPVxPFC_supExPFC_iAMPActx_s_last = p.supISOMxPFC_iK_n_IC+p.supISOMxPFC_iK_IC_noise*rand(1,p.supISOMxPFC_Npop);
supIPVxPFC_supExPFC_iAMPActx_s = zeros(nsamp,4);
supIPVxPFC_supExPFC_iAMPActx_s(1,:) = supIPVxPFC_supExPFC_iAMPActx_s_last;
supExPFC_supISOMxPFC_iGABActx_s_last = p.supISOMxPFC_iNa_h_IC+p.supISOMxPFC_iNa_IC_noise*rand(1,p.supISOMxPFC_Npop);
supExPFC_supISOMxPFC_iGABActx_s = zeros(nsamp,p.supISOMxPFC_Npop);
supExPFC_supISOMxPFC_iGABActx_s(1,:) = supExPFC_supISOMxPFC_iGABActx_s_last;
supIPVxPFC_supISOMxPFC_iGABActx_s_last = p.supISOMxPFC_iNa_m_IC+p.supISOMxPFC_iNa_IC_noise*rand(1,p.supISOMxPFC_Npop);
supIPVxPFC_supISOMxPFC_iGABActx_s = zeros(nsamp,p.supISOMxPFC_Npop);
supIPVxPFC_supISOMxPFC_iGABActx_s(1,:) = supIPVxPFC_supISOMxPFC_iGABActx_s_last;
supExPFC_supIPVxPFC_iGABActx_s_last =  p.supISOMxPFC_supExPFC_iAMPActx_IC+p.supISOMxPFC_supExPFC_iAMPActx_IC_noise.*rand(1,p.supExPFC_Npop);
supExPFC_supIPVxPFC_iGABActx_s = zeros(nsamp,p.supExPFC_Npop);
supExPFC_supIPVxPFC_iGABActx_s(1,:) = supExPFC_supIPVxPFC_iGABActx_s_last;
supISOMxPFC_supIPVxPFC_iGABActx_s_last =  p.supISOMxPFC_supIPVxPFC_iGABActx_IC+p.supISOMxPFC_supIPVxPFC_iGABActx_IC_noise.*rand(1,p.supIPVxPFC_Npop);
supISOMxPFC_supIPVxPFC_iGABActx_s = zeros(nsamp,p.supIPVxPFC_Npop);
supISOMxPFC_supIPVxPFC_iGABActx_s(1,:) = supISOMxPFC_supIPVxPFC_iGABActx_s_last;
midIPVxPFC_midExPFC_iAMPActx_s_last =  p.deepExPFC_supExPFC_iAMPActx_IC+p.deepExPFC_supExPFC_iAMPActx_IC_noise.*rand(1,p.supExPFC_Npop);
midIPVxPFC_midExPFC_iAMPActx_s = zeros(nsamp,41);
midIPVxPFC_midExPFC_iAMPActx_s(1,:) = midIPVxPFC_midExPFC_iAMPActx_s_last;
midExPFC_midIPVxPFC_iGABActx_s_last =  p.supISOMxPFC_midExPFC_iAMPActx_IC+p.supISOMxPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
midExPFC_midIPVxPFC_iGABActx_s = zeros(nsamp,p.midExPFC_Npop);
midExPFC_midIPVxPFC_iGABActx_s(1,:) = midExPFC_midIPVxPFC_iGABActx_s_last;
deepISOMxPFC_deepExPFC_iAMPActx_s_last =  p.supExPFC_midExPFC_iAMPActx_IC+p.supExPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
deepISOMxPFC_deepExPFC_iAMPActx_s = zeros(nsamp,27);
deepISOMxPFC_deepExPFC_iAMPActx_s(1,:) = deepISOMxPFC_deepExPFC_iAMPActx_s_last;
deepIPVxPFC_deepExPFC_iAMPActx_s_last =  p.deepExPFC_midExPFC_iAMPActx_IC+p.deepExPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
deepIPVxPFC_deepExPFC_iAMPActx_s = zeros(nsamp,27);
deepIPVxPFC_deepExPFC_iAMPActx_s(1,:) = deepIPVxPFC_deepExPFC_iAMPActx_s_last;
deepExPFC_deepISOMxPFC_iGABActx_s_last =  p.deepIPVxPFC_midExPFC_iAMPActx_IC+p.deepIPVxPFC_midExPFC_iAMPActx_IC_noise.*rand(1,p.midExPFC_Npop);
deepExPFC_deepISOMxPFC_iGABActx_s = zeros(nsamp,27);
deepExPFC_deepISOMxPFC_iGABActx_s(1,:) = deepExPFC_deepISOMxPFC_iGABActx_s_last;
deepIPVxPFC_deepISOMxPFC_iGABActx_s_last =  p.supExPFC_midIPVxPFC_iGABActx_IC+p.supExPFC_midIPVxPFC_iGABActx_IC_noise.*rand(1,p.midIPVxPFC_Npop);
deepIPVxPFC_deepISOMxPFC_iGABActx_s = zeros(nsamp,4);
deepIPVxPFC_deepISOMxPFC_iGABActx_s(1,:) = deepIPVxPFC_deepISOMxPFC_iGABActx_s_last;
deepExPFC_deepIPVxPFC_iGABActx_s_last =  p.supISOMxPFC_deepExPFC_iAMPActx_IC+p.supISOMxPFC_deepExPFC_iAMPActx_IC_noise.*rand(1,p.deepExPFC_Npop);
deepExPFC_deepIPVxPFC_iGABActx_s = zeros(nsamp,p.deepExPFC_Npop);
deepExPFC_deepIPVxPFC_iGABActx_s(1,:) = deepExPFC_deepIPVxPFC_iGABActx_s_last;
deepISOMxPFC_deepIPVxPFC_iGABActx_s_last =  p.supIPVxPFC_deepExPFC_iAMPActx_IC+p.supIPVxPFC_deepExPFC_iAMPActx_IC_noise.*rand(1,p.deepExPFC_Npop);
deepISOMxPFC_deepIPVxPFC_iGABActx_s = zeros(nsamp,74);
deepISOMxPFC_deepIPVxPFC_iGABActx_s(1,:) = deepISOMxPFC_deepIPVxPFC_iGABActx_s_last;
StimAxPFC_StimAxPFC_iAMPActx_s_last =  p.midIPVxPFC_deepISOMxPFC_iGABActx_IC+p.midIPVxPFC_deepISOMxPFC_iGABActx_IC_noise.*rand(1,p.deepISOMxPFC_Npop);
StimAxPFC_StimAxPFC_iAMPActx_s = zeros(nsamp,3);
StimAxPFC_StimAxPFC_iAMPActx_s(1,:) = StimAxPFC_StimAxPFC_iAMPActx_s_last;
