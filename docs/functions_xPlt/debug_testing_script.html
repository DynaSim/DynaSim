<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of debug_testing_script</title>
  <meta name="keywords" content="debug_testing_script">
  <meta name="description" content="This is a script that I run through every time I want to test the code.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html functions_xPlt -->
<h1>debug_testing_script
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>This is a script that I run through every time I want to test the code.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> This is a script that I run through every time I want to test the code.
 Assumes I've just run one of the scripts in demos.m, namely the section
 titled &quot;%% Save data from a set of simulations&quot;
 Then, I load demo_sPING_3:
 data=ds.importData('demo_sPING_3');
% Run simulation - Sparse Pyramidal-Interneuron-Network-Gamma (sPING)
 Save both figures and data.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="../functions/ds.importData.html" class="code" title="function [data,studyinfo] = ds.importData(file,varargin)">ds.importData</a>	IMPORTDATA - load data into DynaSim formatted data structure.</li><li><a href="../functions/ds.importPlots.html" class="code" title="function [data,studyinfo] = ds.importPlots(file,varargin)">ds.importPlots</a>	IMPORTPLOTS - load info about saved images (generated by SimulateMode or ds.analyzeData) alongwith corresponding varied model components.</li><li><a href="../functions/ds.plotData.html" class="code" title="function handles = ds.plotData(data,varargin)">ds.plotData</a>	PLOTDATA - plot data in various ways depending on what data was provided and what options are defined.</li><li><a href="../functions/ds.simulateModel.html" class="code" title="function [data,studyinfo]=ds.simulateModel(model,varargin)">ds.simulateModel</a>	SIMULATEMODEL -  manage simulation of a DynaSim model.</li><li><a href="ds.plotData2.html" class="code" title="function handles=ds.plotData2(data,varargin)">ds.plotData2</a>	% handles=ds.plotData(data,'option',value)</li><li><a href="../functions_xPlt/classes/@xPlt/recursivePlot.html" class="code" title="function varargout = recursivePlot(xp,function_handles,dimensions,function_handle_arguments)">recursivePlot</a>	function_handle_arguments - cell array of argument cell arrays to pass to</li><li><a href="../functions_xPlt/classes/@xPlt/xPlt.html" class="code" title="">xPlt</a>	</li><li><a href="../functions_xPlt/functions/DynaSimExtract.html" class="code" title="function [data_linear,ax,ax_names,time] = DynaSimExtract (data)">DynaSimExtract</a>	Converts DynaSim structure to 1D cell array format. Later can use to</li><li><a href="../functions_xPlt/functions/DynaSimPlotExtract.html" class="code" title="function [data_linear,ax,ax_names,time] = DynaSimPlotExtract (data)">DynaSimPlotExtract</a>	Converts DynaSim structure to 1D cell array format. Later can use to</li><li><a href="../functions_xPlt/library_plots/xp_matrix_basicplot.html" class="code" title="function xp_matrix_basicplot (xp)">xp_matrix_basicplot</a>	xp must be 1D</li><li><a href="../functions_xPlt/library_plots/xp_plotimage.html" class="code" title="function xp_plotimage (xp,scale)">xp_plotimage</a>	xp must be 1D</li><li><a href="../functions_xPlt/library_plots/xp_subplot.html" class="code" title="function h=xp_subplot (xp,transpose_on,display_mode)">xp_subplot</a>	xp must be 1D or 2D</li><li><a href="../functions_xPlt/library_plots/xp_subplot_grid3D.html" class="code" title="function hsg = xp_subplot_grid3D (xp,transpose_on, display_mode)">xp_subplot_grid3D</a>	xp must be 1D, 2D, or 3D</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 
0002 <span class="comment">% This is a script that I run through every time I want to test the code.</span>
0003 <span class="comment">% Assumes I've just run one of the scripts in demos.m, namely the section</span>
0004 <span class="comment">% titled &quot;%% Save data from a set of simulations&quot;</span>
0005 <span class="comment">% Then, I load demo_sPING_3:</span>
0006 <span class="comment">% data=ds.importData('demo_sPING_3');</span>
0007 <span class="comment">%% Run simulation - Sparse Pyramidal-Interneuron-Network-Gamma (sPING)</span>
0008 <span class="comment">% Save both figures and data.</span>
0009 
0010 dynasim_path=<span class="string">'~/src/DynaSim'</span>;                    
0011 <span class="comment">% add DynaSim toolbox to Matlab path</span>
0012 addpath(genpath(dynasim_path)); <span class="comment">% comment this out if already in path</span>
0013 <span class="comment">%%</span>
0014 cd outputs
0015 
0016 <span class="comment">% define equations of cell model (same for E and I populations)</span>
0017 eqns={ 
0018   <span class="string">'dv/dt=Iapp+@current+noise*randn(1,N_pop)'</span>;
0019   <span class="string">'monitor iGABAa.functions, iAMPA.functions'</span>
0020 };
0021 <span class="comment">% Tip: monitor all functions of a mechanism using: monitor MECHANISM.functions</span>
0022 
0023 <span class="comment">% create DynaSim specification structure</span>
0024 s=[];
0025 s.populations(1).name=<span class="string">'E'</span>;
0026 s.populations(1).size=80;
0027 s.populations(1).equations=eqns;
0028 s.populations(1).mechanism_list={<span class="string">'iNa'</span>,<span class="string">'iK'</span>};
0029 s.populations(1).parameters={<span class="string">'Iapp'</span>,5,<span class="string">'gNa'</span>,120,<span class="string">'gK'</span>,36,<span class="string">'noise'</span>,40};
0030 s.populations(2).name=<span class="string">'I'</span>;
0031 s.populations(2).size=20;
0032 s.populations(2).equations=eqns;
0033 s.populations(2).mechanism_list={<span class="string">'iNa'</span>,<span class="string">'iK'</span>};
0034 s.populations(2).parameters={<span class="string">'Iapp'</span>,0,<span class="string">'gNa'</span>,120,<span class="string">'gK'</span>,36,<span class="string">'noise'</span>,40};
0035 s.connections(1).direction=<span class="string">'I-&gt;E'</span>;
0036 s.connections(1).mechanism_list={<span class="string">'iGABAa'</span>};
0037 s.connections(1).parameters={<span class="string">'tauD'</span>,10,<span class="string">'gSYN'</span>,.1,<span class="string">'netcon'</span>,<span class="string">'ones(N_pre,N_post)'</span>};
0038 s.connections(2).direction=<span class="string">'E-&gt;I'</span>;
0039 s.connections(2).mechanism_list={<span class="string">'iAMPA'</span>};
0040 s.connections(2).parameters={<span class="string">'tauD'</span>,2,<span class="string">'gSYN'</span>,.1,<span class="string">'netcon'</span>,ones(80,20)};
0041 
0042 <span class="comment">% Vary two parameters (run a simulation for all combinations of values)</span>
0043 vary={
0044   <span class="string">'E'</span>   ,<span class="string">'Iapp'</span>,[0 10 20];      <span class="comment">% amplitude of tonic input to E-cells</span>
0045   <span class="string">'I-&gt;E'</span>,<span class="string">'tauD'</span>,[5 10 15]       <span class="comment">% inhibition decay time constant from I to E</span>
0046   };
0047 <a href="../functions/ds.simulateModel.html" class="code" title="function [data,studyinfo]=ds.simulateModel(model,varargin)">ds.simulateModel</a>(s,<span class="string">'save_data_flag'</span>,1,<span class="string">'study_dir'</span>,<span class="string">'demo_sPING_3b'</span>,<span class="keyword">...</span>
0048                 <span class="string">'vary'</span>,vary,<span class="string">'verbose_flag'</span>,1, <span class="keyword">...</span>
0049                 <span class="string">'save_results_flag'</span>,1,<span class="string">'plot_functions'</span>,@<a href="../functions/ds.plotData.html" class="code" title="function handles = ds.plotData(data,varargin)">ds.plotData</a>,<span class="string">'plot_options'</span>,{<span class="string">'format'</span>,<span class="string">'png'</span>} );
0050 
0051 cd ..
0052 
0053 <span class="comment">%% Load the data and import into xPlt class</span>
0054 <span class="comment">% ...Assumes we have some DynaSim data already loaded...</span>
0055 cd outputs
0056 data=<a href="../functions/ds.importData.html" class="code" title="function [data,studyinfo] = ds.importData(file,varargin)">ds.importData</a>(<span class="string">'demo_sPING_3b'</span>);
0057 cd ..
0058 
0059 <span class="comment">% Load the data linearly</span>
0060 [data_linear,ax,ax_names,time] = <a href="../functions_xPlt/functions/DynaSimExtract.html" class="code" title="function [data_linear,ax,ax_names,time] = DynaSimExtract (data)">DynaSimExtract</a> (data);
0061 
0062 
0063 
0064 <span class="comment">% Import into an xPlt class</span>
0065 xp = <a href="../functions_xPlt/classes/@xPlt/xPlt.html" class="code" title="">xPlt</a>;
0066 xp = xp.importLinearData(data_linear,ax{:});
0067 xp = xp.importAxisNames(ax_names);
0068 meta = struct;
0069 meta.datainfo(1:2) = xPltAxis;      <span class="comment">% Use xPltAxis here, because why not?</span>
0070 meta.datainfo(1).name = <span class="string">'time(ms)'</span>;
0071 meta.datainfo(1).values = time;
0072 meta.datainfo(2).name = <span class="string">'cells'</span>;
0073 meta.datainfo(2).values = [];
0074 xp = xp.importMeta(meta);
0075 
0076 <span class="comment">%% Try selecting a bunch of different subsets, squeezing, and testing for errors</span>
0077 <span class="comment">% This should catch most bugs that crop up.</span>
0078 xp2 = xp.subset(2,2,[],7:8);    <span class="comment">% 1x1x2x2</span>
0079     xp2.checkDims;
0080     xp2.getaxisinfo
0081     xp2 = xp2.squeeze;
0082     xp2.getaxisinfo
0083     xp2.checkDims
0084     <span class="comment">%%</span>
0085 clc
0086 xp2 = xp.subset(2,2,[],8);      <span class="comment">% 1x1x2x1</span>
0087     xp2.checkDims;
0088     xp2.getaxisinfo
0089     xp2 = xp2.squeeze;
0090     xp2.getaxisinfo
0091     xp2.checkDims
0092     <span class="comment">%%</span>
0093 clc
0094 xp2 = xp.subset(2,2,2,[]);      <span class="comment">% 1x1x1x8</span>
0095     xp2.checkDims;
0096     xp2.getaxisinfo
0097     xp2 = xp2.squeeze;
0098     xp2.getaxisinfo
0099     xp2.checkDims
0100     <span class="comment">%%</span>
0101 clc
0102 xp2 = xp.subset(1,[],2,1);      <span class="comment">% 1x2x1x1</span>
0103     xp2.checkDims;
0104     xp2.getaxisinfo
0105     xp2 = xp2.squeeze;
0106     xp2.getaxisinfo
0107     xp2.checkDims
0108     <span class="comment">%%</span>
0109 clc
0110 xp2 = xp.subset([],1,2,1);      <span class="comment">% 2x1x1x1</span>
0111     xp2.checkDims;
0112     xp2.getaxisinfo
0113     xp2 = xp2.squeeze;
0114     xp2.getaxisinfo
0115     xp2.checkDims
0116  
0117     <span class="comment">%%</span>
0118 clc
0119 xp3 = xp;
0120 xp3.data = xp.data(:,:,:,5:8);      <span class="comment">% Brute force selection of the xp.data.</span>
0121                                     <span class="comment">% Should produce an error when run</span>
0122                                     <span class="comment">% xp3.squeeze since axes dimensions</span>
0123                                     <span class="comment">% mismatch.</span>
0124 xp3.getaxisinfo;
0125 <span class="comment">% xp3.checkDims;      % Should produce an error</span>
0126 xp3 = xp3.fixAxes;
0127 xp3.checkDims;
0128 xp3.getaxisinfo;
0129                                     
0130 xp6 = xp.subset(1,[],2,1);
0131 
0132 
0133 <span class="comment">%% Run a recursive plot</span>
0134 
0135 clear xp2 xp3
0136 xp4 = (xp.subset([],[],[],8));
0137 xp4.getaxisinfo
0138 
0139 <span class="comment">% recursivePlot(xp4,{@xp_subplot,@xp_subplot,@xp_matrix_basicplot},{1:2,3},{{[],1},{1,1},{}});</span>
0140 <span class="comment">% recursivePlot(xp4,{@xp_subplot_grid3D,@xp_subplot,@xp_matrix_basicplot},{1:2,3},{{},{0,1},{}});</span>
0141 <span class="comment">% recursivePlot(xp4,{@xp_subplot_grid3D,@xp_matrix_basicplot},{[3,1,2]},{{},{}});</span>
0142 <a href="../functions_xPlt/classes/@xPlt/recursivePlot.html" class="code" title="function varargout = recursivePlot(xp,function_handles,dimensions,function_handle_arguments)">recursivePlot</a>(xp4,{@<a href="../functions_xPlt/library_plots/xp_subplot_grid3D.html" class="code" title="function hsg = xp_subplot_grid3D (xp,transpose_on, display_mode)">xp_subplot_grid3D</a>,@<a href="../functions_xPlt/library_plots/xp_subplot_grid3D.html" class="code" title="function hsg = xp_subplot_grid3D (xp,transpose_on, display_mode)">xp_subplot_grid3D</a>,@<a href="../functions_xPlt/library_plots/xp_matrix_basicplot.html" class="code" title="function xp_matrix_basicplot (xp)">xp_matrix_basicplot</a>},{[1,2,4],3},{{},{0,1},{}});
0143 
0144 
0145 <span class="comment">%% Run another recursive plot</span>
0146 clear xp2 xp3
0147 xp4 = (xp.subset([],[],[],8));
0148 xp4.getaxisinfo
0149 
0150 <span class="comment">% recursivePlot(xp4,{@xp_subplot,@xp_subplot,@xp_matrix_basicplot},{1:2,3},{{[],1},{1,1},{}});</span>
0151 <span class="comment">% recursivePlot(xp4,{@xp_subplot_grid3D,@xp_subplot,@xp_matrix_basicplot},{1:2,3},{{},{0,1},{}});</span>
0152 <span class="comment">% recursivePlot(xp4,{@xp_subplot_grid3D,@xp_matrix_basicplot},{[3,1,2]},{{},{}});</span>
0153 <a href="../functions_xPlt/classes/@xPlt/recursivePlot.html" class="code" title="function varargout = recursivePlot(xp,function_handles,dimensions,function_handle_arguments)">recursivePlot</a>(xp4,{@<a href="../functions_xPlt/library_plots/xp_subplot_grid3D.html" class="code" title="function hsg = xp_subplot_grid3D (xp,transpose_on, display_mode)">xp_subplot_grid3D</a>,@<a href="../functions_xPlt/library_plots/xp_matrix_basicplot.html" class="code" title="function xp_matrix_basicplot (xp)">xp_matrix_basicplot</a>},{[3,1,2]},{{},{}});
0154 
0155 
0156 <span class="comment">%% Run another recursive plot</span>
0157 clear xp2 xp3
0158 xp4 = (xp.subset([],[],1,8));
0159 xp4.getaxisinfo
0160 
0161 <span class="comment">% recursivePlot(xp4,{@xp_subplot,@xp_subplot,@xp_matrix_basicplot},{1:2,3},{{[],1},{1,1},{}});</span>
0162 <span class="comment">% recursivePlot(xp4,{@xp_subplot_grid3D,@xp_subplot,@xp_matrix_basicplot},{1:2,3},{{},{0,1},{}});</span>
0163 <span class="comment">% recursivePlot(xp4,{@xp_subplot_grid3D,@xp_matrix_basicplot},{[3,1,2]},{{},{}});</span>
0164 <a href="../functions_xPlt/classes/@xPlt/recursivePlot.html" class="code" title="function varargout = recursivePlot(xp,function_handles,dimensions,function_handle_arguments)">recursivePlot</a>(xp4,{@<a href="../functions_xPlt/library_plots/xp_subplot.html" class="code" title="function h=xp_subplot (xp,transpose_on,display_mode)">xp_subplot</a>,@<a href="../functions_xPlt/library_plots/xp_matrix_basicplot.html" class="code" title="function xp_matrix_basicplot (xp)">xp_matrix_basicplot</a>},{[1,2]},{{0,0},{}});
0165 
0166 
0167 
0168 
0169 <span class="comment">%% Test subset selection using regular expressions</span>
0170 xp5 = xp.subset([],[],[1],<span class="string">'iNa*'</span>);
0171 xp5.getaxisinfo
0172 
0173     <span class="comment">%%</span>
0174     xp5 = xp.subset([],[],[1],<span class="string">'_s'</span>);
0175     xp5.getaxisinfo
0176 
0177 <span class="comment">%% Test packDims</span>
0178 clear xp2 xp3 xp4 xp5
0179 <span class="comment">% xp2 = xp.subset(2,2,[],[1,3,5:8]);      % Selection based on index locations</span>
0180 xp2 = xp.subset(2,2,[],<span class="string">'(v|^i||ISYN$)'</span>);  <span class="comment">% Same thing as above using regular expression. Selects everything except the _s terms. &quot;^&quot; - beginning with; &quot;$&quot; - ending with</span>
0181 xp2 = xp2.squeeze;
0182 xp2.getaxisinfo;
0183 xp2 = xp2.packDim(2,3);
0184 xp2.getaxisinfo;
0185 
0186 <span class="comment">%% Test mergeDims</span>
0187 xp2 = xp.mergeDims([3,4]);
0188 
0189 
0190 <span class="comment">%% Load xPlt structure of images</span>
0191 
0192 cd outputs
0193 file = <span class="string">'demo_sPING_3b'</span>;
0194 data = <a href="../functions/ds.importPlots.html" class="code" title="function [data,studyinfo] = ds.importPlots(file,varargin)">ds.importPlots</a>(file);
0195 cd ..
0196 
0197 [data_linear,ax,ax_names] = <a href="../functions_xPlt/functions/DynaSimPlotExtract.html" class="code" title="function [data_linear,ax,ax_names,time] = DynaSimPlotExtract (data)">DynaSimPlotExtract</a> (data);
0198 
0199 xp = <a href="../functions_xPlt/classes/@xPlt/xPlt.html" class="code" title="">xPlt</a>;
0200 xp = xp.importLinearData(data_linear,ax{:});
0201 xp = xp.importAxisNames(ax_names);
0202 
0203 
0204 <span class="comment">% to do: rename DynaSimExtrat to DynaSimDataExtract</span>
0205 
0206 <span class="comment">%% Run recursive plot of images</span>
0207 <a href="../functions_xPlt/classes/@xPlt/recursivePlot.html" class="code" title="function varargout = recursivePlot(xp,function_handles,dimensions,function_handle_arguments)">recursivePlot</a>(xp,{@<a href="../functions_xPlt/library_plots/xp_subplot_grid3D.html" class="code" title="function hsg = xp_subplot_grid3D (xp,transpose_on, display_mode)">xp_subplot_grid3D</a>,@<a href="../functions_xPlt/library_plots/xp_plotimage.html" class="code" title="function xp_plotimage (xp,scale)">xp_plotimage</a>},{[1,2]},{{},{.25}});
0208 
0209 
0210 
0211 <span class="comment">%% Run ds.plotData2</span>
0212 <span class="comment">% ...Assumes we have some DynaSim data already loaded...</span>
0213 cd outputs
0214 data=<a href="../functions/ds.importData.html" class="code" title="function [data,studyinfo] = ds.importData(file,varargin)">ds.importData</a>(<span class="string">'demo_sPING_3b'</span>);
0215 cd ..
0216 
0217 
0218 <a href="ds.plotData2.html" class="code" title="function handles=ds.plotData2(data,varargin)">ds.plotData2</a>(data);
0219 <a href="ds.plotData2.html" class="code" title="function handles=ds.plotData2(data,varargin)">ds.plotData2</a>(data,<span class="string">'population'</span>,<span class="string">'E'</span>,<span class="string">'variable'</span>,<span class="string">'iNa'</span>,<span class="string">'varied'</span>,{<span class="string">'E_Iapp'</span>,1:2});
0220 <a href="ds.plotData2.html" class="code" title="function handles=ds.plotData2(data,varargin)">ds.plotData2</a>(data,<span class="string">'population'</span>,<span class="string">'E'</span>,<span class="string">'variable'</span>,<span class="string">'iNa'</span>,<span class="string">'varied'</span>,{{<span class="string">'E_Iapp'</span>,1:2},{<span class="string">'I_E_tauD'</span>,3}});
0221 
0222 
0223 <span class="comment">%% To implement</span>
0224 <span class="comment">%</span>
0225 <span class="comment">%</span>
0226 <span class="comment">% Implement the following:</span>
0227 <span class="comment">% 1. Example of averaging across cells</span>
0228 <span class="comment">% 2. Example of averaging synaptic currents (e.g. LFP estimate)</span>
0229 <span class="comment">% 3. Plotting - plots with embedded images</span>
0230 <span class="comment">% 4. Plotting - load images directly from DynaSim</span>
0231 <span class="comment">% 5. Starting work on ds.plotData2 - any new requests?</span></pre></div>
<hr><address>Generated on Mon 27-Feb-2017 14:58:50 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>