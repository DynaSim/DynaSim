<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of specdiff</title>
  <meta name="keywords" content="specdiff">
  <meta name="description" content="SPECDIFF - Scans two DynaSim specs for differences">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html functions -->
<h1>specdiff
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>SPECDIFF - Scans two DynaSim specs for differences</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [pop_diff,conn_diff] = specdiff(spec1,spec2,verbose) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">SPECDIFF - Scans two DynaSim specs for differences

 Usage:
   [pop_diff,conn_diff] = specdiff(spec1,spec2)

 Inputs:
    - spec1, spec2        : DynaSim model specifications to be compared

 Outputs:
    - pop_diff            : Structure summarizing differences between populations
    - conn_diff           : Structure summarizing differences between connections
    - verbose             : Bool - show or hide text output

 Dependencies:
   Requires the nDDims class, which should be party of DynaSim. If not,
   get it here https://github.com/davestanley/nDDims</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function [val,pop_name,properties] = extract_pop_lists(s)</a></li><li><a href="#_sub2" class="code">function [val,pop_name,properties] = extract_conn_lists(s)</a></li><li><a href="#_sub3" class="code">function out = mycompare(x,y)</a></li><li><a href="#_sub4" class="code">function fprintf_cells(string,cells2print)</a></li><li><a href="#_sub5" class="code">function [str_merged,ind1,ind2] = compare_string_cells(string1,string2)</a></li><li><a href="#_sub6" class="code">function run_comparison(nd)</a></li><li><a href="#_sub7" class="code">function s = return_comparison(nd)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [pop_diff,conn_diff] = specdiff(spec1,spec2,verbose)</a>
0002 <span class="comment">%SPECDIFF - Scans two DynaSim specs for differences</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% Usage:</span>
0005 <span class="comment">%   [pop_diff,conn_diff] = specdiff(spec1,spec2)</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% Inputs:</span>
0008 <span class="comment">%    - spec1, spec2        : DynaSim model specifications to be compared</span>
0009 <span class="comment">%</span>
0010 <span class="comment">% Outputs:</span>
0011 <span class="comment">%    - pop_diff            : Structure summarizing differences between populations</span>
0012 <span class="comment">%    - conn_diff           : Structure summarizing differences between connections</span>
0013 <span class="comment">%    - verbose             : Bool - show or hide text output</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% Dependencies:</span>
0016 <span class="comment">%   Requires the nDDims class, which should be party of DynaSim. If not,</span>
0017 <span class="comment">%   get it here https://github.com/davestanley/nDDims</span>
0018 
0019 debug_mode = 0;
0020 
0021 <span class="keyword">if</span> nargin &lt; 3
0022     verbose = true;
0023 <span class="keyword">end</span>
0024 
0025 
0026 <span class="keyword">if</span> ~exist(<span class="string">'nDDict'</span>,<span class="string">'class'</span>)
0027     fprintf(<span class="string">'This function requires the class nDDict. Make sure this is in your MATLAB path.\n'</span>);
0028     fprintf(<span class="string">'It can be downloaded from the following links: \n.'</span>);
0029     fprintf(<span class="string">'1. https://github.com/davestanley/nDDims \n'</span>);
0030     fprintf(<span class="string">'2. https://www.mathworks.com/matlabcentral/fileexchange/61656-multidimensional-dictionaries\n'</span>);
0031     error(<span class="string">'Missing dependency'</span>);
0032 <span class="keyword">end</span>
0033 
0034 <span class="comment">% % % % % % % % % % % % % % % % % % % %</span>
0035 <span class="comment">% % % % % % DO POPULATIONS % % % % % %</span>
0036 <span class="comment">% % % % % % % % % % % % % % % % % % % %</span>
0037 <span class="comment">% Build tables summarizing all information for both models</span>
0038 [val1,pop_name1,property1] = <a href="#_sub1" class="code" title="subfunction [val,pop_name,properties] = extract_pop_lists(s)">extract_pop_lists</a>(spec1.populations);
0039 [val2,pop_name2,property2] = <a href="#_sub1" class="code" title="subfunction [val,pop_name,properties] = extract_pop_lists(s)">extract_pop_lists</a>(spec2.populations);
0040 
0041 <span class="comment">% For example, this is how the table for spec1 should look</span>
0042 <span class="keyword">if</span> debug_mode 
0043     <span class="comment">% Arrange and view one of the tables</span>
0044     table = horzcat(pop_name1,property1,val1);
0045     table
0046 <span class="keyword">end</span>
0047 
0048 <span class="comment">% Merge spec1 and spec2 tables together into one huge table. Create a new</span>
0049 <span class="comment">% column to identify spec1 vs spec2 entries</span>
0050 val = vertcat(val1,val2);
0051 pop_names = vertcat(pop_name1,pop_name2);
0052 properties = vertcat(property1,property2);
0053 specID = vertcat(1*ones(length(val1),1), 2*ones(length(val2),1));       <span class="comment">% Identifier saying whether entry is from spec1 or spec2.</span>
0054 
0055 <span class="keyword">if</span> debug_mode 
0056     <span class="comment">% Arrange and view the huge table</span>
0057     table = horzcat(pop_name1,property1,specID,val1);
0058     table
0059 <span class="keyword">end</span>
0060 clear val1 val2 pop_name1 pop_name2 propert1 property2
0061 
0062 <span class="comment">% Build specs structure.</span>
0063 <span class="comment">% population name x entry x spec1 or spec2</span>
0064 nd = nDDict;
0065 nd = nd.importLinearData(val,pop_names,properties,specID);
0066 nd.axis(1).name = <span class="string">'Populations'</span>;
0067 nd.axis(2).name = <span class="string">'Properties'</span>;
0068 nd.axis(3).name = <span class="string">'SpecID'</span>;
0069 
0070 <span class="keyword">if</span> debug_mode
0071     nd.getaxisinfo
0072 <span class="keyword">end</span>
0073 
0074 <span class="keyword">if</span> verbose; <a href="#_sub6" class="code" title="subfunction run_comparison(nd)">run_comparison</a>(nd); <span class="keyword">end</span>
0075 <span class="keyword">if</span> nargout &gt; 0; pop_diff = <a href="#_sub7" class="code" title="subfunction s = return_comparison(nd)">return_comparison</a>(nd); <span class="keyword">end</span>
0076 
0077 <span class="keyword">if</span> verbose; fprintf(<span class="string">'\n\n'</span>); <span class="keyword">end</span>
0078 
0079 <span class="comment">% % % % % % % % % % % % % % % % % % % %</span>
0080 <span class="comment">% % % % % % DO CONNECTIONS % % % % % %</span>
0081 <span class="comment">% % % % % % % % % % % % % % % % % % % %</span>
0082 <span class="keyword">if</span> isfield(spec1, <span class="string">'connections'</span>)
0083     [val1,pop_name1,property1] = <a href="#_sub2" class="code" title="subfunction [val,pop_name,properties] = extract_conn_lists(s)">extract_conn_lists</a>(spec1.connections);
0084 <span class="keyword">else</span>
0085     val1 = {}; pop_name1 = {}; property1 = {};
0086 <span class="keyword">end</span>
0087    
0088 <span class="keyword">if</span> isfield(spec2, <span class="string">'connections'</span>)
0089     [val2,pop_name2,property2] = <a href="#_sub2" class="code" title="subfunction [val,pop_name,properties] = extract_conn_lists(s)">extract_conn_lists</a>(spec2.connections);
0090 <span class="keyword">else</span>
0091     val2 = {}; pop_name2 = {}; property2 = {};
0092 <span class="keyword">end</span>
0093 
0094 <span class="comment">% Merge spec1 and spec2 tables together into one huge table. Create a new</span>
0095 <span class="comment">% column to identify spec1 vs spec2 entries</span>
0096 val = vertcat(val1,val2);
0097 pop_names = vertcat(pop_name1,pop_name2);
0098 properties = vertcat(property1,property2);
0099 specID = vertcat(1*ones(length(val1),1), 2*ones(length(val2),1));       <span class="comment">% Identifier saying whether entry is from spec1 or spec2.</span>
0100 
0101 clear val1 val2 pop_name1 pop_name2 propert1 property2
0102 
0103 <span class="comment">% Build specs structure.</span>
0104 <span class="comment">% Connection name x entry x spec1 or spec2</span>
0105 <span class="keyword">if</span> ~isempty(val)
0106     
0107     nd = nDDict;
0108     nd = nd.importLinearData(val,pop_names,properties,specID);
0109     nd.axis(1).name = <span class="string">'Connections'</span>;
0110     nd.axis(2).name = <span class="string">'Properties'</span>;
0111     nd.axis(3).name = <span class="string">'SpecID'</span>;
0112     
0113     <span class="keyword">if</span> debug_mode
0114         nd.getaxisinfo
0115     <span class="keyword">end</span>
0116     
0117     <span class="keyword">if</span> verbose; <a href="#_sub6" class="code" title="subfunction run_comparison(nd)">run_comparison</a>(nd); <span class="keyword">end</span>
0118     <span class="keyword">if</span> nargout &gt; 1; conn_diff = <a href="#_sub7" class="code" title="subfunction s = return_comparison(nd)">return_comparison</a>(nd); <span class="keyword">end</span>
0119     
0120 <span class="keyword">else</span>
0121     
0122     conn_diff = struct();
0123     
0124 <span class="keyword">end</span>
0125 
0126 
0127 <span class="keyword">end</span>
0128 
0129 
0130 <a name="_sub1" href="#_subfunctions" class="code">function [val,pop_name,properties] = extract_pop_lists(s)</a>
0131     <span class="comment">% This function builds a huge table describing the properties of all of</span>
0132     <span class="comment">% the mechanisms in each population</span>
0133     
0134     <span class="comment">% Initialize output variables to empty cells</span>
0135     Nparams = arrayfun(@(x) length(x.parameters),s) / 2;
0136     Nproperties = Nparams + 3;      <span class="comment">% Add 3 for: size, equations, mechanism_list</span>
0137     val = cell(sum(Nproperties),1);
0138     pop_name = val;
0139     properties = val;
0140     
0141     N = length(s);
0142     
0143     k=0;
0144     <span class="keyword">for</span> i = 1:N     <span class="comment">% Loop over populations</span>
0145         k=k+1; field = <span class="string">'size'</span>; pop_name{k} = s(i).name; properties{k} = [<span class="string">'spec_'</span> field]; val{k} = s(i).(field);
0146         k=k+1; field = <span class="string">'equations'</span>; pop_name{k} = s(i).name; properties{k} = [<span class="string">'spec_'</span> field]; val{k} = s(i).(field);
0147         k=k+1; field = <span class="string">'mechanism_list'</span>; pop_name{k} = s(i).name; properties{k} = [<span class="string">'spec_'</span> field]; val{k} = s(i).(field);
0148         param_names = s(i).parameters(1:2:end);
0149         param_vals = s(i).parameters(2:2:end);
0150         <span class="keyword">for</span> j = 1:length(param_names)
0151             k=k+1; pop_name{k} = s(i).name; properties{k} = param_names{j}; val{k} = param_vals{j};
0152         <span class="keyword">end</span>
0153     <span class="keyword">end</span>
0154 <span class="keyword">end</span>
0155 
0156 
0157 <a name="_sub2" href="#_subfunctions" class="code">function [val,pop_name,properties] = extract_conn_lists(s)</a>
0158     <span class="comment">% This function builds a huge table describing the properties of all of</span>
0159     <span class="comment">% the mechanisms in each connection</span>
0160     
0161     <span class="comment">% Initialize output variables to empty cells</span>
0162     Nparams = arrayfun(@(x) length(x.parameters),s) / 2;
0163     Nproperties = Nparams + 1;      <span class="comment">% Add 1 for: mechanism_list</span>
0164     val = cell(sum(Nproperties),1);
0165     pop_name = val;
0166     properties = val;
0167     
0168     N = length(s);
0169     
0170     k=0;
0171     <span class="keyword">for</span> i = 1:N     <span class="comment">% Loop over connections</span>
0172         k=k+1; field = <span class="string">'mechanism_list'</span>; pop_name{k} = s(i).direction; properties{k} = [<span class="string">'spec_'</span> field]; val{k} = s(i).(field);
0173         param_names = s(i).parameters(1:2:end);
0174         param_vals = s(i).parameters(2:2:end);
0175         <span class="keyword">for</span> j = 1:length(param_names)
0176             k=k+1; pop_name{k} = s(i).direction; properties{k} = param_names{j}; val{k} = param_vals{j};
0177         <span class="keyword">end</span>
0178     <span class="keyword">end</span>
0179 <span class="keyword">end</span>
0180 
0181 
0182 
0183 <a name="_sub3" href="#_subfunctions" class="code">function out = mycompare(x,y)</a>
0184 
0185     <span class="keyword">if</span> isempty(x) &amp;&amp; isempty(y)
0186         out = -3;                   <span class="comment">% Missing from both</span>
0187     <span class="keyword">elseif</span> isempty(x) &amp;&amp; ~isempty(y)
0188         out = -1;                   <span class="comment">% Missing from spec1</span>
0189     <span class="keyword">elseif</span> ~isempty(x) &amp;&amp; isempty(y)
0190         out = -2;                   <span class="comment">% Missing from spec2</span>
0191     <span class="keyword">else</span>
0192         <span class="comment">% Parameter is present in both spec1 and spec2!!</span>
0193         <span class="keyword">if</span> isnumeric(x) &amp;&amp; isnumeric(y)
0194             out = x == y;       <span class="comment">% 1 codes for same, 0 codes for different</span>
0195         <span class="keyword">elseif</span> ischar(x) &amp;&amp; ischar(y)
0196             out = strcmp(x,y);
0197         <span class="keyword">elseif</span> iscell(x) &amp;&amp; iscell(y)
0198             <span class="keyword">if</span> length(x) == length(y)
0199                 temp = cellfun(@(x2,y2) <a href="#_sub3" class="code" title="subfunction out = mycompare(x,y)">mycompare</a>(x2,y2),x,y);
0200                 out = any(temp == 1);
0201             <span class="keyword">else</span>
0202                 out = -4;               <span class="comment">% Both cells but different lengths!</span>
0203             <span class="keyword">end</span>
0204         <span class="keyword">else</span>
0205             out = -5;                   <span class="comment">% If we reach this, spec1 and spec2 both have an entry, but the variable types are different.</span>
0206         <span class="keyword">end</span>
0207     <span class="keyword">end</span>
0208 
0209     out = double(out);
0210 <span class="keyword">end</span>
0211 
0212 
0213 <a name="_sub4" href="#_subfunctions" class="code">function fprintf_cells(string,cells2print)</a>
0214 
0215     <span class="keyword">if</span> ~isempty(cells2print)
0216         cells2print = cellfunu(@(x) [x <span class="string">' '</span>], cells2print);
0217         fprintf([string <span class="string">' '</span> cells2print{:} <span class="string">'\n'</span>]);
0218     <span class="keyword">end</span>
0219 
0220 <span class="keyword">end</span>
0221 
0222 
0223 <a name="_sub5" href="#_subfunctions" class="code">function [str_merged,ind1,ind2] = compare_string_cells(string1,string2)</a>
0224     str_merged = vertcat(string1(:),string2(:));
0225     str_merged = unique(str_merged);
0226     
0227     Nstr = length(str_merged);
0228     
0229     ind1 = false(1,Nstr);
0230     ind2 = false(1,Nstr);
0231     <span class="keyword">for</span> i = 1:length(str_merged)
0232         ind1(i) = any(strcmp(str_merged{i},string1));
0233         ind2(i) = any(strcmp(str_merged{i},string2));
0234     <span class="keyword">end</span>
0235     
0236 <span class="keyword">end</span>
0237 
0238 
0239 <a name="_sub6" href="#_subfunctions" class="code">function run_comparison(nd)</a>
0240 
0241     <span class="comment">% Now, we start doing the actual comparison between the two specs. This</span>
0242     <span class="comment">% first section looks at the populations in both spec1 and spec2, and</span>
0243     <span class="comment">% identifies those that mutually present.</span>
0244     allpops = nd.axis(1).values';
0245     Npops = length(allpops);
0246     spec1_pops = nd.axis(1).values(any(~cellfun(@isempty,nd.data(:,:,1)),2))';
0247     spec2_pops = nd.axis(1).values(any(~cellfun(@isempty,nd.data(:,:,2)),2))';
0248 <span class="comment">%     spec1_pops = {spec1.populations.name};</span>
0249 <span class="comment">%     spec2_pops = {spec2.populations.name};</span>
0250 
0251     ind1 = false(1,Npops);
0252     ind2 = false(1,Npops);
0253 
0254     <span class="keyword">for</span> i = 1:length(allpops)
0255         ind1(i) = any(strcmp(allpops{i},spec1_pops));
0256         ind2(i) = any(strcmp(allpops{i},spec2_pops));
0257     <span class="keyword">end</span>
0258 
0259     name = lower(nd.axis(1).name);
0260     fprintf(<span class="string">'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n'</span>);
0261     fprintf([<span class="string">'~~~~~~~~~~~~~~~~~~~~~~~~Comparison of '</span> name <span class="string">' ~~~~~~~~~~~~~~~~~~~~~~~~~\n'</span>]);
0262     fprintf(<span class="string">'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n'</span>);
0263     <a href="#_sub4" class="code" title="subfunction fprintf_cells(string,cells2print)">fprintf_cells</a>(<span class="string">'Populations only in spec1:'</span>, allpops(ind1 &amp; ~ind2));
0264     <a href="#_sub4" class="code" title="subfunction fprintf_cells(string,cells2print)">fprintf_cells</a>(<span class="string">'Populations only in spec2:'</span>, allpops(~ind1 &amp; ind2));
0265     <a href="#_sub4" class="code" title="subfunction fprintf_cells(string,cells2print)">fprintf_cells</a>(<span class="string">'Populations in both:'</span>, allpops(ind1 &amp; ind2));
0266     fprintf(<span class="string">'\n'</span>);
0267 
0268     <span class="comment">% Now that we know the populations mutually present in both models, we will</span>
0269     <span class="comment">% proceed to compare the parameters for these populations.</span>
0270 
0271     inds_both = find(ind1 &amp; ind2);        <span class="comment">% Indices of populations present in both spec1 and spec2</span>
0272 
0273     <span class="comment">% First, build matrix summarizing differences between all populations in</span>
0274     <span class="comment">% both models</span>
0275     params1 = nd.data(:,:,1);
0276     params2 = nd.data(:,:,2);
0277 
0278     inds = cellfunu(@(x,y) <a href="#_sub3" class="code" title="subfunction out = mycompare(x,y)">mycompare</a>(x,y), params1,params2);
0279     inds2 = cell2mat(inds);
0280 
0281     <span class="comment">% Loop through each population present in both models and compare</span>
0282     <span class="comment">% mechanisms</span>
0283     <span class="keyword">for</span> i = inds_both
0284         
0285         inds_curr = inds2(i,:);                     <span class="comment">% Comparison indices for current population</span>
0286         inds_different = inds_curr ~= 1;            <span class="comment">% Tracks whether there are differences of some sort...</span>
0287         inds_different(inds_curr == -3) = 0;        <span class="comment">% If these differences are due to the mechanism being missing from both specs, ignore.</span>
0288         
0289         <span class="keyword">if</span> any(inds_different)          <span class="comment">% If there are differences of some sort, show comparison</span>
0290                                                                 <span class="comment">%</span>
0291             fprintf(<span class="string">'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n'</span>);
0292             fprintf([<span class="string">'Comparing mechs in '</span> name <span class="string">' '</span> nd.axis(1).values{i} <span class="string">' \n'</span>]);
0293             
0294 
0295             <span class="comment">% List mechanisms common to both populations, or those missing from one</span>
0296             <span class="comment">% but present in the other</span>
0297             nd1 = nd.subset(i,<span class="string">'spec_mechanism_list'</span>,1);  <span class="comment">% Mechanisms in spec1</span>
0298             nd2 = nd.subset(i,<span class="string">'spec_mechanism_list'</span>,2);  <span class="comment">% Mechanisms in spec2</span>
0299             [str_merged,ind1,ind2] = <a href="#_sub5" class="code" title="subfunction [str_merged,ind1,ind2] = compare_string_cells(string1,string2)">compare_string_cells</a>(nd1.data{:},nd2.data{:});
0300             <a href="#_sub4" class="code" title="subfunction fprintf_cells(string,cells2print)">fprintf_cells</a>(<span class="string">'Mechs only in spec1:'</span>, str_merged(ind1 &amp; ~ind2));
0301             <a href="#_sub4" class="code" title="subfunction fprintf_cells(string,cells2print)">fprintf_cells</a>(<span class="string">'Mechs only in spec2:'</span>, str_merged(~ind1 &amp; ind2));
0302             <span class="comment">% fprintf_cells('Mechs in both:', str_merged(ind1 &amp; ind2));</span>
0303 
0304 
0305             <span class="comment">% Print parameters common to both population, or those missing from one</span>
0306             <span class="comment">% but present in the other</span>
0307             temp = inds_curr == -1; <a href="#_sub4" class="code" title="subfunction fprintf_cells(string,cells2print)">fprintf_cells</a>([<span class="string">'Parameters present in spec1 but missing in spec2:'</span> ], nd.axis(2).values(temp)); 
0308             temp = inds_curr == -2; <a href="#_sub4" class="code" title="subfunction fprintf_cells(string,cells2print)">fprintf_cells</a>([<span class="string">'Parameters present in spec2 but missing in spec1:'</span> ], nd.axis(2).values(temp)); 
0309             temp = inds_curr == -4; <a href="#_sub4" class="code" title="subfunction fprintf_cells(string,cells2print)">fprintf_cells</a>([<span class="string">'Parameters are incomparable because they are cell arrays of different lengths:'</span> ], nd.axis(2).values(temp)); 
0310             temp = inds_curr == -5; <a href="#_sub4" class="code" title="subfunction fprintf_cells(string,cells2print)">fprintf_cells</a>([<span class="string">'Parameters are incomparable because they are different data types (e.g. one is string, one is numeric):'</span> ], nd.axis(2).values(temp)); 
0311             <span class="comment">%temp = inds_curr == 1; fprintf_cells(['Parameters are identical in spec1 and spec2:' ], nd.axis(2).values(temp));</span>
0312             temp = inds_curr == 0; <a href="#_sub4" class="code" title="subfunction fprintf_cells(string,cells2print)">fprintf_cells</a>([<span class="string">'Parameters differing between '</span> nd.axis(1).values{i} <span class="string">':'</span> ], nd.axis(2).values(temp)); 
0313 
0314             <span class="comment">% For the mutual parameters, list ones that have different values</span>
0315             ind_diff = find(inds_curr == 0);
0316             <span class="keyword">for</span> j = ind_diff
0317                 val1 = nd.data{i,j,1};
0318                 val2 = nd.data{i,j,2};
0319                 <span class="keyword">if</span> isnumeric(val1); val1 = num2str(val1); <span class="keyword">end</span>
0320                 <span class="keyword">if</span> isnumeric(val2); val2 = num2str(val2); <span class="keyword">end</span>
0321                 <span class="keyword">if</span> ischar(val1) &amp;&amp; ischar(val2)
0322                     fprintf([<span class="string">'Mechanism '</span> nd.axis(2).values{j} <span class="string">' is '</span> val1 <span class="string">' for spec1 and '</span> val2 <span class="string">' for spec2 \n'</span>]);
0323                 <span class="keyword">end</span>
0324             <span class="keyword">end</span>
0325             
0326             fprintf(<span class="string">'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n'</span>);
0327         <span class="keyword">end</span>
0328 
0329     <span class="keyword">end</span>
0330 <span class="keyword">end</span>
0331 
0332 <a name="_sub7" href="#_subfunctions" class="code">function s = return_comparison(nd)</a>
0333 
0334     sz = size(nd.data);
0335     Npop = sz(1);
0336     
0337     <span class="keyword">for</span> i = 1:Npop
0338         s(i).name = nd.axis(1).values(i);
0339         temp = horzcat(nd.axis(2).values, nd.data(i,:,1)', nd.data(i,:,2)');
0340         inds = cellfun(@(x,y) isempty(x) &amp;&amp; isempty(y),temp(:,2), temp(:,3));      <span class="comment">% Parameters that are abscent from both pops</span>
0341         temp = temp(~inds,:);                                                      <span class="comment">% Remove these parameters</span>
0342         s(i).parameter_names_values = temp;
0343         
0344         str = <span class="string">'spec_size'</span>; ind = strcmp(nd.axis(2).values,str); <span class="keyword">if</span> any(ind); s(i).([str <span class="string">'1'</span>]) = nd.data{i,ind,1}; s(i).([str <span class="string">'2'</span>]) = nd.data{i,ind,2}; <span class="keyword">end</span>
0345         str = <span class="string">'spec_equations'</span>; ind = strcmp(nd.axis(2).values,str); <span class="keyword">if</span> any(ind); s(i).([str <span class="string">'1'</span>]) = nd.data{i,ind,1}; s(i).([str <span class="string">'2'</span>]) = nd.data{i,ind,2}; <span class="keyword">end</span>
0346         str = <span class="string">'spec_mechanism_list'</span>; ind = strcmp(nd.axis(2).values,str); <span class="keyword">if</span> any(ind); s(i).([str <span class="string">'1'</span>]) = nd.data{i,ind,1}; s(i).([str <span class="string">'2'</span>]) = nd.data{i,ind,2}; <span class="keyword">end</span>
0347     <span class="keyword">end</span>
0348     
0349 
0350 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 07-Apr-2017 20:01:20 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>